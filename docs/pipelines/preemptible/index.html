<!doctype html>
<html itemscope itemtype="http://schema.org/WebPage" lang="en" class="no-js">
  <head>
    <meta charset="utf-8">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<meta name="generator" content="Hugo 0.105.0">
<meta name="robots" content="index, follow">

<script type="application/ld+json">
  {
      "@context" : "http://schema.org",
      "@type" : "WebSite",
      "mainEntityOfPage": {
           "@type": "WebPage",
           "@id": "https:\/\/gkcalat.github.io\/kubeflow-docs"
      },
      "articleSection" : "docs",
      "name" : "Using Preemptible VMs and GPUs on Google Cloud",
      "headline" : "Using Preemptible VMs and GPUs on Google Cloud",
      "description" : "Configuring preemptible VMs and GPUs for Kubeflow Pipelines on Google Cloud",
      "inLanguage" : "en-US",
      "author" : "",
      "creator" : "",
      "publisher": "",
      "accountablePerson" : "",
      "copyrightHolder" : "",
      "copyrightYear" : "0001",
      "datePublished": "0001-01-01 00:00:00 \u002b0000 UTC",
      "dateModified" : "0001-01-01 00:00:00 \u002b0000 UTC",
      "url" : "https:\/\/gkcalat.github.io\/kubeflow-docs\/docs\/pipelines\/preemptible\/",
      "wordCount" : "1355",
      "keywords" : [ "Kubeflow on GCP" ]
  }
  </script>

<link rel="shortcut icon" href="/kubeflow-docs/favicons/favicon.ico" >
<link rel="apple-touch-icon" href="/kubeflow-docs/favicons/apple-touch-icon-180x180.png" sizes="180x180">
<link rel="icon" type="image/png" href="/kubeflow-docs/favicons/favicon-16x16.png" sizes="16x16">
<link rel="icon" type="image/png" href="/kubeflow-docs/favicons/favicon-32x32.png" sizes="32x32">
<link rel="manifest" href="/kubeflow-docs/favicons/manifest.json">
<meta name="msapplication-config" content="/kubeflow-docs/favicons/browserconfig.xml" />
<meta name="msapplication-TileColor" content="#4279f4">
<meta name="theme-color" content="#4279f4">

<title>Using Preemptible VMs and GPUs on Google Cloud | Kubeflow on Google Cloud Platform</title>
<meta name="description" content="Configuring preemptible VMs and GPUs for Kubeflow Pipelines on Google Cloud">
<meta property="og:title" content="Using Preemptible VMs and GPUs on Google Cloud" />
<meta property="og:description" content="Configuring preemptible VMs and GPUs for Kubeflow Pipelines on Google Cloud" />
<meta property="og:type" content="article" />
<meta property="og:url" content="https://gkcalat.github.io/kubeflow-docs/docs/pipelines/preemptible/" /><meta property="article:section" content="docs" />

<meta property="article:modified_time" content="2022-11-11T00:13:55+00:00" /><meta property="og:site_name" content="Kubeflow on Google Cloud Platform" />

<meta itemprop="name" content="Using Preemptible VMs and GPUs on Google Cloud">
<meta itemprop="description" content="Configuring preemptible VMs and GPUs for Kubeflow Pipelines on Google Cloud">
<meta itemprop="dateModified" content="2022-11-11T00:13:55+00:00" />
<meta itemprop="wordCount" content="1355">
<meta itemprop="keywords" content="" /><meta name="twitter:card" content="summary"/>
<meta name="twitter:title" content="Using Preemptible VMs and GPUs on Google Cloud"/>
<meta name="twitter:description" content="Configuring preemptible VMs and GPUs for Kubeflow Pipelines on Google Cloud"/>




<link rel="preload" href="/kubeflow-docs/scss/main.min.5006b434b14f73c3d5537a7ba4c8ecef723ddc93f3a3c8530e19d24f75486ea9.css" as="style">
<link href="/kubeflow-docs/scss/main.min.5006b434b14f73c3d5537a7ba4c8ecef723ddc93f3a3c8530e19d24f75486ea9.css" rel="stylesheet" integrity="">

<script
  src="https://code.jquery.com/jquery-3.5.1.min.js"
  integrity="sha256-9/aliU8dGd2tb6OSsuzixeV4y/faTqgFtohetphbbj0="
  crossorigin="anonymous"></script>

<script async src="https://www.googletagmanager.com/gtag/js?id=G-GK9XL47N6S"></script>
<script>
var doNotTrack = false;
if (!doNotTrack) {
	window.dataLayer = window.dataLayer || [];
	function gtag(){dataLayer.push(arguments);}
	gtag('js', new Date());
	gtag('config', 'G-GK9XL47N6S', { 'anonymize_ip': false });
}
</script>

  </head>
  <body class="td-page">
    <header>
      
<nav class="js-navbar-scroll navbar navbar-expand-md navbar-dark  td-navbar">
        <a class="navbar-brand" href="/kubeflow-docs/">
		<span class="navbar-logo"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 276.93 274.55"><g data-name="Layer 2"><g data-name="Layer 1"><path d="M95.9 62.15l4.1 102.1 73.75-94.12a6.79 6.79.0 019.6-1.11l46 36.92-15-65.61z" fill="#4279f4"/><path fill="#0028aa" d="M102.55 182.98h65.42l-40.17-32.23-25.25 32.23z"/><path fill="#014bd1" d="M180.18 83.92l-44 56.14 46.88 37.61 44.47-55.76-47.35-37.99z"/><path fill="#bedcff" d="M83.56 52.3l.01-.01 38.69-48.52-62.39 30.05-15.41 67.51 39.1-49.03z"/><path fill="#6ca1ff" d="M45.32 122.05l41.44 51.96-3.95-98.98-37.49 47.02z"/><path fill="#a1c3ff" d="M202.31 28.73 142.65.0l-37.13 46.56 96.79-17.83z"/><path d="M1.6 272v-44.78h5.74v23.41l20.48-23.41h6.4l-17.39 19.7 19 25.07H29.1l-15.92-20.8-5.84 6.65V272zm40.02-9.79V240h5.43v22.39a4.67 4.67.0 002.35 4.19 11 11 0 0011 0 4.69 4.69.0 002.33-4.19V240h5.43v22.19a9.08 9.08.0 01-4.1 7.87 16.2 16.2.0 01-18.37.0 9.07 9.07.0 01-4.07-7.85zM77.46 272v-48h5.43v16.81a29.29 29.29.0 019.32-1.73 13.1 13.1.0 016.2 1.41 10.71 10.71.0 014.18 3.74 18.07 18.07.0 012.23 5.06 21.26 21.26.0 01.73 5.58q0 8.43-4.38 12.79T87.35 272zm5.43-4.87h4.55q6.77.0 9.72-2.95t3-9.51a14.21 14.21.0 00-2-7.52 6.55 6.55.0 00-6-3.22 24.73 24.73.0 00-9.25 1.54zm29.47-11.19q0-7.71 4.09-12.3a13.75 13.75.0 0110.8-4.59q13.35.0 13.36 18.86h-22.82a12.3 12.3.0 002.9 7.07q2.59 3.11 7.9 3.1a24.92 24.92.0 0010.55-2v5a27.74 27.74.0 01-9.86 1.87 19.83 19.83.0 01-7.7-1.37 13.31 13.31.0 01-5.28-3.76 16.21 16.21.0 01-3-5.38 20.84 20.84.0 01-.94-6.5zm5.62-2.12h17.26a14.91 14.91.0 00-2.37-7.12 6.44 6.44.0 00-5.62-2.78 8.2 8.2.0 00-6.21 2.72 12.07 12.07.0 00-3.04 7.18z" fill="#4279f4" stroke="#4279f4" stroke-miterlimit="10" stroke-width="3.2"/><path d="M147.32 244.89V240h5v-7.59a8.14 8.14.0 012.31-6.05 7.79 7.79.0 015.69-2.28h7.86V229h-5c-2.21.0-3.67.45-4.37 1.34s-1.06 2.55-1.06 5V240h8.46v4.87h-8.46V272h-5.44v-27.1zM175.26 272v-48h5.43v48zm19.15-3.95a17.86 17.86.0 1112.33 4.9 16.57 16.57.0 01-12.33-4.9zm3.84-20.65a13.16 13.16.0 000 17.2 12.07 12.07.0 0017 0 13.09 13.09.0 000-17.2 12.07 12.07.0 00-17 0zm30.2-7.4h5.75l7.3 25.32 7.43-25.32h5.36l7.34 25.34L269 240h5.74l-10.04 32h-6.12l-6.83-24.58L245 272h-6.47z" fill="#0028aa" stroke="#0028aa" stroke-miterlimit="10" stroke-width="3.2"/></g></g></svg></span><span class="text-uppercase font-weight-bold">Kubeflow on Google Cloud Platform</span>
	</a>
	<button class="navbar-toggler" type="button" data-toggle="collapse" data-target="#main_navbar" aria-controls="main_navbar" aria-expanded="false" aria-label="Toggle navigation">
		<span class="navbar-toggler-icon"></span>
	</button>
	<div class="collapse navbar-collapse ml-md-auto" id="main_navbar">
		<ul class="navbar-nav ml-auto pt-4 pt-md-0 my-2 my-md-1">
			
			
			<li class="nav-item mr-2 mr-lg-4 mt-1 mt-lg-0">
				
				
				
				
				
				
				<a class="nav-link" href="/kubeflow-docs/docs/" ><span>Docs</span></a>
			</li>
			
			<li class="nav-item mr-2 mr-lg-4 mt-1 mt-lg-0">
				
				
				
				
				
				
				<a class="nav-link" href="/kubeflow-docs/news/" ><span>News</span></a>
			</li>
			
			<li class="nav-item mr-2 mr-lg-4 mt-1 mt-lg-0">
				
				
				
				
				
				
				<a class="nav-link" href="https://github.com/GoogleCloudPlatform/kubeflow-distribution" target="_blank" ><i class='fa-brands fa-github pr-2'></i><span>Manifests</span></a>
			</li>
			
			
			<li class="nav-item dropdown mt-1 mt-lg-0 mr-2">
				<a class="nav-link dropdown-toggle" href="#" id="navbarDropdown" role="button" data-toggle="dropdown" aria-haspopup="true" aria-expanded="false">
	dev
</a>
<div class="dropdown-menu dropdown-menu-md-right dropdown-menu-lg-left" aria-labelledby="navbarDropdownMenuLink">
	
	<a class="dropdown-item" href="https://gkcalat.github.io/kubeflow-docs/docs">v1.6 (latest)</a>
	
	<a class="dropdown-item" href="https://gkcalat.github.io/kubeflow-docs/v1.5/docs">v1.5</a>
	
	<a class="dropdown-item" href="https://gkcalat.github.io/kubeflow-docs/v1.4/docs">v1.4</a>
	
	<a class="dropdown-item" href="https://gkcalat.github.io/kubeflow-docs/dev/docs">dev</a>
	
</div>

			</li>
			
			
		</ul>
	</div>
</nav>

    </header>
    <div class="container-fluid td-outer">
      <div class="td-main">
        <div class="row flex-xl-nowrap">
          <aside class="col-12 col-md-3 col-xl-2 td-sidebar d-print-none">
            
<div id="td-sidebar-menu" class="td-sidebar__inner">
  <form class="td-sidebar__search d-flex align-items-center">
    
    <button class="btn btn-link td-sidebar__toggle d-md-none p-0 ml-3 fas fa-bars" type="button" data-toggle="collapse" data-target="#td-section-nav" aria-controls="td-section-nav" aria-expanded="false" aria-label="Toggle section navigation">
    </button>
  </form>
  <nav class="collapse td-sidebar-nav foldable-nav" id="td-section-nav">
    <ul class="td-sidebar-nav__section pr-md-3 ul-0">
      <li class="td-sidebar-nav__section-title td-sidebar-nav__section with-child active-path" id="m-kubeflow-docsdocs-li">
  <a href="/kubeflow-docs/docs/" class="align-left pl-0 td-sidebar-link td-sidebar-link__section tree-root" id="m-kubeflow-docsdocs"><span class="">Kubeflow on Google Cloud</span></a>
  <ul class="ul-1">
    <li class="td-sidebar-nav__section-title td-sidebar-nav__section with-child" id="m-kubeflow-docsdocsdeploy-li">
  <input type="checkbox" id="m-kubeflow-docsdocsdeploy-check"/>
  <label for="m-kubeflow-docsdocsdeploy-check"><a href="/kubeflow-docs/docs/deploy/" class="align-left pl-0  td-sidebar-link td-sidebar-link__section" id="m-kubeflow-docsdocsdeploy"><span class="">Deployment</span></a></label>
  
  <ul class="ul-2 foldable">
    <li class="td-sidebar-nav__section-title td-sidebar-nav__section without-child" id="m-kubeflow-docsdocsdeployoverview-li">
  <input type="checkbox" id="m-kubeflow-docsdocsdeployoverview-check"/>
  <label for="m-kubeflow-docsdocsdeployoverview-check"><a href="/kubeflow-docs/docs/deploy/overview/" class="align-left pl-0  td-sidebar-link td-sidebar-link__page" id="m-kubeflow-docsdocsdeployoverview"><span class="">Overview</span></a></label>
  
</li><li class="td-sidebar-nav__section-title td-sidebar-nav__section without-child" id="m-kubeflow-docsdocsdeployproject-setup-li">
  <input type="checkbox" id="m-kubeflow-docsdocsdeployproject-setup-check"/>
  <label for="m-kubeflow-docsdocsdeployproject-setup-check"><a href="/kubeflow-docs/docs/deploy/project-setup/" class="align-left pl-0  td-sidebar-link td-sidebar-link__page" id="m-kubeflow-docsdocsdeployproject-setup"><span class="">Setting up GCP Project</span></a></label>
  
</li><li class="td-sidebar-nav__section-title td-sidebar-nav__section without-child" id="m-kubeflow-docsdocsdeployoauth-setup-li">
  <input type="checkbox" id="m-kubeflow-docsdocsdeployoauth-setup-check"/>
  <label for="m-kubeflow-docsdocsdeployoauth-setup-check"><a href="/kubeflow-docs/docs/deploy/oauth-setup/" class="align-left pl-0  td-sidebar-link td-sidebar-link__page" id="m-kubeflow-docsdocsdeployoauth-setup"><span class="">Setting up OAuth client</span></a></label>
  
</li><li class="td-sidebar-nav__section-title td-sidebar-nav__section without-child" id="m-kubeflow-docsdocsdeploymanagement-setup-li">
  <input type="checkbox" id="m-kubeflow-docsdocsdeploymanagement-setup-check"/>
  <label for="m-kubeflow-docsdocsdeploymanagement-setup-check"><a href="/kubeflow-docs/docs/deploy/management-setup/" class="align-left pl-0  td-sidebar-link td-sidebar-link__page" id="m-kubeflow-docsdocsdeploymanagement-setup"><span class="">Deploying Management cluster</span></a></label>
  
</li><li class="td-sidebar-nav__section-title td-sidebar-nav__section without-child" id="m-kubeflow-docsdocsdeploydeploy-cli-li">
  <input type="checkbox" id="m-kubeflow-docsdocsdeploydeploy-cli-check"/>
  <label for="m-kubeflow-docsdocsdeploydeploy-cli-check"><a href="/kubeflow-docs/docs/deploy/deploy-cli/" class="align-left pl-0  td-sidebar-link td-sidebar-link__page" id="m-kubeflow-docsdocsdeploydeploy-cli"><span class="">Deploying Kubeflow cluster</span></a></label>
  
</li><li class="td-sidebar-nav__section-title td-sidebar-nav__section without-child" id="m-kubeflow-docsdocsdeployupgrade-li">
  <input type="checkbox" id="m-kubeflow-docsdocsdeployupgrade-check"/>
  <label for="m-kubeflow-docsdocsdeployupgrade-check"><a href="/kubeflow-docs/docs/deploy/upgrade/" class="align-left pl-0  td-sidebar-link td-sidebar-link__page" id="m-kubeflow-docsdocsdeployupgrade"><span class="">Upgrade Kubeflow</span></a></label>
  
</li><li class="td-sidebar-nav__section-title td-sidebar-nav__section without-child" id="m-kubeflow-docsdocsdeploymonitor-iap-setup-li">
  <input type="checkbox" id="m-kubeflow-docsdocsdeploymonitor-iap-setup-check"/>
  <label for="m-kubeflow-docsdocsdeploymonitor-iap-setup-check"><a href="/kubeflow-docs/docs/deploy/monitor-iap-setup/" class="align-left pl-0  td-sidebar-link td-sidebar-link__page" id="m-kubeflow-docsdocsdeploymonitor-iap-setup"><span class="">Monitoring Cloud IAP Setup</span></a></label>
  
</li><li class="td-sidebar-nav__section-title td-sidebar-nav__section without-child" id="m-kubeflow-docsdocsdeploydelete-cli-li">
  <input type="checkbox" id="m-kubeflow-docsdocsdeploydelete-cli-check"/>
  <label for="m-kubeflow-docsdocsdeploydelete-cli-check"><a href="/kubeflow-docs/docs/deploy/delete-cli/" class="align-left pl-0  td-sidebar-link td-sidebar-link__page" id="m-kubeflow-docsdocsdeploydelete-cli"><span class="">Deleting Kubeflow</span></a></label>
  
</li>
  </ul>
</li><li class="td-sidebar-nav__section-title td-sidebar-nav__section with-child active-path" id="m-kubeflow-docsdocspipelines-li">
  <input type="checkbox" id="m-kubeflow-docsdocspipelines-check" checked/>
  <label for="m-kubeflow-docsdocspipelines-check"><a href="/kubeflow-docs/docs/pipelines/" class="align-left pl-0  td-sidebar-link td-sidebar-link__section" id="m-kubeflow-docsdocspipelines"><span class="">Pipelines on Google Cloud</span></a></label>
  
  <ul class="ul-2 foldable">
    <li class="td-sidebar-nav__section-title td-sidebar-nav__section without-child" id="m-kubeflow-docsdocspipelinesauthentication-sdk-li">
  <input type="checkbox" id="m-kubeflow-docsdocspipelinesauthentication-sdk-check"/>
  <label for="m-kubeflow-docsdocspipelinesauthentication-sdk-check"><a href="/kubeflow-docs/docs/pipelines/authentication-sdk/" class="align-left pl-0  td-sidebar-link td-sidebar-link__page" id="m-kubeflow-docsdocspipelinesauthentication-sdk"><span class="">Connecting to Kubeflow Pipelines on Google Cloud using the SDK</span></a></label>
  
</li><li class="td-sidebar-nav__section-title td-sidebar-nav__section without-child" id="m-kubeflow-docsdocspipelinesauthentication-pipelines-li">
  <input type="checkbox" id="m-kubeflow-docsdocspipelinesauthentication-pipelines-check"/>
  <label for="m-kubeflow-docsdocspipelinesauthentication-pipelines-check"><a href="/kubeflow-docs/docs/pipelines/authentication-pipelines/" class="align-left pl-0  td-sidebar-link td-sidebar-link__page" id="m-kubeflow-docsdocspipelinesauthentication-pipelines"><span class="">Authenticating Pipelines to Google Cloud</span></a></label>
  
</li><li class="td-sidebar-nav__section-title td-sidebar-nav__section without-child" id="m-kubeflow-docsdocspipelinesupgrade-li">
  <input type="checkbox" id="m-kubeflow-docsdocspipelinesupgrade-check"/>
  <label for="m-kubeflow-docsdocspipelinesupgrade-check"><a href="/kubeflow-docs/docs/pipelines/upgrade/" class="align-left pl-0  td-sidebar-link td-sidebar-link__page" id="m-kubeflow-docsdocspipelinesupgrade"><span class="">Upgrading</span></a></label>
  
</li><li class="td-sidebar-nav__section-title td-sidebar-nav__section without-child" id="m-kubeflow-docsdocspipelinesenable-gpu-and-tpu-li">
  <input type="checkbox" id="m-kubeflow-docsdocspipelinesenable-gpu-and-tpu-check"/>
  <label for="m-kubeflow-docsdocspipelinesenable-gpu-and-tpu-check"><a href="/kubeflow-docs/docs/pipelines/enable-gpu-and-tpu/" class="align-left pl-0  td-sidebar-link td-sidebar-link__page" id="m-kubeflow-docsdocspipelinesenable-gpu-and-tpu"><span class="">Enabling GPU and TPU</span></a></label>
  
</li><li class="td-sidebar-nav__section-title td-sidebar-nav__section without-child active-path" id="m-kubeflow-docsdocspipelinespreemptible-li">
  <input type="checkbox" id="m-kubeflow-docsdocspipelinespreemptible-check" checked/>
  <label for="m-kubeflow-docsdocspipelinespreemptible-check"><a href="/kubeflow-docs/docs/pipelines/preemptible/" class="align-left pl-0  active td-sidebar-link td-sidebar-link__page" id="m-kubeflow-docsdocspipelinespreemptible"><span class="td-sidebar-nav-active-item">Using Preemptible VMs and GPUs on Google Cloud</span></a></label>
  
</li>
  </ul>
</li><li class="td-sidebar-nav__section-title td-sidebar-nav__section without-child" id="m-kubeflow-docsdocscustomizing-li">
  <input type="checkbox" id="m-kubeflow-docsdocscustomizing-check"/>
  <label for="m-kubeflow-docsdocscustomizing-check"><a href="/kubeflow-docs/docs/customizing/" class="align-left pl-0  td-sidebar-link td-sidebar-link__page" id="m-kubeflow-docsdocscustomizing"><span class="">Customize Kubeflow on GKE</span></a></label>
  
</li><li class="td-sidebar-nav__section-title td-sidebar-nav__section without-child" id="m-kubeflow-docsdocscustom-domain-li">
  <input type="checkbox" id="m-kubeflow-docsdocscustom-domain-check"/>
  <label for="m-kubeflow-docsdocscustom-domain-check"><a href="/kubeflow-docs/docs/custom-domain/" class="align-left pl-0  td-sidebar-link td-sidebar-link__page" id="m-kubeflow-docsdocscustom-domain"><span class="">Using Your Own Domain</span></a></label>
  
</li><li class="td-sidebar-nav__section-title td-sidebar-nav__section without-child" id="m-kubeflow-docsdocsauthentication-li">
  <input type="checkbox" id="m-kubeflow-docsdocsauthentication-check"/>
  <label for="m-kubeflow-docsdocsauthentication-check"><a href="/kubeflow-docs/docs/authentication/" class="align-left pl-0  td-sidebar-link td-sidebar-link__page" id="m-kubeflow-docsdocsauthentication"><span class="">Authenticating Kubeflow to Google Cloud</span></a></label>
  
</li><li class="td-sidebar-nav__section-title td-sidebar-nav__section without-child" id="m-kubeflow-docsdocsprivate-clusters-li">
  <input type="checkbox" id="m-kubeflow-docsdocsprivate-clusters-check"/>
  <label for="m-kubeflow-docsdocsprivate-clusters-check"><a href="/kubeflow-docs/docs/private-clusters/" class="align-left pl-0  td-sidebar-link td-sidebar-link__page" id="m-kubeflow-docsdocsprivate-clusters"><span class="">Securing Your Clusters</span></a></label>
  
</li><li class="td-sidebar-nav__section-title td-sidebar-nav__section without-child" id="m-kubeflow-docsdocstroubleshooting-li">
  <input type="checkbox" id="m-kubeflow-docsdocstroubleshooting-check"/>
  <label for="m-kubeflow-docsdocstroubleshooting-check"><a href="/kubeflow-docs/docs/troubleshooting/" class="align-left pl-0  td-sidebar-link td-sidebar-link__page" id="m-kubeflow-docsdocstroubleshooting"><span class="">Troubleshooting Deployments on GKE</span></a></label>
  
</li><li class="td-sidebar-nav__section-title td-sidebar-nav__section without-child" id="m-kubeflow-docsdocsanthos-li">
  <input type="checkbox" id="m-kubeflow-docsdocsanthos-check"/>
  <label for="m-kubeflow-docsdocsanthos-check"><a href="/kubeflow-docs/docs/anthos/" class="align-left pl-0  td-sidebar-link td-sidebar-link__page" id="m-kubeflow-docsdocsanthos"><span class="">Kubeflow On-premises on Anthos</span></a></label>
  
</li><li class="td-sidebar-nav__section-title td-sidebar-nav__section without-child" id="m-kubeflow-docsdocschangelog-li">
  <input type="checkbox" id="m-kubeflow-docsdocschangelog-check"/>
  <label for="m-kubeflow-docsdocschangelog-check"><a href="/kubeflow-docs/docs/changelog/" class="align-left pl-0  td-sidebar-link td-sidebar-link__section" id="m-kubeflow-docsdocschangelog"><span class="">Changelog</span></a></label>
  
</li>
  </ul>
</li>
    </ul>
  </nav>
</div>

          </aside>
          <aside class="d-none d-xl-block col-xl-2 td-sidebar-toc d-print-none">
            
<div class="td-page-meta ml-2 pb-1 pt-2 mb-0">
<a id="print" href="https://gkcalat.github.io/kubeflow-docs/docs/pipelines/_print/"><i class="fa-solid fa-print fa-fw"></i> Print entire section</a>

</div>

            <div class="td-toc">
        <nav id="TableOfContents">
  <ul>
    <li><a href="#introduction">Introduction</a></li>
    <li><a href="#before-you-start">Before you start</a></li>
    <li><a href="#using-preemptible-vms-with-kubeflow-pipelines">Using preemptible VMs with Kubeflow Pipelines</a>
      <ul>
        <li><a href="#1-create-a-node-pool-with-preemptible-vms">1. Create a node pool with preemptible VMs</a></li>
        <li><a href="#2-schedule-your-pipeline-to-run-on-the-preemptible-vms">2. Schedule your pipeline to run on the preemptible VMs</a></li>
      </ul>
    </li>
    <li><a href="#using-preemptible-gpus-with-kubeflow-pipelines">Using preemptible GPUs with Kubeflow Pipelines</a>
      <ul>
        <li><a href="#1-make-sure-you-have-enough-gpu-quota">1. Make sure you have enough GPU quota</a></li>
        <li><a href="#2-create-a-node-pool-of-preemptible-vms-with-preemptible-gpus">2. Create a node pool of preemptible VMs with preemptible GPUs</a></li>
        <li><a href="#3-schedule-your-pipeline-to-run-on-the-preemptible-vms-with-preemptible-gpus">3. Schedule your pipeline to run on the preemptible VMs with preemptible GPUs</a></li>
      </ul>
    </li>
    <li><a href="#debugging">Debugging</a></li>
    <li><a href="#next-steps">Next steps</a></li>
  </ul>
</nav>
      </div>
    
            

	
		
			
				
			
			



  
  

		
			
				
			
			



  
  

		
	

          </aside>
          <main class="col-12 col-md-9 col-xl-8 pl-md-5" role="main">
            
  

            <nav aria-label="breadcrumb" class="td-breadcrumbs">
  <ol class="breadcrumb">
  <li class="breadcrumb-item">
    <a href="https://gkcalat.github.io/kubeflow-docs/docs/">Kubeflow on Google Cloud</a>
  </li>
  <li class="breadcrumb-item">
    <a href="https://gkcalat.github.io/kubeflow-docs/docs/pipelines/">Pipelines on Google Cloud</a>
  </li>
  <li class="breadcrumb-item active" aria-current="page">
    <a href="https://gkcalat.github.io/kubeflow-docs/docs/pipelines/preemptible/" aria-disabled="true" class="btn-link disabled">Using Preemptible VMs and GPUs on Google Cloud</a>
  </li>
  </ol>
</nav>
            
<div class="td-content">
	<h1>Using Preemptible VMs and GPUs on Google Cloud</h1>
	<div class="lead">Configuring preemptible VMs and GPUs for Kubeflow Pipelines on Google Cloud</div>
	<header class="article-meta">
		

  
    
      


    
      


    
  

		
			<p class="reading-time"><i class="fa-solid fa-clock" aria-hidden="true"></i>&nbsp; 7 minute read &nbsp;</p>

		
	</header>    
	<p>This document describes how to configure preemptible virtual machines
(<a href="https://cloud.google.com/kubernetes-engine/docs/how-to/preemptible-vms">preemptible VMs</a>)
and GPUs on preemptible VM instances
(<a href="https://cloud.google.com/compute/docs/instances/preemptible#preemptible_with_gpu">preemptible GPUs</a>)
for your workflows running on Kubeflow Pipelines on Google Cloud.</p>
<h2 id="introduction">Introduction</h2>
<p>Preemptible VMs are <a href="https://cloud.google.com/compute/docs/instances/">Compute Engine VM
instances</a> that last a maximum
of 24 hours and provide no availability guarantees. The
<a href="https://cloud.google.com/compute/pricing">pricing</a> of preemptible VMs is
lower than that of standard Compute Engine VMs.</p>
<p>GPUs attached to preemptible instances
(<a href="https://cloud.google.com/compute/docs/instances/preemptible#preemptible_with_gpu">preemptible GPUs</a>)
work like normal GPUs but persist only for the life of the instance.</p>
<p>Using preemptible VMs and GPUs can reduce costs on Google Cloud.
In addition to using preemptible VMs, your Google Kubernetes Engine (GKE)
cluster can autoscale based on current workloads.</p>
<p>This guide assumes that you have already deployed Kubeflow Pipelines. If not,
follow the guide to <a href="/docs/deploy/">deploying Kubeflow on Google Cloud</a>.</p>
<h2 id="before-you-start">Before you start</h2>
<p>The variables defined in this page can be found in <a href="https://github.com/GoogleCloudPlatform/kubeflow-distribution/blob/master/kubeflow/env.sh">kubeflow-distribution/kubeflow/env.sh</a>. They are the same value as you set based on your <a href="/docs/deploy/deploy-cli/#environment-variables">Kubeflow deployment</a>.</p>
<h2 id="using-preemptible-vms-with-kubeflow-pipelines">Using preemptible VMs with Kubeflow Pipelines</h2>
<p>In summary, the steps to schedule a pipeline to run on <a href="https://cloud.google.com/compute/docs/instances/preemptible">preemptible
VMs</a> are as
follows:</p>
<ol>
<li>Create a
<a href="https://cloud.google.com/kubernetes-engine/docs/concepts/node-pools">node pool</a>
in your cluster that contains preemptible VMs.</li>
<li>Configure your pipelines to run on the preemptible VMs.</li>
</ol>
<p>The following sections contain more detail about the above steps.</p>
<h3 id="1-create-a-node-pool-with-preemptible-vms">1. Create a node pool with preemptible VMs</h3>
<p>Create a <code>preemptible-nodepool.yaml</code> as below and fulfill all placerholder content <code>KF_NAME</code>, <code>KF_PROJECT</code>, <code>LOCATION</code>:</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-fallback" data-lang="fallback"><span class="line"><span class="cl">apiVersion: container.cnrm.cloud.google.com/v1beta1
</span></span><span class="line"><span class="cl">kind: ContainerNodePool
</span></span><span class="line"><span class="cl">metadata:
</span></span><span class="line"><span class="cl">  labels:
</span></span><span class="line"><span class="cl">    kf-name: KF_NAME # kpt-set: ${name}
</span></span><span class="line"><span class="cl">  name: PREEMPTIBLE_CPU_POOL
</span></span><span class="line"><span class="cl">  namespace: KF_PROJECT # kpt-set: ${gcloud.core.project}
</span></span><span class="line"><span class="cl">spec:
</span></span><span class="line"><span class="cl">  location: LOCATION # kpt-set: ${location}
</span></span><span class="line"><span class="cl">  initialNodeCount: 1
</span></span><span class="line"><span class="cl">  autoscaling:
</span></span><span class="line"><span class="cl">    minNodeCount: 0
</span></span><span class="line"><span class="cl">    maxNodeCount: 5
</span></span><span class="line"><span class="cl">  nodeConfig:
</span></span><span class="line"><span class="cl">    machineType: n1-standard-4
</span></span><span class="line"><span class="cl">    diskSizeGb: 100
</span></span><span class="line"><span class="cl">    diskType: pd-standard
</span></span><span class="line"><span class="cl">    preemptible: true
</span></span><span class="line"><span class="cl">    taint:
</span></span><span class="line"><span class="cl">    - effect: NO_SCHEDULE
</span></span><span class="line"><span class="cl">      key: preemptible
</span></span><span class="line"><span class="cl">      value: &#34;true&#34;
</span></span><span class="line"><span class="cl">    oauthScopes:
</span></span><span class="line"><span class="cl">    - &#34;https://www.googleapis.com/auth/logging.write&#34;
</span></span><span class="line"><span class="cl">    - &#34;https://www.googleapis.com/auth/monitoring&#34;
</span></span><span class="line"><span class="cl">    - &#34;https://www.googleapis.com/auth/devstorage.read_only&#34;
</span></span><span class="line"><span class="cl">    serviceAccountRef:
</span></span><span class="line"><span class="cl">      external: KF_NAME-vm@KF_PROJECT.iam.gserviceaccount.com # kpt-set: ${name}-vm@${gcloud.core.project}.iam.gserviceaccount.com
</span></span><span class="line"><span class="cl">    metadata:
</span></span><span class="line"><span class="cl">      disable-legacy-endpoints: &#34;true&#34;
</span></span><span class="line"><span class="cl">  management:
</span></span><span class="line"><span class="cl">    autoRepair: true
</span></span><span class="line"><span class="cl">    autoUpgrade: true
</span></span><span class="line"><span class="cl">  clusterRef:
</span></span><span class="line"><span class="cl">    name: KF_NAME # kpt-set: ${name}
</span></span><span class="line"><span class="cl">    namespace: KF_PROJECT # kpt-set: ${name}
</span></span></code></pre></div><p>Where:</p>
<ul>
<li><code>PREEMPTIBLE_CPU_POOL</code> is the name of the node pool.</li>
<li><code>KF_NAME</code> is the name of the Kubeflow GKE cluster.</li>
<li><code>KF_PROJECT</code> is the name of your Kubeflow Google Cloud project.</li>
<li><code>LOCATION</code> is the region of this nodepool, for example: us-west1-b.</li>
<li><code>KF_NAME-vm@KF_PROJECT.iam.gserviceaccount.com</code> is your service account, replace the <code>KF_NAME</code> and <code>KF_PROJECT</code> using the value above  in this pattern, you can get vm service account you have already created in Kubeflow cluster deployment</li>
</ul>
<p>Apply the nodepool patch file above by running:</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash"><span class="line"><span class="cl">kubectl --context<span class="o">=</span><span class="si">${</span><span class="nv">MGMTCTXT</span><span class="si">}</span> --namespace<span class="o">=</span><span class="si">${</span><span class="nv">KF_PROJECT</span><span class="si">}</span> apply -f &lt;path-to-nodepool-file&gt;/preemptible-nodepool.yaml
</span></span></code></pre></div><h4 id="for-kubeflow-pipelines-standalone-only">For Kubeflow Pipelines standalone only</h4>
<p>Alternatively, if you are on Kubeflow Pipelines standalone, or AI Platform Pipelines, you can run this command to create node pool:</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-fallback" data-lang="fallback"><span class="line"><span class="cl">gcloud container node-pools create PREEMPTIBLE_CPU_POOL \
</span></span><span class="line"><span class="cl">    --cluster=CLUSTER_NAME \
</span></span><span class="line"><span class="cl">      --enable-autoscaling --max-nodes=MAX_NODES --min-nodes=MIN_NODES \
</span></span><span class="line"><span class="cl">      --preemptible \
</span></span><span class="line"><span class="cl">      --node-taints=preemptible=true:NoSchedule \
</span></span><span class="line"><span class="cl">      --service-account=DEPLOYMENT_NAME-vm@PROJECT_NAME.iam.gserviceaccount.com
</span></span></code></pre></div><p>Below is an example of command:</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-fallback" data-lang="fallback"><span class="line"><span class="cl">gcloud container node-pools create preemptible-cpu-pool \
</span></span><span class="line"><span class="cl">  --cluster=user-4-18 \
</span></span><span class="line"><span class="cl">    --enable-autoscaling --max-nodes=4 --min-nodes=0 \
</span></span><span class="line"><span class="cl">    --preemptible \
</span></span><span class="line"><span class="cl">    --node-taints=preemptible=true:NoSchedule \
</span></span><span class="line"><span class="cl">    --service-account=user-4-18-vm@ml-pipeline-project.iam.gserviceaccount.com
</span></span></code></pre></div><h3 id="2-schedule-your-pipeline-to-run-on-the-preemptible-vms">2. Schedule your pipeline to run on the preemptible VMs</h3>
<p>After configuring a node pool with preemptible VMs, you must configure your
pipelines to run on the preemptible VMs.</p>
<p>In the DSL code for
your pipeline, add the following to the <code>ContainerOp</code> instance:</p>
<pre><code>.apply(gcp.use_preemptible_nodepool())
</code></pre>
<p>The above function works for both methods of generating the <code>ContainerOp</code>:</p>
<ul>
<li>The <code>ContainerOp</code> generated from
<a href="https://github.com/kubeflow/pipelines/blob/sdk/release-1.8/sdk/python/kfp/components/_python_op.py"><code>kfp.components.func_to_container_op</code></a>.</li>
<li>The <code>ContainerOp</code> generated from the task factory function, which is
loaded by <a href="https://github.com/kubeflow/pipelines/blob/sdk/release-1.8/sdk/python/kfp/components/_components.py"><code>components.load_component_from_url</code></a>.</li>
</ul>
<p><strong>Note</strong>:</p>
<ul>
<li>Call <code>.set_retry(#NUM_RETRY)</code> on your <code>ContainerOp</code> to retry
the task after the task is preempted.</li>
<li>If you modified the
<a href="https://cloud.google.com/kubernetes-engine/docs/how-to/node-taints">node taint</a>
when creating the node pool, pass the same node toleration to the
<code>use_preemptible_nodepool()</code> function.</li>
<li><code>use_preemptible_nodepool()</code> also accepts a parameter <code>hard_constraint</code>. When the <code>hard_constraint</code> is
<code>True</code>, the system will strictly schedule the task in preemptible VMs. When the <code>hard_constraint</code> is
<code>False</code>, the system will try to schedule the task in preemptible VMs. If it cannot find the preemptible VMs,
or the preemptible VMs are busy, the system will schedule the task in normal VMs.</li>
</ul>
<p>For example:</p>
<pre><code>import kfp.dsl as dsl
import kfp.gcp as gcp

class FlipCoinOp(dsl.ContainerOp):
  &quot;&quot;&quot;Flip a coin and output heads or tails randomly.&quot;&quot;&quot;

  def __init__(self):
    super(FlipCoinOp, self).__init__(
      name='Flip',
      image='python:alpine3.6',
      command=['sh', '-c'],
      arguments=['python -c &quot;import random; result = \'heads\' if random.randint(0,1) == 0 '
                 'else \'tails\'; print(result)&quot; | tee /tmp/output'],
      file_outputs={'output': '/tmp/output'})

@dsl.pipeline(
  name='pipeline flip coin',
  description='shows how to use dsl.Condition.'
)

def flipcoin():
  flip = FlipCoinOp().apply(gcp.use_preemptible_nodepool())

if __name__ == '__main__':
  import kfp.compiler as compiler
  compiler.Compiler().compile(flipcoin, __file__ + '.zip')
</code></pre>
<h2 id="using-preemptible-gpus-with-kubeflow-pipelines">Using preemptible GPUs with Kubeflow Pipelines</h2>
<p>This guide assumes that you have already deployed Kubeflow Pipelines. In
summary, the steps to schedule a pipeline to run with
<a href="https://cloud.google.com/compute/docs/instances/preemptible#preemptible_with_gpu">preemptible GPUs</a>
are as follows:</p>
<ol>
<li>Make sure you have enough GPU quota.</li>
<li>Create a node pool in your GKE cluster that contains preemptible VMs with
preemptible GPUs.</li>
<li>Configure your pipelines to run on the preemptible VMs with preemptible
GPUs.</li>
</ol>
<p>The following sections contain more detail about the above steps.</p>
<h3 id="1-make-sure-you-have-enough-gpu-quota">1. Make sure you have enough GPU quota</h3>
<p>Add GPU quota to your Google Cloud project. The <a href="https://cloud.google.com/compute/docs/gpus/#introduction">Google Cloud
documentation</a> lists
the availability of GPUs across regions. To check the available quota for
resources in your project, go to the
<a href="https://console.cloud.google.com/iam-admin/quotas">Quotas</a> page in the Google Cloud
Console.</p>
<h3 id="2-create-a-node-pool-of-preemptible-vms-with-preemptible-gpus">2. Create a node pool of preemptible VMs with preemptible GPUs</h3>
<p>Create a <code>preemptible-gpu-nodepool.yaml</code> as below and fulfill all placerholder content:</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-fallback" data-lang="fallback"><span class="line"><span class="cl">apiVersion: container.cnrm.cloud.google.com/v1beta1
</span></span><span class="line"><span class="cl">kind: ContainerNodePool
</span></span><span class="line"><span class="cl">metadata:
</span></span><span class="line"><span class="cl">  labels:
</span></span><span class="line"><span class="cl">    kf-name: KF_NAME # kpt-set: ${name}
</span></span><span class="line"><span class="cl">  name: KF_NAME-containernodepool-gpu
</span></span><span class="line"><span class="cl">  namespace: KF_PROJECT # kpt-set: ${gcloud.core.project}
</span></span><span class="line"><span class="cl">spec:
</span></span><span class="line"><span class="cl">  location: LOCATION # kpt-set: ${location}
</span></span><span class="line"><span class="cl">  initialNodeCount: 1
</span></span><span class="line"><span class="cl">  autoscaling:
</span></span><span class="line"><span class="cl">    minNodeCount: 0
</span></span><span class="line"><span class="cl">    maxNodeCount: 5
</span></span><span class="line"><span class="cl">  nodeConfig:
</span></span><span class="line"><span class="cl">    machineType: n1-standard-4
</span></span><span class="line"><span class="cl">    diskSizeGb: 100
</span></span><span class="line"><span class="cl">    diskType: pd-standard
</span></span><span class="line"><span class="cl">    preemptible: true
</span></span><span class="line"><span class="cl">    oauthScopes:
</span></span><span class="line"><span class="cl">    - &#34;https://www.googleapis.com/auth/logging.write&#34;
</span></span><span class="line"><span class="cl">    - &#34;https://www.googleapis.com/auth/monitoring&#34;
</span></span><span class="line"><span class="cl">    - &#34;https://www.googleapis.com/auth/devstorage.read_only&#34;
</span></span><span class="line"><span class="cl">    serviceAccountRef:
</span></span><span class="line"><span class="cl">      external: KF_NAME-vm@KF_PROJECT.iam.gserviceaccount.com # kpt-set: ${name}-vm@${gcloud.core.project}.iam.gserviceaccount.com
</span></span><span class="line"><span class="cl">    guestAccelerator:
</span></span><span class="line"><span class="cl">    - type: &#34;nvidia-tesla-k80&#34;
</span></span><span class="line"><span class="cl">      count: 1
</span></span><span class="line"><span class="cl">    metadata:
</span></span><span class="line"><span class="cl">      disable-legacy-endpoints: &#34;true&#34;
</span></span><span class="line"><span class="cl">  management:
</span></span><span class="line"><span class="cl">    autoRepair: true
</span></span><span class="line"><span class="cl">    autoUpgrade: true
</span></span><span class="line"><span class="cl">  clusterRef:
</span></span><span class="line"><span class="cl">    name: KF_NAME # kpt-set: ${name}
</span></span><span class="line"><span class="cl">    namespace: KF_PROJECT # kpt-set: ${gcloud.core.project}
</span></span></code></pre></div><p>Where:</p>
<ul>
<li><code>PREEMPTIBLE_CPU_POOL</code> is the name of the node pool.</li>
<li><code>KF_NAME</code> is the name of the Kubeflow GKE cluster.</li>
<li><code>KF_PROJECT</code> is the name of your Kubeflow Google Cloud project.</li>
<li><code>LOCATION</code> is the region of this nodepool, for example: us-west1-b.</li>
<li><code>KF_NAME-vm@KF_PROJECT.iam.gserviceaccount.com</code> is your service account, replace the <code>KF_NAME</code> and <code>KF_PROJECT</code> using the value above  in this pattern, you can get vm service account you have already created in Kubeflow cluster deployment.</li>
</ul>
<h4 id="for-kubeflow-pipelines-standalone-only-1">For Kubeflow Pipelines standalone only</h4>
<p>Alternatively, if you are on Kubeflow Pipelines standalone, or AI Platform Pipelines, you can run this command to create node pool:</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-fallback" data-lang="fallback"><span class="line"><span class="cl">gcloud container node-pools create PREEMPTIBLE_GPU_POOL \
</span></span><span class="line"><span class="cl">    --cluster=CLUSTER_NAME \
</span></span><span class="line"><span class="cl">    --enable-autoscaling --max-nodes=MAX_NODES --min-nodes=MIN_NODES \
</span></span><span class="line"><span class="cl">    --preemptible \
</span></span><span class="line"><span class="cl">    --node-taints=preemptible=true:NoSchedule \
</span></span><span class="line"><span class="cl">    --service-account=DEPLOYMENT_NAME-vm@PROJECT_NAME.iam.gserviceaccount.com \
</span></span><span class="line"><span class="cl">    --accelerator=type=GPU_TYPE,count=GPU_COUNT
</span></span></code></pre></div><p>Below is an example of command:</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-fallback" data-lang="fallback"><span class="line"><span class="cl">gcloud container node-pools create preemptible-gpu-pool \
</span></span><span class="line"><span class="cl">    --cluster=user-4-18 \
</span></span><span class="line"><span class="cl">    --enable-autoscaling --max-nodes=4 --min-nodes=0 \
</span></span><span class="line"><span class="cl">    --preemptible \
</span></span><span class="line"><span class="cl">    --node-taints=preemptible=true:NoSchedule \
</span></span><span class="line"><span class="cl">    --service-account=user-4-18-vm@ml-pipeline-project.iam.gserviceaccount.com \
</span></span><span class="line"><span class="cl">    --accelerator=type=nvidia-tesla-t4,count=2
</span></span></code></pre></div><h3 id="3-schedule-your-pipeline-to-run-on-the-preemptible-vms-with-preemptible-gpus">3. Schedule your pipeline to run on the preemptible VMs with preemptible GPUs</h3>
<p>In the <a href="/docs/components/pipelines/sdk/sdk-overview/">DSL code</a> for
your pipeline, add the following to the <code>ContainerOp</code> instance:</p>
<pre><code>.apply(gcp.use_preemptible_nodepool()
</code></pre>
<p>The above function works for both methods of generating the <code>ContainerOp</code>:</p>
<ul>
<li>The <code>ContainerOp</code> generated from
<a href="https://github.com/kubeflow/pipelines/blob/sdk/release-1.8/sdk/python/kfp/components/_python_op.py"><code>kfp.components.func_to_container_op</code></a>.</li>
<li>The <code>ContainerOp</code> generated from the task factory function, which is
loaded by <a href="https://github.com/kubeflow/pipelines/blob/sdk/release-1.8/sdk/python/kfp/components/_components.py"><code>components.load_component_from_url</code></a>.</li>
</ul>
<p><strong>Note</strong>:</p>
<ul>
<li>Call <code>.set_gpu_limit(#NUM_GPUs, GPU_VENDOR)</code> on your
<code>ContainerOp</code> to specify the GPU limit (for example, <code>1</code>) and vendor (for
example, <code>'nvidia'</code>).</li>
<li>Call <code>.set_retry(#NUM_RETRY)</code> on your <code>ContainerOp</code> to retry
the task after the task is preempted.</li>
<li>If you modified the
<a href="https://cloud.google.com/kubernetes-engine/docs/how-to/node-taints">node taint</a>
when creating the node pool, pass the same node toleration to the
<code>use_preemptible_nodepool()</code> function.</li>
<li><code>use_preemptible_nodepool()</code> also accepts a parameter <code>hard_constraint</code>. When the <code>hard_constraint</code> is
<code>True</code>, the system will strictly schedule the task in preemptible VMs. When the <code>hard_constraint</code> is
<code>False</code>, the system will try to schedule the task in preemptible VMs. If it cannot find the preemptible VMs,
or the preemptible VMs are busy, the system will schedule the task in normal VMs.</li>
</ul>
<p>For example:</p>
<pre><code>import kfp.dsl as dsl
import kfp.gcp as gcp

class FlipCoinOp(dsl.ContainerOp):
  &quot;&quot;&quot;Flip a coin and output heads or tails randomly.&quot;&quot;&quot;

  def __init__(self):
    super(FlipCoinOp, self).__init__(
      name='Flip',
      image='python:alpine3.6',
      command=['sh', '-c'],
      arguments=['python -c &quot;import random; result = \'heads\' if random.randint(0,1) == 0 '
                 'else \'tails\'; print(result)&quot; | tee /tmp/output'],
      file_outputs={'output': '/tmp/output'})

@dsl.pipeline(
  name='pipeline flip coin',
  description='shows how to use dsl.Condition.'
)

def flipcoin():
  flip = FlipCoinOp().set_gpu_limit(1, 'nvidia').apply(gcp.use_preemptible_nodepool())
if __name__ == '__main__':
  import kfp.compiler as compiler
  compiler.Compiler().compile(flipcoin, __file__ + '.zip')
</code></pre>
<h2 id="debugging">Debugging</h2>
<p>Run the following command if your nodepool didn&rsquo;t show up or has error during provisioning:</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash"><span class="line"><span class="cl">kubectl --context<span class="o">=</span><span class="si">${</span><span class="nv">MGMTCTXT</span><span class="si">}</span> --namespace<span class="o">=</span><span class="si">${</span><span class="nv">KF_PROJECT</span><span class="si">}</span> describe containernodepool -l kf-name<span class="o">=</span><span class="si">${</span><span class="nv">KF_NAME</span><span class="si">}</span>
</span></span></code></pre></div><h2 id="next-steps">Next steps</h2>
<ul>
<li>Explore further options for <a href="/docs/">customizing Kubeflow on Google Cloud</a>.</li>
<li>See how to <a href="https://kubeflow.org/docs/components/pipelines/sdk/">build pipelines with the SDK</a>.</li>
</ul>

	
		<style>
  .feedback--answer {
    display: inline-block;
  }
  .feedback--answer-no {
    margin-left: 1em;
  }
  .feedback--response {
    display: none;
    margin-top: 1em;
  }
  .feedback--response__visible {
    display: block;
  }
</style>
<div class="card mt-4 col-12 col-sm-6">
  <div class="card-body">
    <h3 class="card-title">Feedback</h3>
    <p class="card-text">Was this page helpful?</p>
    <button class="btn btn-primary feedback--answer feedback--answer-yes" style="width: 5rem;">Yes</button>
    <button class="btn btn-primary feedback--answer feedback--answer-no" style="width: 5rem;">No</button>
    <p class="feedback--response feedback--response-yes">
      Thank you! <a href="https://github.com/gkcalat/kubeflow-docs/issues/new">Send your feedback to us</a>.
    </p>
    <p class="feedback--response feedback--response-no">
      Sorry to hear that. Please <a href="https://github.com/gkcalat/kubeflow-docs/issues/new">tell us how we can improve</a>.
    </p>
  </div>
</div>
<script>
  const yesButton = document.querySelector('.feedback--answer-yes');
  const noButton = document.querySelector('.feedback--answer-no');
  const yesResponse = document.querySelector('.feedback--response-yes');
  const noResponse = document.querySelector('.feedback--response-no');
  const disableButtons = () => {
    yesButton.disabled = true;
    noButton.disabled = true;
  };
  const sendFeedback = (value) => {
    if (typeof ga !== 'function') return;
    const args = {
      command: 'send',
      hitType: 'event',
      category: 'Helpful',
      action: 'click',
      label: window.location.pathname,
      value: value
    };
    ga(args.command, args.hitType, args.category, args.action, args.label, args.value);
  };
  yesButton.addEventListener('click', () => {
    yesResponse.classList.add('feedback--response__visible');
    disableButtons();
    sendFeedback(1);
  });
  noButton.addEventListener('click', () => {
    noResponse.classList.add('feedback--response__visible');
    disableButtons();
    sendFeedback(0);
  });
</script>

		<br />
	
	
	
</div>


          </main>
        </div>
      </div>
      
<footer class="bg-dark pt-3 row d-print-none">
  <div class="container-fluid mx-sm-5">
    <div class="row">
      <div class="col-6 col-sm-4 text-xs-center order-sm-2">
        
        
        
<ul class="list-inline mb-0">
  
  <li class="list-inline-item mx-2 h3" data-toggle="tooltip" data-placement="top" title="Kubeflow mailing list" aria-label="Kubeflow mailing list">
    <a class="text-white" target="_blank" rel="noopener" href="https://www.kubeflow.org/docs/about/community/#kubeflow-mailing-list" aria-label="Kubeflow mailing list">
      <i class="fa fa-envelope"></i>
    </a>
  </li>
  
  <li class="list-inline-item mx-2 h3" data-toggle="tooltip" data-placement="top" title="Slack" aria-label="Slack">
    <a class="text-white" target="_blank" rel="noopener" href="https://www.kubeflow.org/docs/about/community/#kubeflow-slack" aria-label="Slack">
      <i class="fab fa-slack"></i>
    </a>
  </li>
  
  <li class="list-inline-item mx-2 h3" data-toggle="tooltip" data-placement="top" title="Twitter" aria-label="Twitter">
    <a class="text-white" target="_blank" rel="noopener" href="https://twitter.com/kubeflow" aria-label="Twitter">
      <i class="fab fa-twitter"></i>
    </a>
  </li>
  
  <li class="list-inline-item mx-2 h3" data-toggle="tooltip" data-placement="top" title="Stack Overflow" aria-label="Stack Overflow">
    <a class="text-white" target="_blank" rel="noopener" href="https://stackoverflow.com/questions/tagged/kubeflow" aria-label="Stack Overflow">
      <i class="fab fa-stack-overflow"></i>
    </a>
  </li>
  
</ul>

        
        
      </div>
      <div class="col-12 col-sm-4 text-center py-2 order-sm-2">
        <small class="text-white">&copy; 2022 Kubeflow on GCP authors | Documentation Distributed under CC BY 4.0</small>
        <p><small class="ml-1"><a href="https://policies.google.com/privacy" target="_blank" rel="noopener">Privacy Policy</a></small></p>
	
		
	
      </div>
      <div class="col-6 col-sm-4 text-right text-xs-center order-sm-3">
        
        
        
<ul class="list-inline mb-0">
  
  <li class="list-inline-item mx-2 h3" data-toggle="tooltip" data-placement="top" title="GitHub" aria-label="GitHub">
    <a class="text-white" target="_blank" rel="noopener" href="https://github.com/GoogleCloudPlatform/kubeflow-distribution" aria-label="GitHub">
      <i class="fab fa-github"></i>
    </a>
  </li>
  
  <li class="list-inline-item mx-2 h3" data-toggle="tooltip" data-placement="top" title="Kubeflow community calendar" aria-label="Kubeflow community calendar">
    <a class="text-white" target="_blank" rel="noopener" href="https://www.kubeflow.org/docs/about/community/#kubeflow-community-calendars" aria-label="Kubeflow community calendar">
      <i class="fa fa-calendar"></i>
    </a>
  </li>
  
</ul>

        
        
      </div>
    </div>
  </div>
</footer>


    </div>
    <script src="/kubeflow-docs/js/main.min.301c0110334bec1b4445867d27dc7dd69b2df859154ccf252005508bc860cc5a.js" integrity="sha256-MBwBEDNL7BtERYZ9J9x91pst&#43;FkVTM8lIAVQi8hgzFo=" crossorigin="anonymous"></script>
<script src='/kubeflow-docs/js/tabpane-persist.js'></script>

  </body>
</html>