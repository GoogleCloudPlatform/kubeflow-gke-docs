<!doctype html>
<html itemscope itemtype="http://schema.org/WebPage" lang="en" class="no-js">
  <head>
    <meta charset="utf-8">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<meta name="generator" content="Hugo 0.105.0">
<link rel="canonical" type="text/html" href="https://gkcalat.github.io/kubeflow-docs/docs/components/">
<link rel="alternate" type="application/rss&#43;xml" href="https://gkcalat.github.io/kubeflow-docs/docs/components/index.xml">
<meta name="robots" content="noindex, nofollow">

<script type="application/ld+json">
  {
      "@context" : "http://schema.org",
      "@type" : "WebSite",
      "mainEntityOfPage": {
           "@type": "WebPage",
           "@id": "https:\/\/gkcalat.github.io\/kubeflow-docs"
      },
      "articleSection" : "docs",
      "name" : "Components",
      "headline" : "Components",
      "description" : "Logical components that make up Kubeflow",
      "inLanguage" : "en-US",
      "author" : "",
      "creator" : "",
      "publisher": "",
      "accountablePerson" : "",
      "copyrightHolder" : "",
      "copyrightYear" : "0001",
      "datePublished": "0001-01-01 00:00:00 \u002b0000 UTC",
      "dateModified" : "0001-01-01 00:00:00 \u002b0000 UTC",
      "url" : "https:\/\/gkcalat.github.io\/kubeflow-docs\/docs\/components\/",
      "wordCount" : "0",
      "keywords" : [ "Kubeflow" ]
  }
  </script>

<link rel="shortcut icon" href="/kubeflow-docs/favicons/favicon.ico" >
<link rel="apple-touch-icon" href="/kubeflow-docs/favicons/apple-touch-icon-180x180.png" sizes="180x180">
<link rel="icon" type="image/png" href="/kubeflow-docs/favicons/favicon-16x16.png" sizes="16x16">
<link rel="icon" type="image/png" href="/kubeflow-docs/favicons/favicon-32x32.png" sizes="32x32">
<link rel="manifest" href="/kubeflow-docs/favicons/manifest.json">
<meta name="msapplication-config" content="/kubeflow-docs/favicons/browserconfig.xml" />
<meta name="msapplication-TileColor" content="#4279f4">
<meta name="theme-color" content="#4279f4">

<title>Components | Kubeflow on Google Cloud Platform</title>
<meta name="description" content="Logical components that make up Kubeflow">
<meta property="og:title" content="Components" />
<meta property="og:description" content="Logical components that make up Kubeflow" />
<meta property="og:type" content="website" />
<meta property="og:url" content="https://gkcalat.github.io/kubeflow-docs/docs/components/" /><meta property="og:site_name" content="Kubeflow on Google Cloud Platform" />

<meta itemprop="name" content="Components">
<meta itemprop="description" content="Logical components that make up Kubeflow"><meta name="twitter:card" content="summary"/>
<meta name="twitter:title" content="Components"/>
<meta name="twitter:description" content="Logical components that make up Kubeflow"/>




<link rel="preload" href="/kubeflow-docs/scss/main.min.5006b434b14f73c3d5537a7ba4c8ecef723ddc93f3a3c8530e19d24f75486ea9.css" as="style">
<link href="/kubeflow-docs/scss/main.min.5006b434b14f73c3d5537a7ba4c8ecef723ddc93f3a3c8530e19d24f75486ea9.css" rel="stylesheet" integrity="">

<script
  src="https://code.jquery.com/jquery-3.5.1.min.js"
  integrity="sha256-9/aliU8dGd2tb6OSsuzixeV4y/faTqgFtohetphbbj0="
  crossorigin="anonymous"></script>

<script async src="https://www.googletagmanager.com/gtag/js?id=G-GK9XL47N6S"></script>
<script>
var doNotTrack = false;
if (!doNotTrack) {
	window.dataLayer = window.dataLayer || [];
	function gtag(){dataLayer.push(arguments);}
	gtag('js', new Date());
	gtag('config', 'G-GK9XL47N6S', { 'anonymize_ip': false });
}
</script>

  </head>
  <body class="td-section">
    <header>
      
<nav class="js-navbar-scroll navbar navbar-expand-md navbar-dark  td-navbar">
        <a class="navbar-brand" href="/kubeflow-docs/">
		<span class="navbar-logo"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 276.93 274.55"><g data-name="Layer 2"><g data-name="Layer 1"><path d="M95.9 62.15l4.1 102.1 73.75-94.12a6.79 6.79.0 019.6-1.11l46 36.92-15-65.61z" fill="#4279f4"/><path fill="#0028aa" d="M102.55 182.98h65.42l-40.17-32.23-25.25 32.23z"/><path fill="#014bd1" d="M180.18 83.92l-44 56.14 46.88 37.61 44.47-55.76-47.35-37.99z"/><path fill="#bedcff" d="M83.56 52.3l.01-.01 38.69-48.52-62.39 30.05-15.41 67.51 39.1-49.03z"/><path fill="#6ca1ff" d="M45.32 122.05l41.44 51.96-3.95-98.98-37.49 47.02z"/><path fill="#a1c3ff" d="M202.31 28.73 142.65.0l-37.13 46.56 96.79-17.83z"/><path d="M1.6 272v-44.78h5.74v23.41l20.48-23.41h6.4l-17.39 19.7 19 25.07H29.1l-15.92-20.8-5.84 6.65V272zm40.02-9.79V240h5.43v22.39a4.67 4.67.0 002.35 4.19 11 11 0 0011 0 4.69 4.69.0 002.33-4.19V240h5.43v22.19a9.08 9.08.0 01-4.1 7.87 16.2 16.2.0 01-18.37.0 9.07 9.07.0 01-4.07-7.85zM77.46 272v-48h5.43v16.81a29.29 29.29.0 019.32-1.73 13.1 13.1.0 016.2 1.41 10.71 10.71.0 014.18 3.74 18.07 18.07.0 012.23 5.06 21.26 21.26.0 01.73 5.58q0 8.43-4.38 12.79T87.35 272zm5.43-4.87h4.55q6.77.0 9.72-2.95t3-9.51a14.21 14.21.0 00-2-7.52 6.55 6.55.0 00-6-3.22 24.73 24.73.0 00-9.25 1.54zm29.47-11.19q0-7.71 4.09-12.3a13.75 13.75.0 0110.8-4.59q13.35.0 13.36 18.86h-22.82a12.3 12.3.0 002.9 7.07q2.59 3.11 7.9 3.1a24.92 24.92.0 0010.55-2v5a27.74 27.74.0 01-9.86 1.87 19.83 19.83.0 01-7.7-1.37 13.31 13.31.0 01-5.28-3.76 16.21 16.21.0 01-3-5.38 20.84 20.84.0 01-.94-6.5zm5.62-2.12h17.26a14.91 14.91.0 00-2.37-7.12 6.44 6.44.0 00-5.62-2.78 8.2 8.2.0 00-6.21 2.72 12.07 12.07.0 00-3.04 7.18z" fill="#4279f4" stroke="#4279f4" stroke-miterlimit="10" stroke-width="3.2"/><path d="M147.32 244.89V240h5v-7.59a8.14 8.14.0 012.31-6.05 7.79 7.79.0 015.69-2.28h7.86V229h-5c-2.21.0-3.67.45-4.37 1.34s-1.06 2.55-1.06 5V240h8.46v4.87h-8.46V272h-5.44v-27.1zM175.26 272v-48h5.43v48zm19.15-3.95a17.86 17.86.0 1112.33 4.9 16.57 16.57.0 01-12.33-4.9zm3.84-20.65a13.16 13.16.0 000 17.2 12.07 12.07.0 0017 0 13.09 13.09.0 000-17.2 12.07 12.07.0 00-17 0zm30.2-7.4h5.75l7.3 25.32 7.43-25.32h5.36l7.34 25.34L269 240h5.74l-10.04 32h-6.12l-6.83-24.58L245 272h-6.47z" fill="#0028aa" stroke="#0028aa" stroke-miterlimit="10" stroke-width="3.2"/></g></g></svg></span><span class="text-uppercase font-weight-bold">Kubeflow on Google Cloud Platform</span>
	</a>
	<button class="navbar-toggler" type="button" data-toggle="collapse" data-target="#main_navbar" aria-controls="main_navbar" aria-expanded="false" aria-label="Toggle navigation">
		<span class="navbar-toggler-icon"></span>
	</button>
	<div class="collapse navbar-collapse ml-md-auto" id="main_navbar">
		<ul class="navbar-nav ml-auto pt-4 pt-md-0 my-2 my-md-1">
			
			
			<li class="nav-item mr-2 mr-lg-4 mt-1 mt-lg-0">
				
				
				
				
				
				
				<a class="nav-link" href="/kubeflow-docs/docs/" ><span>Docs</span></a>
			</li>
			
			<li class="nav-item mr-2 mr-lg-4 mt-1 mt-lg-0">
				
				
				
				
				
				
				<a class="nav-link" href="/kubeflow-docs/news/" ><span>News</span></a>
			</li>
			
			<li class="nav-item mr-2 mr-lg-4 mt-1 mt-lg-0">
				
				
				
				
				
				
				<a class="nav-link" href="https://github.com/GoogleCloudPlatform/kubeflow-distribution" target="_blank" ><i class='fa-brands fa-github pr-2'></i><span>Source</span></a>
			</li>
			
			
			<li class="nav-item dropdown mt-1 mt-lg-0 mr-2">
				<a class="nav-link dropdown-toggle" href="#" id="navbarDropdown" role="button" data-toggle="dropdown" aria-haspopup="true" aria-expanded="false">
	Releases
</a>
<div class="dropdown-menu dropdown-menu-md-right dropdown-menu-lg-left" aria-labelledby="navbarDropdownMenuLink">
	
	<a class="dropdown-item" href="https://gkcalat.github.io/kubeflow-docs/v1.6-release/docs">latest</a>
	
	<a class="dropdown-item" href="https://gkcalat.github.io/kubeflow-docs/v1.6-release/docs">v1.6</a>
	
	<a class="dropdown-item" href="https://gkcalat.github.io/kubeflow-docs/v1.5-release/docs">v1.5</a>
	
	<a class="dropdown-item" href="https://gkcalat.github.io/kubeflow-docs/v1.4-release/docs">v1.4</a>
	
	<a class="dropdown-item" href="https://gkcalat.github.io/kubeflow-docs/main/docs">dev</a>
	
</div>

			</li>
			
			
		</ul>
	</div>
</nav>

    </header>
    <div class="container-fluid td-outer">
      <div class="td-main">
        <div class="row flex-xl-nowrap">
          <main class="col-12 col-md-9 col-xl-8 pl-md-5" role="main">
            




<div class="td-content">
<div class="pageinfo pageinfo-primary d-print-none">
<p>
This is the multi-page printable view of this section.
<a href="#" onclick="print();return false;">Click here to print</a>.
</p><p>
<a href="/kubeflow-docs/docs/components/">Return to the regular view of this page</a>.
</p>
</div>



<h1 class="title">Components</h1>
<div class="lead">Logical components that make up Kubeflow</div>




    <ul>
    
  
  
  
  

  
    
    
	
<li>1: <a href="#pg-ff4f75f0d71c4bcabcaafa029be28106">Central Dashboard</a></li>


    
    <ul>
        
  
  
  
  

  
    
    
	
<li>1.1: <a href="#pg-45e276e9722879c2a835087eaddf00cb">Central Dashboard</a></li>


    
  
    
    
	
<li>1.2: <a href="#pg-0cb09d60e293109075bdd95bc7f6abf9">Customizing menu items</a></li>


    
  
    
    
	
<li>1.3: <a href="#pg-fce671713bf5527252ba60054b164b4e">Registration Flow</a></li>


    
  

    </ul>
    
  
    
    
	
<li>2: <a href="#pg-a559a73b6a3cd8309c703671821a05be">Kubeflow Notebooks</a></li>


    
    <ul>
        
  
  
  
  

  
    
    
	
<li>2.1: <a href="#pg-a1dadde8ee150a386ce42e32af5814aa">Overview</a></li>


    
  
    
    
	
<li>2.2: <a href="#pg-c8ab47d4f1d64e45f971641bdda486ab">Quickstart Guide</a></li>


    
  
    
    
	
<li>2.3: <a href="#pg-fb24dac53cf9bda9679b2f48d566f43c">Container Images</a></li>


    
  
    
    
	
<li>2.4: <a href="#pg-6783e7595e3463d9b32c8e39ab6b7441">Jupyter TensorFlow Examples</a></li>


    
  
    
    
	
<li>2.5: <a href="#pg-0e54c1a1221463890a83803ce89e1686">Submit Kubernetes Resources</a></li>


    
  
    
    
	
<li>2.6: <a href="#pg-6df9976b3b6f04214918966cac839101">Troubleshooting</a></li>


    
  
    
    
	
<li>2.7: <a href="#pg-8edb7e5ba14c7fe4f9ff0ea005bcef8b">API Reference</a></li>


    
    <ul>
        
  
  
  
  

  
    
    
	
<li>2.7.1: <a href="#pg-972c570813edbd8a8f8c695ed586f54a">Notebook (v1)</a></li>


    
  

    </ul>
    
  

    </ul>
    
  
    
    
	
<li>3: <a href="#pg-ec7ce56a8d2096a6665a5e94777dd5d3">Kubeflow Pipelines</a></li>


    
    <ul>
        
  
  
  
  

  
    
    
	
<li>3.1: <a href="#pg-602ebf82a762d97e6ba22897f56cd58b">v1</a></li>


    
    <ul>
        
  
  
  
  

  
    
    
	
<li>3.1.1: <a href="#pg-a12c176b136bf54932f124befc18e5f8">Introduction</a></li>


    
  
    
    
	
<li>3.1.2: <a href="#pg-0777647aa48fbe0f824745e24490c04e">Overview</a></li>


    
    <ul>
        
  
  
  
  

  
    
    
	
<li>3.1.2.1: <a href="#pg-a148519f049b4d923d80c134d57a0da8">Quickstart</a></li>


    
  
    
    
	
<li>3.1.2.2: <a href="#pg-7c0f89103ef95403b48dd2aa13f731a1">Pipelines Interfaces</a></li>


    
  
    
    
	
<li>3.1.2.3: <a href="#pg-d3cec6965952a60c6a492aeee96e221b">Multi-user Isolation</a></li>


    
  
    
    
	
<li>3.1.2.4: <a href="#pg-0c82dc6780f69fb583c5e950c80d8417">Caching</a></li>


    
  
    
    
	
<li>3.1.2.5: <a href="#pg-c7e546e96cee0ce3e347c65d7ea674fc">Caching v2</a></li>


    
  
    
    
	
<li>3.1.2.6: <a href="#pg-4c9d3fedae9983188fafd2b5356887f7">Pipeline Root</a></li>


    
  

    </ul>
    
  
    
    
	
<li>3.1.3: <a href="#pg-060c8cb37a256181746cb201db0a3044">Concepts</a></li>


    
    <ul>
        
  
  
  
  

  
    
    
	
<li>3.1.3.1: <a href="#pg-47b93a2008be6edd146543a09d537805">Pipeline</a></li>


    
  
    
    
	
<li>3.1.3.2: <a href="#pg-789813dd0bef14690b23c5f697b60344">Component</a></li>


    
  
    
    
	
<li>3.1.3.3: <a href="#pg-033c56b71b85e6e7268a6288392252b5">Graph</a></li>


    
  
    
    
	
<li>3.1.3.4: <a href="#pg-dc0a02d65cccdebb935eae6c19dcf29d">Experiment</a></li>


    
  
    
    
	
<li>3.1.3.5: <a href="#pg-673850e161eaa19a91d6d536144cb5c3">Run and Recurring Run</a></li>


    
  
    
    
	
<li>3.1.3.6: <a href="#pg-4f1dec38fdd8c154fb193a02d24b03a8">Run Trigger</a></li>


    
  
    
    
	
<li>3.1.3.7: <a href="#pg-696b79e43e2c90b2208b118f99ee085e">Step</a></li>


    
  
    
    
	
<li>3.1.3.8: <a href="#pg-bfae76fed696ce6cd7a87f0c18a72862">Output Artifact</a></li>


    
  
    
    
	
<li>3.1.3.9: <a href="#pg-2e81a36f30fec5fe727a6cbf39d86dae">ML Metadata</a></li>


    
  

    </ul>
    
  
    
    
	
<li>3.1.4: <a href="#pg-5bb6b9f7730debf1fc61622394f44eca">Installation</a></li>


    
    <ul>
        
  
  
  
  

  
    
    
	
<li>3.1.4.1: <a href="#pg-bf5608113cd0f142b59a1ebf6bdc0ddf">Installation Options</a></li>


    
  
    
    
	
<li>3.1.4.2: <a href="#pg-c3e83ecb2e15685ebd378756baadb500">Local Deployment</a></li>


    
  
    
    
	
<li>3.1.4.3: <a href="#pg-66adf3067d8aebc177db56ac3216c29d">Standalone Deployment</a></li>


    
  
    
    
	
<li>3.1.4.4: <a href="#pg-fd77b2375cf26c5efa8e44515f653900">Choosing an Argo Workflows Executor</a></li>


    
  
    
    
	
<li>3.1.4.5: <a href="#pg-15348c81205e7f1ec62291a74fc14992">Upgrade Notes</a></li>


    
  
    
    
	
<li>3.1.4.6: <a href="#pg-6f46cfeabcf176dd38dca8992b1dc5d5">Compatibility Matrix</a></li>


    
  

    </ul>
    
  
    
    
	
<li>3.1.5: <a href="#pg-e1957bf303e6673097b3ee28dfccf6f3">Pipelines SDK</a></li>


    
    <ul>
        
  
  
  
  

  
    
    
	
<li>3.1.5.1: <a href="#pg-4c4cc1220583c8dadcf45ac61da1c89f">Introduction to the Pipelines SDK</a></li>


    
  
    
    
	
<li>3.1.5.2: <a href="#pg-18204851ea0a52843d149feaa73750b8">Install the Kubeflow Pipelines SDK</a></li>


    
  
    
    
	
<li>3.1.5.3: <a href="#pg-16043ffea1aee8a9b986cc1dc4598463">Connect the Pipelines SDK to Kubeflow Pipelines</a></li>


    
  
    
    
	
<li>3.1.5.4: <a href="#pg-95de41d77d62a53dd61ef8fe4dcf3c80">Build a Pipeline</a></li>


    
  
    
    
	
<li>3.1.5.5: <a href="#pg-201764e91fc94af83f5f9784d2243490">Building Components</a></li>


    
  
    
    
	
<li>3.1.5.6: <a href="#pg-ec0a69a45422dd2b502a48a36d15bf24">Building Python function-based components</a></li>


    
  
    
    
	
<li>3.1.5.7: <a href="#pg-affaa52b1b38b301a656c06f43992a9c">Best Practices for Designing Components</a></li>


    
  
    
    
	
<li>3.1.5.8: <a href="#pg-6a9a2a321d5959620aa38f3f01399c97">Pipeline Parameters</a></li>


    
  
    
    
	
<li>3.1.5.9: <a href="#pg-6c3616d054a1d9bb69a6a3e81e532406">Visualize Results in the Pipelines UI</a></li>


    
  
    
    
	
<li>3.1.5.10: <a href="#pg-6290e41c026254218090f8aba54b9598">Pipeline Metrics</a></li>


    
  
    
    
	
<li>3.1.5.11: <a href="#pg-4539e2425322e75e85f28e46fbd56edf">DSL Static Type Checking</a></li>


    
  
    
    
	
<li>3.1.5.12: <a href="#pg-db2b3d927ec2c0b7fed0512c94bc61ae">DSL Recursion</a></li>


    
  
    
    
	
<li>3.1.5.13: <a href="#pg-6a0dc6801800a3b5b8b4c7cb9a1d4104">Using environment variables in pipelines</a></li>


    
  
    
    
	
<li>3.1.5.14: <a href="#pg-ad66bcbcfacb2647b3a55cba3d1e76c6">GCP-specific Uses of the SDK</a></li>


    
  
    
    
	
<li>3.1.5.15: <a href="#pg-af8ccd9f5dc570d16c52b5d3e0ba2cf5">Kubeflow Pipelines SDK for Tekton</a></li>


    
  
    
    
	
<li>3.1.5.16: <a href="#pg-1399671edb649a321c5d364b2a3c2218">Manipulate Kubernetes Resources as Part of a Pipeline</a></li>


    
  
    
    
	
<li>3.1.5.17: <a href="#pg-67b05544f3675abcc53d37062cf6583a">Python Based Visualizations (Deprecated)</a></li>


    
  
    
    
	
<li>3.1.5.18: <a href="#pg-6b0621ddf48d2bc7b2827f237fb1eebf"></a></li>


    
  

    </ul>
    
  
    
    
	
<li>3.1.6: <a href="#pg-5484f729f763ffba2281086c91c3ca4b">Pipelines SDK (v2)</a></li>


    
    <ul>
        
  
  
  
  

  
    
    
	
<li>3.1.6.1: <a href="#pg-7de693453582d12951b61f9fd9caa3ab">Introducing Kubeflow Pipelines SDK v2</a></li>


    
  
    
    
	
<li>3.1.6.2: <a href="#pg-71afab4db485174bd352d12f64e8e088">Comparing Pipeline Runs</a></li>


    
  
    
    
	
<li>3.1.6.3: <a href="#pg-f31ed082c64d3490d1377466dfdc3520">Kubeflow Pipelines v2 Component I/O</a></li>


    
  
    
    
	
<li>3.1.6.4: <a href="#pg-3dcf3dde7fbe3043d83871453e9b58d7">Build a Pipeline</a></li>


    
  
    
    
	
<li>3.1.6.5: <a href="#pg-9184b16f91df608e5869bd5db102ef95">Building Components</a></li>


    
  
    
    
	
<li>3.1.6.6: <a href="#pg-1b784a63be21dc3d677420b83ac1439e">Building Python Function-based Components</a></li>


    
  
    
    
	
<li>3.1.6.7: <a href="#pg-469c8de604213a6de88b276eeb473f1b">Importer component</a></li>


    
  

    </ul>
    
  
    
    
	
<li>3.1.7: <a href="#pg-570360a90228471336a30a660d70070c">Samples and Tutorials</a></li>


    
    <ul>
        
  
  
  
  

  
    
    
	
<li>3.1.7.1: <a href="#pg-d5325394cc7abd01614d7b4eb37cb40c">Using the Kubeflow Pipelines Benchmark Scripts</a></li>


    
  
    
    
	
<li>3.1.7.2: <a href="#pg-55ead7004b3cd366b5decb7eba327a38">Using the Kubeflow Pipelines SDK</a></li>


    
  
    
    
	
<li>3.1.7.3: <a href="#pg-47b3be3dd816e4ac0c83ba23d8a169d5">Experiment with the Kubeflow Pipelines API</a></li>


    
  
    
    
	
<li>3.1.7.4: <a href="#pg-d0b87844f0fd8f7f5d00526028c9c2c6">Experiment with the Pipelines Samples</a></li>


    
  
    
    
	
<li>3.1.7.5: <a href="#pg-5c47ad4da8e3c2a4edddeb4460d4b3ef">Run a Cloud-specific Pipelines Tutorial</a></li>


    
  

    </ul>
    
  
    
    
	
<li>3.1.8: <a href="#pg-102daf76bac1d475739853b0c616283c">Troubleshooting</a></li>


    
  
    
    
	
<li>3.1.9: <a href="#pg-65b28e2fec48a1a03fd11b7057352a68">Reference</a></li>


    
    <ul>
        
  
  
  
  

  
    
    
	
<li>3.1.9.1: <a href="#pg-7830028a1fe66e561a2e983210d902e0">Component Specification</a></li>


    
  
    
    
	
<li>3.1.9.2: <a href="#pg-00ac3f50c5b8788374edc5630970f6f6">Pipelines API Reference</a></li>


    
  
    
    
	
<li>3.1.9.3: <a href="#pg-160d2268979e6dd7a6add5e009df9bb1"> Pipelines SDK Reference</a></li>


    
  

    </ul>
    
  

    </ul>
    
  
    
    
	
<li>3.2: <a href="#pg-2e292725af6ef6d4ac4f546c6c3652a4">v2</a></li>


    
    <ul>
        
  
  
  
  

  
    
    
	
<li>3.2.1: <a href="#pg-491d81fa84033751ec5e23d040fe3b20">Introduction</a></li>


    
  
    
    
	
<li>3.2.2: <a href="#pg-40b7d37854add4a8b5bab284800cd2e8">Installation</a></li>


    
  
    
    
	
<li>3.2.3: <a href="#pg-50b1788ca8945aadd369ed873937651f">Quickstart</a></li>


    
  
    
    
	
<li>3.2.4: <a href="#pg-71d14ac04c3b2a201568806e101af25a">Author a Pipeline</a></li>


    
    <ul>
        
  
  
  
  

  
    
    
	
<li>3.2.4.1: <a href="#pg-8399b7eb477a6311c212af1521456bad">Components</a></li>


    
  
    
    
	
<li>3.2.4.2: <a href="#pg-6434584f19aa221c1b86bb04ddc1aebe">Tasks</a></li>


    
  
    
    
	
<li>3.2.4.3: <a href="#pg-6afd16685922f350ab1b27a4d4e79d0c">Pipelines</a></li>


    
  
    
    
	
<li>3.2.4.4: <a href="#pg-4cdabdf4d68974491ee69accb5f7080d">Component I/O</a></li>


    
  

    </ul>
    
  
    
    
	
<li>3.2.5: <a href="#pg-949036519b58594da97d168aa118d46d">Compile a Pipeline</a></li>


    
  
    
    
	
<li>3.2.6: <a href="#pg-a68b69ed119639161f8aa77ca8cb9aa9">Run a Pipeline</a></li>


    
  
    
    
	
<li>3.2.7: <a href="#pg-417e76f1404dfae7c66273efdc10e05b">Command Line Interface</a></li>


    
  
    
    
	
<li>3.2.8: <a href="#pg-0aa565b096b841bd6171b56fe09e39c8">Community and Support</a></li>


    
  
    
    
	
<li>3.2.9: <a href="#pg-f0fb094d1c5469ccf9ae7e2c40cfebca">Reference</a></li>


    
  

    </ul>
    
  

    </ul>
    
  
    
    
	
<li>4: <a href="#pg-4a244e194817114d25521449f4937d23">Katib</a></li>


    
    <ul>
        
  
  
  
  

  
    
    
	
<li>4.1: <a href="#pg-00f61fe76ea63c90c498a3519d9a26a7">Introduction to Katib</a></li>


    
  
    
    
	
<li>4.2: <a href="#pg-0884c858a705c182d2436896e0bef13e">Getting Started with Katib</a></li>


    
  
    
    
	
<li>4.3: <a href="#pg-7f397238fac71de59685256a78cd9f76">Running an Experiment</a></li>


    
  
    
    
	
<li>4.4: <a href="#pg-bfd3194b361e71038ee054637a0a8043">Resuming an Experiment</a></li>


    
  
    
    
	
<li>4.5: <a href="#pg-ae840460e289e0593ca27a1274d3e948">Overview of Trial Templates</a></li>


    
  
    
    
	
<li>4.6: <a href="#pg-b80a2e37cea35fb836557e60f56f4ce2">Using Early Stopping</a></li>


    
  
    
    
	
<li>4.7: <a href="#pg-51e1645fcfdf30aa149835216f6f8cd0">Katib Configuration Overview</a></li>


    
  
    
    
	
<li>4.8: <a href="#pg-cffe32d69412f2ff2bd13ff9e8bcea7f">Environment Variables for Katib Components</a></li>


    
  

    </ul>
    
  
    
    
	
<li>5: <a href="#pg-51fdbf378e6f2d230f7206aeacd43a90">Training Operators</a></li>


    
    <ul>
        
  
  
  
  

  
    
    
	
<li>5.1: <a href="#pg-576bf8908783688384260fc466c40af5">TensorFlow Training (TFJob)</a></li>


    
  
    
    
	
<li>5.2: <a href="#pg-94aec72d7979152842ed2f8cbe6dbe06">PyTorch Training (PyTorchJob)</a></li>


    
  
    
    
	
<li>5.3: <a href="#pg-918c00c4648652b4a145759ea270e3fe">MXNet Training (MXJob)</a></li>


    
  
    
    
	
<li>5.4: <a href="#pg-66d70221609b85eb891d6f7d3b11fbe6">XGBoost Training (XGBoostJob)</a></li>


    
  
    
    
	
<li>5.5: <a href="#pg-e31f8fe300fca877319ecc67f6f703f2">MPI Training (MPIJob)</a></li>


    
  
    
    
	
<li>5.6: <a href="#pg-0f6575cd7361e2994f36778f82849b99">Job Scheduling</a></li>


    
  

    </ul>
    
  
    
    
	
<li>6: <a href="#pg-ae6de7cad0e76d5df6250988a0160212">Multi-Tenancy</a></li>


    
    <ul>
        
  
  
  
  

  
    
    
	
<li>6.1: <a href="#pg-e87786fc6cd6ef512d86583d427d2d72">Introduction to Multi-user Isolation</a></li>


    
  
    
    
	
<li>6.2: <a href="#pg-ddca94c4aa141a8f92713881d827f9d7">Design for Multi-user Isolation</a></li>


    
  
    
    
	
<li>6.3: <a href="#pg-e865bd308ad26da3a77cd89815745e7f">Getting Started with Multi-user Isolation</a></li>


    
  

    </ul>
    
  

    </ul>


<div class="content">
      
</div>
</div>


  
  
  
  

  
  

  
    
    
	
    

<div class="td-content" style="">
    
	<h1 id="pg-ff4f75f0d71c4bcabcaafa029be28106">1 - Central Dashboard</h1>
    <div class="lead">The central user interface (UI) in Kubeflow</div>
	
</div>



    
      
  
  
  
  

  
  

  
    
    
	
    

<div class="td-content" style="">
    
	<h1 id="pg-45e276e9722879c2a835087eaddf00cb">1.1 - Central Dashboard</h1>
    <div class="lead">Overview of the Kubeflow user interfaces (UIs)</div>
	<div class="alert alert-primary" role="alert">
This Kubeflow component has <b>stable</b> status. See the
<a href="/docs/started/support/#application-status">Kubeflow versioning policies</a>.
</div>
<p>Your Kubeflow deployment includes a central dashboard that provides quick access
to the Kubeflow components deployed in your cluster. The dashboard includes the
following features:</p>
<ul>
<li>Shortcuts to specific actions, a list of recent pipelines and notebooks, and
metrics, giving you an overview of your jobs and cluster in one view.</li>
<li>A housing for the UIs of the components running in the cluster, including
<strong>Pipelines</strong>, <strong>Katib</strong>, <strong>Notebooks</strong>, and more.</li>
<li>A <a href="/docs/components/central-dash/registration-flow/">registration flow</a> that
prompts new users to set up their namespace if necessary.</li>
</ul>
<h2 id="overview-of-kubeflow-uis">Overview of Kubeflow UIs</h2>
<p>The Kubeflow UIs include the following:</p>
<ul>
<li><strong>Home</strong>: Home, the central hub to access recent resources, active
experiments, and useful documentation.</li>
<li><strong>Notebook Servers</strong>: To manage <a href="/docs/components/notebooks/">Notebook servers</a>.</li>
<li><strong>TensorBoards</strong>: To manage TensorBoard servers.</li>
<li><strong>Models</strong>: To manage deployed <a href="/docs/components/kfserving/kfserving/">KFServing models</a>.</li>
<li><strong>Volumes</strong>: To manage the cluster&rsquo;s Volumes.</li>
<li><strong>Experiments (AutoML)</strong>: To manage <a href="/docs/components/katib/">Katib</a> experiments.</li>
<li><strong>Experiments (KFP)</strong>: To manage <a href="/docs/components/pipelines/">Kubeflow Pipelines (KFP)</a> experiments.</li>
<li><strong>Pipelines</strong>: To manage KFP pipelines.</li>
<li><strong>Runs</strong>: To manage KFP runs.</li>
<li><strong>Recurring Runs</strong>: To manage KFP recurring runs.</li>
<li><strong>Artifacts</strong>: To track ML Metadata (MLMD) artifacts.</li>
<li><strong>Executions</strong>: To track various component executions in MLMD.</li>
<li><strong>Manage Contributors</strong>: To configure user access sharing across namespaces in
the Kubeflow deployment.</li>
</ul>
<p>The central dashboard looks like this:</p>
<p><img src="/docs/images/central-ui.png"
alt="Kubeflow central UI"
class="mt-3 mb-3 border border-info rounded"></p>
<h2 id="accessing-the-central-dashboard">Accessing the central dashboard</h2>
<p>To access the central dashboard, you need to connect to the
<a href="https://istio.io/docs/concepts/traffic-management/#gateways">Istio gateway</a> that
provides access to the Kubeflow
<a href="https://istio.io/docs/concepts/what-is-istio/#what-is-a-service-mesh">service mesh</a>.</p>
<p>How you access the Istio gateway varies depending on how you&rsquo;ve configured it.</p>
<h2 id="url-pattern-with-google-cloud-platform-gcp">URL pattern with Google Cloud Platform (GCP)</h2>
<p>If you followed the guide to <a href="/docs/gke/deploy/">deploying Kubeflow on GCP</a>,
the Kubeflow central UI is accessible at a URL of the following pattern:</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-fallback" data-lang="fallback"><span class="line"><span class="cl">https://&lt;application-name&gt;.endpoints.&lt;project-id&gt;.cloud.goog/
</span></span></code></pre></div><p>The URL brings up the dashboard illustrated above.</p>
<p>If you deploy Kubeflow with Cloud Identity-Aware Proxy (IAP), Kubeflow uses the
<a href="https://letsencrypt.org/">Let&rsquo;s Encrypt</a> service to provide an SSL certificate
for the Kubeflow UI. For troubleshooting issues with your certificate, see the
guide to
<a href="/docs/gke/deploy/monitor-iap-setup/">monitoring your Cloud IAP setup</a>.</p>
<h2 id="using-kubectl-and-port-forwarding">Using kubectl and port-forwarding</h2>
<p>If you didn&rsquo;t configure Kubeflow to integrate with an identity provider
then you can port-forward directly to the Istio gateway.</p>
<p>Port-forwarding typically does not work if any of the following are true:</p>
<ul>
<li>
<p>You&rsquo;ve deployed Kubeflow on GCP using the default settings
with the <a href="/docs/gke/deploy/deploy-cli/">CLI deployment</a>.</p>
</li>
<li>
<p>You&rsquo;ve configured the Istio ingress to only accept
HTTPS traffic on a specific domain or IP address.</p>
</li>
<li>
<p>You&rsquo;ve configured the Istio ingress to perform an authorization check
(for example, using Cloud IAP or <a href="https://github.com/dexidp/dex">Dex</a>).</p>
</li>
</ul>
<p>You can access Kubeflow via <code>kubectl</code> and port-forwarding as follows:</p>
<ol>
<li>
<p>Install <code>kubectl</code> if you haven&rsquo;t already done so:</p>
<ul>
<li>If you&rsquo;re using Kubeflow on GCP, run the following command on the command
line: <code>gcloud components install kubectl</code>.</li>
<li>Alternatively, follow the <a href="https://kubernetes.io/docs/tasks/tools/install-kubectl/"><code>kubectl</code>
installation guide</a>.</li>
</ul>
</li>
<li>
<p>Use the following command to set up port forwarding to the
<a href="https://istio.io/docs/tasks/traffic-management/ingress/ingress-control/">Istio gateway</a>.</p>
 <pre><code>export NAMESPACE=istio-system
    kubectl port-forward -n ${NAMESPACE} svc/istio-ingressgateway 8080:80</code></pre>
</li>
<li>
<p>Access the central navigation dashboard at:</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-fallback" data-lang="fallback"><span class="line"><span class="cl">http://localhost:8080/
</span></span></code></pre></div><p>Depending on how you&rsquo;ve configured Kubeflow, not all UIs work behind
port-forwarding to the reverse proxy.</p>
<p>For some web applications, you need to configure the base URL on which
the app is serving.</p>
<p>For example, if you deployed Kubeflow with an ingress serving at
<code>https://example.mydomain.com</code> and configured an application
to be served at the URL <code>https://example.mydomain.com/myapp</code>, then the
app may not work when served on
<code>https://localhost:8080/myapp</code> because the paths do not match.</p>
</li>
</ol>
<h2 id="next-steps">Next steps</h2>
<ul>
<li>Explore the <a href="/docs/components/multi-tenancy/">contributor management
option</a> where you
can set up a single namespace for a shared deployment or configure
multi-tenancy for your Kubeflow deployment.</li>
<li><a href="/docs/components/notebooks/setup/">Set up your Jupyter notebooks</a> in Kubeflow.</li>
</ul>

</div>



    
	
  
    
    
	
    

<div class="td-content" style="page-break-before: always">
    
	<h1 id="pg-0cb09d60e293109075bdd95bc7f6abf9">1.2 - Customizing menu items</h1>
    <div class="lead">Customizing menu items to integrate third party apps</div>
	<p>Cluster admin can integrate third party apps with kubeflow.
In a below example, &ldquo;My App&rdquo; is added on the side menubar.</p>
<p><img src="/docs/images/customize-menu-add-app.png" 
alt="Display third party app on a kubeflow dashboard"
class="mt-3 mb-3 border border-info rounded"></p>
<h2 id="add-shared-items">Add shared items</h2>
<p>The way to add items shared by all users is described in this section.</p>
<p>First, the cluster admin should deploy the application as a microservice in Kubernetes.
The traffic to the app should be set as a VirtualService of Istio.</p>
<p>Deploying with specific prefix and controlling the traffic by it is an instant way.
In this case, the new app can be accessed from the below URL.</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-fallback" data-lang="fallback"><span class="line"><span class="cl">http(s)://gateway/_/myapp/
</span></span></code></pre></div><p>Next, the configuration of menubar can be opened as below.</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-shell" data-lang="shell"><span class="line"><span class="cl">kubectl edit cm centraldashboard-config -n kubeflow
</span></span></code></pre></div><p>You would see the current settings. Please add new item as you want.</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-fallback" data-lang="fallback"><span class="line"><span class="cl">apiVersion: v1
</span></span><span class="line"><span class="cl">data:
</span></span><span class="line"><span class="cl">  links: |-
</span></span><span class="line"><span class="cl">    {
</span></span><span class="line"><span class="cl">      &#34;menuLinks&#34;: [
</span></span><span class="line"><span class="cl">        {
</span></span><span class="line"><span class="cl">          &#34;type&#34;: &#34;item&#34;,
</span></span><span class="line"><span class="cl">          &#34;link&#34;: &#34;/jupyter/&#34;,
</span></span><span class="line"><span class="cl">          &#34;text&#34;: &#34;Notebooks&#34;,
</span></span><span class="line"><span class="cl">          &#34;icon&#34;: &#34;book&#34;
</span></span><span class="line"><span class="cl">        },
</span></span><span class="line"><span class="cl">.
</span></span><span class="line"><span class="cl">.
</span></span><span class="line"><span class="cl">.
</span></span><span class="line"><span class="cl">        {
</span></span><span class="line"><span class="cl">          &#34;type&#34;: &#34;item&#34;,
</span></span><span class="line"><span class="cl">          &#34;link&#34;: &#34;/pipeline/#/executions&#34;,
</span></span><span class="line"><span class="cl">          &#34;text&#34;: &#34;Executions&#34;,
</span></span><span class="line"><span class="cl">          &#34;icon&#34;: &#34;av:play-arrow&#34;
</span></span><span class="line"><span class="cl">        },
</span></span><span class="line"><span class="cl">        {
</span></span><span class="line"><span class="cl">          &#34;type&#34;: &#34;item&#34;,
</span></span><span class="line"><span class="cl">          &#34;link&#34;: &#34;/myapp/&#34;,
</span></span><span class="line"><span class="cl">          &#34;text&#34;: &#34;MyApp&#34;,
</span></span><span class="line"><span class="cl">          &#34;icon&#34;: &#34;social:mood&#34;
</span></span><span class="line"><span class="cl">        }
</span></span><span class="line"><span class="cl">      ],
</span></span></code></pre></div><p>&ldquo;icon&rdquo; can be chosen from iron-icons.
You can see the list of iron-icons in this <a href="http://kevingleason.me/Polymer-Todo/bower_components/iron-icons/demo/index.html">icon-demo</a>.</p>
<p>The change of configuration would be reflected soon.
If not, please rollout centraldashboard and reload the web browser.</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-shell" data-lang="shell"><span class="line"><span class="cl">kubectl rollout restart deployment centraldashboard -n kubeflow
</span></span></code></pre></div><p>You would see a new item (in this case, it is MyApp) on the menubar.
By clicking that button, you can jump to <code>http(s)://gateway/_/myapp/</code> and access the third party app through the kubeflow dashboard.</p>
<h2 id="add-namespaced-items">Add namespaced items</h2>
<p>The way to split the resouce of additional apps is described in this section.</p>
<p>Although Kubeflow has the functions for multi tenancy, some third party apps can&rsquo;t interact with kubeflow profiles or don&rsquo;t support multi tenancy.</p>
<p>The universal way to handle this problem is deploying the app for each namespace.
The cluster admin deploy the app for each namespace and URLs would be like below.</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-fallback" data-lang="fallback"><span class="line"><span class="cl">http(s)://gateway/_/myapp/profile1/
</span></span><span class="line"><span class="cl">http(s)://gateway/_/myapp/profile2/
</span></span></code></pre></div><p>In this case, you can configure the central dashboard as below.
<code>{ns}</code> should be replaced by the namespace when the user open the dashboard.</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-fallback" data-lang="fallback"><span class="line"><span class="cl">apiVersion: v1
</span></span><span class="line"><span class="cl">data:
</span></span><span class="line"><span class="cl">  links: |-
</span></span><span class="line"><span class="cl">    {
</span></span><span class="line"><span class="cl">      &#34;menuLinks&#34;: [
</span></span><span class="line"><span class="cl">        {
</span></span><span class="line"><span class="cl">          &#34;type&#34;: &#34;item&#34;,
</span></span><span class="line"><span class="cl">          &#34;link&#34;: &#34;/jupyter/&#34;,
</span></span><span class="line"><span class="cl">          &#34;text&#34;: &#34;Notebooks&#34;,
</span></span><span class="line"><span class="cl">          &#34;icon&#34;: &#34;book&#34;
</span></span><span class="line"><span class="cl">        },
</span></span><span class="line"><span class="cl">.
</span></span><span class="line"><span class="cl">.
</span></span><span class="line"><span class="cl">.
</span></span><span class="line"><span class="cl">        {
</span></span><span class="line"><span class="cl">          &#34;type&#34;: &#34;item&#34;,
</span></span><span class="line"><span class="cl">          &#34;link&#34;: &#34;/pipeline/#/executions&#34;,
</span></span><span class="line"><span class="cl">          &#34;text&#34;: &#34;Executions&#34;,
</span></span><span class="line"><span class="cl">          &#34;icon&#34;: &#34;av:play-arrow&#34;
</span></span><span class="line"><span class="cl">        },
</span></span><span class="line"><span class="cl">        {
</span></span><span class="line"><span class="cl">          &#34;type&#34;: &#34;item&#34;,
</span></span><span class="line"><span class="cl">          &#34;link&#34;: &#34;/myapp/{ns}&#34;,
</span></span><span class="line"><span class="cl">          &#34;text&#34;: &#34;MyApp&#34;,
</span></span><span class="line"><span class="cl">          &#34;icon&#34;: &#34;social:mood&#34;
</span></span><span class="line"><span class="cl">        }
</span></span><span class="line"><span class="cl">      ],
</span></span></code></pre></div><p>The users can see a new item (in this case, it is MyApp as well) on the menubar.
They can either jump to <code>http(s)://gateway/_/myapp/profile1/</code> or <code>http(s)://gateway/_/myapp/profile2/</code> based on the namespace selection.
The actual inside content of iframe is swiched by the namespace.</p>
<p>If sidecar injection is enabled, the authorization to the app is done by istio.
e.g) The users who don&rsquo;t belong to profile2 can&rsquo;t access to <code>http(s)://gateway/_/myapp/profile2/</code>.</p>

</div>



    
	
  
    
    
	
    

<div class="td-content" style="page-break-before: always">
    
	<h1 id="pg-fce671713bf5527252ba60054b164b4e">1.3 - Registration Flow</h1>
    <div class="lead">Setting up your namespace in Kubeflow</div>
	

<div class="alert alert-warning" role="alert">
<h4 class="alert-heading">Out of date</h4>

    This guide contains outdated information pertaining to Kubeflow 1.0. This guide
needs to be updated for Kubeflow 1.1.

</div>

<p>This guide is for Kubeflow users who are logging in to Kubeflow for the first
time. The user may be the person who deployed Kubeflow, or another person who
has permission to access the Kubeflow cluster and use Kubeflow.</p>
<h2 id="introduction-to-namespaces">Introduction to namespaces</h2>
<p>Depending on the setup of your Kubeflow cluster, you may need to create a
<em>namespace</em> when you first log in to Kubeflow. Namespaces are sometimes called
<em>profiles</em> or <em>workgroups</em>.</p>
<p>Kubeflow prompts you to create a namespace under the following circumstances:</p>
<ul>
<li>For Kubeflow deployments that support multi-user isolation: Your username
does not yet have an associated namespace with role bindings that give you
administrative (owner) access to the namespace.</li>
<li>For Kubeflow deployments that support single-user isolation: The Kubeflow
cluster has no namespace role bindings.</li>
</ul>
<p>If Kubeflow doesn&rsquo;t prompt you to create a namespace, then your Kubeflow
administrator may have created a namespace for you. You should be able to see
the Kubeflow central dashboard and start using Kubeflow.</p>
<h2 id="prerequisites">Prerequisites</h2>
<p>Your Kubeflow administrator must perform the following steps:</p>
<ul>
<li>Deploy Kubeflow to a Kubernetes cluster, by following the <a href="/docs/started/getting-started/">Kubeflow
getting-started guide</a>.</li>
<li>Give you access to the Kubernetes cluster. See the <a href="/docs/components/multi-tenancy/getting-started/#onboarding-a-new-user">guide to
multi-tenancy</a>.</li>
</ul>
<h2 id="creating-your-namespace">Creating your namespace</h2>
<p>If you don&rsquo;t yet have a suitable namespace associated with your username,
Kubeflow shows the following screen when you first log in:</p>
<p><img src="/docs/images/auto-profile1.png" 
alt="Profile creation step 1"
class="mt-3 mb-3 border border-info rounded"></p>
<p>Click <strong>Start Setup</strong> and follow the instructions on the screen to set up your
namespace. The default name for your namespace is your username.</p>
<p>After creating the namespace, you should see the Kubeflow central dashboard,
with your namespace available in the dropdown list at the top of the screen:</p>
<p><img src="/docs/images/central-ui.png"
alt="Kubeflow central UI"
class="mt-3 mb-3 border border-info rounded"></p>
<h2 id="next-steps">Next steps</h2>
<ul>
<li><a href="/docs/components/notebooks/setup/">Set up a Jupyter notebook</a> in Kubeflow.</li>
<li>Read more about <a href="/docs/components/multi-tenancy/">multi-tenancy in Kubeflow</a>.</li>
</ul>

</div>



    
	
  

    
	
  
    
    
	
    

<div class="td-content" style="page-break-before: always">
    
	<h1 id="pg-a559a73b6a3cd8309c703671821a05be">2 - Kubeflow Notebooks</h1>
    <div class="lead">Documentation for Kubeflow Notebooks</div>
	
</div>



    
      
  
  
  
  

  
  

  
    
    
	
    

<div class="td-content" style="">
    
	<h1 id="pg-a1dadde8ee150a386ce42e32af5814aa">2.1 - Overview</h1>
    <div class="lead">An overview of Kubeflow Notebooks</div>
	<div class="alert alert-primary" role="alert">
This Kubeflow component has <b>stable</b> status. See the
<a href="/docs/started/support/#application-status">Kubeflow versioning policies</a>.
</div>
<h2 id="what-is-kubeflow-notebooks">What is Kubeflow Notebooks?</h2>
<p>Kubeflow Notebooks provides a way to run web-based development environments inside your Kubernetes cluster by running them inside Pods.</p>
<p>Some key features include:</p>
<ul>
<li>Native support for <a href="https://github.com/jupyterlab/jupyterlab">JupyterLab</a>, <a href="https://github.com/jupyterlab/jupyterlab">RStudio</a>, and <a href="https://github.com/cdr/code-server">Visual Studio Code (code-server)</a>.</li>
<li>Users can create notebook containers directly in the cluster, rather than locally on their workstations.</li>
<li>Admins can provide standard notebook images for their organization with required packages pre-installed.</li>
<li>Access control is managed by Kubeflow&rsquo;s RBAC, enabling easier notebook sharing across the organization.</li>
</ul>
<h2 id="next-steps">Next steps</h2>
<ul>
<li>Get started with Kubeflow Notebooks using the <a href="/docs/components/notebooks/quickstart-guide/">quickstart guide</a>.</li>
<li>Learn how to create your own <a href="/docs/components/notebooks/container-images/">container images</a>.</li>
</ul>

</div>



    
	
  
    
    
	
    

<div class="td-content" style="page-break-before: always">
    
	<h1 id="pg-c8ab47d4f1d64e45f971641bdda486ab">2.2 - Quickstart Guide</h1>
    <div class="lead">Getting started with Kubeflow Notebooks</div>
	<h2 id="summary">Summary</h2>
<ol>
<li>Install Kubeflow by following <a href="/docs/started/installing-kubeflow/">Getting Started - Installing Kubeflow</a>.</li>
<li>Open the Kubeflow <a href="/docs/components/central-dash/">Central Dashboard</a> in your browser.</li>
<li>Click <strong>&ldquo;Notebooks&rdquo;</strong> in the left-hand panel.</li>
<li>Click <strong>&ldquo;New Server&rdquo;</strong> to create a new notebook server.</li>
<li>Specify the configs for your notebook server.</li>
<li>Click  <strong>&ldquo;CONNECT&rdquo;</strong> once the notebook has been provisioned</li>
</ol>
<h2 id="detailed-steps">Detailed Steps</h2>
<ol>
<li>
<p>Open the Kubeflow <a href="/docs/components/central-dash/">Central Dashboard</a> in your browser.</p>
</li>
<li>
<p>Select a Namespace:</p>
<ul>
<li>Click the namespace dropdown to see the list of available namespaces.</li>
<li>Choose the namespace that corresponds to your Kubeflow Profile.
(See the page on <a href="/docs/components/multi-tenancy/">multi-user isolation</a> for more information about Profiles.)</li>
</ul>
<p><img src="/docs/images/notebooks-namespace.png"
alt="Selecting a Kubeflow namespace"
class="mt-3 mb-3 border border-info rounded"></p>
</li>
<li>
<p>Click <strong>&ldquo;Notebook Servers&rdquo;</strong> in the left-hand panel:</p>
<p><img src="/docs/images/jupyterlink.png"
alt="Opening notebooks from the Kubeflow UI"
class="mt-3 mb-3 border border-info rounded"></p>
</li>
<li>
<p>Click <strong>&ldquo;New Server&rdquo;</strong> on the <strong>&ldquo;Notebook Servers&rdquo;</strong> page:</p>
<p><img src="/docs/images/add-notebook-server.png"
alt="The Kubeflow notebook servers page"
class="mt-3 mb-3 border border-info rounded"></p>
</li>
<li>
<p>Enter a <strong>&ldquo;Name&rdquo;</strong> for your notebook server.</p>
<ul>
<li>The name can include letters and numbers, but no spaces.</li>
<li>For example, <code>my-first-notebook</code>.</li>
</ul>
<p><img src="/docs/images/new-notebook-server.png"
alt="Form for adding a Kubeflow notebook server"
class="mt-3 mb-3 border border-info rounded"></p>
</li>
<li>
<p>Select a Docker <strong>&ldquo;Image&rdquo;</strong> for your notebook server</p>
<ul>
<li><strong>Custom image</strong>: If you select the custom option, you must specify a Docker image in  the form <code>registry/image:tag</code>.
(See the guide on <a href="/docs/components/notebooks/container-images/">container images</a>.)</li>
<li><strong>Standard image</strong>: Click the <strong>&ldquo;Image&rdquo;</strong> dropdown menu to see the list of available images.
(You can choose from the list configured by your Kubeflow administrator)</li>
</ul>
</li>
<li>
<p>Specify the amount of <strong>&ldquo;CPU&rdquo;</strong> that your notebook server will request.</p>
</li>
<li>
<p>Specify the amount of <strong>&ldquo;RAM&rdquo;</strong> that your notebook server will request.</p>
</li>
<li>
<p>Specify a <strong>&ldquo;workspace volume&rdquo;</strong> to be mounted as a PVC Volume on your home folder.</p>
</li>
<li>
<p><em>(Optional)</em> Specify one or more <strong>&ldquo;data volumes&rdquo;</strong> to be mounted as a PVC Volumes.</p>
</li>
<li>
<p><em>(Optional)</em> Specify one or more additional <strong>&ldquo;configurations&rdquo;</strong></p>
<ul>
<li>These correspond to <a href="https://github.com/kubeflow/kubeflow/blob/master/components/admission-webhook/README.md">PodDefault resources</a> which exit in your profile namespace.</li>
<li>Kubeflow matches the labels in the <strong>&ldquo;configurations&rdquo;</strong> field against the properties specified in the PodDefault manifest.</li>
<li>For example, select the label <code>add-gcp-secret</code> in the <strong>&ldquo;configurations&rdquo;</strong> field to match to a PodDefault manifest containing the following configuration:</li>
</ul>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-yaml" data-lang="yaml"><span class="line"><span class="cl"><span class="nt">apiVersion</span><span class="p">:</span><span class="w"> </span><span class="l">kubeflow.org/v1alpha1</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="nt">kind</span><span class="p">:</span><span class="w"> </span><span class="l">PodDefault</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="nt">metadata</span><span class="p">:</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">  </span><span class="nt">name</span><span class="p">:</span><span class="w"> </span><span class="l">add-gcp-secret</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">  </span><span class="nt">namespace</span><span class="p">:</span><span class="w"> </span><span class="l">MY_PROFILE_NAMESPACE</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="nt">spec</span><span class="p">:</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"> </span><span class="nt">selector</span><span class="p">:</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">  </span><span class="nt">matchLabels</span><span class="p">:</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="nt">add-gcp-secret</span><span class="p">:</span><span class="w"> </span><span class="s2">&#34;true&#34;</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"> </span><span class="nt">desc</span><span class="p">:</span><span class="w"> </span><span class="s2">&#34;add gcp credential&#34;</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"> </span><span class="nt">volumeMounts</span><span class="p">:</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"> </span>- <span class="nt">name</span><span class="p">:</span><span class="w"> </span><span class="l">secret-volume</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">   </span><span class="nt">mountPath</span><span class="p">:</span><span class="w"> </span><span class="l">/secret/gcp</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"> </span><span class="nt">volumes</span><span class="p">:</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"> </span>- <span class="nt">name</span><span class="p">:</span><span class="w"> </span><span class="l">secret-volume</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">   </span><span class="nt">secret</span><span class="p">:</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="nt">secretName</span><span class="p">:</span><span class="w"> </span><span class="l">gcp-secret</span><span class="w">
</span></span></span></code></pre></div></li>
<li>
<p><em>(Optional)</em> Specify any <strong>&ldquo;GPUs&rdquo;</strong> that your notebook server will request.</p>
<ul>
<li>Kubeflow uses &ldquo;limits&rdquo; in Pod requests to provision GPUs onto the notebook Pods
(Details about scheduling GPUs can be found in the <a href="https://kubernetes.io/docs/tasks/manage-gpus/scheduling-gpus/">Kubernetes Documentation</a>.)</li>
</ul>
</li>
<li>
<p><em>(Optional)</em> Specify the setting for <strong>&ldquo;enable shared memory&rdquo;</strong>.</p>
<ul>
<li>Some libraries like PyTorch use shared memory for multiprocessing.</li>
<li>Currently, there is no implementation in Kubernetes to activate shared memory.</li>
<li>As a workaround, Kubeflow mounts an empty directory volume at <code>/dev/shm</code>.</li>
</ul>
</li>
<li>
<p>Click <strong>&ldquo;LAUNCH&rdquo;</strong> to create a new Notebook CRD with your specified settings.</p>
<ul>
<li>You should see an entry for your new notebook server on the <strong>&ldquo;Notebook Servers&rdquo;</strong> page</li>
<li>There should be a spinning indicator in the <strong>&ldquo;Status&rdquo;</strong> column.</li>
<li>It can take a few minutes for kubernetes to provision the notebook server pod.</li>
<li>You can check the status of your Pod by hovering your mouse cursor over the icon in the <strong>&ldquo;Status&rdquo;</strong> column.</li>
</ul>
</li>
<li>
<p>Click <strong>&ldquo;CONNECT&rdquo;</strong> to view the web interface exposed by your notebook server.</p>
<p><img src="/docs/images/notebook-servers.png"
alt="Opening notebooks from the Kubeflow UI"
class="mt-3 mb-3 border border-info rounded"></p>
</li>
</ol>
<h2 id="next-steps">Next steps</h2>
<ul>
<li>Learn how to create your own <a href="/docs/components/notebooks/container-images/">container images</a>.</li>
<li>Review examples of using <a href="/docs/components/notebooks/jupyter-tensorflow-examples/">jupyter and tensorflow</a>.</li>
<li>Visit the <a href="/docs/components/notebooks/troubleshooting">troubleshooting guide</a> to fix common errors.</li>
</ul>

</div>



    
	
  
    
    
	
    

<div class="td-content" style="page-break-before: always">
    
	<h1 id="pg-fb24dac53cf9bda9679b2f48d566f43c">2.3 - Container Images</h1>
    <div class="lead">About Container Images for Kubeflow Notebooks</div>
	<p>Kubeflow Notebooks natively supports three types of notebooks, <a href="https://github.com/jupyterlab/jupyterlab">JupyterLab</a>, <a href="https://github.com/rstudio/rstudio">RStudio</a>, and <a href="https://github.com/cdr/code-server">Visual Studio Code (code-server)</a>, but any web-based IDE should work.
Notebook servers run as containers inside a Kubernetes Pod, which means the type of IDE (and which packages are installed) is determined by the Docker image you pick for your server.</p>
<h2 id="images">Images</h2>
<p>We provide a number of <a href="https://github.com/kubeflow/kubeflow/tree/master/components/example-notebook-servers">example container images</a> to get you started.</p>
<h3 id="base-images">Base Images</h3>
<p>These images provide a common starting point for Kubeflow Notebook containers.
See <a href="#custom-images">custom images</a> to learn how to extend them with your own packages.</p>
<table>
<thead>
<tr>
<th>Dockerfile</th>
<th>Registry</th>
<th>Notes</th>
</tr>
</thead>
<tbody>
<tr>
<td><a href="https://github.com/kubeflow/kubeflow/tree/master/components/example-notebook-servers/base">base</a></td>
<td><a href="https://gallery.ecr.aws/j1r0q0g6/notebooks/notebook-servers/base"><code>public.ecr.aws/j1r0q0g6/notebooks/notebook-servers/base:{TAG}</code></a></td>
<td>common base image</td>
</tr>
<tr>
<td><a href="https://github.com/kubeflow/kubeflow/tree/master/components/example-notebook-servers/codeserver">codeserver</a></td>
<td><a href="https://gallery.ecr.aws/j1r0q0g6/notebooks/notebook-servers/codeserver"><code>public.ecr.aws/j1r0q0g6/notebooks/notebook-servers/codeserver:{TAG}</code></a></td>
<td>base <a href="https://github.com/cdr/code-server">code-server</a> (Visual Studio Code) image</td>
</tr>
<tr>
<td><a href="https://github.com/kubeflow/kubeflow/tree/master/components/example-notebook-servers/jupyter">jupyter</a></td>
<td><a href="https://gallery.ecr.aws/j1r0q0g6/notebooks/notebook-servers/jupyter"><code>public.ecr.aws/j1r0q0g6/notebooks/notebook-servers/jupyter:{TAG}</code></a></td>
<td>base <a href="https://github.com/jupyterlab/jupyterlab">JupyterLab</a> image</td>
</tr>
<tr>
<td><a href="https://github.com/kubeflow/kubeflow/tree/master/components/example-notebook-servers/rstudio">rstudio</a></td>
<td><a href="https://gallery.ecr.aws/j1r0q0g6/notebooks/notebook-servers/rstudio"><code>public.ecr.aws/j1r0q0g6/notebooks/notebook-servers/rstudio:{TAG}</code></a></td>
<td>base <a href="https://github.com/rstudio/rstudio">RStudio</a> image</td>
</tr>
</tbody>
</table>
<h3 id="full-images">Full Images</h3>
<p>These images extend the <a href="#base-images">base images</a> with common packages used by Data Scientists and ML Engineers.</p>
<table>
<thead>
<tr>
<th>Dockerfile</th>
<th>Registry</th>
<th>Notes</th>
</tr>
</thead>
<tbody>
<tr>
<td><a href="https://github.com/kubeflow/kubeflow/tree/master/components/example-notebook-servers/codeserver-python">codeserver-python</a></td>
<td><a href="https://gallery.ecr.aws/j1r0q0g6/notebooks/notebook-servers/codeserver-python"><code>public.ecr.aws/j1r0q0g6/notebooks/notebook-servers/codeserver-python:{TAG}</code></a></td>
<td>code-server (Visual Studio Code) + Conda Python</td>
</tr>
<tr>
<td><a href="https://github.com/kubeflow/kubeflow/tree/master/components/example-notebook-servers/jupyter-pytorch">jupyter-pytorch (CPU)</a></td>
<td><a href="https://gallery.ecr.aws/j1r0q0g6/notebooks/notebook-servers/jupyter-pytorch"><code>public.ecr.aws/j1r0q0g6/notebooks/notebook-servers/jupyter-pytorch:{TAG}</code></a></td>
<td>JupyterLab + PyTorch (CPU)</td>
</tr>
<tr>
<td><a href="https://github.com/kubeflow/kubeflow/tree/master/components/example-notebook-servers/jupyter-pytorch">jupyter-pytorch (CUDA)</a></td>
<td><a href="https://gallery.ecr.aws/j1r0q0g6/notebooks/notebook-servers/jupyter-pytorch-cuda"><code>public.ecr.aws/j1r0q0g6/notebooks/notebook-servers/jupyter-pytorch-cuda:{TAG}</code></a></td>
<td>JupyterLab + PyTorch (CUDA)</td>
</tr>
<tr>
<td><a href="https://github.com/kubeflow/kubeflow/tree/master/components/example-notebook-servers/jupyter-pytorch-full">jupyter-pytorch-full (CPU)</a></td>
<td><a href="https://gallery.ecr.aws/j1r0q0g6/notebooks/notebook-servers/jupyter-pytorch-full"><code>public.ecr.aws/j1r0q0g6/notebooks/notebook-servers/jupyter-pytorch-full:{TAG}</code></a></td>
<td>JupyterLab + PyTorch (CPU) + <a href="https://github.com/kubeflow/kubeflow/tree/master/components/example-notebook-servers/jupyter-pytorch-full/requirements.txt">common</a> packages</td>
</tr>
<tr>
<td><a href="https://github.com/kubeflow/kubeflow/tree/master/components/example-notebook-servers/jupyter-pytorch-full">jupyter-pytorch-full (CUDA)</a></td>
<td><a href="https://gallery.ecr.aws/j1r0q0g6/notebooks/notebook-servers/jupyter-pytorch-cuda-full"><code>public.ecr.aws/j1r0q0g6/notebooks/notebook-servers/jupyter-pytorch-cuda-full:{TAG}</code></a></td>
<td>JupyterLab + PyTorch (CUDA) + <a href="https://github.com/kubeflow/kubeflow/tree/master/components/example-notebook-servers/jupyter-pytorch-full/requirements.txt">common</a> packages</td>
</tr>
<tr>
<td><a href="https://github.com/kubeflow/kubeflow/tree/master/components/example-notebook-servers/jupyter-scipy">jupyter-scipy</a></td>
<td><a href="https://gallery.ecr.aws/j1r0q0g6/notebooks/notebook-servers/jupyter-scipy"><code>public.ecr.aws/j1r0q0g6/notebooks/notebook-servers/jupyter-scipy:{TAG}</code></a></td>
<td>JupyterLab + <a href="https://www.scipy.org/">SciPy</a> packages</td>
</tr>
<tr>
<td><a href="https://github.com/kubeflow/kubeflow/tree/master/components/example-notebook-servers/jupyter-tensorflow">jupyter-tensorflow (CPU)</a></td>
<td><a href="https://gallery.ecr.aws/j1r0q0g6/notebooks/notebook-servers/jupyter-tensorflow"><code>public.ecr.aws/j1r0q0g6/notebooks/notebook-servers/jupyter-tensorflow:{TAG}</code></a></td>
<td>JupyterLab + TensorFlow (CPU)</td>
</tr>
<tr>
<td><a href="https://github.com/kubeflow/kubeflow/tree/master/components/example-notebook-servers/jupyter-tensorflow">jupyter-tensorflow (CUDA)</a></td>
<td><a href="https://gallery.ecr.aws/j1r0q0g6/notebooks/notebook-servers/jupyter-tensorflow-cuda"><code>public.ecr.aws/j1r0q0g6/notebooks/notebook-servers/jupyter-tensorflow-cuda:{TAG}</code></a></td>
<td>JupyterLab + TensorFlow (CUDA)</td>
</tr>
<tr>
<td><a href="https://github.com/kubeflow/kubeflow/tree/master/components/example-notebook-servers/jupyter-tensorflow-full">jupyter-tensorflow-full (CPU)</a></td>
<td><a href="https://gallery.ecr.aws/j1r0q0g6/notebooks/notebook-servers/jupyter-tensorflow-full"><code>public.ecr.aws/j1r0q0g6/notebooks/notebook-servers/jupyter-tensorflow-full:{TAG}</code></a></td>
<td>JupyterLab + TensorFlow (CPU) + <a href="https://github.com/kubeflow/kubeflow/tree/master/components/example-notebook-servers/jupyter-tensorflow-full/requirements.txt">common</a> packages</td>
</tr>
<tr>
<td><a href="https://github.com/kubeflow/kubeflow/tree/master/components/example-notebook-servers/jupyter-tensorflow-full">jupyter-tensorflow-full (CUDA)</a></td>
<td><a href="https://gallery.ecr.aws/j1r0q0g6/notebooks/notebook-servers/jupyter-tensorflow-cuda-full"><code>public.ecr.aws/j1r0q0g6/notebooks/notebook-servers/jupyter-tensorflow-cuda-full:{TAG}</code></a></td>
<td>JupyterLab + TensorFlow (CUDA) + <a href="https://github.com/kubeflow/kubeflow/tree/master/components/example-notebook-servers/jupyter-tensorflow-full/requirements.txt">common</a> packages</td>
</tr>
<tr>
<td><a href="https://github.com/kubeflow/kubeflow/tree/master/components/example-notebook-servers/rstudio-tidyverse">rstudio-tidyverse</a></td>
<td><a href="https://gallery.ecr.aws/j1r0q0g6/notebooks/notebook-servers/rstudio-tidyverse"><code>public.ecr.aws/j1r0q0g6/notebooks/notebook-servers/rstudio-tidyverse:{TAG}</code></a></td>
<td>RStudio + <a href="https://www.tidyverse.org/">Tidyverse</a> packages</td>
</tr>
</tbody>
</table>
<h3 id="image-dependency-chart">Image Dependency Chart</h3>
<p>This flow-chart shows how our notebook container images depend on each other.</p>
<p><img src="/docs/images/notebook-container-image-chart.png" 
alt="A flow-chart showing how notebook container images depend on each other"  
class="mt-3 mb-3 border border-info rounded"></p>
<h2 id="custom-images">Custom Images</h2>
<p>Packages installed by users <strong>after spawning</strong> a Kubeflow Notebook will only last the lifetime of the pod (unless installed into a PVC-backed directory).</p>
<p>To ensure packages are preserved throughout Pod restarts users will need to either:</p>
<ol>
<li><a href="https://github.com/kubeflow/kubeflow/tree/master/components/example-notebook-servers#custom-images">Build custom images that include them</a>, or</li>
<li>Ensure they are installed in a PVC-backed directory</li>
</ol>
<h3 id="image-requirements">Image Requirements</h3>
<p>For Kubeflow Notebooks to work with a container image, the image must:</p>
<ul>
<li>expose an HTTP interface on port <code>8888</code>:
<ul>
<li>kubeflow sets an environment variable <code>NB_PREFIX</code> at runtime with the URL path we expect the container be listening under</li>
<li>kubeflow uses IFrames, so ensure your application sets <code>Access-Control-Allow-Origin: *</code> in HTTP response headers</li>
</ul>
</li>
<li>run as a user called <code>jovyan</code>:
<ul>
<li>the home directory of <code>jovyan</code> should be <code>/home/jovyan</code></li>
<li>the UID of <code>jovyan</code> should be <code>1000</code></li>
</ul>
</li>
<li>start successfully with an empty PVC mounted at <code>/home/jovyan</code>:
<ul>
<li>kubeflow mounts a PVC at <code>/home/jovyan</code> to keep state across Pod restarts</li>
</ul>
</li>
</ul>
<h2 id="next-steps">Next steps</h2>
<ul>
<li>Use your container image by specifying it when spawning your notebook server.
(See the <a href="/docs/components/notebooks/quickstart-guide/">quickstart guide</a>.)</li>
</ul>

</div>



    
	
  
    
    
	
    

<div class="td-content" style="page-break-before: always">
    
	<h1 id="pg-6783e7595e3463d9b32c8e39ab6b7441">2.4 - Jupyter TensorFlow Examples</h1>
    <div class="lead">Examples using Jupyter and TensorFlow in Kubeflow Notebooks</div>
	<h2 id="mnist-example">Mnist Example</h2>
<p>(adapted from <a href="https://github.com/tensorflow/tensorflow/blob/r1.4/tensorflow/examples/tutorials/mnist/mnist_softmax.py">tensorflow/tensorflow - mnist_softmax.py</a>)</p>
<ol>
<li>
<p>When creating your notebook server choose a <a href="/docs/components/notebooks/container-images/">container image</a> which has Jupyter and TensorFlow installed.</p>
</li>
<li>
<p>Use Jupyter&rsquo;s interface to create a new <strong>Python 3</strong> notebook.</p>
</li>
<li>
<p>Copy the following code and paste it into your notebook:</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-python" data-lang="python"><span class="line"><span class="cl"><span class="kn">from</span> <span class="nn">tensorflow.examples.tutorials.mnist</span> <span class="kn">import</span> <span class="n">input_data</span>
</span></span><span class="line"><span class="cl"><span class="n">mnist</span> <span class="o">=</span> <span class="n">input_data</span><span class="o">.</span><span class="n">read_data_sets</span><span class="p">(</span><span class="s2">&#34;MNIST_data/&#34;</span><span class="p">,</span> <span class="n">one_hot</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="kn">import</span> <span class="nn">tensorflow</span> <span class="k">as</span> <span class="nn">tf</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="n">x</span> <span class="o">=</span> <span class="n">tf</span><span class="o">.</span><span class="n">placeholder</span><span class="p">(</span><span class="n">tf</span><span class="o">.</span><span class="n">float32</span><span class="p">,</span> <span class="p">[</span><span class="kc">None</span><span class="p">,</span> <span class="mi">784</span><span class="p">])</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="n">W</span> <span class="o">=</span> <span class="n">tf</span><span class="o">.</span><span class="n">Variable</span><span class="p">(</span><span class="n">tf</span><span class="o">.</span><span class="n">zeros</span><span class="p">([</span><span class="mi">784</span><span class="p">,</span> <span class="mi">10</span><span class="p">]))</span>
</span></span><span class="line"><span class="cl"><span class="n">b</span> <span class="o">=</span> <span class="n">tf</span><span class="o">.</span><span class="n">Variable</span><span class="p">(</span><span class="n">tf</span><span class="o">.</span><span class="n">zeros</span><span class="p">([</span><span class="mi">10</span><span class="p">]))</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="n">y</span> <span class="o">=</span> <span class="n">tf</span><span class="o">.</span><span class="n">nn</span><span class="o">.</span><span class="n">softmax</span><span class="p">(</span><span class="n">tf</span><span class="o">.</span><span class="n">matmul</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">W</span><span class="p">)</span> <span class="o">+</span> <span class="n">b</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="n">y_</span> <span class="o">=</span> <span class="n">tf</span><span class="o">.</span><span class="n">placeholder</span><span class="p">(</span><span class="n">tf</span><span class="o">.</span><span class="n">float32</span><span class="p">,</span> <span class="p">[</span><span class="kc">None</span><span class="p">,</span> <span class="mi">10</span><span class="p">])</span>
</span></span><span class="line"><span class="cl"><span class="n">cross_entropy</span> <span class="o">=</span> <span class="n">tf</span><span class="o">.</span><span class="n">reduce_mean</span><span class="p">(</span><span class="o">-</span><span class="n">tf</span><span class="o">.</span><span class="n">reduce_sum</span><span class="p">(</span><span class="n">y_</span> <span class="o">*</span> <span class="n">tf</span><span class="o">.</span><span class="n">log</span><span class="p">(</span><span class="n">y</span><span class="p">),</span> <span class="n">reduction_indices</span><span class="o">=</span><span class="p">[</span><span class="mi">1</span><span class="p">]))</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="n">train_step</span> <span class="o">=</span> <span class="n">tf</span><span class="o">.</span><span class="n">train</span><span class="o">.</span><span class="n">GradientDescentOptimizer</span><span class="p">(</span><span class="mf">0.05</span><span class="p">)</span><span class="o">.</span><span class="n">minimize</span><span class="p">(</span><span class="n">cross_entropy</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="n">sess</span> <span class="o">=</span> <span class="n">tf</span><span class="o">.</span><span class="n">InteractiveSession</span><span class="p">()</span>
</span></span><span class="line"><span class="cl"><span class="n">tf</span><span class="o">.</span><span class="n">global_variables_initializer</span><span class="p">()</span><span class="o">.</span><span class="n">run</span><span class="p">()</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="k">for</span> <span class="n">_</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">1000</span><span class="p">):</span>
</span></span><span class="line"><span class="cl">  <span class="n">batch_xs</span><span class="p">,</span> <span class="n">batch_ys</span> <span class="o">=</span> <span class="n">mnist</span><span class="o">.</span><span class="n">train</span><span class="o">.</span><span class="n">next_batch</span><span class="p">(</span><span class="mi">100</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">  <span class="n">sess</span><span class="o">.</span><span class="n">run</span><span class="p">(</span><span class="n">train_step</span><span class="p">,</span> <span class="n">feed_dict</span><span class="o">=</span><span class="p">{</span><span class="n">x</span><span class="p">:</span> <span class="n">batch_xs</span><span class="p">,</span> <span class="n">y_</span><span class="p">:</span> <span class="n">batch_ys</span><span class="p">})</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="n">correct_prediction</span> <span class="o">=</span> <span class="n">tf</span><span class="o">.</span><span class="n">equal</span><span class="p">(</span><span class="n">tf</span><span class="o">.</span><span class="n">argmax</span><span class="p">(</span><span class="n">y</span><span class="p">,</span><span class="mi">1</span><span class="p">),</span> <span class="n">tf</span><span class="o">.</span><span class="n">argmax</span><span class="p">(</span><span class="n">y_</span><span class="p">,</span><span class="mi">1</span><span class="p">))</span>
</span></span><span class="line"><span class="cl"><span class="n">accuracy</span> <span class="o">=</span> <span class="n">tf</span><span class="o">.</span><span class="n">reduce_mean</span><span class="p">(</span><span class="n">tf</span><span class="o">.</span><span class="n">cast</span><span class="p">(</span><span class="n">correct_prediction</span><span class="p">,</span> <span class="n">tf</span><span class="o">.</span><span class="n">float32</span><span class="p">))</span>
</span></span><span class="line"><span class="cl"><span class="nb">print</span><span class="p">(</span><span class="s2">&#34;Accuracy: &#34;</span><span class="p">,</span> <span class="n">sess</span><span class="o">.</span><span class="n">run</span><span class="p">(</span><span class="n">accuracy</span><span class="p">,</span> <span class="n">feed_dict</span><span class="o">=</span><span class="p">{</span><span class="n">x</span><span class="p">:</span> <span class="n">mnist</span><span class="o">.</span><span class="n">test</span><span class="o">.</span><span class="n">images</span><span class="p">,</span> <span class="n">y_</span><span class="p">:</span> <span class="n">mnist</span><span class="o">.</span><span class="n">test</span><span class="o">.</span><span class="n">labels</span><span class="p">}))</span>
</span></span></code></pre></div></li>
<li>
<p>Run the code. You should see a number of <code>WARNING</code> messages from TensorFlow, followed by a line showing a training accuracy something like this:</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-fallback" data-lang="fallback"><span class="line"><span class="cl">Accuracy:  0.9012
</span></span></code></pre></div></li>
</ol>
<h2 id="next-steps">Next steps</h2>
<ul>
<li>See a <a href="https://github.com/kubeflow/examples/tree/master/pipelines/simple-notebook-pipeline">simple example</a> of creating Kubeflow pipelines in a Jupyter notebook.</li>
<li>Build machine-learning pipelines with the <a href="/docs/components/pipelines/sdk/sdk-overview/">Kubeflow Pipelines SDK</a>.</li>
<li>Learn the advanced features available from a Kubeflow notebook, such as <a href="/docs/components/notebooks/submit-kubernetes/">submitting Kubernetes resources</a> or <a href="/docs/components/notebooks/custom-notebook/">building Docker images</a>.</li>
</ul>

</div>



    
	
  
    
    
	
    

<div class="td-content" style="page-break-before: always">
    
	<h1 id="pg-0e54c1a1221463890a83803ce89e1686">2.5 - Submit Kubernetes Resources</h1>
    <div class="lead">Submitting Kubernetes resources from a Notebook</div>
	<h2 id="notebook-pod-serviceaccount">Notebook Pod ServiceAccount</h2>
<p>Kubeflow assigns the <code>default-editor</code> Kubernetes ServiceAccount to the Notebook Pods.
The Kubernetes <code>default-editor</code> ServiceAccount is bound to the <code>kubeflow-edit</code> ClusterRole, which has namespace-scoped permissions to many Kubernetes resources.</p>
<p>You can get the full list of RBAC for <code>ClusterRole/kubeflow-edit</code> using:</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-fallback" data-lang="fallback"><span class="line"><span class="cl">kubectl describe clusterrole kubeflow-edit
</span></span></code></pre></div><h2 id="kubectl-in-notebook-pod">Kubectl in Notebook Pod</h2>
<p>Because every Notebook Pod has the highly-privileged <code>default-editor</code> Kubernetes ServiceAccount bound to it, you can run <code>kubectl</code> inside it without providing additional authentication.</p>
<p>For example, the following command will create the resources defined in <code>test.yaml</code>:</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-shell" data-lang="shell"><span class="line"><span class="cl">kubectl create -f <span class="s2">&#34;test.yaml&#34;</span> --namespace <span class="s2">&#34;MY_PROFILE_NAMESPACE&#34;</span>
</span></span></code></pre></div><h2 id="next-steps">Next steps</h2>
<ul>
<li>See the Kubeflow Notebook <a href="/docs/components/notebooks/quickstart-guide/">quickstart guide</a>.</li>
<li>Explore the other <a href="/docs/components/">components of Kubeflow</a>.</li>
</ul>

</div>



    
	
  
    
    
	
    

<div class="td-content" style="page-break-before: always">
    
	<h1 id="pg-6df9976b3b6f04214918966cac839101">2.6 - Troubleshooting</h1>
    <div class="lead">Problems and solutions for common problems with Kubeflow Notebooks</div>
	<h2 id="issue-notebook-not-starting">ISSUE: notebook not starting</h2>
<h3 id="solution-check-events-of-notebook">SOLUTION: check events of Notebook</h3>
<p>Run the following command then check the <code>events</code> section to make sure that there are no errors:</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-shell" data-lang="shell"><span class="line"><span class="cl">kubectl describe notebooks <span class="s2">&#34;</span><span class="si">${</span><span class="nv">MY_NOTEBOOK_NAME</span><span class="si">}</span><span class="s2">&#34;</span> --namespace <span class="s2">&#34;</span><span class="si">${</span><span class="nv">MY_PROFILE_NAMESPACE</span><span class="si">}</span><span class="s2">&#34;</span>
</span></span></code></pre></div><h3 id="solution-check-events-of-pod">SOLUTION: check events of Pod</h3>
<p>Run the following command then check the <code>events</code> section to make sure that there are no errors:</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-shell" data-lang="shell"><span class="line"><span class="cl">kubectl describe pod <span class="s2">&#34;</span><span class="si">${</span><span class="nv">MY_NOTEBOOK_NAME</span><span class="si">}</span><span class="s2">-0&#34;</span> --namespace <span class="s2">&#34;</span><span class="si">${</span><span class="nv">MY_PROFILE_NAMESPACE</span><span class="si">}</span><span class="s2">&#34;</span>
</span></span></code></pre></div><h3 id="solution-check-yaml-of-pod">SOLUTION: check YAML of Pod</h3>
<p>Run the following command and check the Pod YAML looks as expected:</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-shell" data-lang="shell"><span class="line"><span class="cl">kubectl get pod <span class="s2">&#34;</span><span class="si">${</span><span class="nv">MY_NOTEBOOK_NAME</span><span class="si">}</span><span class="s2">-0&#34;</span> --namespace <span class="s2">&#34;</span><span class="si">${</span><span class="nv">MY_PROFILE_NAMESPACE</span><span class="si">}</span><span class="s2">&#34;</span> -o yaml
</span></span></code></pre></div><h3 id="solution-check-logs-of-pod">SOLUTION: check logs of Pod</h3>
<p>Run the following command to get the logs from the Pod:</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-shell" data-lang="shell"><span class="line"><span class="cl">kubectl logs <span class="s2">&#34;</span><span class="si">${</span><span class="nv">MY_NOTEBOOK_NAME</span><span class="si">}</span><span class="s2">-0&#34;</span> --namespace <span class="s2">&#34;</span><span class="si">${</span><span class="nv">MY_PROFILE_NAMESPACE</span><span class="si">}</span><span class="s2">&#34;</span>
</span></span></code></pre></div><h2 id="issue-manually-delete-notebook">ISSUE: manually delete notebook</h2>
<h3 id="solution-use-kubectl-to-delete-notebook-resource">SOLUTION: use kubectl to delete Notebook resource</h3>
<p>Run the following command to delete a Notebook resource manually:</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-shell" data-lang="shell"><span class="line"><span class="cl">kubectl delete notebook <span class="s2">&#34;</span><span class="si">${</span><span class="nv">MY_NOTEBOOK_NAME</span><span class="si">}</span><span class="s2">&#34;</span> --namespace <span class="s2">&#34;</span><span class="si">${</span><span class="nv">MY_PROFILE_NAMESPACE</span><span class="si">}</span><span class="s2">&#34;</span>
</span></span></code></pre></div>
</div>



    
	
  
    
    
	
    

<div class="td-content" style="page-break-before: always">
    
	<h1 id="pg-8edb7e5ba14c7fe4f9ff0ea005bcef8b">2.7 - API Reference</h1>
    <div class="lead">Reference documentation for Kubeflow Notebooks</div>
	
</div>



    
      
  
  
  
  

  
  

  
    
    
	
    

<div class="td-content" style="">
    
	<h1 id="pg-972c570813edbd8a8f8c695ed586f54a">2.7.1 - Notebook (v1)</h1>
    <div class="lead">Reference documentation for the <code>v1</code> version of the <code>Notebook</code> resource</div>
	<p>Packages:</p>
<ul>
<li>
<a href="#kubeflow.org%2fv1">kubeflow.org/v1</a>
</li>
</ul>
<h2 id="kubeflow.org/v1">kubeflow.org/v1</h2>
<p>
<p>Package v1 contains API Schema definitions for the kubeflow.org v1 API group</p>
</p>
Resource Types:
<ul></ul>
<h3 id="kubeflow.org/v1.Notebook">Notebook
</h3>
<p>
<p>Notebook is the Schema for the notebooks API</p>
</p>
<table>
<thead>
<tr>
<th>Field</th>
<th>Description</th>
</tr>
</thead>
<tbody>
<tr>
<td>
<code>metadata</code></br>
<em>
<a href="https://v1-18.docs.kubernetes.io/docs/reference/generated/kubernetes-api/v1.18/#objectmeta-v1-meta">
Kubernetes meta/v1.ObjectMeta
</a>
</em>
</td>
<td>
Refer to the Kubernetes API documentation for the fields of the
<code>metadata</code> field.
</td>
</tr>
<tr>
<td>
<code>spec</code></br>
<em>
<a href="#kubeflow.org/v1.NotebookSpec">
NotebookSpec
</a>
</em>
</td>
<td>
<br/>
<br/>
<table>
<tr>
<td>
<code>template</code></br>
<em>
<a href="#kubeflow.org/v1.NotebookTemplateSpec">
NotebookTemplateSpec
</a>
</em>
</td>
<td>
<p>INSERT ADDITIONAL SPEC FIELDS - desired state of cluster
Important: Run &ldquo;make&rdquo; to regenerate code after modifying this file</p>
</td>
</tr>
</table>
</td>
</tr>
<tr>
<td>
<code>status</code></br>
<em>
<a href="#kubeflow.org/v1.NotebookStatus">
NotebookStatus
</a>
</em>
</td>
<td>
</td>
</tr>
</tbody>
</table>
<h3 id="kubeflow.org/v1.NotebookCondition">NotebookCondition
</h3>
<p>
(<em>Appears on:</em>
<a href="#kubeflow.org/v1.NotebookStatus">NotebookStatus</a>)
</p>
<p>
</p>
<table>
<thead>
<tr>
<th>Field</th>
<th>Description</th>
</tr>
</thead>
<tbody>
<tr>
<td>
<code>type</code></br>
<em>
string
</em>
</td>
<td>
<p>Type is the type of the condition. Possible values are Running|Waiting|Terminated</p>
</td>
</tr>
<tr>
<td>
<code>lastProbeTime</code></br>
<em>
<a href="https://v1-18.docs.kubernetes.io/docs/reference/generated/kubernetes-api/v1.18/#time-v1-meta">
Kubernetes meta/v1.Time
</a>
</em>
</td>
<td>
<em>(Optional)</em>
<p>Last time we probed the condition.</p>
</td>
</tr>
<tr>
<td>
<code>reason</code></br>
<em>
string
</em>
</td>
<td>
<em>(Optional)</em>
<p>(brief) reason the container is in the current state</p>
</td>
</tr>
<tr>
<td>
<code>message</code></br>
<em>
string
</em>
</td>
<td>
<em>(Optional)</em>
<p>Message regarding why the container is in the current state.</p>
</td>
</tr>
</tbody>
</table>
<h3 id="kubeflow.org/v1.NotebookSpec">NotebookSpec
</h3>
<p>
(<em>Appears on:</em>
<a href="#kubeflow.org/v1.Notebook">Notebook</a>)
</p>
<p>
<p>NotebookSpec defines the desired state of Notebook</p>
</p>
<table>
<thead>
<tr>
<th>Field</th>
<th>Description</th>
</tr>
</thead>
<tbody>
<tr>
<td>
<code>template</code></br>
<em>
<a href="#kubeflow.org/v1.NotebookTemplateSpec">
NotebookTemplateSpec
</a>
</em>
</td>
<td>
<p>INSERT ADDITIONAL SPEC FIELDS - desired state of cluster
Important: Run &ldquo;make&rdquo; to regenerate code after modifying this file</p>
</td>
</tr>
</tbody>
</table>
<h3 id="kubeflow.org/v1.NotebookStatus">NotebookStatus
</h3>
<p>
(<em>Appears on:</em>
<a href="#kubeflow.org/v1.Notebook">Notebook</a>)
</p>
<p>
<p>NotebookStatus defines the observed state of Notebook</p>
</p>
<table>
<thead>
<tr>
<th>Field</th>
<th>Description</th>
</tr>
</thead>
<tbody>
<tr>
<td>
<code>conditions</code></br>
<em>
<a href="#kubeflow.org/v1.NotebookCondition">
[]NotebookCondition
</a>
</em>
</td>
<td>
<p>Conditions is an array of current conditions</p>
</td>
</tr>
<tr>
<td>
<code>readyReplicas</code></br>
<em>
int32
</em>
</td>
<td>
<p>ReadyReplicas is the number of Pods created by the StatefulSet controller that have a Ready Condition.</p>
</td>
</tr>
<tr>
<td>
<code>containerState</code></br>
<em>
<a href="https://v1-18.docs.kubernetes.io/docs/reference/generated/kubernetes-api/v1.18/#containerstate-v1-core">
Kubernetes core/v1.ContainerState
</a>
</em>
</td>
<td>
<p>ContainerState is the state of underlying container.</p>
</td>
</tr>
</tbody>
</table>
<h3 id="kubeflow.org/v1.NotebookTemplateSpec">NotebookTemplateSpec
</h3>
<p>
(<em>Appears on:</em>
<a href="#kubeflow.org/v1.NotebookSpec">NotebookSpec</a>)
</p>
<p>
</p>
<table>
<thead>
<tr>
<th>Field</th>
<th>Description</th>
</tr>
</thead>
<tbody>
<tr>
<td>
<code>spec</code></br>
<em>
<a href="https://v1-18.docs.kubernetes.io/docs/reference/generated/kubernetes-api/v1.18/#podspec-v1-core">
Kubernetes core/v1.PodSpec
</a>
</em>
</td>
<td>
<br/>
<br/>
<table>
<tr>
<td>
<code>volumes</code></br>
<em>
<a href="https://v1-18.docs.kubernetes.io/docs/reference/generated/kubernetes-api/v1.18/#volume-v1-core">
[]Kubernetes core/v1.Volume
</a>
</em>
</td>
<td>
<em>(Optional)</em>
<p>List of volumes that can be mounted by containers belonging to the pod.
More info: <a href="https://kubernetes.io/docs/concepts/storage/volumes">https://kubernetes.io/docs/concepts/storage/volumes</a></p>
</td>
</tr>
<tr>
<td>
<code>initContainers</code></br>
<em>
<a href="https://v1-18.docs.kubernetes.io/docs/reference/generated/kubernetes-api/v1.18/#container-v1-core">
[]Kubernetes core/v1.Container
</a>
</em>
</td>
<td>
<p>List of initialization containers belonging to the pod.
Init containers are executed in order prior to containers being started. If any
init container fails, the pod is considered to have failed and is handled according
to its restartPolicy. The name for an init container or normal container must be
unique among all containers.
Init containers may not have Lifecycle actions, Readiness probes, Liveness probes, or Startup probes.
The resourceRequirements of an init container are taken into account during scheduling
by finding the highest request/limit for each resource type, and then using the max of
of that value or the sum of the normal containers. Limits are applied to init containers
in a similar fashion.
Init containers cannot currently be added or removed.
Cannot be updated.
More info: <a href="https://kubernetes.io/docs/concepts/workloads/pods/init-containers/">https://kubernetes.io/docs/concepts/workloads/pods/init-containers/</a></p>
</td>
</tr>
<tr>
<td>
<code>containers</code></br>
<em>
<a href="https://v1-18.docs.kubernetes.io/docs/reference/generated/kubernetes-api/v1.18/#container-v1-core">
[]Kubernetes core/v1.Container
</a>
</em>
</td>
<td>
<p>List of containers belonging to the pod.
Containers cannot currently be added or removed.
There must be at least one container in a Pod.
Cannot be updated.</p>
</td>
</tr>
<tr>
<td>
<code>ephemeralContainers</code></br>
<em>
<a href="https://v1-18.docs.kubernetes.io/docs/reference/generated/kubernetes-api/v1.18/#ephemeralcontainer-v1-core">
[]Kubernetes core/v1.EphemeralContainer
</a>
</em>
</td>
<td>
<em>(Optional)</em>
<p>List of ephemeral containers run in this pod. Ephemeral containers may be run in an existing
pod to perform user-initiated actions such as debugging. This list cannot be specified when
creating a pod, and it cannot be modified by updating the pod spec. In order to add an
ephemeral container to an existing pod, use the pod&rsquo;s ephemeralcontainers subresource.
This field is alpha-level and is only honored by servers that enable the EphemeralContainers feature.</p>
</td>
</tr>
<tr>
<td>
<code>restartPolicy</code></br>
<em>
string
</em>
</td>
<td>
<em>(Optional)</em>
<p>Restart policy for all containers within the pod.
One of Always, OnFailure, Never.
Default to Always.
More info: <a href="https://kubernetes.io/docs/concepts/workloads/pods/pod-lifecycle/#restart-policy">https://kubernetes.io/docs/concepts/workloads/pods/pod-lifecycle/#restart-policy</a></p>
</td>
</tr>
<tr>
<td>
<code>terminationGracePeriodSeconds</code></br>
<em>
int64
</em>
</td>
<td>
<em>(Optional)</em>
<p>Optional duration in seconds the pod needs to terminate gracefully. May be decreased in delete request.
Value must be non-negative integer. The value zero indicates delete immediately.
If this value is nil, the default grace period will be used instead.
The grace period is the duration in seconds after the processes running in the pod are sent
a termination signal and the time when the processes are forcibly halted with a kill signal.
Set this value longer than the expected cleanup time for your process.
Defaults to 30 seconds.</p>
</td>
</tr>
<tr>
<td>
<code>activeDeadlineSeconds</code></br>
<em>
int64
</em>
</td>
<td>
<em>(Optional)</em>
<p>Optional duration in seconds the pod may be active on the node relative to
StartTime before the system will actively try to mark it failed and kill associated containers.
Value must be a positive integer.</p>
</td>
</tr>
<tr>
<td>
<code>dnsPolicy</code></br>
<em>
string
</em>
</td>
<td>
<em>(Optional)</em>
<p>Set DNS policy for the pod.
Defaults to &ldquo;ClusterFirst&rdquo;.
Valid values are &lsquo;ClusterFirstWithHostNet&rsquo;, &lsquo;ClusterFirst&rsquo;, &lsquo;Default&rsquo; or &lsquo;None&rsquo;.
DNS parameters given in DNSConfig will be merged with the policy selected with DNSPolicy.
To have DNS options set along with hostNetwork, you have to specify DNS policy
explicitly to &lsquo;ClusterFirstWithHostNet&rsquo;.</p>
</td>
</tr>
<tr>
<td>
<code>nodeSelector</code></br>
<em>
map[string]string
</em>
</td>
<td>
<em>(Optional)</em>
<p>NodeSelector is a selector which must be true for the pod to fit on a node.
Selector which must match a node&rsquo;s labels for the pod to be scheduled on that node.
More info: <a href="https://kubernetes.io/docs/concepts/configuration/assign-pod-node/">https://kubernetes.io/docs/concepts/configuration/assign-pod-node/</a></p>
</td>
</tr>
<tr>
<td>
<code>serviceAccountName</code></br>
<em>
string
</em>
</td>
<td>
<em>(Optional)</em>
<p>ServiceAccountName is the name of the ServiceAccount to use to run this pod.
More info: <a href="https://kubernetes.io/docs/tasks/configure-pod-container/configure-service-account/">https://kubernetes.io/docs/tasks/configure-pod-container/configure-service-account/</a></p>
</td>
</tr>
<tr>
<td>
<code>serviceAccount</code></br>
<em>
string
</em>
</td>
<td>
<em>(Optional)</em>
<p>DeprecatedServiceAccount is a depreciated alias for ServiceAccountName.
Deprecated: Use serviceAccountName instead.</p>
</td>
</tr>
<tr>
<td>
<code>automountServiceAccountToken</code></br>
<em>
bool
</em>
</td>
<td>
<em>(Optional)</em>
<p>AutomountServiceAccountToken indicates whether a service account token should be automatically mounted.</p>
</td>
</tr>
<tr>
<td>
<code>nodeName</code></br>
<em>
string
</em>
</td>
<td>
<em>(Optional)</em>
<p>NodeName is a request to schedule this pod onto a specific node. If it is non-empty,
the scheduler simply schedules this pod onto that node, assuming that it fits resource
requirements.</p>
</td>
</tr>
<tr>
<td>
<code>hostNetwork</code></br>
<em>
bool
</em>
</td>
<td>
<em>(Optional)</em>
<p>Host networking requested for this pod. Use the host&rsquo;s network namespace.
If this option is set, the ports that will be used must be specified.
Default to false.</p>
</td>
</tr>
<tr>
<td>
<code>hostPID</code></br>
<em>
bool
</em>
</td>
<td>
<em>(Optional)</em>
<p>Use the host&rsquo;s pid namespace.
Optional: Default to false.</p>
</td>
</tr>
<tr>
<td>
<code>hostIPC</code></br>
<em>
bool
</em>
</td>
<td>
<em>(Optional)</em>
<p>Use the host&rsquo;s ipc namespace.
Optional: Default to false.</p>
</td>
</tr>
<tr>
<td>
<code>shareProcessNamespace</code></br>
<em>
bool
</em>
</td>
<td>
<em>(Optional)</em>
<p>Share a single process namespace between all of the containers in a pod.
When this is set containers will be able to view and signal processes from other containers
in the same pod, and the first process in each container will not be assigned PID 1.
HostPID and ShareProcessNamespace cannot both be set.
Optional: Default to false.</p>
</td>
</tr>
<tr>
<td>
<code>securityContext</code></br>
<em>
<a href="https://v1-18.docs.kubernetes.io/docs/reference/generated/kubernetes-api/v1.18/#podsecuritycontext-v1-core">
Kubernetes core/v1.PodSecurityContext
</a>
</em>
</td>
<td>
<em>(Optional)</em>
<p>SecurityContext holds pod-level security attributes and common container settings.
Optional: Defaults to empty.  See type description for default values of each field.</p>
</td>
</tr>
<tr>
<td>
<code>imagePullSecrets</code></br>
<em>
<a href="https://v1-18.docs.kubernetes.io/docs/reference/generated/kubernetes-api/v1.18/#localobjectreference-v1-core">
[]Kubernetes core/v1.LocalObjectReference
</a>
</em>
</td>
<td>
<em>(Optional)</em>
<p>ImagePullSecrets is an optional list of references to secrets in the same namespace to use for pulling any of the images used by this PodSpec.
If specified, these secrets will be passed to individual puller implementations for them to use. For example,
in the case of docker, only DockerConfig type secrets are honored.
More info: <a href="https://kubernetes.io/docs/concepts/containers/images#specifying-imagepullsecrets-on-a-pod">https://kubernetes.io/docs/concepts/containers/images#specifying-imagepullsecrets-on-a-pod</a></p>
</td>
</tr>
<tr>
<td>
<code>hostname</code></br>
<em>
string
</em>
</td>
<td>
<em>(Optional)</em>
<p>Specifies the hostname of the Pod
If not specified, the pod&rsquo;s hostname will be set to a system-defined value.</p>
</td>
</tr>
<tr>
<td>
<code>subdomain</code></br>
<em>
string
</em>
</td>
<td>
<em>(Optional)</em>
<p>If specified, the fully qualified Pod hostname will be &ldquo;<hostname>.<subdomain>.<pod namespace>.svc.<cluster domain>&rdquo;.
If not specified, the pod will not have a domainname at all.</p>
</td>
</tr>
<tr>
<td>
<code>affinity</code></br>
<em>
<a href="https://v1-18.docs.kubernetes.io/docs/reference/generated/kubernetes-api/v1.18/#affinity-v1-core">
Kubernetes core/v1.Affinity
</a>
</em>
</td>
<td>
<em>(Optional)</em>
<p>If specified, the pod&rsquo;s scheduling constraints</p>
</td>
</tr>
<tr>
<td>
<code>schedulerName</code></br>
<em>
string
</em>
</td>
<td>
<em>(Optional)</em>
<p>If specified, the pod will be dispatched by specified scheduler.
If not specified, the pod will be dispatched by default scheduler.</p>
</td>
</tr>
<tr>
<td>
<code>tolerations</code></br>
<em>
<a href="https://v1-18.docs.kubernetes.io/docs/reference/generated/kubernetes-api/v1.18/#toleration-v1-core">
[]Kubernetes core/v1.Toleration
</a>
</em>
</td>
<td>
<em>(Optional)</em>
<p>If specified, the pod&rsquo;s tolerations.</p>
</td>
</tr>
<tr>
<td>
<code>hostAliases</code></br>
<em>
<a href="https://v1-18.docs.kubernetes.io/docs/reference/generated/kubernetes-api/v1.18/#hostalias-v1-core">
[]Kubernetes core/v1.HostAlias
</a>
</em>
</td>
<td>
<em>(Optional)</em>
<p>HostAliases is an optional list of hosts and IPs that will be injected into the pod&rsquo;s hosts
file if specified. This is only valid for non-hostNetwork pods.</p>
</td>
</tr>
<tr>
<td>
<code>priorityClassName</code></br>
<em>
string
</em>
</td>
<td>
<em>(Optional)</em>
<p>If specified, indicates the pod&rsquo;s priority. &ldquo;system-node-critical&rdquo; and
&ldquo;system-cluster-critical&rdquo; are two special keywords which indicate the
highest priorities with the former being the highest priority. Any other
name must be defined by creating a PriorityClass object with that name.
If not specified, the pod priority will be default or zero if there is no
default.</p>
</td>
</tr>
<tr>
<td>
<code>priority</code></br>
<em>
int32
</em>
</td>
<td>
<em>(Optional)</em>
<p>The priority value. Various system components use this field to find the
priority of the pod. When Priority Admission Controller is enabled, it
prevents users from setting this field. The admission controller populates
this field from PriorityClassName.
The higher the value, the higher the priority.</p>
</td>
</tr>
<tr>
<td>
<code>dnsConfig</code></br>
<em>
<a href="https://v1-18.docs.kubernetes.io/docs/reference/generated/kubernetes-api/v1.18/#poddnsconfig-v1-core">
Kubernetes core/v1.PodDNSConfig
</a>
</em>
</td>
<td>
<em>(Optional)</em>
<p>Specifies the DNS parameters of a pod.
Parameters specified here will be merged to the generated DNS
configuration based on DNSPolicy.</p>
</td>
</tr>
<tr>
<td>
<code>readinessGates</code></br>
<em>
<a href="https://v1-18.docs.kubernetes.io/docs/reference/generated/kubernetes-api/v1.18/#podreadinessgate-v1-core">
[]Kubernetes core/v1.PodReadinessGate
</a>
</em>
</td>
<td>
<em>(Optional)</em>
<p>If specified, all readiness gates will be evaluated for pod readiness.
A pod is ready when all its containers are ready AND
all conditions specified in the readiness gates have status equal to &ldquo;True&rdquo;
More info: <a href="https://git.k8s.io/enhancements/keps/sig-network/0007-pod-ready%2B%2B.md">https://git.k8s.io/enhancements/keps/sig-network/0007-pod-ready%2B%2B.md</a></p>
</td>
</tr>
<tr>
<td>
<code>runtimeClassName</code></br>
<em>
string
</em>
</td>
<td>
<em>(Optional)</em>
<p>RuntimeClassName refers to a RuntimeClass object in the node.k8s.io group, which should be used
to run this pod.  If no RuntimeClass resource matches the named class, the pod will not be run.
If unset or empty, the &ldquo;legacy&rdquo; RuntimeClass will be used, which is an implicit class with an
empty definition that uses the default runtime handler.
More info: <a href="https://git.k8s.io/enhancements/keps/sig-node/runtime-class.md">https://git.k8s.io/enhancements/keps/sig-node/runtime-class.md</a>
This is a beta feature as of Kubernetes v1.14.</p>
</td>
</tr>
<tr>
<td>
<code>enableServiceLinks</code></br>
<em>
bool
</em>
</td>
<td>
<em>(Optional)</em>
<p>EnableServiceLinks indicates whether information about services should be injected into pod&rsquo;s
environment variables, matching the syntax of Docker links.
Optional: Defaults to true.</p>
</td>
</tr>
<tr>
<td>
<code>preemptionPolicy</code></br>
<em>
string
</em>
</td>
<td>
<em>(Optional)</em>
<p>PreemptionPolicy is the Policy for preempting pods with lower priority.
One of Never, PreemptLowerPriority.
Defaults to PreemptLowerPriority if unset.
This field is alpha-level and is only honored by servers that enable the NonPreemptingPriority feature.</p>
</td>
</tr>
<tr>
<td>
<code>overhead</code></br>
<em>
object
</em>
</td>
<td>
<em>(Optional)</em>
<p>Overhead represents the resource overhead associated with running a pod for a given RuntimeClass.
This field will be autopopulated at admission time by the RuntimeClass admission controller. If
the RuntimeClass admission controller is enabled, overhead must not be set in Pod create requests.
The RuntimeClass admission controller will reject Pod create requests which have the overhead already
set. If RuntimeClass is configured and selected in the PodSpec, Overhead will be set to the value
defined in the corresponding RuntimeClass, otherwise it will remain unset and treated as zero.
More info: <a href="https://git.k8s.io/enhancements/keps/sig-node/20190226-pod-overhead.md">https://git.k8s.io/enhancements/keps/sig-node/20190226-pod-overhead.md</a>
This field is alpha-level as of Kubernetes v1.16, and is only honored by servers that enable the PodOverhead feature.</p>
</td>
</tr>
<tr>
<td>
<code>topologySpreadConstraints</code></br>
<em>
<a href="https://v1-18.docs.kubernetes.io/docs/reference/generated/kubernetes-api/v1.18/#topologyspreadconstraint-v1-core">
[]Kubernetes core/v1.TopologySpreadConstraint
</a>
</em>
</td>
<td>
<em>(Optional)</em>
<p>TopologySpreadConstraints describes how a group of pods ought to spread across topology
domains. Scheduler will schedule pods in a way which abides by the constraints.
This field is alpha-level and is only honored by clusters that enables the EvenPodsSpread
feature.
All topologySpreadConstraints are ANDed.</p>
</td>
</tr>
</table>
</td>
</tr>
</tbody>
</table>
<hr/>
<p><em>
Generated with <code>gen-crd-api-reference-docs</code>
on git commit <code>3b35937</code>.
</em></p>

</div>



    
	
  

    
	
  

    
	
  
    
    
	
    

<div class="td-content" style="page-break-before: always">
    
	<h1 id="pg-ec7ce56a8d2096a6665a5e94777dd5d3">3 - Kubeflow Pipelines</h1>
    <div class="lead">Documentation for Kubeflow Pipelines.</div>
	
</div>



    
      
  
  
  
  

  
  

  
    
    
	
    

<div class="td-content" style="">
    
	<h1 id="pg-602ebf82a762d97e6ba22897f56cd58b">3.1 - v1</h1>
    <div class="lead">Kubeflow Pipelines v1 Documentation</div>
	
</div>



    
      
  
  
  
  

  
  

  
    
    
	
    

<div class="td-content" style="">
    
	<h1 id="pg-a12c176b136bf54932f124befc18e5f8">3.1.1 - Introduction</h1>
    <div class="lead">An introduction to the goals and main concepts of Kubeflow Pipelines</div>
	<div class="alert alert-primary" role="alert">
This Kubeflow component has <b>stable</b> status. See the
<a href="/docs/started/support/#application-status">Kubeflow versioning policies</a>.
</div>
<p>Kubeflow Pipelines is a platform for building and deploying portable,
scalable machine learning (ML) workflows based on Docker containers.</p>
<h2 id="quickstart">Quickstart</h2>
<p>Run your first pipeline by following the
<a href="/docs/components/pipelines/overview/quickstart">pipelines quickstart guide</a>.</p>
<h2 id="what-is-kubeflow-pipelines">What is Kubeflow Pipelines?</h2>
<p>The Kubeflow Pipelines platform consists of:</p>
<ul>
<li>A user interface (UI) for managing and tracking experiments, jobs, and runs.</li>
<li>An engine for scheduling multi-step ML workflows.</li>
<li>An SDK for defining and manipulating pipelines and components.</li>
<li>Notebooks for interacting with the system using the SDK.</li>
</ul>
<p>The following are the goals of Kubeflow Pipelines:</p>
<ul>
<li>End-to-end orchestration: enabling and simplifying the orchestration of
machine learning pipelines.</li>
<li>Easy experimentation: making it easy for you to try numerous ideas and
techniques and manage your various trials/experiments.</li>
<li>Easy re-use: enabling you to re-use components and pipelines to quickly
create end-to-end solutions without having to rebuild each time.</li>
</ul>
<p>Kubeflow Pipelines is available as a core component of Kubeflow or as a standalone installation.</p>
<ul>
<li><a href="/docs/started/getting-started/">Learn more about installing Kubeflow</a>.</li>
<li><a href="/docs/components/pipelines/installation/overview/">Learn more about installing Kubeflow Pipelines standalone</a>.</li>
</ul>
<p><i>Due to <a href="https://github.com/kubeflow/pipelines/issues/1700">kubeflow/pipelines#1700</a>, the container builder in Kubeflow Pipelines currently prepares credentials for Google Cloud Platform (GCP) only. As a result, the container builder supports only Google Container Registry. However, you can store the container images on other registries, provided you set up the credentials correctly to fetch the image.</i></p>
<h2 id="what-is-a-pipeline">What is a pipeline?</h2>
<p>A <em>pipeline</em> is a description of an ML workflow, including all of the components
in the workflow and how they combine in the form of a graph. (See the
screenshot below showing an example of a pipeline graph.) The pipeline
includes the definition of the inputs (parameters) required to run the pipeline
and the inputs and outputs of each component.</p>
<p>After developing your pipeline, you can upload and share it on the
Kubeflow Pipelines UI.</p>
<p>A <em>pipeline component</em> is a self-contained set of user code, packaged as a
<a href="https://docs.docker.com/get-started/">Docker image</a>, that
performs one step in the pipeline. For example, a component can be responsible
for data preprocessing, data transformation, model training, and so on.</p>
<p>See the conceptual guides to <a href="/docs/components/pipelines/concepts/pipeline/">pipelines</a>
and <a href="/docs/components/pipelines/concepts/component/">components</a>.</p>
<h2 id="example-of-a-pipeline">Example of a pipeline</h2>
<p>The screenshots and code below show the <code>xgboost-training-cm.py</code> pipeline, which
creates an XGBoost model using structured data in CSV format. You can see the
source code and other information about the pipeline on
<a href="https://github.com/kubeflow/pipelines/tree/sdk/release-1.8/samples/core/xgboost_training_cm">GitHub</a>.</p>
<h3 id="the-runtime-execution-graph-of-the-pipeline">The runtime execution graph of the pipeline</h3>
<p>The screenshot below shows the example pipeline&rsquo;s runtime execution graph in the
Kubeflow Pipelines UI:</p>
<p><img src="/docs/images/pipelines-xgboost-graph.png" 
alt="XGBoost results on the pipelines UI"
class="mt-3 mb-3 border border-info rounded"></p>
<h3 id="the-python-code-that-represents-the-pipeline">The Python code that represents the pipeline</h3>
<p>Below is an extract from the Python code that defines the
<code>xgboost-training-cm.py</code> pipeline. You can see the full code on
<a href="https://github.com/kubeflow/pipelines/tree/sdk/release-1.8/samples/core/xgboost_training_cm">GitHub</a>.</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-python" data-lang="python"><span class="line"><span class="cl"><span class="nd">@dsl</span><span class="o">.</span><span class="n">pipeline</span><span class="p">(</span>
</span></span><span class="line"><span class="cl">    <span class="n">name</span><span class="o">=</span><span class="s1">&#39;XGBoost Trainer&#39;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">    <span class="n">description</span><span class="o">=</span><span class="s1">&#39;A trainer that does end-to-end distributed training for XGBoost models.&#39;</span>
</span></span><span class="line"><span class="cl"><span class="p">)</span>
</span></span><span class="line"><span class="cl"><span class="k">def</span> <span class="nf">xgb_train_pipeline</span><span class="p">(</span>
</span></span><span class="line"><span class="cl">    <span class="n">output</span><span class="o">=</span><span class="s1">&#39;gs://your-gcs-bucket&#39;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">    <span class="n">project</span><span class="o">=</span><span class="s1">&#39;your-gcp-project&#39;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">    <span class="n">cluster_name</span><span class="o">=</span><span class="s1">&#39;xgb-</span><span class="si">%s</span><span class="s1">&#39;</span> <span class="o">%</span> <span class="n">dsl</span><span class="o">.</span><span class="n">RUN_ID_PLACEHOLDER</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">    <span class="n">region</span><span class="o">=</span><span class="s1">&#39;us-central1&#39;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">    <span class="n">train_data</span><span class="o">=</span><span class="s1">&#39;gs://ml-pipeline-playground/sfpd/train.csv&#39;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">    <span class="n">eval_data</span><span class="o">=</span><span class="s1">&#39;gs://ml-pipeline-playground/sfpd/eval.csv&#39;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">    <span class="n">schema</span><span class="o">=</span><span class="s1">&#39;gs://ml-pipeline-playground/sfpd/schema.json&#39;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">    <span class="n">target</span><span class="o">=</span><span class="s1">&#39;resolution&#39;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">    <span class="n">rounds</span><span class="o">=</span><span class="mi">200</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">    <span class="n">workers</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">    <span class="n">true_label</span><span class="o">=</span><span class="s1">&#39;ACTION&#39;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl"><span class="p">):</span>
</span></span><span class="line"><span class="cl">    <span class="n">output_template</span> <span class="o">=</span> <span class="nb">str</span><span class="p">(</span><span class="n">output</span><span class="p">)</span> <span class="o">+</span> <span class="s1">&#39;/&#39;</span> <span class="o">+</span> <span class="n">dsl</span><span class="o">.</span><span class="n">RUN_ID_PLACEHOLDER</span> <span class="o">+</span> <span class="s1">&#39;/data&#39;</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">    <span class="c1"># Current GCP pyspark/spark op do not provide outputs as return values, instead,</span>
</span></span><span class="line"><span class="cl">    <span class="c1"># we need to use strings to pass the uri around.</span>
</span></span><span class="line"><span class="cl">    <span class="n">analyze_output</span> <span class="o">=</span> <span class="n">output_template</span>
</span></span><span class="line"><span class="cl">    <span class="n">transform_output_train</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">output_template</span><span class="p">,</span> <span class="s1">&#39;train&#39;</span><span class="p">,</span> <span class="s1">&#39;part-*&#39;</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">    <span class="n">transform_output_eval</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">output_template</span><span class="p">,</span> <span class="s1">&#39;eval&#39;</span><span class="p">,</span> <span class="s1">&#39;part-*&#39;</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">    <span class="n">train_output</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">output_template</span><span class="p">,</span> <span class="s1">&#39;train_output&#39;</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">    <span class="n">predict_output</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">output_template</span><span class="p">,</span> <span class="s1">&#39;predict_output&#39;</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">    <span class="k">with</span> <span class="n">dsl</span><span class="o">.</span><span class="n">ExitHandler</span><span class="p">(</span><span class="n">exit_op</span><span class="o">=</span><span class="n">dataproc_delete_cluster_op</span><span class="p">(</span>
</span></span><span class="line"><span class="cl">        <span class="n">project_id</span><span class="o">=</span><span class="n">project</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">        <span class="n">region</span><span class="o">=</span><span class="n">region</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">        <span class="n">name</span><span class="o">=</span><span class="n">cluster_name</span>
</span></span><span class="line"><span class="cl">    <span class="p">)):</span>
</span></span><span class="line"><span class="cl">        <span class="n">_create_cluster_op</span> <span class="o">=</span> <span class="n">dataproc_create_cluster_op</span><span class="p">(</span>
</span></span><span class="line"><span class="cl">            <span class="n">project_id</span><span class="o">=</span><span class="n">project</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">            <span class="n">region</span><span class="o">=</span><span class="n">region</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">            <span class="n">name</span><span class="o">=</span><span class="n">cluster_name</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">            <span class="n">initialization_actions</span><span class="o">=</span><span class="p">[</span>
</span></span><span class="line"><span class="cl">              <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">_PYSRC_PREFIX</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">                           <span class="s1">&#39;initialization_actions.sh&#39;</span><span class="p">),</span>
</span></span><span class="line"><span class="cl">            <span class="p">],</span>
</span></span><span class="line"><span class="cl">            <span class="n">image_version</span><span class="o">=</span><span class="s1">&#39;1.2&#39;</span>
</span></span><span class="line"><span class="cl">        <span class="p">)</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">        <span class="n">_analyze_op</span> <span class="o">=</span> <span class="n">dataproc_analyze_op</span><span class="p">(</span>
</span></span><span class="line"><span class="cl">            <span class="n">project</span><span class="o">=</span><span class="n">project</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">            <span class="n">region</span><span class="o">=</span><span class="n">region</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">            <span class="n">cluster_name</span><span class="o">=</span><span class="n">cluster_name</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">            <span class="n">schema</span><span class="o">=</span><span class="n">schema</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">            <span class="n">train_data</span><span class="o">=</span><span class="n">train_data</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">            <span class="n">output</span><span class="o">=</span><span class="n">output_template</span>
</span></span><span class="line"><span class="cl">        <span class="p">)</span><span class="o">.</span><span class="n">after</span><span class="p">(</span><span class="n">_create_cluster_op</span><span class="p">)</span><span class="o">.</span><span class="n">set_display_name</span><span class="p">(</span><span class="s1">&#39;Analyzer&#39;</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">        <span class="n">_transform_op</span> <span class="o">=</span> <span class="n">dataproc_transform_op</span><span class="p">(</span>
</span></span><span class="line"><span class="cl">            <span class="n">project</span><span class="o">=</span><span class="n">project</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">            <span class="n">region</span><span class="o">=</span><span class="n">region</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">            <span class="n">cluster_name</span><span class="o">=</span><span class="n">cluster_name</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">            <span class="n">train_data</span><span class="o">=</span><span class="n">train_data</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">            <span class="n">eval_data</span><span class="o">=</span><span class="n">eval_data</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">            <span class="n">target</span><span class="o">=</span><span class="n">target</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">            <span class="n">analysis</span><span class="o">=</span><span class="n">analyze_output</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">            <span class="n">output</span><span class="o">=</span><span class="n">output_template</span>
</span></span><span class="line"><span class="cl">        <span class="p">)</span><span class="o">.</span><span class="n">after</span><span class="p">(</span><span class="n">_analyze_op</span><span class="p">)</span><span class="o">.</span><span class="n">set_display_name</span><span class="p">(</span><span class="s1">&#39;Transformer&#39;</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">        <span class="n">_train_op</span> <span class="o">=</span> <span class="n">dataproc_train_op</span><span class="p">(</span>
</span></span><span class="line"><span class="cl">            <span class="n">project</span><span class="o">=</span><span class="n">project</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">            <span class="n">region</span><span class="o">=</span><span class="n">region</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">            <span class="n">cluster_name</span><span class="o">=</span><span class="n">cluster_name</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">            <span class="n">train_data</span><span class="o">=</span><span class="n">transform_output_train</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">            <span class="n">eval_data</span><span class="o">=</span><span class="n">transform_output_eval</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">            <span class="n">target</span><span class="o">=</span><span class="n">target</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">            <span class="n">analysis</span><span class="o">=</span><span class="n">analyze_output</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">            <span class="n">workers</span><span class="o">=</span><span class="n">workers</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">            <span class="n">rounds</span><span class="o">=</span><span class="n">rounds</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">            <span class="n">output</span><span class="o">=</span><span class="n">train_output</span>
</span></span><span class="line"><span class="cl">        <span class="p">)</span><span class="o">.</span><span class="n">after</span><span class="p">(</span><span class="n">_transform_op</span><span class="p">)</span><span class="o">.</span><span class="n">set_display_name</span><span class="p">(</span><span class="s1">&#39;Trainer&#39;</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">        <span class="n">_predict_op</span> <span class="o">=</span> <span class="n">dataproc_predict_op</span><span class="p">(</span>
</span></span><span class="line"><span class="cl">            <span class="n">project</span><span class="o">=</span><span class="n">project</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">            <span class="n">region</span><span class="o">=</span><span class="n">region</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">            <span class="n">cluster_name</span><span class="o">=</span><span class="n">cluster_name</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">            <span class="n">data</span><span class="o">=</span><span class="n">transform_output_eval</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">            <span class="n">model</span><span class="o">=</span><span class="n">train_output</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">            <span class="n">target</span><span class="o">=</span><span class="n">target</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">            <span class="n">analysis</span><span class="o">=</span><span class="n">analyze_output</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">            <span class="n">output</span><span class="o">=</span><span class="n">predict_output</span>
</span></span><span class="line"><span class="cl">        <span class="p">)</span><span class="o">.</span><span class="n">after</span><span class="p">(</span><span class="n">_train_op</span><span class="p">)</span><span class="o">.</span><span class="n">set_display_name</span><span class="p">(</span><span class="s1">&#39;Predictor&#39;</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">        <span class="n">_cm_op</span> <span class="o">=</span> <span class="n">confusion_matrix_op</span><span class="p">(</span>
</span></span><span class="line"><span class="cl">            <span class="n">predictions</span><span class="o">=</span><span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">predict_output</span><span class="p">,</span> <span class="s1">&#39;part-*.csv&#39;</span><span class="p">),</span>
</span></span><span class="line"><span class="cl">            <span class="n">output_dir</span><span class="o">=</span><span class="n">output_template</span>
</span></span><span class="line"><span class="cl">        <span class="p">)</span><span class="o">.</span><span class="n">after</span><span class="p">(</span><span class="n">_predict_op</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">        <span class="n">_roc_op</span> <span class="o">=</span> <span class="n">roc_op</span><span class="p">(</span>
</span></span><span class="line"><span class="cl">            <span class="n">predictions_dir</span><span class="o">=</span><span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">predict_output</span><span class="p">,</span> <span class="s1">&#39;part-*.csv&#39;</span><span class="p">),</span>
</span></span><span class="line"><span class="cl">            <span class="n">true_class</span><span class="o">=</span><span class="n">true_label</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">            <span class="n">true_score_column</span><span class="o">=</span><span class="n">true_label</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">            <span class="n">output_dir</span><span class="o">=</span><span class="n">output_template</span>
</span></span><span class="line"><span class="cl">        <span class="p">)</span><span class="o">.</span><span class="n">after</span><span class="p">(</span><span class="n">_predict_op</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">    <span class="n">dsl</span><span class="o">.</span><span class="n">get_pipeline_conf</span><span class="p">()</span><span class="o">.</span><span class="n">add_op_transformer</span><span class="p">(</span>
</span></span><span class="line"><span class="cl">        <span class="n">gcp</span><span class="o">.</span><span class="n">use_gcp_secret</span><span class="p">(</span><span class="s1">&#39;user-gcp-sa&#39;</span><span class="p">))</span>
</span></span></code></pre></div><h3 id="pipeline-input-data-on-the-kubeflow-pipelines-ui">Pipeline input data on the Kubeflow Pipelines UI</h3>
<p>The partial screenshot below shows the Kubeflow Pipelines UI for kicking off a
run of the pipeline. The pipeline definition in your code determines which
parameters appear in the UI form. The pipeline definition can also set default
values for the parameters:</p>
<p><img src="/docs/images/pipelines-start-xgboost-run.png" 
alt="Starting the XGBoost run on the pipelines UI"
class="mt-3 mb-3 border border-info rounded"></p>
<h3 id="outputs-from-the-pipeline">Outputs from the pipeline</h3>
<p>The following screenshots show examples of the pipeline output visible on
the Kubeflow Pipelines UI.</p>
<p>Prediction results:</p>
<p><img src="/docs/images/predict.png" 
alt="Prediction output"
class="mt-3 mb-3 p-3 border border-info rounded"></p>
<p>Confusion matrix:</p>
<p><img src="/docs/images/cm.png" 
alt="Confusion matrix"
class="mt-3 mb-3 p-3 border border-info rounded"></p>
<p>Receiver operating characteristics (ROC) curve:</p>
<p><img src="/docs/images/roc.png" 
alt="ROC"
class="mt-3 mb-3 p-3 border border-info rounded"></p>
<h2 id="architectural-overview">Architectural overview</h2>
<p><img src="/docs/images/pipelines-architecture.png" 
alt="Pipelines architectural diagram"
class="mt-3 mb-3 p-3 border border-info rounded"></p>
<p>At a high level, the execution of a pipeline proceeds as follows:</p>
<ul>
<li>
<p><strong>Python SDK</strong>: You create components or specify a pipeline using the Kubeflow
Pipelines domain-specific language
(<a href="https://github.com/kubeflow/pipelines/tree/sdk/release-1.8/sdk/python/kfp/dsl">DSL</a>).</p>
</li>
<li>
<p><strong>DSL compiler</strong>: The
<a href="https://github.com/kubeflow/pipelines/tree/sdk/release-1.8/sdk/python/kfp/compiler">DSL compiler</a>
transforms your pipeline&rsquo;s Python code into a static configuration (YAML).</p>
</li>
<li>
<p><strong>Pipeline Service</strong>: You call the Pipeline Service to create a
pipeline run from the static configuration.</p>
</li>
<li>
<p><strong>Kubernetes resources</strong>: The Pipeline Service calls the Kubernetes API server to create
the necessary Kubernetes resources
(<a href="https://kubernetes.io/docs/concepts/extend-kubernetes/api-extension/custom-resources/">CRDs</a>)
to run the pipeline.</p>
</li>
<li>
<p><strong>Orchestration controllers</strong>: A set of orchestration controllers
execute the containers needed to complete the pipeline.
The containers execute within Kubernetes Pods on virtual machines.
An example controller is the
<strong><a href="https://github.com/argoproj/argo-workflows">Argo Workflow</a></strong> controller,
which orchestrates task-driven workflows.</p>
</li>
<li>
<p><strong>Artifact storage</strong>: The Pods store two kinds of data:</p>
<ul>
<li>
<p><strong>Metadata:</strong> Experiments, jobs, pipeline runs, and single scalar metrics.
Metric data is aggregated for the purpose of sorting and filtering.
Kubeflow Pipelines stores the metadata in a MySQL database.</p>
</li>
<li>
<p><strong>Artifacts:</strong> Pipeline packages, views, and large-scale metrics (time series).
Use large-scale metrics to debug a pipeline run or investigate an individual runs performance.
Kubeflow Pipelines stores the artifacts in an artifact store like
<a href="https://docs.minio.io/">Minio server</a> or
<a href="https://cloud.google.com/storage/docs/">Cloud Storage</a>.</p>
<p>The MySQL database and the Minio server are both backed by the Kubernetes
<a href="https://kubernetes.io/docs/concepts/storage/persistent-volumes/#types-of-persistent-volumes">PersistentVolume</a>
subsystem.</p>
</li>
</ul>
</li>
<li>
<p><strong>Persistence agent and ML metadata</strong>: The Pipeline Persistence Agent
watches the Kubernetes resources created by the Pipeline Service and
persists the state of these resources in the ML Metadata Service. The
Pipeline Persistence Agent records the set of containers that executed as
well as their inputs and outputs. The input/output consists of either
container parameters or data artifact URIs.</p>
</li>
<li>
<p><strong>Pipeline web server</strong>: The Pipeline web server gathers data from various
services to display relevant views: the list of pipelines currently running,
the history of pipeline execution, the list of data artifacts, debugging
information about individual pipeline runs, execution status about individual
pipeline runs.</p>
</li>
</ul>
<h2 id="next-steps">Next steps</h2>
<ul>
<li>Follow the
<a href="/docs/components/pipelines/overview/quickstart">pipelines quickstart guide</a> to
deploy Kubeflow and run a sample pipeline directly from the
Kubeflow Pipelines UI.</li>
<li>Build machine-learning pipelines with the <a href="/docs/components/pipelines/sdk/sdk-overview/">Kubeflow Pipelines
SDK</a>.</li>
<li>Follow the full guide to experimenting with
<a href="/docs/components/pipelines/tutorials/build-pipeline/">the Kubeflow Pipelines samples</a>.</li>
</ul>

</div>



    
	
  
    
    
	
    

<div class="td-content" style="page-break-before: always">
    
	<h1 id="pg-0777647aa48fbe0f824745e24490c04e">3.1.2 - Overview</h1>
    <div class="lead">Overview of Kubeflow Pipelines</div>
	
</div>



    
      
  
  
  
  

  
  

  
    
    
	
    

<div class="td-content" style="">
    
	<h1 id="pg-a148519f049b4d923d80c134d57a0da8">3.1.2.1 - Quickstart</h1>
    <div class="lead">Getting started with Kubeflow Pipelines</div>
	<div class="alert alert-primary" role="alert">
This Kubeflow component has <b>stable</b> status. See the
<a href="/docs/started/support/#application-status">Kubeflow versioning policies</a>.
</div>
<p>Use this guide if you want to get an introduction to the Kubeflow Piplines user interface (UI) and get a simple pipeline running quickly.</p>
<p>The goal with this quickstart guide is to shows how to use two of the samples that come with
the Kubeflow Pipelines installation and are visible on the Kubeflow Pipelines
UI. You can use this guide as an introduction to the
Kubeflow Pipelines UI.</p>
<h2 id="deploy-kubeflow-and-open-the-kubeflow-pipelines-ui">Deploy Kubeflow and open the Kubeflow Pipelines UI</h2>
<p>There are several options to <a href="/docs/components/pipelines/installation/overview/">deploy Kubeflow Pipelines</a>, follow the option that best suits your needs. If you are uncertain and just want to try out kubeflow pipelines it is recommended to start with the <a href="/docs/components/pipelines/installation/standalone-deployment/">standalone deployment</a>.</p>
<p>Once you have deployed Kubeflow Pipelines, make sure you can access the UI. The steps to access the UI vary based on the method you used to deploy Kubeflow Pipelines.</p>
<h2 id="run-a-basic-pipeline">Run a basic pipeline</h2>
<p>Kubeflow Pipelines offers a few samples that you can use to try out
Kubeflow Pipelines quickly. The steps below show you how to run a basic sample that
includes some Python operations, but doesn&rsquo;t include a machine learning (ML)
workload:</p>
<ol>
<li>
<p>Click the name of the sample, <strong>[Tutorial] Data passing in python components</strong>, on the pipelines UI:
<img src="/docs/images/click-pipeline-sample.png" 
alt="Pipelines UI"
class="mt-3 mb-3 border border-info rounded"></p>
</li>
<li>
<p>Click <strong>Create experiment</strong>:
<img src="/docs/images/pipelines-start-experiment.png" 
alt="Creating an experiment on the pipelines UI"
class="mt-3 mb-3 border border-info rounded"></p>
</li>
<li>
<p>Follow the prompts to create an <strong>experiment</strong> and then create a <strong>run</strong>.
The sample supplies default values for all the parameters you need. The
following screenshot assumes you&rsquo;ve already created an experiment named
<em>My experiment</em> and are now creating a run named <em>My first run</em>:
<img src="/docs/images/pipelines-start-run.png" 
alt="Creating a run on the pipelines UI"
class="mt-3 mb-3 border border-info rounded"></p>
</li>
<li>
<p>Click <strong>Start</strong> to run the pipeline.</p>
</li>
<li>
<p>Click the name of the run on the experiments dashboard:
<img src="/docs/images/pipelines-experiments-dashboard.png" 
alt="Experiments dashboard on the pipelines UI"
class="mt-3 mb-3 border border-info rounded"></p>
</li>
<li>
<p>Explore the graph and other aspects of your run by clicking on the
components of the graph and the other UI elements:
<img src="/docs/images/pipelines-basic-run.png" 
alt="Run results on the pipelines UI"
class="mt-3 mb-3 border border-info rounded"></p>
</li>
</ol>
<p>You can find the <a href="https://github.com/kubeflow/pipelines/tree/sdk/release-1.8/samples/tutorials/Data%20passing%20in%20python%20components">source code for the <strong>Data passing in python components</strong> tutorial</a> in the Kubeflow Pipelines repo.</p>
<h2 id="run-an-ml-pipeline">Run an ML pipeline</h2>
<p>This section shows you how to run the XGBoost sample available
from the pipelines UI. Unlike the basic sample described above, the
XGBoost sample does include ML components.</p>
<p>Follow these steps to run the sample:</p>
<ol>
<li>
<p>Click the name of the sample,
<strong>[Demo] XGBoost - Iterative model training</strong>, on the pipelines UI:
<img src="/docs/images/click-xgboost-sample.png" 
alt="XGBoost sample on the pipelines UI"
class="mt-3 mb-3 border border-info rounded"></p>
</li>
<li>
<p>Click <strong>Create experiment</strong>.</p>
</li>
<li>
<p>Follow the prompts to create an <strong>experiment</strong> and then create a <strong>run</strong>.</p>
<p>The following screenshot shows the run details:
<img src="/docs/images/pipelines-start-xgboost-run.png" 
alt="Starting the XGBoost run on the pipelines UI"
class="mt-3 mb-3 border border-info rounded"></p>
</li>
<li>
<p>Click <strong>Start</strong> to create the run.</p>
</li>
<li>
<p>Click the name of the run on the experiments dashboard.</p>
</li>
<li>
<p>Explore the graph and other aspects of your run by clicking on the
components of the graph and the other UI elements. The following screenshot
shows part of the graph when the pipeline has finished running:
<img src="/docs/images/pipelines-xgboost-graph.png" 
alt="XGBoost results on the pipelines UI"
class="mt-3 mb-3 border border-info rounded"></p>
</li>
</ol>
<p>You can find the <a href="https://github.com/kubeflow/pipelines/tree/sdk/release-1.8/samples/core/xgboost_training_cm">source code for the <strong>XGBoost - Iterative model training</strong> demo</a> in the Kubeflow Pipelines repo.</p>
<h2 id="next-steps">Next steps</h2>
<ul>
<li>Learn more about the
<a href="/docs/pipelines/overview/concepts/">important concepts</a> in Kubeflow
Pipelines.</li>
<li>This page showed you how to run some of the examples supplied in the Kubeflow
Pipelines UI. Next, you may want to run a pipeline from a notebook, or compile
and run a sample from the code. See the guide to experimenting with
<a href="/docs/components/pipelines/tutorials/build-pipeline/">the Kubeflow Pipelines samples</a>.</li>
<li>Build your own machine-learning pipelines with the <a href="/docs/components/pipelines/sdk/sdk-overview/">Kubeflow Pipelines
SDK</a>.</li>
</ul>

</div>



    
	
  
    
    
	
    

<div class="td-content" style="page-break-before: always">
    
	<h1 id="pg-7c0f89103ef95403b48dd2aa13f731a1">3.1.2.2 - Pipelines Interfaces</h1>
    <div class="lead">The ways you can interact with the Kubeflow Pipelines system</div>
	<p>This page introduces the interfaces that you can use to build and run
machine learning (ML) workflows with Kubeflow Pipelines.</p>
<h2 id="user-interface-ui">User interface (UI)</h2>
<p>You can access the Kubeflow Pipelines UI by clicking <strong>Pipeline Dashboard</strong> on
the Kubeflow UI. The Kubeflow Pipelines UI looks like this:
<img src="/docs/images/pipelines/v1/pipelines-ui.png" 
alt="Pipelines UI"
class="mt-3 mb-3 border border-info rounded"></p>
<p>From the Kubeflow Pipelines UI you can perform the following tasks:</p>
<ul>
<li>Run one or more of the preloaded samples to try out pipelines quickly.</li>
<li>Upload a pipeline as a compressed file. The pipeline can be one that you
have built (see how to <a href="/docs/components/pipelines/sdk/build-pipeline/">build a
pipeline</a>) or one
that someone has shared with you.</li>
<li>Create an <em>experiment</em> to group one or more of your pipeline runs.
See the <a href="/docs/components/pipelines/concepts/experiment/">definition of an
experiment</a>.</li>
<li>Create and start a <em>run</em> within the experiment. A run is a single execution
of a pipeline. See the <a href="/docs/components/pipelines/concepts/run/">definition of a
run</a>.</li>
<li>Explore the configuration, graph, and output of your pipeline run.</li>
<li>Compare the results of one or more runs within an experiment.</li>
<li>Schedule runs by creating a recurring run.</li>
</ul>
<p>See the <a href="/docs/components/pipelines/overview/quickstart/">quickstart guide</a> for more
information about accessing the Kubeflow Pipelines UI and running the samples.</p>
<p>When building a pipeline component, you can write out information for display
in the UI. See the guides to <a href="/docs/components/pipelines/sdk/pipelines-metrics/">exporting
metrics</a> and <a href="/docs/components/pipelines/sdk/output-viewer/">visualizing results in
the UI</a>.</p>
<h2 id="python-sdk">Python SDK</h2>
<p>The Kubeflow Pipelines SDK provides a set of Python packages that you can use to
specify and run your ML workflows.</p>
<p>See the <a href="/docs/components/pipelines/sdk/sdk-overview/">introduction to the Kubeflow Pipelines
SDK</a> for an overview of the ways you can
use the SDK to build pipeline components and pipelines.</p>
<h2 id="rest-api">REST API</h2>
<p>The Kubeflow Pipelines API is useful for continuous integration/deployment
systems, for example, where you want to incorporate your pipeline executions
into shell scripts or other systems.
For example, you may want to trigger a pipeline run when new data comes in.</p>
<p>See the <a href="/docs/components/pipelines/reference/api/kubeflow-pipeline-api-spec/">Kubeflow Pipelines API reference
documentation</a>.</p>

</div>



    
	
  
    
    
	
    

<div class="td-content" style="page-break-before: always">
    
	<h1 id="pg-d3cec6965952a60c6a492aeee96e221b">3.1.2.3 - Multi-user Isolation</h1>
    <div class="lead">How multi-user isolation works in Kubeflow Pipelines</div>
	<p>Multi-user isolation for Kubeflow Pipelines is part of Kubeflow&rsquo;s overall <a href="/docs/components/multi-tenancy/">multi-tenancy</a> feature.</p>


<div class="alert alert-info" role="alert">
<h4 class="alert-heading">Tip</h4>

    <ul>
<li>Kubeflow Pipelines multi-user isolation is only supported in <a href="/docs/components/pipelines/installation/overview/#full-kubeflow-deployment">&ldquo;full&rdquo; Kubeflow deployments</a>.</li>
<li>Refer to <a href="/docs/components/multi-tenancy/getting-started/">Getting Started with Multi-user isolation</a> for the common Kubeflow multi-user operations
like <a href="/docs/components/multi-tenancy/getting-started/#managing-contributors-through-the-kubeflow-ui">Managing contributors</a>.</li>
</ul>


</div>

<h2 id="how-are-resources-separated">How are resources separated?</h2>
<p>Kubeflow Pipelines separates resources using Kubernetes namespaces that are managed by Kubeflow&rsquo;s <a href="/docs/components/multi-tenancy/overview/#key-concepts">Profile resources</a>.
Other users cannot see resources in your Profile/Namespace without permission, because the Kubeflow Pipelines API server
rejects requests for namespaces that the current user is not authorized to access.</p>
<p>&ldquo;Experiments&rdquo; belong to namespaces directly, runs and recurring runs belong to their parent experiment&rsquo;s namespace.</p>
<p>&ldquo;Pipeline Runs&rdquo; are executed in user namespaces, so that users can leverage Kubernetes namespace isolation.
For example, they can configure different secrets for other services in different namespaces.</p>


<div class="alert alert-warning" role="alert">
<h4 class="alert-heading">Warning</h4>

    Kubeflow makes no hard security guarantees about Profile isolation.
<br>
User profiles have no additional isolation beyond what is provided by Kubernetes Namespaces.

</div>

<h2 id="when-using-the-ui">When using the UI</h2>
<p>When you visit the Kubeflow Pipelines UI from the Kubeflow Dashboard, it only shows &ldquo;experiments&rdquo;, &ldquo;runs&rdquo;, and &ldquo;recurring runs&rdquo; in your chosen namespace.
Similarly, when you create resources from the UI, they also belong to the namespace you have chosen.</p>


<div class="alert alert-warning" role="alert">
<h4 class="alert-heading">Warning</h4>

    Pipeline definitions are not isolated right now, and are shared across all namespaces, see <a href="#current-limitations">Current Limitations</a> for more details.

</div>

<h2 id="when-using-the-sdk">When using the SDK</h2>
<p>How to connect Pipelines SDK to Kubeflow Pipelines will depend on <strong>what kind</strong> of Kubeflow deployment you have, and <strong>from where you are running your code</strong>.</p>
<ul>
<li><a href="/docs/components/pipelines/sdk/connect-api/#full-kubeflow-subfrom-inside-clustersub">Full Kubeflow (from inside cluster)</a></li>
<li><a href="/docs/components/pipelines/sdk/connect-api/#full-kubeflow-subfrom-outside-clustersub">Full Kubeflow (from outside cluster)</a></li>
<li><a href="/docs/components/pipelines/sdk/connect-api/#standalone-kubeflow-pipelines-subfrom-inside-clustersub">Standalone Kubeflow Pipelines (from inside cluster)</a></li>
<li><a href="/docs/components/pipelines/sdk/connect-api/#standalone-kubeflow-pipelines-subfrom-outside-clustersub">Standalone Kubeflow Pipelines (from outside cluster)</a></li>
</ul>
<p>The following Python code will create an experiment (and associated run) from a Pod inside a full Kubeflow cluster.</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-python" data-lang="python"><span class="line"><span class="cl"><span class="kn">import</span> <span class="nn">kfp</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="c1"># the namespace in which you deployed Kubeflow Pipelines</span>
</span></span><span class="line"><span class="cl"><span class="n">kubeflow_namespace</span> <span class="o">=</span> <span class="s2">&#34;kubeflow&#34;</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="c1"># the namespace of your pipelines user (where the pipeline will be executed)</span>
</span></span><span class="line"><span class="cl"><span class="n">user_namespace</span> <span class="o">=</span> <span class="s2">&#34;jane-doe&#34;</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="c1"># the KF_PIPELINES_SA_TOKEN_PATH environment variable is used when no `path` is set</span>
</span></span><span class="line"><span class="cl"><span class="c1"># the default KF_PIPELINES_SA_TOKEN_PATH is /var/run/secrets/kubeflow/pipelines/token</span>
</span></span><span class="line"><span class="cl"><span class="n">credentials</span> <span class="o">=</span> <span class="n">kfp</span><span class="o">.</span><span class="n">auth</span><span class="o">.</span><span class="n">ServiceAccountTokenVolumeCredentials</span><span class="p">(</span><span class="n">path</span><span class="o">=</span><span class="kc">None</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="c1"># create a client</span>
</span></span><span class="line"><span class="cl"><span class="n">client</span> <span class="o">=</span> <span class="n">kfp</span><span class="o">.</span><span class="n">Client</span><span class="p">(</span><span class="n">host</span><span class="o">=</span><span class="sa">f</span><span class="s2">&#34;http://ml-pipeline-ui.</span><span class="si">{</span><span class="n">kubeflow_namespace</span><span class="si">}</span><span class="s2">&#34;</span><span class="p">,</span> <span class="n">credentials</span><span class="o">=</span><span class="n">credentials</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="c1"># create an experiment</span>
</span></span><span class="line"><span class="cl"><span class="n">client</span><span class="o">.</span><span class="n">create_experiment</span><span class="p">(</span><span class="n">name</span><span class="o">=</span><span class="s2">&#34;&lt;YOUR_EXPERIMENT_ID&gt;&#34;</span><span class="p">,</span> <span class="n">namespace</span><span class="o">=</span><span class="n">user_namespace</span><span class="p">)</span>
</span></span><span class="line"><span class="cl"><span class="nb">print</span><span class="p">(</span><span class="n">client</span><span class="o">.</span><span class="n">list_experiments</span><span class="p">(</span><span class="n">namespace</span><span class="o">=</span><span class="n">user_namespace</span><span class="p">))</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="c1"># create a pipeline run</span>
</span></span><span class="line"><span class="cl"><span class="n">client</span><span class="o">.</span><span class="n">run_pipeline</span><span class="p">(</span>
</span></span><span class="line"><span class="cl">    <span class="n">experiment_id</span><span class="o">=</span><span class="s2">&#34;&lt;YOUR_EXPERIMENT_ID&gt;&#34;</span><span class="p">,</span>  <span class="c1"># the experiment determines the namespace</span>
</span></span><span class="line"><span class="cl">    <span class="n">job_name</span><span class="o">=</span><span class="s2">&#34;&lt;YOUR_RUN_NAME&gt;&#34;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">    <span class="n">pipeline_id</span><span class="o">=</span><span class="s2">&#34;&lt;YOUR_PIPELINE_ID&gt;&#34;</span>  <span class="c1"># the pipeline definition to run</span>
</span></span><span class="line"><span class="cl"><span class="p">)</span>
</span></span><span class="line"><span class="cl"><span class="nb">print</span><span class="p">(</span><span class="n">client</span><span class="o">.</span><span class="n">list_runs</span><span class="p">(</span><span class="n">experiment_id</span><span class="o">=</span><span class="s2">&#34;&lt;YOUR_EXPERIMENT_ID&gt;&#34;</span><span class="p">))</span>
</span></span><span class="line"><span class="cl"><span class="nb">print</span><span class="p">(</span><span class="n">client</span><span class="o">.</span><span class="n">list_runs</span><span class="p">(</span><span class="n">namespace</span><span class="o">=</span><span class="n">user_namespace</span><span class="p">))</span>
</span></span></code></pre></div>

<div class="alert alert-info" role="alert">
<h4 class="alert-heading">Tip</h4>

    <ul>
<li>To set a default namespace for Pipelines SDK commands, use the <a href="https://kubeflow-pipelines.readthedocs.io/en/stable/source/kfp.client.html#kfp.Client.set_user_namespace"><code>kfp.Client().set_user_namespace()</code></a> method,
this method stores your user namespace in a configuration file at <code>$HOME/.config/kfp/context.json</code>.</li>
<li>Detailed documentation for <code>kfp.Client()</code> can be found in the <a href="https://kubeflow-pipelines.readthedocs.io/en/stable/source/kfp.client.html">Kubeflow Pipelines SDK Reference</a>.</li>
</ul>


</div>

<h2 id="when-using-the-rest-api">When using the REST API</h2>
<p>When calling the <a href="/docs/components/pipelines/reference/api/kubeflow-pipeline-api-spec/">Kubeflow Pipelines REST API</a>, a namespace argument is required for experiment APIs.
<br>
The namespace is specified by a &ldquo;resource reference&rdquo; with <code>type</code> of <code>NAMESPACE</code> and <code>key.id</code> equal to the namespace name.</p>
<p>The following code uses the <a href="https://kubeflow-pipelines.readthedocs.io/en/stable/source/kfp.server_api.html">generated python API client</a> to create an experiment and pipeline run.</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-python" data-lang="python"><span class="line"><span class="cl"><span class="kn">import</span> <span class="nn">kfp</span>
</span></span><span class="line"><span class="cl"><span class="kn">from</span> <span class="nn">kfp_server_api</span> <span class="kn">import</span> <span class="o">*</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="c1"># the namespace in which you deployed Kubeflow Pipelines</span>
</span></span><span class="line"><span class="cl"><span class="n">kubeflow_namespace</span> <span class="o">=</span> <span class="s2">&#34;kubeflow&#34;</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="c1"># the namespace of your pipelines user (where the pipeline will be executed)</span>
</span></span><span class="line"><span class="cl"><span class="n">user_namespace</span> <span class="o">=</span> <span class="s2">&#34;jane-doe&#34;</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="c1"># the KF_PIPELINES_SA_TOKEN_PATH environment variable is used when no `path` is set</span>
</span></span><span class="line"><span class="cl"><span class="c1"># the default KF_PIPELINES_SA_TOKEN_PATH is /var/run/secrets/kubeflow/pipelines/token</span>
</span></span><span class="line"><span class="cl"><span class="n">credentials</span> <span class="o">=</span> <span class="n">kfp</span><span class="o">.</span><span class="n">auth</span><span class="o">.</span><span class="n">ServiceAccountTokenVolumeCredentials</span><span class="p">(</span><span class="n">path</span><span class="o">=</span><span class="kc">None</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="c1"># create a client</span>
</span></span><span class="line"><span class="cl"><span class="n">client</span> <span class="o">=</span> <span class="n">kfp</span><span class="o">.</span><span class="n">Client</span><span class="p">(</span><span class="n">host</span><span class="o">=</span><span class="sa">f</span><span class="s2">&#34;http://ml-pipeline-ui.</span><span class="si">{</span><span class="n">kubeflow_namespace</span><span class="si">}</span><span class="s2">&#34;</span><span class="p">,</span> <span class="n">credentials</span><span class="o">=</span><span class="n">credentials</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="c1"># create an experiment</span>
</span></span><span class="line"><span class="cl"><span class="n">experiment</span><span class="p">:</span> <span class="n">ApiExperiment</span> <span class="o">=</span> <span class="n">client</span><span class="o">.</span><span class="n">_experiment_api</span><span class="o">.</span><span class="n">create_experiment</span><span class="p">(</span>
</span></span><span class="line"><span class="cl">    <span class="n">body</span><span class="o">=</span><span class="n">ApiExperiment</span><span class="p">(</span>
</span></span><span class="line"><span class="cl">        <span class="n">name</span><span class="o">=</span><span class="s2">&#34;&lt;YOUR_EXPERIMENT_ID&gt;&#34;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">        <span class="n">resource_references</span><span class="o">=</span><span class="p">[</span>
</span></span><span class="line"><span class="cl">            <span class="n">ApiResourceReference</span><span class="p">(</span>
</span></span><span class="line"><span class="cl">                <span class="n">key</span><span class="o">=</span><span class="n">ApiResourceKey</span><span class="p">(</span>
</span></span><span class="line"><span class="cl">                    <span class="nb">id</span><span class="o">=</span><span class="n">user_namespace</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">                    <span class="nb">type</span><span class="o">=</span><span class="n">ApiResourceType</span><span class="o">.</span><span class="n">NAMESPACE</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">                <span class="p">),</span>
</span></span><span class="line"><span class="cl">                <span class="n">relationship</span><span class="o">=</span><span class="n">ApiRelationship</span><span class="o">.</span><span class="n">OWNER</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">            <span class="p">)</span>
</span></span><span class="line"><span class="cl">        <span class="p">],</span>
</span></span><span class="line"><span class="cl">    <span class="p">)</span>
</span></span><span class="line"><span class="cl"><span class="p">)</span>
</span></span><span class="line"><span class="cl"><span class="nb">print</span><span class="p">(</span><span class="s2">&#34;-------- BEGIN: EXPERIMENT --------&#34;</span><span class="p">)</span>
</span></span><span class="line"><span class="cl"><span class="nb">print</span><span class="p">(</span><span class="n">experiment</span><span class="p">)</span>
</span></span><span class="line"><span class="cl"><span class="nb">print</span><span class="p">(</span><span class="s2">&#34;-------- END: EXPERIMENT ----------&#34;</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="c1"># get the experiment by name (only necessary if you comment out the `create_experiment()` call)</span>
</span></span><span class="line"><span class="cl"><span class="c1"># experiment: ApiExperiment = client.get_experiment(</span>
</span></span><span class="line"><span class="cl"><span class="c1">#     experiment_name=&#34;&lt;YOUR_EXPERIMENT_ID&gt;&#34;,</span>
</span></span><span class="line"><span class="cl"><span class="c1">#     namespace=user_namespace</span>
</span></span><span class="line"><span class="cl"><span class="c1"># )</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="c1"># create a pipeline run</span>
</span></span><span class="line"><span class="cl"><span class="n">run</span><span class="p">:</span> <span class="n">ApiRunDetail</span> <span class="o">=</span> <span class="n">client</span><span class="o">.</span><span class="n">_run_api</span><span class="o">.</span><span class="n">create_run</span><span class="p">(</span>
</span></span><span class="line"><span class="cl">    <span class="n">body</span><span class="o">=</span><span class="n">ApiRun</span><span class="p">(</span>
</span></span><span class="line"><span class="cl">        <span class="n">name</span><span class="o">=</span><span class="s2">&#34;&lt;YOUR_RUN_NAME&gt;&#34;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">        <span class="n">pipeline_spec</span><span class="o">=</span><span class="n">ApiPipelineSpec</span><span class="p">(</span>
</span></span><span class="line"><span class="cl">            <span class="c1"># replace &lt;YOUR_PIPELINE_ID&gt; with the UID of a pipeline definition you have previously uploaded</span>
</span></span><span class="line"><span class="cl">            <span class="n">pipeline_id</span><span class="o">=</span><span class="s2">&#34;&lt;YOUR_PIPELINE_ID&gt;&#34;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">        <span class="p">),</span>
</span></span><span class="line"><span class="cl">        <span class="n">resource_references</span><span class="o">=</span><span class="p">[</span><span class="n">ApiResourceReference</span><span class="p">(</span>
</span></span><span class="line"><span class="cl">            <span class="n">key</span><span class="o">=</span><span class="n">ApiResourceKey</span><span class="p">(</span>
</span></span><span class="line"><span class="cl">                <span class="nb">id</span><span class="o">=</span><span class="n">experiment</span><span class="o">.</span><span class="n">id</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">                <span class="nb">type</span><span class="o">=</span><span class="n">ApiResourceType</span><span class="o">.</span><span class="n">EXPERIMENT</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">            <span class="p">),</span>
</span></span><span class="line"><span class="cl">            <span class="n">relationship</span><span class="o">=</span><span class="n">ApiRelationship</span><span class="o">.</span><span class="n">OWNER</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">        <span class="p">)</span>
</span></span><span class="line"><span class="cl">        <span class="p">],</span>
</span></span><span class="line"><span class="cl">    <span class="p">)</span>
</span></span><span class="line"><span class="cl"><span class="p">)</span>
</span></span><span class="line"><span class="cl"><span class="nb">print</span><span class="p">(</span><span class="s2">&#34;-------- BEGIN: RUN --------&#34;</span><span class="p">)</span>
</span></span><span class="line"><span class="cl"><span class="nb">print</span><span class="p">(</span><span class="n">run</span><span class="p">)</span>
</span></span><span class="line"><span class="cl"><span class="nb">print</span><span class="p">(</span><span class="s2">&#34;-------- END: RUN ----------&#34;</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="c1"># view the pipeline run</span>
</span></span><span class="line"><span class="cl"><span class="n">runs</span><span class="p">:</span> <span class="n">ApiListRunsResponse</span> <span class="o">=</span> <span class="n">client</span><span class="o">.</span><span class="n">_run_api</span><span class="o">.</span><span class="n">list_runs</span><span class="p">(</span>
</span></span><span class="line"><span class="cl">    <span class="n">resource_reference_key_type</span><span class="o">=</span><span class="n">ApiResourceType</span><span class="o">.</span><span class="n">EXPERIMENT</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">    <span class="n">resource_reference_key_id</span><span class="o">=</span><span class="n">experiment</span><span class="o">.</span><span class="n">id</span><span class="p">,</span>
</span></span><span class="line"><span class="cl"><span class="p">)</span>
</span></span><span class="line"><span class="cl"><span class="nb">print</span><span class="p">(</span><span class="s2">&#34;-------- BEGIN: RUNS --------&#34;</span><span class="p">)</span>
</span></span><span class="line"><span class="cl"><span class="nb">print</span><span class="p">(</span><span class="n">runs</span><span class="p">)</span>
</span></span><span class="line"><span class="cl"><span class="nb">print</span><span class="p">(</span><span class="s2">&#34;-------- END: RUNS ----------&#34;</span><span class="p">)</span>
</span></span></code></pre></div><h2 id="current-limitations">Current limitations</h2>
<h3 id="resources-without-isolation">Resources without isolation</h3>
<p>The following resources do not currently support isolation and are shared without access control:</p>
<ul>
<li>Pipelines (Pipeline definitions).</li>
<li>Artifacts, Executions, and other metadata entities in <a href="https://www.tensorflow.org/tfx/guide/mlmd">Machine Learning Metadata (MLMD)</a>.</li>
<li><a href="https://min.io/">Minio artifact storage</a> which contains pipeline runs&rsquo; input/output artifacts.</li>
</ul>

</div>



    
	
  
    
    
	
    

<div class="td-content" style="page-break-before: always">
    
	<h1 id="pg-0c82dc6780f69fb583c5e950c80d8417">3.1.2.4 - Caching</h1>
    <div class="lead">Getting started with Kubeflow Pipelines step caching</div>
	<div class="alert alert-warning" role="alert">
  <h4 class="alert-heading">Alpha</h4>
  This Kubeflow component has <b>alpha</b> status with limited support. See the
  <a href="/docs/started/support/#application-status">Kubeflow versioning policies</a>.
  The Kubeflow team is interested in your   
  <a href="https://github.com/kubeflow/pipelines/issues">feedback</a></h4> 
  about the usability of the feature.
</div>
<p>Starting from Kubeflow Pipelines 0.4, Kubeflow Pipelines supports step caching capabilities in both standalone deployment and AI Platform Pipelines.</p>
<h2 id="before-you-start">Before you start</h2>
<p>This guide tells you the basic concepts of Kubeflow Pipelines step caching and how to use it.
This guide assumes that you already have Kubeflow Pipelines installed or want to use options in the <a href="/docs/components/pipelines/installation/">Kubeflow Pipelines deployment guide</a> to deploy Kubeflow Pipelines.</p>
<h2 id="what-is-step-caching">What is step caching?</h2>
<p>Kubeflow Pipelines caching provides step-level output caching.
And caching is enabled by default for all pipelines submitted through the KFP backend and UI.
The exception is pipelines authored using TFX SDK which has its own caching mechanism.
The cache key calculation is based on the component (base image, command-line, code), arguments passed to the component (values or artifacts) and any additional customizations.
If the component is exactly the same and the arguments are exactly the same as in some previous execution, then the task can be skipped and the outputs of the old step can be used.
The cache reuse behavior can be controlled and the pipeline author can specify the maximum staleness of the cached data considered for reuse.
With caching enabled, the system can skip a step that has already been executed which saves time and money.</p>
<h2 id="disablingenabling-caching">Disabling/enabling caching</h2>
<p>Cache is enabled by default after Kubeflow Pipelines 0.4.
These are instructions on disabling and enabling cache service:</p>
<h3 id="configure-access-to-your-kubeflow-cluster">Configure access to your Kubeflow cluster</h3>
<p>Use the following instructions to configure <code>kubectl</code> with access to your
Kubeflow cluster.</p>
<ol>
<li>
<p>To check if you have <code>kubectl</code> installed, run the following command:</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash"><span class="line"><span class="cl">which kubectl
</span></span></code></pre></div><p>The response should be something like this:</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash"><span class="line"><span class="cl">/usr/bin/kubectl
</span></span></code></pre></div><p>If you do not have <code>kubectl</code> installed, follow the instructions in the
guide to <a href="https://kubernetes.io/docs/tasks/tools/install-kubectl/">installing and setting up kubectl</a>.</p>
</li>
<li>
<p>Follow the <a href="https://kubernetes.io/docs/reference/access-authn-authz/authentication/">guide to configuring access to Kubernetes
clusters</a>.</p>
</li>
</ol>
<h3 id="disabling-caching-in-your-kubeflow-pipelines-deployment">Disabling caching in your Kubeflow Pipelines deployment:</h3>
<ol>
<li>
<p>Make sure <code>mutatingwebhookconfiguration</code> exists in your cluster:</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-fallback" data-lang="fallback"><span class="line"><span class="cl">export NAMESPACE=&lt;Namespace where KFP is installed&gt;
</span></span><span class="line"><span class="cl">kubectl get mutatingwebhookconfiguration cache-webhook-${NAMESPACE}
</span></span></code></pre></div></li>
<li>
<p>Change <code>mutatingwebhookconfiguration</code> rules:</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-fallback" data-lang="fallback"><span class="line"><span class="cl">kubectl patch mutatingwebhookconfiguration cache-webhook-${NAMESPACE} --type=&#39;json&#39; -p=&#39;[{&#34;op&#34;:&#34;replace&#34;, &#34;path&#34;: &#34;/webhooks/0/rules/0/operations/0&#34;, &#34;value&#34;: &#34;DELETE&#34;}]&#39;
</span></span></code></pre></div></li>
</ol>
<h3 id="enabling-caching">Enabling caching</h3>
<ol>
<li>
<p>Make sure <code>mutatingwebhookconfiguration</code> exists in your cluster:</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-fallback" data-lang="fallback"><span class="line"><span class="cl">export NAMESPACE=&lt;Namespace where KFP is installed&gt;
</span></span><span class="line"><span class="cl">kubectl get mutatingwebhookconfiguration cache-webhook-${NAMESPACE}
</span></span></code></pre></div></li>
<li>
<p>Change back <code>mutatingwebhookconfiguration</code> rules:</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-fallback" data-lang="fallback"><span class="line"><span class="cl">kubectl patch mutatingwebhookconfiguration cache-webhook-${NAMESPACE} --type=&#39;json&#39; -p=&#39;[{&#34;op&#34;:&#34;replace&#34;, &#34;path&#34;: &#34;/webhooks/0/rules/0/operations/0&#34;, &#34;value&#34;: &#34;CREATE&#34;}]&#39;
</span></span></code></pre></div></li>
</ol>
<h2 id="managing-caching-staleness">Managing caching staleness</h2>
<p>The cache is enabled by default and if you ever executed same component with the same arguments, any new execution of the component will be skipped and the outputs will be taken from the cache.
For some scenarios, the cached output data of some components might become too stale for use after some time.
To control the maximum staleness of the reused cached data, you can set the step&rsquo;s <code>max_cache_staleness</code> parameter.
The <code>max_cache_staleness</code> is in <a href="https://www.ietf.org/rfc/rfc3339.txt">RFC3339 Duration</a> format (so 30 days = &ldquo;P30D&rdquo;).
By default the <code>max_cache_staleness</code> is set to infinity so any old cached data will be reused.</p>
<p>Set <code>max_cache_staleness</code> to 30 days for a step:</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-fallback" data-lang="fallback"><span class="line"><span class="cl">def some_pipeline():
</span></span><span class="line"><span class="cl">      # task is a target step in a pipeline
</span></span><span class="line"><span class="cl">      task = some_op()
</span></span><span class="line"><span class="cl">      task.execution_options.caching_strategy.max_cache_staleness = &#34;P30D&#34;
</span></span></code></pre></div><p>Ideally, the component code should be pure and deterministic in the sense that it produces same outputs given same inputs.
If your component is not deterministic (for example, it returns a different random number on every invocation) you might want to disable caching for the tasks created from this component by setting <code>max_cache_staleness</code> to 0:</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-fallback" data-lang="fallback"><span class="line"><span class="cl">def some_pipeline():
</span></span><span class="line"><span class="cl">      # task is a target step in a pipeline
</span></span><span class="line"><span class="cl">      task_never_use_cache = some_op()
</span></span><span class="line"><span class="cl">      task_never_use_cache.execution_options.caching_strategy.max_cache_staleness = &#34;P0D&#34;
</span></span></code></pre></div><p>A better solution would be to make the component deterministic. If the component uses random number generation, you can expose the RNG seed as a component input. If the component fetches some changing data you can add a timestamp or date input.</p>

</div>



    
	
  
    
    
	
    

<div class="td-content" style="page-break-before: always">
    
	<h1 id="pg-c7e546e96cee0ce3e347c65d7ea674fc">3.1.2.5 - Caching v2</h1>
    <div class="lead">Getting started with Kubeflow Pipelines caching v2</div>
	<div class="alert alert-warning" role="alert">
  <h4 class="alert-heading">Beta</h4>
  This Kubeflow component has <b>beta</b> status. See the
  <a href="/docs/started/support/#application-status">Kubeflow versioning policies</a>.
  The Kubeflow team is interested in your   
  <a href="https://github.com/kubeflow/pipelines/issues">feedback</a></h4> 
  about the usability of the feature.
</div>
<p>Starting from <a href="https://www.kubeflow.org/docs/components/pipelines/sdk-v2/">Kubeflow Pipelines SDK v2</a> and Kubeflow Pipelines 1.7.0, Kubeflow Pipelines supports step caching capabilities in both <a href="https://www.kubeflow.org/docs/components/pipelines/installation/standalone-deployment/">standalone deployment</a> and <a href="https://cloud.google.com/ai-platform/pipelines/docs">AI Platform Pipelines</a>.</p>
<h2 id="before-you-start">Before you start</h2>
<p>This guide tells you the basic concepts of Kubeflow Pipelines caching and how to use it.
This guide assumes that you already have Kubeflow Pipelines installed or want to use standalone or AI Platform Pipelines options in the <a href="/docs/components/pipelines/installation/">Kubeflow Pipelines deployment
guide</a> to deploy Kubeflow Pipelines.</p>
<h2 id="what-is-step-caching">What is step caching?</h2>
<p>Kubeflow Pipelines caching provides step-level output caching, a process that helps to reduce costs by skipping computations that were completed in a previous pipeline run.
Caching is enabled by default for all tasks of pipelines built with <a href="https://www.kubeflow.org/docs/components/pipelines/sdk-v2/">Kubeflow Pipelines SDK v2</a> using <code>kfp.dsl.PipelineExecutionMode.V2_COMPATIBLE</code> mode.
When Kubeflow Pipeline runs a pipeline, it checks to see whether
an execution exists in Kubeflow Pipeline with the interface of each pipeline task.
The task&rsquo;s interface is defined as the combination of the pipeline task specification (base image, command, args), the pipeline task&rsquo;s inputs (the name and id of artifacts, the name and value of parameters),
and the pipeline task&rsquo;s outputs specification (artifacts and parameters).
Note: If the producer task which generates an artifact is not cached, then the producer task will generate a new artifact with different ID, and downstream task which uses the artifact generated by the producer task won&rsquo;t hit cache.</p>
<p>If there is a matching execution in Kubeflow Pipelines, the outputs of that execution are used, and the task is skipped. An example of cache being hit:</p>
<p><img src="/docs/images/pipelines/v1/v2-compatible/cacheicon.png" 
alt="Cache is hit on KFPv2 pipelines"
class="mt-3 mb-3 border border-info rounded"></p>
<h2 id="disablingenabling-caching">Disabling/enabling caching</h2>
<p>Cache is enabled by default with <a href="https://www.kubeflow.org/docs/components/pipelines/sdk-v2/">Kubeflow Pipelines SDK v2</a> using <code>kfp.dsl.PipelineExecutionMode.V2_COMPATIBLE</code> mode.</p>
<p>You can turn off execution caching for pipeline runs that are created using Python. When you run a pipeline using <a href="https://kubeflow-pipelines.readthedocs.io/en/latest/source/kfp.client.html#kfp.Client.create_run_from_pipeline_func">create_run_from_pipeline_func</a> or <a href="https://kubeflow-pipelines.readthedocs.io/en/latest/source/kfp.client.html#kfp.Client.create_run_from_pipeline_package">create_run_from_pipeline_package</a> or <a href="https://kubeflow-pipelines.readthedocs.io/en/latest/source/kfp.client.html#kfp.Client.run_pipeline,">run_pipeline</a> you can use the <code>enable_caching</code> argument to specify that this pipeline run does not use caching.</p>

</div>



    
	
  
    
    
	
    

<div class="td-content" style="page-break-before: always">
    
	<h1 id="pg-4c9d3fedae9983188fafd2b5356887f7">3.1.2.6 - Pipeline Root</h1>
    <div class="lead">Getting started with Kubeflow Pipelines pipeline root</div>
	<div class="alert alert-warning" role="alert">
  <h4 class="alert-heading">Beta</h4>
  This Kubeflow component has <b>beta</b> status. See the
  <a href="/docs/started/support/#application-status">Kubeflow versioning policies</a>.
  The Kubeflow team is interested in your   
  <a href="https://github.com/kubeflow/pipelines/issues">feedback</a></h4> 
  about the usability of the feature.
</div>
<p>Starting from <a href="https://www.kubeflow.org/docs/components/pipelines/sdk-v2/">Kubeflow Pipelines SDK v2</a> and Kubeflow Pipelines 1.7.0, Kubeflow Pipelines supports a new intermediate artifact repository feature: pipeline root in both <a href="https://www.kubeflow.org/docs/components/pipelines/installation/standalone-deployment/">standalone deployment</a> and <a href="https://cloud.google.com/ai-platform/pipelines/docs">AI Platform Pipelines</a>.</p>
<h2 id="before-you-start">Before you start</h2>
<p>This guide tells you the basic concepts of Kubeflow Pipelines pipeline root and how to use it.
This guide assumes that you already have Kubeflow Pipelines installed, or want to use standalone or AI Platform Pipelines options in the <a href="/docs/components/pipelines/installation/">Kubeflow Pipelines deployment
guide</a> to deploy Kubeflow Pipelines.</p>
<h2 id="what-is-pipeline-root">What is pipeline root?</h2>
<p>Pipeline root represents an artifact repository where Kubeflow Pipelines stores a pipeline&rsquo;s artifacts.
This feature supports MinIO, S3, GCS natively using <a href="https://github.com/google/go-cloud">Go CDK</a>. Artifacts can be more accessible in S3 and GCS when integrating Kubeflow Pipelines with other systems.</p>
<p><strong>Note:</strong> For MinIO, you can&rsquo;t change the MinIO instance. Kubeflow Pipelines can only use the Minio instance deployed with itself.
(Please thumb up this <a href="https://github.com/kubeflow/pipelines/issues/6517">GitHub Issue</a> if you need to specify the Minio instance.)</p>
<h2 id="how-to-configure-pipeline-root-authentication">How to configure pipeline root authentication</h2>
<h4 id="minio">MinIO</h4>
<p>You don&rsquo;t need to pass the authentication for MinIO.
Kubeflow Pipelines is configured with the authentication of the MinIO instance deployed with itself.</p>
<h4 id="gcs">GCS</h4>
<p>If you want to specify the <code>pipeline root</code> to GCS :</p>
<p>check <a href="https://www.kubeflow.org/docs/distributions/gke/pipelines/authentication-pipelines/">authentication-pipelines</a></p>
<h4 id="s3">S3</h4>
<p>If you want to specify the <code>pipeline root</code> to S3, please choose one of the following options:</p>
<ul>
<li>
<p>Via <a href="https://aws.amazon.com/blogs/containers/cross-account-iam-roles-for-kubernetes-service-accounts/">AWS IRSA</a>:</p>
</li>
<li>
<p>Via kfp sdk:
<code>dsl.get_pipeline_conf().add_op_transformer(aws.use_aws_secret('xxx', xxx, xxx))</code></p>
</li>
</ul>
<p><strong>references</strong>:</p>
<ul>
<li><a href="https://kubeflow-pipelines.readthedocs.io/en/latest/source/kfp.dsl.html#kfp.dsl.PipelineConf.add_op_transformer">add-op-transformer</a></li>
<li><a href="https://kubeflow-pipelines.readthedocs.io/en/latest/source/kfp.extensions.html#kfp.aws.use_aws_secret">use-aws-secret</a></li>
</ul>
<h2 id="how-to-configure-pipeline-root">How to configure pipeline root</h2>
<h4 id="via-configmaps">Via ConfigMaps</h4>
<p>You can configure default pipeline root for Kubeflow Pipelines via changing the <code>defaultPipelineRoot</code> entry of  ConfigMaps <code>kfp-launcher</code> in Kubernetes namespace.</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-shell" data-lang="shell"><span class="line"><span class="cl">kubectl edit configMap kfp-launcher -n <span class="si">${</span><span class="nv">namespace</span><span class="si">}</span>
</span></span></code></pre></div><p>This pipeline root will be the default pipeline root for all pipelines running in the Kubernetes namespace unless you override it using one of the following options:</p>
<h4 id="via-building-pipelines">Via Building Pipelines</h4>
<p>You can configure a pipeline root through the <code>kfp.dsl.pipeline</code> annotation when <a href="https://www.kubeflow.org/docs/components/pipelines/sdk-v2/build-pipeline/#build-your-pipeline">building pipelines</a></p>
<h4 id="via-submitting-a-pipeline-through-sdk">Via Submitting a Pipeline through SDK</h4>
<p>You can configure pipeline root via <code>pipeline_root</code> argument when you submit a Pipeline using one of the following:</p>
<ul>
<li><a href="https://kubeflow-pipelines.readthedocs.io/en/latest/source/kfp.client.html#kfp.Client.create_run_from_pipeline_func">create_run_from_pipeline_func</a></li>
<li><a href="https://kubeflow-pipelines.readthedocs.io/en/latest/source/kfp.client.html#kfp.Client.create_run_from_pipeline_package">create_run_from_pipeline_package</a></li>
<li><a href="https://kubeflow-pipelines.readthedocs.io/en/latest/source/kfp.client.html#kfp.Client.run_pipeline">run_pipeline</a>.</li>
</ul>
<h4 id="via-submitting-a-pipeline-run-through-ui">Via Submitting a Pipeline Run through UI</h4>
<p>You can configure a pipeline root via the <code>pipeline_root</code> run parameters when you submit a pipeline run in the UI
<img src="/docs/images/pipelines/v1/v2-compatible/pipelines-ui-pipelineroot.png"
alt="Configure pipeline root on the pipelines UI"
class="mt-3 mb-3 border border-info rounded"></p>

</div>



    
	
  

    
	
  
    
    
	
    

<div class="td-content" style="page-break-before: always">
    
	<h1 id="pg-060c8cb37a256181746cb201db0a3044">3.1.3 - Concepts</h1>
    <div class="lead">Concepts used in Kubeflow Pipelines</div>
	
</div>



    
      
  
  
  
  

  
  

  
    
    
	
    

<div class="td-content" style="">
    
	<h1 id="pg-47b93a2008be6edd146543a09d537805">3.1.3.1 - Pipeline</h1>
    <div class="lead">Conceptual overview of pipelines in Kubeflow Pipelines</div>
	<p>A <em>pipeline</em> is a description of a machine learning (ML) workflow, including all
of the <a href="/docs/components/pipelines/concepts/component/">components</a> in the workflow and how the components relate to each other in
the form of a <a href="/docs/components/pipelines/concepts/graph/">graph</a>. The pipeline
configuration includes the definition of the inputs (parameters) required to run
the pipeline and the inputs and outputs of each component.</p>
<p>When you run a pipeline, the system launches one or more Kubernetes Pods
corresponding to the <a href="/docs/components/pipelines/concepts/step/">steps</a> (components) in your workflow (pipeline). The Pods
start Docker containers, and the containers in turn start your programs.</p>
<p>After developing your pipeline, you can upload your pipeline using the Kubeflow Pipelines UI or the Kubeflow Pipelines SDK.</p>
<h2 id="next-steps">Next steps</h2>
<ul>
<li>Read an <a href="/docs/components/pipelines/introduction/">overview of Kubeflow Pipelines</a>.</li>
<li>Follow the <a href="/docs/components/pipelines/overview/quickstart/">pipelines quickstart guide</a>
to deploy Kubeflow and run a sample pipeline directly from the Kubeflow
Pipelines UI.</li>
</ul>

</div>



    
	
  
    
    
	
    

<div class="td-content" style="page-break-before: always">
    
	<h1 id="pg-789813dd0bef14690b23c5f697b60344">3.1.3.2 - Component</h1>
    <div class="lead">Conceptual overview of components in Kubeflow Pipelines</div>
	<p>A <em>pipeline component</em> is self-contained set of code that performs one step in
the ML workflow (pipeline), such as data preprocessing, data transformation,
model training, and so on. A component is analogous to a function, in that it
has a name, parameters, return values, and a body.</p>
<h2 id="component-code">Component code</h2>
<p>The code for each component includes the following:</p>
<ul>
<li>
<p><strong>Client code:</strong> The code that talks to endpoints to submit jobs. For example,
code to talk to the Google Dataproc API to submit a Spark job.</p>
</li>
<li>
<p><strong>Runtime code:</strong> The code that does the actual job and usually runs in the
cluster. For example, Spark code that transforms raw data into preprocessed
data.</p>
</li>
</ul>
<p>Note the naming convention for client code and runtime codefor a task
named &ldquo;mytask&rdquo;:</p>
<ul>
<li>The <code>mytask.py</code> program contains the client code.</li>
<li>The <code>mytask</code> directory contains all the runtime code.</li>
</ul>
<h2 id="component-definition">Component definition</h2>
<p>A component specification in YAML format describes the component for the
Kubeflow Pipelines system. A component definition has the following parts:</p>
<ul>
<li><strong>Metadata:</strong> name, description, etc.</li>
<li><strong>Interface:</strong> input/output specifications (name, type, description, default
value, etc).</li>
<li><strong>Implementation:</strong> A specification of how to run the component given a
set of argument values for the component&rsquo;s inputs. The implementation section
also describes how to get the output values from the component once the
component has finished running.</li>
</ul>
<p>For the complete definition of a component, see the
<a href="/docs/components/pipelines/reference/component-spec/">component specification</a>.</p>
<h2 id="containerizing-components">Containerizing components</h2>
<p>You must package your component as a
<a href="https://docs.docker.com/get-started/">Docker image</a>. Components represent a
specific program or entry point inside a container.</p>
<p>Each component in a pipeline executes independently. The components do not run
in the same process and cannot directly share in-memory data. You must serialize
(to strings or files) all the data pieces that you pass between the components
so that the data can travel over the distributed network. You must then
deserialize the data for use in the downstream component.</p>
<h2 id="next-steps">Next steps</h2>
<ul>
<li>Read an <a href="/docs/components/pipelines/introduction/">overview of Kubeflow Pipelines</a>.</li>
<li>Follow the <a href="/docs/components/pipelines/overview/quickstart/">pipelines quickstart guide</a>
to deploy Kubeflow and run a sample pipeline directly from the Kubeflow
Pipelines UI.</li>
<li>Build your own
<a href="/docs/components/pipelines/sdk/build-component/">component and pipeline</a>.</li>
<li>Build a <a href="/docs/components/pipelines/sdk/component-development/">reusable component</a> for
sharing in multiple pipelines.</li>
</ul>

</div>



    
	
  
    
    
	
    

<div class="td-content" style="page-break-before: always">
    
	<h1 id="pg-033c56b71b85e6e7268a6288392252b5">3.1.3.3 - Graph</h1>
    <div class="lead">Conceptual overview of graphs in Kubeflow Pipelines</div>
	<p>A <em>graph</em> is a pictorial representation in the Kubeflow Pipelines UI of the
runtime execution of a pipeline. The graph shows the steps that a pipeline run
has executed or is executing, with arrows indicating the parent/child
relationships between the pipeline components represented by each step. The
graph is viewable as soon as the run begins. Each node within the graph
corresponds to a step within the pipeline and is labeled accordingly.</p>
<p>The screenshot below shows an example of a pipeline graph:</p>
<p><img src="/docs/images/pipelines-xgboost-graph.png" 
alt="XGBoost results on the pipelines UI"
class="mt-3 mb-3 border border-info rounded"></p>
<p>At the top right of each node is an icon indicating its status: running,
succeeded, failed, or skipped. (A node can be skipped when its
parent contains a conditional clause.)</p>
<h2 id="next-steps">Next steps</h2>
<ul>
<li>Read an <a href="/docs/components/pipelines/introduction/">overview of Kubeflow Pipelines</a>.</li>
<li>Follow the <a href="/docs/components/pipelines/overview/quickstart/">pipelines quickstart guide</a>
to deploy Kubeflow and run a sample pipeline directly from the Kubeflow
Pipelines UI.</li>
</ul>

</div>



    
	
  
    
    
	
    

<div class="td-content" style="page-break-before: always">
    
	<h1 id="pg-dc0a02d65cccdebb935eae6c19dcf29d">3.1.3.4 - Experiment</h1>
    <div class="lead">Conceptual overview of experiments in Kubeflow Pipelines</div>
	<p>An <em>experiment</em> is a workspace where you can try different configurations of
your pipelines. You can use experiments to organize your runs into logical
groups. Experiments can contain arbitrary runs, including
<a href="/docs/components/pipelines/concepts/run/">recurring runs</a>.</p>
<h2 id="next-steps">Next steps</h2>
<ul>
<li>Read an <a href="/docs/components/pipelines/introduction/">overview of Kubeflow Pipelines</a>.</li>
<li>Follow the <a href="/docs/components/pipelines/overview/quickstart/">pipelines quickstart guide</a>
to deploy Kubeflow and run a sample pipeline directly from the Kubeflow
Pipelines UI.</li>
</ul>

</div>



    
	
  
    
    
	
    

<div class="td-content" style="page-break-before: always">
    
	<h1 id="pg-673850e161eaa19a91d6d536144cb5c3">3.1.3.5 - Run and Recurring Run</h1>
    <div class="lead">Conceptual overview of runs in Kubeflow Pipelines</div>
	<p>A <em>run</em> is a single execution of a pipeline. Runs comprise an immutable log of
all experiments that you attempt, and are designed to be self-contained to allow
for reproducibility. You can track the progress of a run by looking at its
details page on the Kubeflow Pipelines UI, where you can see the runtime graph,
output artifacts, and logs for each step in the run.</p>
<p><a id=recurring-run></a>
A <em>recurring run</em>, or job in the Kubeflow Pipelines <a href="https://github.com/kubeflow/pipelines/tree/06e4dc660498ce10793d566ca50b8d0425b39981/backend/api/go_http_client/job_client">backend APIs</a>, is a repeatable run of
a pipeline. The configuration for a recurring run includes a copy of a pipeline
with all parameter values specified and a
<a href="/docs/components/pipelines/concepts/run-trigger/">run trigger</a>.
You can start a recurring run inside any experiment, and it will periodically
start a new copy of the run configuration. You can enable/disable the recurring
run from the Kubeflow Pipelines UI. You can also specify the maximum number of
concurrent runs, to limit the number of runs launched in parallel. This can be
helpful if the pipeline is expected to run for a long period of time and is
triggered to run frequently.</p>
<h2 id="next-steps">Next steps</h2>
<ul>
<li>Read an <a href="/docs/components/pipelines/introduction/">overview of Kubeflow Pipelines</a>.</li>
<li>Follow the <a href="/docs/components/pipelines/overview/quickstart/">pipelines quickstart guide</a>
to deploy Kubeflow and run a sample pipeline directly from the Kubeflow
Pipelines UI.</li>
</ul>

</div>



    
	
  
    
    
	
    

<div class="td-content" style="page-break-before: always">
    
	<h1 id="pg-4f1dec38fdd8c154fb193a02d24b03a8">3.1.3.6 - Run Trigger</h1>
    <div class="lead">Conceptual overview of run triggers in Kubeflow Pipelines</div>
	<p>A <em>run trigger</em> is a flag that tells the system when a recurring run
configuration spawns a new run. The following types of run trigger are
available:</p>
<ul>
<li>Periodic: for an interval-based scheduling of runs (for example: every 2 hours
or every 45 minutes).</li>
<li>Cron: for specifying <code>cron</code> semantics for scheduling runs.</li>
</ul>
<h2 id="next-steps">Next steps</h2>
<ul>
<li>Read an <a href="/docs/components/pipelines/introduction/">overview of Kubeflow Pipelines</a>.</li>
<li>Follow the <a href="/docs/components/pipelines/overview/quickstart/">pipelines quickstart guide</a>
to deploy Kubeflow and run a sample pipeline directly from the Kubeflow
Pipelines UI.</li>
</ul>

</div>



    
	
  
    
    
	
    

<div class="td-content" style="page-break-before: always">
    
	<h1 id="pg-696b79e43e2c90b2208b118f99ee085e">3.1.3.7 - Step</h1>
    <div class="lead">Conceptual overview of steps in Kubeflow Pipelines</div>
	<p>A <em>step</em> is an execution of one of the components in the pipeline. The
relationship between a step and its component is one of instantiation, much like
the relationship between a run and its pipeline. In a complex pipeline,
components can execute multiple times in loops, or conditionally after resolving
an if/else like clause in the pipeline code.</p>
<h2 id="next-steps">Next steps</h2>
<ul>
<li>Read an <a href="/docs/components/pipelines/introduction/">overview of Kubeflow Pipelines</a>.</li>
<li>Follow the <a href="/docs/components/pipelines/overview/quickstart/">pipelines quickstart guide</a>
to deploy Kubeflow and run a sample pipeline directly from the Kubeflow
Pipelines UI.</li>
</ul>

</div>



    
	
  
    
    
	
    

<div class="td-content" style="page-break-before: always">
    
	<h1 id="pg-bfae76fed696ce6cd7a87f0c18a72862">3.1.3.8 - Output Artifact</h1>
    <div class="lead">Conceptual overview of output artifacts in Kubeflow Pipelines</div>
	<p>An <em>output artifact</em> is an output emitted by a pipeline component, which the
Kubeflow Pipelines UI understands and can render as rich visualizations. Its
useful for pipeline components to include artifacts so that you can provide for
performance evaluation, quick decision making for the run, or comparison across
different runs. Artifacts also make it possible to understand how the pipelines
various components work. An artifact can range from a plain textual view of the
data to rich interactive visualizations.</p>
<h2 id="next-steps">Next steps</h2>
<ul>
<li>Read an <a href="/docs/components/pipelines/introduction/">overview of Kubeflow Pipelines</a>.</li>
<li>Follow the <a href="/docs/components/pipelines/overview/quickstart/">pipelines quickstart guide</a>
to deploy Kubeflow and run a sample pipeline directly from the Kubeflow
Pipelines UI.</li>
<li>Read more about the available
<a href="/docs/components/pipelines/sdk/output-viewer/">output viewers</a>
and how to provide the metadata to make use of the visualizations
that the output viewers provide.</li>
</ul>

</div>



    
	
  
    
    
	
    

<div class="td-content" style="page-break-before: always">
    
	<h1 id="pg-2e81a36f30fec5fe727a6cbf39d86dae">3.1.3.9 - ML Metadata</h1>
    <div class="lead">Conceptual overview about Metadata in Kubeflow Pipelines</div>
	<p><strong>Note:</strong> Kubeflow Pipelines has moved from using <a href="https://github.com/kubeflow/metadata">kubeflow/metadata</a>
to using <a href="https://github.com/google/ml-metadata">google/ml-metadata</a> for Metadata dependency.</p>
<p>Kubeflow Pipelines backend stores runtime information of a pipeline run in Metadata store.
Runtime information includes the status of a task, availability of artifacts, custom properties associated
with Execution or Artifact, etc. Learn more at <a href="https://github.com/google/ml-metadata/blob/master/g3doc/get_started.md">ML Metadata Get Started</a>.</p>
<p>You can view the connection between Artifacts and Executions across Pipeline Runs, if
one Artifact is being used by multiple Executions in different Runs. This connection visualization
is called a <em>Lineage Graph</em>.</p>
<h2 id="next-steps">Next steps</h2>
<ul>
<li>Learn about <a href="/docs/components/pipelines/concepts/output-artifact">output Aritfact</a>.</li>
</ul>

</div>



    
	
  

    
	
  
    
    
	
    

<div class="td-content" style="page-break-before: always">
    
	<h1 id="pg-5bb6b9f7730debf1fc61622394f44eca">3.1.4 - Installation</h1>
    <div class="lead">Options for installing Kubeflow Pipelines</div>
	
</div>



    
      
  
  
  
  

  
  

  
    
    
	
    

<div class="td-content" style="">
    
	<h1 id="pg-bf5608113cd0f142b59a1ebf6bdc0ddf">3.1.4.1 - Installation Options</h1>
    <div class="lead">Overview of the ways to deploy Kubeflow Pipelines</div>
	<p>Kubeflow Pipelines offers a few installation options.
This page describes the options and the features available
with each option:</p>
<ul>
<li><a href="#kubeflow-pipelines-standalone">Kubeflow Pipelines Standalone</a> is the minimal
portable installation that only includes Kubeflow Pipelines.</li>
<li>Kubeflow Pipelines as <a href="#full-kubeflow-deployment">part of a full Kubeflow deployment</a> provides
all Kubeflow components and more integration with each platform.</li>
<li><strong>Beta</strong>: <a href="#google-cloud-ai-platform-pipelines">Google Cloud AI Platform Pipelines</a> makes it easier to install and use Kubeflow Pipelines on Google Cloud by providing a management UI on <a href="https://console.cloud.google.com/ai-platform/pipelines/clusters">Google Cloud Console</a>.</li>
<li>A <a href="/docs/components/pipelines/installation/localcluster-deployment">local</a> Kubeflow Pipelines deployment for testing purposes.</li>
</ul>
<h2 id="choosing-an-installation-option">Choosing an installation option</h2>
<ol>
<li>
<p>Do you want to use other Kubeflow components in addition to Pipelines?</p>
<p>If yes, choose the <a href="#full-kubeflow-deployment">full Kubeflow deployment</a>.</p>
</li>
<li>
<p>Can you use a cloud/on-prem Kubernetes cluster?</p>
<p>If you can&rsquo;t, you should try using Kubeflow Pipelines on a local Kubernetes cluster for learning and testing purposes by following the steps in <a href="/docs/components/pipelines/installation/localcluster-deployment">Deploying Kubeflow Pipelines on a local cluster</a>.</p>
</li>
<li>
<p>Do you want to use Kubeflow Pipelines with <a href="https://github.com/kubeflow/pipelines/issues/1223">multi-user support</a>?</p>
<p>If yes, choose the <a href="#full-kubeflow-deployment">full Kubeflow deployment</a> with version &gt;= v1.1.</p>
</li>
<li>
<p>Do you deploy on Google Cloud?</p>
<p>If yes, deploy <a href="#kubeflow-pipelines-standalone">Kubeflow Pipelines Standalone</a>. You can also
use <a href="#google-cloud-ai-platform-pipelines">Google Cloud AI Platform Pipelines</a> to deploy Kubeflow Pipelines
using a user interface, but there are limitations in
customizability and upgradability. For details, please read corresponding
sections.</p>
</li>
<li>
<p>You deploy on other platforms.</p>
<p>Please compare your platform specific <a href="#full-kubeflow-deployment">full Kubeflow</a> with the
<a href="#kubeflow-pipelines-standalone">Kubeflow Pipelines Standalone</a> before making your decision.</p>
</li>
</ol>
<p><strong>Warning:</strong> Choose your installation option with caution, there&rsquo;s no current
supported path to migrate data between different installation options. Please
create <a href="https://github.com/kubeflow/pipelines/issues/new/choose">a GitHub issue</a>
if that&rsquo;s important for you.</p>
<p><a id="standalone"></a></p>
<h2 id="kubeflow-pipelines-standalone">Kubeflow Pipelines Standalone</h2>
<p>Use this option to deploy Kubeflow Pipelines to an on-premises, cloud
or even local Kubernetes cluster, without the other components of Kubeflow.
To deploy Kubeflow Pipelines Standalone, you use kustomize manifests only.
This process makes it simpler to customize your deployment and to integrate
Kubeflow Pipelines into an existing Kubernetes cluster.</p>
<dl>
<dt>Installation guide</dt>
<dd><a href="/docs/components/pipelines/installation/standalone-deployment/">Kubeflow Pipelines Standalone deployment
guide</a></dd>
</dl>
<p>Interfaces
:</p>
<ul>
<li>Kubeflow Pipelines UI</li>
<li>Kubeflow Pipelines SDK</li>
<li>Kubeflow Pipelines API</li>
<li>Kubeflow Pipelines endpoint is <strong>only auto-configured</strong> for Google Cloud.</li>
</ul>
<p>If you wish to deploy Kubeflow Pipelines on other platforms, you can either access it through
<code>kubectl port-forward</code> or configure your own platform specific auth-enabled
endpoint by yourself.</p>
<dl>
<dt>Release Schedule</dt>
<dd>Kubeflow Pipelines Standalone is available for every Kubeflow Pipelines release.
You will have access to the latest features.</dd>
<dt>Upgrade Support (<strong>Beta</strong>)</dt>
<dd><a href="/docs/components/pipelines/installation/standalone-deployment/#upgrading-kubeflow-pipelines">Upgrading Kubeflow Pipelines Standalone</a> introduces how to upgrade
in place.</dd>
</dl>
<p>Google Cloud Integrations
:</p>
<ul>
<li>A Kubeflow Pipelines public endpoint with auth support is <strong>auto-configured</strong> for you.</li>
<li>Open the Kubeflow Pipelines UI via the <strong>Open Pipelines Dashboard</strong> link in <a href="https://console.cloud.google.com/ai-platform/pipelines/clusters">the AI Platform Pipelines dashboard of Cloud Console</a>.</li>
<li>(Optional) You can choose to persist your data in Google Cloud managed storage (Cloud SQL and Cloud Storage).</li>
<li><a href="/docs/gke/pipelines/authentication-pipelines/">All options to authenticate to Google Cloud</a> are supported.</li>
</ul>
<p>Notes on specific features
:</p>
<ul>
<li>After deployment, your Kubernetes cluster contains Kubeflow Pipelines only.
It does not include the other Kubeflow components.
For example, to use a Jupyter Notebook, you must use a local notebook or a
hosted notebook in a cloud service such as the <a href="https://cloud.google.com/ai-platform/notebooks/docs/">AI Platform
Notebooks</a>.</li>
<li>Kubeflow Pipelines multi-user support is <strong>not available</strong> in standalone, because
multi-user support depends on other Kubeflow components.</li>
</ul>
<p><a id="full-kubeflow"></a></p>
<h2 id="full-kubeflow-deployment">Full Kubeflow deployment</h2>
<p>Use this option to deploy Kubeflow Pipelines to your local machine, on-premises,
or to a cloud, as part of a full Kubeflow installation.</p>
<dl>
<dt>Installation guide</dt>
<dd><a href="/docs/started/getting-started/">Kubeflow installation guide</a></dd>
</dl>
<p>Interfaces
:</p>
<ul>
<li>Kubeflow UI</li>
<li>Kubeflow Pipelines UI within or outside the Kubeflow UI</li>
<li>Kubeflow Pipelines SDK</li>
<li>Kubeflow Pipelines API</li>
<li>Other Kubeflow APIs</li>
<li>Kubeflow Pipelines endpoint is auto-configured with auth support for each platform</li>
</ul>
<dl>
<dt>Release Schedule</dt>
<dd>The full Kubeflow is released quarterly. It has significant delay in receiving
Kubeflow Pipelines updates.</dd>
</dl>
<table>
<thead>
<tr>
<th>Kubeflow Version</th>
<th>Kubeflow Pipelines Version</th>
</tr>
</thead>
<tbody>
<tr>
<td>0.7.0</td>
<td>0.1.31</td>
</tr>
<tr>
<td>1.0.0</td>
<td>0.2.0</td>
</tr>
<tr>
<td>1.0.2</td>
<td>0.2.5</td>
</tr>
<tr>
<td>1.1.0</td>
<td>1.0.0</td>
</tr>
<tr>
<td>1.2.0</td>
<td>1.0.4</td>
</tr>
<tr>
<td>1.3.0</td>
<td>1.5.0</td>
</tr>
<tr>
<td>1.4.0</td>
<td>1.7.0</td>
</tr>
</tbody>
</table>
<p>Note: Google Cloud, AWS, and IBM Cloud have supported Kubeflow Pipelines 1.0.0 with multi-user separation. Other platforms might not be up-to-date for now, refer to <a href="https://github.com/kubeflow/manifests/issues/1364#issuecomment-668415871">this GitHub issue</a> for status.</p>
<p>Upgrade Support
:
Refer to <a href="/docs/gke/pipelines/upgrade/#full-kubeflow">the full Kubeflow section of upgrading Kubeflow Pipelines on Google Cloud</a> guide.</p>
<p>Google Cloud Integrations
:</p>
<ul>
<li>A Kubeflow Pipelines public endpoint with auth support is <strong>auto-configured</strong> for you using <a href="https://cloud.google.com/iap">Cloud Identity-Aware Proxy</a>.</li>
<li>There&rsquo;s no current support for persisting your data in Google Cloud managed storage (Cloud SQL and Cloud Storage). Refer to <a href="https://github.com/kubeflow/pipelines/issues/4356">this GitHub issue</a> for the latest status.</li>
<li>You can <a href="/docs/gke/pipelines/authentication-pipelines/#workload-identity">authenticate to Google Cloud with Workload Identity</a>.</li>
</ul>
<p>Notes on specific features
:</p>
<ul>
<li>After deployment, your Kubernetes cluster includes all the
<a href="/docs/components/">Kubeflow components</a>.
For example, you can use the Jupyter notebook services
<a href="/docs/components/notebooks/">deployed with Kubeflow</a> to create one or more notebook
servers in your Kubeflow cluster.</li>
<li>Kubeflow Pipelines multi-user support is <strong>only available</strong> in full Kubeflow. It supports
using a single Kubeflow Pipelines control plane to orchestrate user pipeline
runs in multiple user namespaces with authorization.</li>
<li>Latest features and bug fixes may not be available soon because release
cadence is long.</li>
</ul>
<p><a id="marketplace"></a></p>
<h2 id="google-cloud-ai-platform-pipelines">Google Cloud AI Platform Pipelines</h2>


<div class="alert alert-warning" role="alert">
<h4 class="alert-heading">Beta release</h4>

    <p>Google Cloud AI Platform Pipelines is currently in <b>Beta</b> with
  limited support. The Kubeflow Pipelines team is interested in any feedback you may have,
  in particular on the usability of the feature.
<p>You can raise any issues or discussion items in the
<a href="https://github.com/kubeflow/pipelines/issues">Kubeflow Pipelines
issue tracker</a>.</p></p>


</div>

<p>Use this option to deploy Kubeflow Pipelines to Google Kubernetes Engine (GKE)
from Google Cloud Marketplace. You can deploy Kubeflow Pipelines to an existing or new
GKE cluster and manage your cluster within Google Cloud.</p>
<dl>
<dt>Installation guide</dt>
<dd><a href="https://cloud.google.com/ai-platform/pipelines/docs">Google Cloud AI Platform Pipelines documentation</a></dd>
</dl>
<p>Interfaces
:</p>
<ul>
<li>Google Cloud Console for managing the Kubeflow Pipelines cluster and other Google Cloud
services</li>
<li>Kubeflow Pipelines UI via the <strong>Open Pipelines Dashboard</strong> link in the
Google Cloud Console</li>
<li>Kubeflow Pipelines SDK in Cloud Notebooks</li>
<li>Kubeflow Pipelines endpoint of your instance is auto-configured for you</li>
</ul>
<dl>
<dt>Release Schedule</dt>
<dd>AI Platform Pipelines is available for a chosen set of stable Kubeflow
Pipelines releases. You will receive updates slightly slower than Kubeflow
Pipelines Standalone.</dd>
<dt>Upgrade Support (<strong>Alpha</strong>)</dt>
<dd>An in-place upgrade is not supported.</dd>
</dl>
<p>To upgrade AI Platform Pipelines by reinstalling it (with existing data), refer to the <a href="/docs/gke/pipelines/upgrade/#ai-platform-pipelines">Upgrading AI Platform Pipelines</a> guide.</p>
<p>Google Cloud Integrations
:</p>
<ul>
<li>You can deploy AI Platform Pipelines on <a href="https://console.cloud.google.com/marketplace/details/google-cloud-ai-platform/kubeflow-pipelines">Cloud Console UI</a>.</li>
<li>A Kubeflow Pipelines public endpoint with auth support is <strong>auto-configured</strong> for you.</li>
<li>(Optional) You can choose to persist your data in Google Cloud managed storage services (Cloud SQL and Cloud Storage).</li>
<li>You can <a href="/docs/gke/pipelines/authentication-pipelines/#compute-engine-default-service-account">authenticate to Google Cloud with the Compute Engine default service account</a>. However, this method may not be suitable if you need workload permission separation.</li>
<li>You can deploy AI Platform Pipelines on both public and private GKE clusters as long as the cluster <a href="https://cloud.google.com/ai-platform/pipelines/docs/configure-gke-cluster#ensure">has sufficient resources for AI Platform Pipelines</a>.</li>
</ul>
<p>Notes on specific features
:</p>
<ul>
<li>After deployment, your Kubernetes cluster contains Kubeflow Pipelines only.
It does not include the other Kubeflow components.
For example, to use a Jupyter Notebook, you can use <a href="https://cloud.google.com/ai-platform/notebooks/docs/">AI Platform
Notebooks</a>.</li>
<li>Kubeflow Pipelines multi-user support is <strong>not available</strong> in AI Platform Pipelines, because
multi-user support depends on other Kubeflow components.</li>
</ul>

</div>



    
	
  
    
    
	
    

<div class="td-content" style="page-break-before: always">
    
	<h1 id="pg-c3e83ecb2e15685ebd378756baadb500">3.1.4.2 - Local Deployment</h1>
    <div class="lead">Information about local Deployment of Kubeflow Pipelines (kind, K3s, K3ai)</div>
	<p>This guide shows how to deploy Kubeflow Pipelines standalone on a local
Kubernetes cluster using:</p>
<ul>
<li>kind</li>
<li>K3s</li>
<li>K3s on Windows Subsystem for Linux (WSL)</li>
<li>K3ai [<em>alpha</em>]</li>
</ul>
<p>Such deployment methods can be part of your local environment using the supplied
kustomize manifests for test purposes. This guide is an alternative to</p>
<p><a href="/docs/started/getting-started/#installing-kubeflow">Deploying Kubeflow Pipelines
(KFP)</a>.</p>
<h2 id="before-you-get-started">Before you get started</h2>
<ul>
<li>
<p>You should be familiar with <a href="https://kubernetes.io/docs/home/">Kubernetes</a>,
<a href="https://kubernetes.io/docs/reference/kubectl/overview/">kubectl</a>, and
<a href="https://kustomize.io/">kustomize</a>.</p>
</li>
<li>
<p>For native support of kustomize, you will need kubectl v1.14 or higher. You
can download and install kubectl by following the <a href="https://kubernetes.io/docs/tasks/tools/install-kubectl/">kubectl installation
guide</a>.</p>
</li>
</ul>
<h2 id="kind">kind</h2>
<h3 id="1-installing-kind">1. Installing kind</h3>
<p><a href="https://kind.sigs.k8s.io">kind</a> is a tool for running local Kubernetes clusters
using Docker container nodes. <code>kind</code> was primarily designed for testing
Kubernetes itself. It can also be used for local development or CI.</p>
<p>You can install and configure kind by following the
<a href="https://kind.sigs.k8s.io/docs/user/quick-start/">official quick start</a>.</p>
<p>To get started with kind:</p>
<p><strong>On Linux:</strong></p>
<p>Download and move the <code>kind</code> executable to your directory in your PATH by
running the following commands:</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-shell" data-lang="shell"><span class="line"><span class="cl">curl -Lo ./kind https://kind.sigs.k8s.io/dl/<span class="o">{</span>KIND_VERSION<span class="o">}</span>/kind-linux-amd64 <span class="o">&amp;&amp;</span> <span class="se">\
</span></span></span><span class="line"><span class="cl"><span class="se"></span>chmod +x ./kind <span class="o">&amp;&amp;</span> <span class="se">\
</span></span></span><span class="line"><span class="cl"><span class="se"></span>mv ./kind /<span class="o">{</span>YOUR_KIND_DIRECTORY<span class="o">}</span>/kind
</span></span></code></pre></div><p>Replace the following:</p>
<ul>
<li><code>{KIND_VERSION}</code>: the kind version; for example, <code>v0.8.1</code> as of the date this
guide was written</li>
<li><code>{YOUR_KIND_DIRECTORY}</code>: your directory in PATH</li>
</ul>
<p><strong>On macOS:</strong></p>
<p>You can use <a href="https://brew.sh">Homebrew</a> to install kind:</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-shell" data-lang="shell"><span class="line"><span class="cl">brew install kind
</span></span></code></pre></div><p><strong>On Windows:</strong></p>
<ul>
<li>
<p>You can use the administrative PowerShell console to run the following
commands to download and move the <code>kind</code> executable to a directory in your
PATH:</p>
</li>
<li>
<p><strong>PowerShell:</strong> Run these commands to download and move the <code>kind</code> executable
to a directory in your PATH:</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-powershell" data-lang="powershell"><span class="line"><span class="cl"><span class="n">curl</span><span class="p">.</span><span class="n">exe</span> <span class="n">-Lo</span> <span class="nb">kind-windows</span><span class="n">-amd64</span><span class="p">.</span><span class="n">exe</span> <span class="n">https</span><span class="err">:</span><span class="p">//</span><span class="n">kind</span><span class="p">.</span><span class="n">sigs</span><span class="p">.</span><span class="n">k8s</span><span class="p">.</span><span class="n">io</span><span class="p">/</span><span class="n">dl</span><span class="p">/{</span><span class="n">KIND_VERSION</span><span class="p">}/</span><span class="nb">kind-windows</span><span class="n">-amd64</span>
</span></span><span class="line"><span class="cl"><span class="nb">Move-Item</span> <span class="p">.\</span><span class="nb">kind-windows</span><span class="n">-amd64</span><span class="p">.</span><span class="n">exe</span> <span class="n">c:</span><span class="p">\{</span><span class="n">YOUR_KIND_DIRECTORY</span><span class="p">}\</span><span class="n">kind</span><span class="p">.</span><span class="n">exe</span>
</span></span></code></pre></div><p>Replace the following:</p>
<ul>
<li><code>{KIND_VERSION}</code>: the kind version - for example, <code>v0.9</code> (check the latest
stable binary versions on the <a href="https://github.com/kubernetes-sigs/kind/releases">kind releases
pages</a>)</li>
<li><code>{YOUR_KIND_DIRECTORY}</code>: your directory for kind in PATH</li>
</ul>
</li>
</ul>
<ul>
<li><code>{KIND_VERSION}</code>: the kind version; for example, <code>v0.8.1</code> as of the date this
guide was written</li>
<li><code>{YOUR_KIND_DIRECTORY}</code>: your directory in PATH</li>
</ul>
<ul>
<li>
<p>Alternatively, you can use Chocolatey <a href="https://chocolatey.org/packages/kind">https://chocolatey.org/packages/kind</a>:</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-SHELL" data-lang="SHELL"><span class="line"><span class="cl">choco install kind
</span></span></code></pre></div></li>
</ul>
<p><strong>Note:</strong> kind uses containerd as a default container-runtime hence you cannot
use the standard kubeflow pipeline manifests.</p>
<p><strong>References</strong>:</p>
<p><strong>References:</strong></p>
<ul>
<li><a href="https://kind.sigs.k8s.io/docs/user/quick-start/">kind: Quick Start Guide</a></li>
<li><a href="https://kind.sigs.k8s.io/docs/user/known-issues/">kind: Known Issues</a></li>
<li><a href="https://kind.sigs.k8s.io/docs/user/working-offline/">kind: Working Offline</a></li>
</ul>
<h3 id="2-creating-a-cluster-on-kind">2. Creating a cluster on kind</h3>
<p>Having installed kind, you can create a Kubernetes cluster on kind with this
command:</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-shell" data-lang="shell"><span class="line"><span class="cl">kind create cluster
</span></span></code></pre></div><p>This will bootstrap a Kubernetes cluster using a pre-built node image. You can
find that image on the Docker Hub <code>kindest/node</code>
<a href="https://hub.docker.com/r/kindest/node">here</a>. If you wish to build the node
image yourself, you can use the <code>kind build node-image</code> commandsee the official
<a href="https://kind.sigs.k8s.io/docs/user/quick-start/#building-images">building
image</a> section
for more details. And, to specify another image, use the <code>--image</code> flag.</p>
<p>By default, the cluster will be given the name kind. Use the <code>--name</code> flag to
assign the cluster a different context name.</p>
<h2 id="k3s">K3s</h2>
<h3 id="1-setting-up-a-cluster-on-k3s">1. Setting up a cluster on K3s</h3>
<p>K3s is a fully compliant Kubernetes distribution with the following
enhancements:</p>
<ul>
<li>
<p>Packaged as a single binary.</p>
</li>
<li>
<p>Lightweight storage backend based on sqlite3 as the default storage mechanism.
etcd3, MySQL, Postgres also still available.</p>
</li>
<li>
<p>Wrapped in simple launcher that handles a lot of the complexity of TLS and
options.</p>
</li>
<li>
<p>Secure by default with reasonable defaults for lightweight environments.</p>
</li>
<li>
<p>Simple but powerful batteries-included features have been added, such as: a
local storage provider, a service load balancer, a Helm controller, and the
Traefik ingress controller.</p>
</li>
<li>
<p>Operation of all Kubernetes control plane components is encapsulated in a
single binary and process. This allows K3s to automate and manage complex
cluster operations like distributing certificates.</p>
</li>
<li>
<p>External dependencies have been minimized (just a modern kernel and cgroup
mounts needed). K3s packages required dependencies, including:</p>
<ul>
<li>containerd</li>
<li>Flannel</li>
<li>CoreDNS</li>
<li>CNI</li>
<li>Host utilities (iptables, socat, etc)</li>
<li>Ingress controller (traefik)</li>
<li>Embedded service loadbalancer</li>
<li>Embedded network policy controller</li>
</ul>
</li>
</ul>
<p>You can find the the official K3s installation script to install it as a service
on systemd- or openrc-based systems on the official
<a href="https://get.k3s.io">K3s website</a>.</p>
<p>To install K3s using that method, run the following command:</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-SHELL" data-lang="SHELL"><span class="line"><span class="cl">curl -sfL https://get.k3s.io <span class="p">|</span> sh -
</span></span></code></pre></div><p><strong>References</strong>:</p>
<ul>
<li>
<p><a href="https://rancher.com/docs/k3s/latest/en/quick-start/">K3s: Quick Start Guide</a></p>
</li>
<li>
<p><a href="https://rancher.com/docs/k3s/latest/en/known-issues/">K3s: Known Issues</a></p>
</li>
<li>
<p><a href="https://rancher.com/docs/k3s/latest/en/faq/">K3s: FAQ</a></p>
</li>
</ul>
<h3 id="2-creating-a-cluster-on-k3s">2. Creating a cluster on K3s</h3>
<ol>
<li>
<p>To create a Kubernetes cluster on K3s, use the following command:</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-shell" data-lang="shell"><span class="line"><span class="cl">sudo k3s server <span class="p">&amp;</span>
</span></span></code></pre></div><p>This will bootstrap a Kubernetes cluster kubeconfig is written to
<code>/etc/rancher/k3s/k3s.yaml</code>.</p>
</li>
<li>
<p>(Optional) Check your cluster:</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-shell" data-lang="shell"><span class="line"><span class="cl">sudo k3s kubectl get node
</span></span></code></pre></div><p>K3s embeds the popular kubectl command directly in the binaries, so you may
immediately interact with the cluster through it.</p>
</li>
<li>
<p>(Optional) Run the below command on a different node. <code>NODE_TOKEN</code> comes from
<code>/var/lib/rancher/k3s/server/node-token</code> on your server:</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-shell" data-lang="shell"><span class="line"><span class="cl">sudo k3s agent --server https://myserver:6443 --token <span class="o">{</span>YOUR_NODE_TOKEN<span class="o">}</span>
</span></span></code></pre></div></li>
</ol>
<h2 id="k3s-on-windows-subsystem-for-linux-wsl">K3s on Windows Subsystem for Linux (WSL)</h2>
<h3 id="1-setting-up-a-cluster-on-k3s-on-windows-subsystem-for-linux-wsl">1. Setting up a cluster on K3s on Windows Subsystem for Linux (WSL)</h3>
<p>The Windows Subsystem for Linux (WSL) lets developers run a GNU/Linux
environmentincluding most command-line tools, utilities, and applications
directly on Windows, unmodified, without the overhead of a traditional virtual
machine or dualboot setup.</p>
<p>The full instructions for installing WSL can be found on the
<a href="https://docs.microsoft.com/en-us/windows/wsl/install-win10">official Windows site</a>.</p>
<p>The following steps summarize what you&rsquo;ll need to set up WSL and then K3s on
WSL.</p>
<ol>
<li>
<p>Install [WSL] by following the official <a href="https://docs.microsoft.com/en-us/windows/wsl/install-win10">docs</a>.</p>
</li>
<li>
<p>As per the official instructions, update WSL and download your preferred
distibution:</p>
</li>
</ol>
<ul>
<li><a href="https://www.microsoft.com/store/apps/9PN498VPMF3Z">SUSE Linux Enterprise Server 15
SP1</a></li>
<li><a href="https://www.microsoft.com/store/apps/9MZD0N9Z4M4H">openSUSE Leap 15.2</a></li>
<li><a href="https://www.microsoft.com/store/apps/9N9TNGVNDL3Q">Ubuntu 18.04 LTS</a></li>
<li><a href="https://www.microsoft.com/store/apps/9MSVKQC78PK6">Debian GNU/Linux</a></li>
</ul>
<p><strong>References</strong>:</p>
<ul>
<li><a href="https://gist.github.com/ibuildthecloud/1b7d6940552ada6d37f54c71a89f7d00">K3s on WSL: Quick Start Guide</a></li>
</ul>
<h3 id="2-creating-a-cluster-on-k3s-on-wsl">2. Creating a cluster on K3s on WSL</h3>
<p>Below are the steps to create a cluster on K3s in WSL</p>
<ol>
<li>
<p>To create a Kubernetes cluster on K3s on WSL, run the following command:</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-shell" data-lang="shell"><span class="line"><span class="cl">sudo ./k3s server
</span></span></code></pre></div><p>This will bootstrap a Kubernetes cluster but you will cannot yet access from
your Windows machine to the cluster itself.</p>
<p><strong>Note:</strong> You can&rsquo;t install K3s using the curl script because there is no
supervisor (systemd or openrc) in WSL.</p>
</li>
<li>
<p>Download the K3s binary from <a href="https://github.com/rancher/k3s/releases/latest">https://github.com/rancher/k3s/releases/latest</a>.
Then, inside the directory where you download the K3s binary to, run this
command to add execute permission to the K3s binary:</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-shell" data-lang="shell"><span class="line"><span class="cl">chmod +x k3s
</span></span></code></pre></div></li>
<li>
<p>Start K3s:</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-shell" data-lang="shell"><span class="line"><span class="cl">sudo ./k3s server
</span></span></code></pre></div></li>
</ol>
<h3 id="3-setting-up-access-to-wsl-instance">3. Setting up access to WSL instance</h3>
<p>To set up access to your WSL instance:</p>
<ol>
<li>
<p>Copy <code>/etc/rancher/k3s/k3s.yaml</code> from WSL to <code>$HOME/.kube/config</code>.</p>
</li>
<li>
<p>Edit the copied file by changing the server URL from <code>https://localhost:6443</code>
to the IP of the your WSL instance (<code>ip addr show dev eth0</code>) (For example,
<code>https://192.168.170.170:6443</code>.)</p>
</li>
<li>
<p>Run kubectl in a Windows terminal. If you don&rsquo;t kubectl installed, follow the
official <a href="https://kubernetes.io/docs/tasks/tools/install-kubectl/#install-kubectl-on-windows">Kubernetes on Windows instructions</a>.</p>
</li>
</ol>
<h2 id="k3ai-alpha">K3ai [<em>alpha</em>]</h2>
<p>K3ai is a lightweight &ldquo;infrastructure in a box&rdquo; designed specifically to install
and configure AI tools and platforms on portable hardware, such as laptops and
edge devices. This enables users to perform quick experimentations with Kubeflow
on a local cluster.</p>
<p>K3ai&rsquo;s main goal is to provide a quick way to install Kubernetes (K3s-based) and
Kubeflow Pipelines with NVIDIA GPU support and TensorFlow Serving with just one
line. (For Kubeflow and other component support, check <a href="https://kf5ai.gitbook.io/k3ai/#components-of-k-3-ai">K3ai&rsquo;s
website</a> for updates.) To
install Kubeflow Pipelines using K3ai, run the following commands:</p>
<ul>
<li>With CPU-only support:</li>
</ul>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-SHELL" data-lang="SHELL"><span class="line"><span class="cl">curl -sfL https://get.k3ai.in <span class="p">|</span> bash -s -- --cpu --plugin_kfpipelines
</span></span></code></pre></div><ul>
<li>With GPU support:</li>
</ul>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-SHELL" data-lang="SHELL"><span class="line"><span class="cl">curl -sfL https://get.k3ai.in <span class="p">|</span> bash -s -- --gpu --plugin_kfpipelines
</span></span></code></pre></div><p>For more information about K3ai, refer to the
<a href="https://k3ai.github.io/docs/intro">official documentation</a>.</p>
<h2 id="deploying-kubeflow-pipelines">Deploying Kubeflow Pipelines</h2>
<p>The installation process for Kubeflow Pipelines is the same for all three
environments covered in this guide: kind, K3s, and K3ai.</p>
<p><strong>Note</strong>: Process Namespace Sharing (PNS) is not mature in Argo yet - for more
information go to <a href="https://argoproj.github.io/argo-workflows/workflow-executors/">Argo
Executors</a> and reference
&ldquo;pns executors&rdquo; in any issue you may come across when using PNS.</p>
<ol>
<li>
<p>To deploy the Kubeflow Pipelines, run the following commands:</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-shell" data-lang="shell"><span class="line"><span class="cl"><span class="c1"># env/platform-agnostic-pns hasn&#39;t been publically released, so you will install it from master</span>
</span></span><span class="line"><span class="cl"><span class="nb">export</span> <span class="nv">PIPELINE_VERSION</span><span class="o">=</span>1.8.5
</span></span><span class="line"><span class="cl">kubectl apply -k <span class="s2">&#34;github.com/kubeflow/pipelines/manifests/kustomize/cluster-scoped-resources?ref=</span><span class="nv">$PIPELINE_VERSION</span><span class="s2">&#34;</span>
</span></span><span class="line"><span class="cl">kubectl <span class="nb">wait</span> --for <span class="nv">condition</span><span class="o">=</span>established --timeout<span class="o">=</span>60s crd/applications.app.k8s.io
</span></span><span class="line"><span class="cl">kubectl apply -k <span class="s2">&#34;github.com/kubeflow/pipelines/manifests/kustomize/env/platform-agnostic-pns?ref=</span><span class="nv">$PIPELINE_VERSION</span><span class="s2">&#34;</span>
</span></span></code></pre></div><p>The Kubeflow Pipelines deployment may take several minutes to complete.</p>
</li>
<li>
<p>Verify that the Kubeflow Pipelines UI is accessible by port-forwarding:</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-shell" data-lang="shell"><span class="line"><span class="cl">kubectl port-forward -n kubeflow svc/ml-pipeline-ui 8080:80
</span></span></code></pre></div><p>Then, open the Kubeflow Pipelines UI at <code>http://localhost:8080/</code> or - if you are
using kind or K3s within a virtual machine - <code>http://{YOUR_VM_IP_ADDRESS}:8080/</code></p>
<p>Note that K3ai will automatically print the URL for the web UI at the end of
the installation process.</p>
<p><strong>Note</strong>: <code>kubectl apply -k</code> accepts local paths and paths that are
formatted as
<a href="https://github.com/kubernetes-sigs/kustomize/blob/master/examples/remoteBuild.md#url-format">hashicorp/go-getter URLs</a>.
While the paths in the preceding commands look like URLs, they are not valid
URLs.</p>
</li>
</ol>
<h2 id="uninstalling-kubeflow-pipelines">Uninstalling Kubeflow Pipelines</h2>
<p>Below are the steps to remove Kubeflow Pipelines on kind, K3s, or K3ai:</p>
<ul>
<li>
<p>To uninstall Kubeflow Pipelines using your manifest file, run the following command,
replacing <code>{YOUR_MANIFEST_FILE}</code> with the name of your manifest file:</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-shell" data-lang="shell"><span class="line"><span class="cl">kubectl delete -k <span class="o">{</span>YOUR_MANIFEST_FILE<span class="o">}</span><span class="sb">`</span>
</span></span></code></pre></div></li>
<li>
<p>To uninstall Kubeflow Pipelines using manifests from Kubeflow Pipelines&rsquo;s
GitHub repository, run these commands:</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-shell" data-lang="shell"><span class="line"><span class="cl"><span class="nb">export</span> <span class="nv">PIPELINE_VERSION</span><span class="o">=</span>1.8.5
</span></span><span class="line"><span class="cl">kubectl delete -k <span class="s2">&#34;github.com/kubeflow/pipelines/manifests/kustomize/env/platform-agnostic-pns?ref=</span><span class="nv">$PIPELINE_VERSION</span><span class="s2">&#34;</span>
</span></span><span class="line"><span class="cl">kubectl delete -k <span class="s2">&#34;github.com/kubeflow/pipelines/manifests/kustomize/cluster-scoped-resources?ref=</span><span class="nv">$PIPELINE_VERSION</span><span class="s2">&#34;</span>
</span></span></code></pre></div></li>
<li>
<p>To uninstall Kubeflow Pipelines using manifests from your local repository or
file system, run the following commands:</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-shell" data-lang="shell"><span class="line"><span class="cl">kubectl delete -k manifests/kustomize/env/platform-agnostic-pns
</span></span><span class="line"><span class="cl">kubectl delete -k manifests/kustomize/cluster-scoped-resources
</span></span></code></pre></div></li>
</ul>

</div>



    
	
  
    
    
	
    

<div class="td-content" style="page-break-before: always">
    
	<h1 id="pg-66adf3067d8aebc177db56ac3216c29d">3.1.4.3 - Standalone Deployment</h1>
    <div class="lead">Information about Standalone Deployment of Kubeflow Pipelines</div>
	<p>As an alternative to deploying Kubeflow Pipelines (KFP) as part of the
<a href="/docs/started/getting-started/#installing-kubeflow">Kubeflow deployment</a>, you also have a choice
to deploy only Kubeflow Pipelines. Follow the instructions below to deploy
Kubeflow Pipelines standalone using the supplied kustomize manifests.</p>
<p>You should be familiar with <a href="https://kubernetes.io/docs/home/">Kubernetes</a>,
<a href="https://kubernetes.io/docs/reference/kubectl/overview/">kubectl</a>, and <a href="https://kustomize.io/">kustomize</a>.</p>


<div class="alert alert-info" role="alert">
<h4 class="alert-heading">Installation options for Kubeflow Pipelines standalone</h4>

    This guide currently describes how to install Kubeflow Pipelines standalone
on Google Cloud Platform (GCP). You can also install Kubeflow Pipelines standalone on other
platforms. This guide needs updating. See <a href="https://github.com/kubeflow/website/issues/1253">Issue 1253</a>.

</div>

<h2 id="before-you-get-started">Before you get started</h2>
<p>Working with Kubeflow Pipelines Standalone requires a Kubernetes cluster as well as an installation of kubectl.</p>
<h3 id="download-and-install-kubectl">Download and install kubectl</h3>
<p>Download and install kubectl by following the <a href="https://kubernetes.io/docs/tasks/tools/install-kubectl/">kubectl installation guide</a>.</p>
<p>You need kubectl version 1.14 or higher for native support of kustomize.</p>
<h3 id="set-up-your-cluster">Set up your cluster</h3>
<p>If you have an existing Kubernetes cluster, continue with the instructions for <a href="#configure-kubectl">configuring kubectl to talk to your cluster</a>.</p>
<p>See the GKE guide to <a href="https://cloud.google.com/kubernetes-engine/docs/how-to/creating-a-cluster">creating a cluster</a> for Google Cloud Platform (GCP).</p>
<p>Use the <a href="https://cloud.google.com/sdk/gcloud/reference/container/clusters/create">gcloud container clusters create command</a> to create a cluster that can run all Kubeflow Pipelines samples:</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-fallback" data-lang="fallback"><span class="line"><span class="cl"># The following parameters can be customized based on your needs.
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">CLUSTER_NAME=&#34;kubeflow-pipelines-standalone&#34;
</span></span><span class="line"><span class="cl">ZONE=&#34;us-central1-a&#34;
</span></span><span class="line"><span class="cl">MACHINE_TYPE=&#34;e2-standard-2&#34; # A machine with 2 CPUs and 8GB memory.
</span></span><span class="line"><span class="cl">SCOPES=&#34;cloud-platform&#34; # This scope is needed for running some pipeline samples. Read the warning below for its security implication
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">gcloud container clusters create $CLUSTER_NAME \
</span></span><span class="line"><span class="cl">     --zone $ZONE \
</span></span><span class="line"><span class="cl">     --machine-type $MACHINE_TYPE \
</span></span><span class="line"><span class="cl">     --scopes $SCOPES
</span></span></code></pre></div><p><strong>Note</strong>: <code>e2-standard-2</code> doesn&rsquo;t support GPU. You can choose machine types that meet your need by referring to guidance in <a href="http://cloud/compute/docs/machine-types">Cloud Machine families</a>.</p>
<p><strong>Warning</strong>: Using <code>SCOPES=&quot;cloud-platform&quot;</code> grants all GCP permissions to the cluster. For a more secure cluster setup, refer to <a href="/docs/gke/authentication/#authentication-from-kubeflow-pipelines">Authenticating Pipelines to GCP</a>.</p>
<p>Note, some legacy pipeline examples may need minor code change to run on clusters with <code>SCOPES=&quot;cloud-platform&quot;</code>, refer to <a href="/docs/gke/pipelines/authentication-pipelines/#authoring-pipelines-to-use-default-service-account">Authoring Pipelines to use default service account</a>.</p>
<p><strong>References</strong>:</p>
<ul>
<li>
<p><a href="https://cloud.google.com/compute/docs/regions-zones/#available">GCP regions and zones documentation</a></p>
</li>
<li>
<p><a href="https://cloud.google.com/sdk/gcloud/">gcloud command-line tool guide</a></p>
</li>
<li>
<p><a href="https://cloud.google.com/sdk/gcloud/reference/container/clusters/create">gcloud command reference</a></p>
</li>
</ul>
<h3 id="configure-kubectl">Configure kubectl to talk to your cluster</h3>
<p>See the Google Kubernetes Engine (GKE) guide to
<a href="https://cloud.google.com/kubernetes-engine/docs/how-to/cluster-access-for-kubectl">configuring cluster access for kubectl</a>.</p>
<h2 id="deploying-kubeflow-pipelines">Deploying Kubeflow Pipelines</h2>
<ol>
<li>
<p>Deploy the Kubeflow Pipelines:</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-fallback" data-lang="fallback"><span class="line"><span class="cl">export PIPELINE_VERSION=1.8.5
</span></span><span class="line"><span class="cl">kubectl apply -k &#34;github.com/kubeflow/pipelines/manifests/kustomize/cluster-scoped-resources?ref=$PIPELINE_VERSION&#34;
</span></span><span class="line"><span class="cl">kubectl wait --for condition=established --timeout=60s crd/applications.app.k8s.io
</span></span><span class="line"><span class="cl">kubectl apply -k &#34;github.com/kubeflow/pipelines/manifests/kustomize/env/dev?ref=$PIPELINE_VERSION&#34;
</span></span></code></pre></div><p>The Kubeflow Pipelines deployment requires approximately 3 minutes to complete.</p>
<p><strong>Note</strong>: The above commands apply to Kubeflow Pipelines version 0.4.0 and higher.</p>
<p>For Kubeflow Pipelines version 0.2.0 ~ 0.3.0, use:</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-fallback" data-lang="fallback"><span class="line"><span class="cl">export PIPELINE_VERSION=&lt;kfp-version-between-0.2.0-and-0.3.0&gt;
</span></span><span class="line"><span class="cl">kubectl apply -k &#34;github.com/kubeflow/pipelines/manifests/kustomize/base/crds?ref=$PIPELINE_VERSION&#34;
</span></span><span class="line"><span class="cl">kubectl wait --for condition=established --timeout=60s crd/applications.app.k8s.io
</span></span><span class="line"><span class="cl">kubectl apply -k &#34;github.com/kubeflow/pipelines/manifests/kustomize/env/dev?ref=$PIPELINE_VERSION&#34;
</span></span></code></pre></div><p>For Kubeflow Pipelines version &lt; 0.2.0, use:</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-fallback" data-lang="fallback"><span class="line"><span class="cl">export PIPELINE_VERSION=&lt;kfp-version-0.1.x&gt;
</span></span><span class="line"><span class="cl">kubectl apply -k &#34;github.com/kubeflow/pipelines/manifests/kustomize/env/dev?ref=$PIPELINE_VERSION&#34;
</span></span></code></pre></div><p><strong>Note</strong>: <code>kubectl apply -k</code> accepts local paths and paths that are formatted as <a href="https://github.com/kubernetes-sigs/kustomize/blob/master/examples/remoteBuild.md#url-format">hashicorp/go-getter URLs</a>. While the paths in the preceding commands look like URLs, the paths are not valid URLs.</p>


<div class="alert alert-warning" role="alert">
<h4 class="alert-heading">Deprecation Notice</h4>

    <p>Kubeflow Pipelines will change default executor from Docker to Emissary starting KFP backend v1.8, docker executor has been
deprecated on Kubernetes 1.20+.</p>
<p>For Kubeflow Pipelines before v1.8, configure to use Emissary executor by
referring to <a href="/docs/components/pipelines/installation/choose-executor">Argo Workflow Executors</a>.</p>


</div>

</li>
<li>
<p>Get the public URL for the Kubeflow Pipelines UI and use it to access the Kubeflow Pipelines UI:</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-fallback" data-lang="fallback"><span class="line"><span class="cl">kubectl describe configmap inverse-proxy-config -n kubeflow | grep googleusercontent.com
</span></span></code></pre></div></li>
</ol>
<h2 id="upgrading-kubeflow-pipelines">Upgrading Kubeflow Pipelines</h2>
<ol>
<li>
<p>For release notices and breaking changes, refer to <a href="/docs/components/pipelines/upgrade">Upgrading Kubeflow Pipelines</a>.</p>
</li>
<li>
<p>Check the <a href="https://github.com/kubeflow/pipelines/releases">Kubeflow Pipelines GitHub repository</a> for available releases.</p>
</li>
<li>
<p>To upgrade to Kubeflow Pipelines 0.4.0 and higher, use the following commands:</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-fallback" data-lang="fallback"><span class="line"><span class="cl">export PIPELINE_VERSION=&lt;version-you-want-to-upgrade-to&gt;
</span></span><span class="line"><span class="cl">kubectl apply -k &#34;github.com/kubeflow/pipelines/manifests/kustomize/cluster-scoped-resources?ref=$PIPELINE_VERSION&#34;
</span></span><span class="line"><span class="cl">kubectl wait --for condition=established --timeout=60s crd/applications.app.k8s.io
</span></span><span class="line"><span class="cl">kubectl apply -k &#34;github.com/kubeflow/pipelines/manifests/kustomize/env/dev?ref=$PIPELINE_VERSION&#34;
</span></span></code></pre></div><p>To upgrade to Kubeflow Pipelines 0.3.0 and lower, use the <a href="#deploying-kubeflow-pipelines">deployment instructions</a> to upgrade your Kubeflow Pipelines cluster.</p>
</li>
<li>
<p>Delete obsolete resources manually.</p>
<p>Depending on the version you are upgrading from and the version you are upgrading to,
some Kubeflow Pipelines resources may have become obsolete.</p>
<p>If you are upgrading from Kubeflow Pipelines &lt; 0.4.0 to 0.4.0 or above, you can remove the
following obsolete resources after the upgrade:
<code>metadata-deployment</code>, <code>metadata-service</code>.</p>
<p>Run the following command to check if these resources exist on your cluster:</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-fallback" data-lang="fallback"><span class="line"><span class="cl">kubectl -n &lt;KFP_NAMESPACE&gt; get deployments | grep metadata-deployment
</span></span><span class="line"><span class="cl">kubectl -n &lt;KFP_NAMESPACE&gt; get service | grep metadata-service
</span></span></code></pre></div><p>If these resources exist on your cluster, run the following commands to delete them:</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-fallback" data-lang="fallback"><span class="line"><span class="cl">kubectl -n &lt;KFP_NAMESPACE&gt; delete deployment metadata-deployment
</span></span><span class="line"><span class="cl">kubectl -n &lt;KFP_NAMESPACE&gt; delete service metadata-service
</span></span></code></pre></div><p>For other versions, you don&rsquo;t need to do anything.</p>
</li>
</ol>
<h2 id="customizing-kubeflow-pipelines">Customizing Kubeflow Pipelines</h2>
<p>Kubeflow Pipelines can be configured through kustomize <a href="https://github.com/kubernetes-sigs/kustomize/blob/master/docs/glossary.md#overlay">overlays</a>.</p>
<p>To begin, first clone the <a href="https://github.com/kubeflow/pipelines">Kubeflow Pipelines GitHub repository</a>,
and use it as your working directory.</p>
<h3 id="deploy-on-gcp-with-cloud-sql-and-google-cloud-storage">Deploy on GCP with Cloud SQL and Google Cloud Storage</h3>
<p><strong>Note</strong>: This is recommended for production environments. For more details about customizing your environment
for GCP, see the <a href="https://github.com/kubeflow/pipelines/tree/sdk/release-1.8/manifests/kustomize/env/gcp">Kubeflow Pipelines GCP manifests</a>.</p>
<h3 id="change-deployment-namespace">Change deployment namespace</h3>
<p>To deploy Kubeflow Pipelines standalone in namespace <code>&lt;my-namespace&gt;</code>:</p>
<ol>
<li>
<p>Set the <code>namespace</code> field to <code>&lt;my-namespace&gt;</code> in
<a href="https://github.com/kubeflow/pipelines/blob/sdk/release-1.8/manifests/kustomize/env/dev/kustomization.yaml">dev/kustomization.yaml</a> or
<a href="https://github.com/kubeflow/pipelines/blob/sdk/release-1.8/manifests/kustomize/env/gcp/kustomization.yaml">gcp/kustomization.yaml</a>.</p>
</li>
<li>
<p>Set the <code>namespace</code> field to <code>&lt;my-namespace&gt;</code> in <a href="https://github.com/kubeflow/pipelines/blob/sdk/release-1.8/manifests/kustomize/cluster-scoped-resources/kustomization.yaml">cluster-scoped-resources/kustomization.yaml</a></p>
</li>
<li>
<p>Apply the changes to update the Kubeflow Pipelines deployment:</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-fallback" data-lang="fallback"><span class="line"><span class="cl">kubectl apply -k manifests/kustomize/cluster-scoped-resources
</span></span><span class="line"><span class="cl">kubectl apply -k manifests/kustomize/env/dev
</span></span></code></pre></div><p><strong>Note</strong>: If using GCP Cloud SQL and Google Cloud Storage, set the proper values in <a href="https://github.com/kubeflow/pipelines/blob/sdk/release-1.8/manifests/kustomize/env/gcp/params.env">manifests/kustomize/env/gcp/params.env</a>, then apply with this command:</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-fallback" data-lang="fallback"><span class="line"><span class="cl">kubectl apply -k manifests/kustomize/cluster-scoped-resources
</span></span><span class="line"><span class="cl">kubectl apply -k manifests/kustomize/env/gcp
</span></span></code></pre></div></li>
</ol>
<h3 id="disable-the-public-endpoint">Disable the public endpoint</h3>
<p>By default, the KFP standalone deployment installs an <a href="https://github.com/google/inverting-proxy">inverting proxy agent</a> that exposes a public URL. If you want to skip the installation of the inverting proxy agent, complete the following:</p>
<ol>
<li>
<p>Comment out the proxy components in the base <code>kustomization.yaml</code>. For example in <a href="https://github.com/kubeflow/pipelines/blob/sdk/release-1.8/manifests/kustomize/env/dev/kustomization.yaml">manifests/kustomize/env/dev/kustomization.yaml</a> comment out <code>inverse-proxy</code>.</p>
</li>
<li>
<p>Apply the changes to update the Kubeflow Pipelines deployment:</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-fallback" data-lang="fallback"><span class="line"><span class="cl">kubectl apply -k manifests/kustomize/env/dev
</span></span></code></pre></div><p><strong>Note</strong>: If using GCP Cloud SQL and Google Cloud Storage, set the proper values in <a href="https://github.com/kubeflow/pipelines/blob/sdk/release-1.8/manifests/kustomize/env/gcp/params.env">manifests/kustomize/env/gcp/params.env</a>, then apply with this command:</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-fallback" data-lang="fallback"><span class="line"><span class="cl">kubectl apply -k manifests/kustomize/env/gcp
</span></span></code></pre></div></li>
<li>
<p>Verify that the Kubeflow Pipelines UI is accessible by port-forwarding:</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-fallback" data-lang="fallback"><span class="line"><span class="cl">kubectl port-forward -n kubeflow svc/ml-pipeline-ui 8080:80
</span></span></code></pre></div></li>
<li>
<p>Open the Kubeflow Pipelines UI at <code>http://localhost:8080/</code>.</p>
</li>
</ol>
<h2 id="uninstalling-kubeflow-pipelines">Uninstalling Kubeflow Pipelines</h2>
<p>To uninstall Kubeflow Pipelines, run <code>kubectl delete -k &lt;manifest-file&gt;</code>.</p>
<p>For example, to uninstall KFP using manifests from a GitHub repository, run:</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-fallback" data-lang="fallback"><span class="line"><span class="cl">export PIPELINE_VERSION=1.8.5
</span></span><span class="line"><span class="cl">kubectl delete -k &#34;github.com/kubeflow/pipelines/manifests/kustomize/env/dev?ref=$PIPELINE_VERSION&#34;
</span></span><span class="line"><span class="cl">kubectl delete -k &#34;github.com/kubeflow/pipelines/manifests/kustomize/cluster-scoped-resources?ref=$PIPELINE_VERSION&#34;
</span></span></code></pre></div><p>To uninstall KFP using manifests from your local repository or file system, run:</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-fallback" data-lang="fallback"><span class="line"><span class="cl">kubectl delete -k manifests/kustomize/env/dev
</span></span><span class="line"><span class="cl">kubectl delete -k manifests/kustomize/cluster-scoped-resources
</span></span></code></pre></div><p><strong>Note</strong>: If you are using GCP Cloud SQL and Google Cloud Storage, run:</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-fallback" data-lang="fallback"><span class="line"><span class="cl">kubectl delete -k manifests/kustomize/env/gcp
</span></span><span class="line"><span class="cl">kubectl delete -k manifests/kustomize/cluster-scoped-resources
</span></span></code></pre></div><h2 id="best-practices-for-maintaining-manifests">Best practices for maintaining manifests</h2>
<p>Similar to source code, configuration files belong in source control.
A repository manages the changes to your
manifest files and ensures that you can repeatedly deploy, upgrade,
and uninstall your components.</p>
<h3 id="maintain-your-manifests-in-source-control">Maintain your manifests in source control</h3>
<p>After creating or customizing your deployment manifests, save your manifests
to a local or remote source control repository.
For example, save the following <code>kustomization.yaml</code>:</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-fallback" data-lang="fallback"><span class="line"><span class="cl"># kustomization.yaml
</span></span><span class="line"><span class="cl">apiVersion: kustomize.config.k8s.io/v1beta1
</span></span><span class="line"><span class="cl">kind: Kustomization
</span></span><span class="line"><span class="cl"># Edit the following to change the deployment to your custom namespace.
</span></span><span class="line"><span class="cl">namespace: kubeflow
</span></span><span class="line"><span class="cl"># You can add other customizations here using kustomize.
</span></span><span class="line"><span class="cl"># Edit ref in the following link to deploy a different version of Kubeflow Pipelines.
</span></span><span class="line"><span class="cl">bases:
</span></span><span class="line"><span class="cl">- github.com/kubeflow/pipelines/manifests/kustomize/env/dev?ref=1.8.5
</span></span></code></pre></div><h3 id="further-reading">Further reading</h3>
<ul>
<li>To learn about kustomize workflows with off-the-shelf configurations, see the
<a href="https://github.com/kubernetes-sigs/kustomize/blob/master/docs/workflows.md#off-the-shelf-configuration">kustomize configuration workflows guide</a>.</li>
</ul>
<h2 id="troubleshooting">Troubleshooting</h2>
<ul>
<li>If your pipelines are stuck in ContainerCreating state and it has pod events like</li>
</ul>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-fallback" data-lang="fallback"><span class="line"><span class="cl">MountVolume.SetUp failed for volume &#34;gcp-credentials-user-gcp-sa&#34; : secret &#34;user-gcp-sa&#34; not found
</span></span></code></pre></div><p>You should remove <code>use_gcp_secret</code> usages as documented in <a href="/docs/distributions/gke/pipelines/authentication-pipelines/#authoring-pipelines-to-use-workload-identity">Authenticating Pipelines to GCP</a>.</p>
<h2 id="whats-next">What&rsquo;s next</h2>
<ul>
<li><a href="/docs/distributions/gke/pipelines/authentication-sdk/#connecting-to-kubeflow-pipelines-standalone-or-ai-platform-pipelines">Connecting to Kubeflow Pipelines standalone on Google Cloud using the SDK</a></li>
<li><a href="/docs/distributions/gke/pipelines/authentication-pipelines/#authoring-pipelines-to-use-workload-identity">Authenticating Pipelines to GCP</a> if you want to use GCP services in Kubeflow Pipelines.</li>
</ul>

</div>



    
	
  
    
    
	
    

<div class="td-content" style="page-break-before: always">
    
	<h1 id="pg-fd77b2375cf26c5efa8e44515f653900">3.1.4.4 - Choosing an Argo Workflows Executor</h1>
    <div class="lead">How to choose an Argo Workflows Executor</div>
	<p>An Argo workflow executor is a process that conforms to a specific interface that allows Argo to perform certain actions like monitoring pod logs, collecting artifacts, managing container lifecycles, etc.</p>
<p>Kubeflow Pipelines runs on <a href="https://argoproj.github.io/workflows/">Argo Workflows</a> as the workflow engine, so Kubeflow Pipelines users need to choose a workflow executor.</p>
<h2 id="choosing-the-workflow-executor">Choosing the Workflow Executor</h2>
<ol>
<li>
<p>Some users may value stability and backward compatibility. For example, if you
are running Kubeflow Pipelines in a production cluster or you maintain production
pipelines that you don&rsquo;t want to break or migrate.</p>
<p>In this case, we recommend you use <a href="#docker-executor">docker executor</a> and configure your Kubernetes nodes to use docker container runtime.</p>
<p>However, Kubernetes is deprecating docker as a container runtime, so we recommend
starting to try out emissary and prepare for a migration when it&rsquo;s stable.</p>
</li>
<li>
<p>For users less concerned with stability and backwards compatibility, we
recommend trying out the new <a href="#emissary-executor">emissary executor</a>.</p>
</li>
</ol>
<p>Note that Argo Workflows support other workflow executors, but the Kubeflow Pipelines
team only recommend choosing between docker executor and emissary executor.</p>
<h3 id="docker-executor">Docker Executor</h3>
<p>Docker executor is the <strong>default</strong> workflow executor. But Kubeflow Pipelines v1.8 will switch to Emissary Executor as default executor.</p>


<div class="alert alert-warning" role="alert">
<h4 class="alert-heading">Warning</h4>

    Docker executor depends on docker container runtime, which will be deprecated on Kubernetes 1.20+.

</div>

<ul>
<li>Container Runtime: docker only. However, <a href="https://kubernetes.io/blog/2020/12/02/dont-panic-kubernetes-and-docker/">Kubernetes is deprecating Docker as a container runtime after v1.20</a>.
On Google Kubernetes Engine (GKE) 1.19+, container runtime already defaults to containerd.</li>
<li>Reliability: most well-tested and most popular argo workflows executor</li>
<li>Security: least secure
<ul>
<li>It requires <code>privileged</code> access to <code>docker.sock</code> of the host to be mounted which.
Often rejected by Open Policy Agent (OPA) or your Pod Security Policy (PSP).
GKE autopilot mode also rejects it, because <a href="https://cloud.google.com/kubernetes-engine/docs/concepts/autopilot-overview#no_privileged_pods">No privileged Pods</a>.</li>
<li>It can escape the privileges of the pod&rsquo;s service account.</li>
</ul>
</li>
</ul>
<h4 id="prepare-a-gke-cluster-for-docker-executor">Prepare a GKE cluster for Docker Executor</h4>
<p>For GKE, the node image decides which container runtime is used. To use docker
container runtime, you need to <a href="https://cloud.google.com/kubernetes-engine/docs/how-to/node-images">specify a node image</a> with Docker.</p>
<p>You must use one of the following node images:</p>
<ul>
<li>Container-Optimized OS with Docker (cos)</li>
<li>Ubuntu with Docker (ubuntu)</li>
</ul>
<p>If your nodes are not using docker as container runtime, when you run pipelines
you will always find error messages like:</p>
<blockquote>
<p>This step is in Error state with this message: failed to save outputs: Error response from daemon: No such container: XXXXXX</p>
</blockquote>
<h3 id="emissary-executor">Emissary Executor</h3>
<div class="alert alert-warning" role="alert">
  <h4 class="alert-heading">Alpha</h4>
  This Kubeflow component has <b>alpha</b> status with limited support. See the
  <a href="/docs/started/support/#application-status">Kubeflow versioning policies</a>.
  The Kubeflow team is interested in your   
  <a href="https://github.com/kubeflow/pipelines/issues/6249">feedback</a></h4> 
  about the usability of the feature.
</div>
<p>Emissary executor is a new workflow executor. It was first released in Argo Workflows v3.1 (June 2021).
However, the Kubeflow Pipelines team believe that its architectural and portability
improvements can make it the default executor that most people should use in the
future.</p>
<p>Therefore, the team makes a commitment to actively collect feedback and fix bugs
for the emissary executor, so that we can stablize it faster.
Submit your feedback in <a href="https://github.com/kubeflow/pipelines/issues/6249">the Emissary Executor feedback github issue</a>.</p>
<p>So far, Kubeflow
Pipelines test infrastructure has been running stably with the emissary executor.</p>
<ul>
<li>
<p>Container Runtime: any</p>
</li>
<li>
<p>Reliability: not yet well-tested and not yet popular, but the Kubeflow Pipelines
team supports it.</p>
</li>
<li>
<p>Security: more secure</p>
<ul>
<li>No <code>privileged</code> access.</li>
<li>Cannot escape the privileges of the pod&rsquo;s service account.</li>
</ul>
</li>
<li>
<p>Migration: <code>command</code> must be specified in <a href="https://www.kubeflow.org/docs/components/pipelines/reference/component-spec/">Kubeflow Pipelines component specification</a>.</p>
<p>Note, the same migration requirement is required by <a href="https://www.kubeflow.org/docs/components/pipelines/sdk-v2/v2-compatibility/">Kubeflow Pipelines v2 compatible mode</a>, refer to
<a href="https://github.com/kubeflow/pipelines/issues/6133">known caveats &amp; breaking changes</a>.</p>
</li>
</ul>
<h4 id="migrate-to-emissary-executor">Migrate to Emissary Executor</h4>
<p>Prerequisite: emissary executor is only available in Kubeflow Pipelines backend version 1.7+.
To upgrade, refer to <a href="/docs/components/pipelines/upgrade/">upgrading Kubeflow Pipelines</a>.</p>
<h5 id="configure-an-existing-kubeflow-pipelines-cluster-to-use-emissary-executor">Configure an existing Kubeflow Pipelines cluster to use emissary executor</h5>
<ol>
<li>
<p>Install <a href="https://kubernetes.io/docs/tasks/tools/#kubectl">kubectl</a>.</p>
</li>
<li>
<p>Connect to your cluster via kubectl.</p>
</li>
<li>
<p>Switch to the namespace you installed Kubeflow Pipelines:</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash"><span class="line"><span class="cl">kubectl config set-context --current --namespace &lt;your-kfp-namespace&gt;
</span></span></code></pre></div><p>Note, usually it&rsquo;s <code>kubeflow</code> or <code>default</code>.</p>
</li>
<li>
<p>Confirm current workflow executor:</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash"><span class="line"><span class="cl">kubectl describe configmap workflow-controller-configmap <span class="p">|</span> grep -A <span class="m">2</span> containerRuntimeExecutor
</span></span></code></pre></div><p>You&rsquo;ll see output like the following when using docker executor:</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-text" data-lang="text"><span class="line"><span class="cl">containerRuntimeExecutor:
</span></span><span class="line"><span class="cl">----
</span></span><span class="line"><span class="cl">docker
</span></span></code></pre></div></li>
<li>
<p>Configure workflow executor to emissary:</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash"><span class="line"><span class="cl">kubectl patch configmap workflow-controller-configmap --patch <span class="s1">&#39;{&#34;data&#34;:{&#34;containerRuntimeExecutor&#34;:&#34;emissary&#34;}}&#39;</span>
</span></span></code></pre></div></li>
<li>
<p>Confirm workflow executor is changed successfully:</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash"><span class="line"><span class="cl">kubectl describe configmap workflow-controller-configmap <span class="p">|</span> grep -A <span class="m">2</span> containerRuntimeExecutor
</span></span></code></pre></div><p>You&rsquo;ll see output like the following:</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-text" data-lang="text"><span class="line"><span class="cl">containerRuntimeExecutor:
</span></span><span class="line"><span class="cl">----
</span></span><span class="line"><span class="cl">emissary
</span></span></code></pre></div></li>
</ol>
<h5 id="deploy-a-new-kubeflow-pipelines-cluster-with-emissary-executor">Deploy a new Kubeflow Pipelines cluster with emissary executor</h5>
<p>For <a href="https://cloud.google.com/ai-platform/pipelines/docs">AI Platform Pipelines</a>, check the &ldquo;Use emissary executor&rdquo; checkbox during installation.</p>
<p>For <a href="https://www.kubeflow.org/docs/components/pipelines/installation/standalone-deployment/">Kubeflow Pipelines Standalone</a>, install <code>env/platform-agnostic-emissary</code>:</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash"><span class="line"><span class="cl">kubectl apply -k <span class="s2">&#34;github.com/kubeflow/pipelines/manifests/kustomize/env/platform-agnostic-emissary?ref=</span><span class="nv">$PIPELINE_VERSION</span><span class="s2">&#34;</span>
</span></span></code></pre></div><p>When in doubt, you can always deploy your Kubeflow Pipelines cluster first and
configure workflow executor after installation using the instructions for
existing clusters.</p>
<h5 id="migrate-pipeline-components-to-run-on-emissary-executor">Migrate pipeline components to run on emissary executor</h5>
<p>Some pipeline components require manual updates to run on emissary executor.
For <a href="https://www.kubeflow.org/docs/components/pipelines/reference/component-spec/">Kubeflow Pipelines component specification</a> YAML,
the <code>command</code> field must be specified.</p>
<p>Step by step component migration tutorial:</p>
<ol>
<li>
<p>There is a hello world component:</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-yaml" data-lang="yaml"><span class="line"><span class="cl"><span class="nt">name</span><span class="p">:</span><span class="w"> </span><span class="l">hello-world</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="nt">implementation</span><span class="p">:</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">  </span><span class="nt">container</span><span class="p">:</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="nt">image</span><span class="p">:</span><span class="w"> </span><span class="l">hello-world</span><span class="w">
</span></span></span></code></pre></div></li>
<li>
<p>We can run the container without command/args:</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash"><span class="line"><span class="cl">$ docker run hello-world
</span></span><span class="line"><span class="cl">Hello from Docker!
</span></span><span class="line"><span class="cl">...
</span></span></code></pre></div></li>
<li>
<p>Find out what the default ENTRYPOINT and CMD is in the image:</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash"><span class="line"><span class="cl">$ docker image inspect -f <span class="s1">&#39;{{.Config.Entrypoint}} {{.Config.Cmd}}&#39;</span> hello-world
</span></span><span class="line"><span class="cl"><span class="o">[]</span> <span class="o">[</span>/hello<span class="o">]</span>
</span></span></code></pre></div><p>So ENTRYPOINT is not specified, and CMD is [&quot;/hello&quot;].
Note, ENTRYPOINT roughly means <code>command</code> and CMD roughly
means <code>arguments</code>. <code>command</code> and <code>arguments</code> are concatenated as the user
command.</p>
</li>
<li>
<p>Update the component YAML:</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-yaml" data-lang="yaml"><span class="line"><span class="cl"><span class="nt">name</span><span class="p">:</span><span class="w"> </span><span class="l">hello-world</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="nt">implementation</span><span class="p">:</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">  </span><span class="nt">container</span><span class="p">:</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="nt">image</span><span class="p">:</span><span class="w"> </span><span class="l">hello-world</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="nt">command</span><span class="p">:</span><span class="w"> </span><span class="p">[</span><span class="s2">&#34;/hello&#34;</span><span class="p">]</span><span class="w">
</span></span></span></code></pre></div></li>
<li>
<p>The updated component can run on emissary executor now.</p>
</li>
</ol>
<p>Note: Kubeflow Pipelines SDK compiler always specifies a command for
<a href="https://www.kubeflow.org/docs/components/pipelines/sdk/python-function-components/">python function based components</a>.
Therefore, these components will continue to work on emissary executor without
modifications.</p>
<h2 id="references">References</h2>
<ul>
<li><a href="https://argoproj.github.io/argo-workflows/workflow-executors/">Argo Workflow Executors documentation</a></li>
<li>KFP docker executor doesn&rsquo;t support Kubernetes 1.19 or above <a href="https://github.com/kubeflow/pipelines/issues/5714">kubeflow/pipelines#5714</a></li>
<li>Feature request - default to emissary executor <a href="https://github.com/kubeflow/pipelines/issues/5718">kubeflow/pipelines#5718</a></li>
</ul>

</div>



    
	
  
    
    
	
    

<div class="td-content" style="page-break-before: always">
    
	<h1 id="pg-15348c81205e7f1ec62291a74fc14992">3.1.4.5 - Upgrade Notes</h1>
    <div class="lead">Notices and breaking changes when you upgrade Kubeflow Pipelines Backend</div>
	<p>This page introduces notices and breaking changes you need to know when upgrading Kubeflow Pipelines Backend.</p>
<p>For upgrade instructions, refer to distribution specific documentations:</p>
<ul>
<li><a href="/docs/distributions/gke/pipelines/upgrade/">Upgrading Kubeflow Pipelines on Google Cloud</a></li>
</ul>
<h2 id="upgrading-to-v17">Upgrading to <a href="https://github.com/kubeflow/pipelines/releases/tag/1.7.0">v1.7</a></h2>
<ul>
<li>
<p><strong>Breaking Change</strong>: Metadata UI and visualizations are not compatible with TensorFlow Extended (TFX) &lt;= v1.0.0. Upgrade to v1.2.0 or above, refer to <a href="/docs/components/pipelines/installation/compatibility-matrix/">Kubeflow Pipelines Backend and TensorFlow Extended (TFX) compatibility matrix</a>.</p>
</li>
<li>
<p><strong>Notice</strong>: Emissary executor (Alpha), a new argo workflow executor is available as an option. Due to <a href="https://kubernetes.io/blog/2020/12/02/dont-panic-kubernetes-and-docker/">Kubernetes deprecating Docker as a container runtime after v1.20</a>, emissary may become the default workflow executor for Kubeflow Pipelines in the near future.</p>
<p>For example, the current default docker executor does not work on Google Kubernetes Engine (GKE) 1.19+ out of the box. To use docker executor, your cluster node image must be configured to use docker (deprecated) as container runtime.</p>
<p>Alternatively, using emissary executor (Alpha) removes the restriction on container runtime, but note some of your pipelines may require manual migrations. The Kubeflow Pipelines team welcomes your feedback in <a href="https://github.com/kubeflow/pipelines/issues/6249">the Emissary Executor feedback github issue</a>.</p>
<p>For detailed configuration and migration instructions for both options, refer to <a href="https://www.kubeflow.org/docs/components/pipelines/installation/choose-executor/">Argo Workflow Executors</a>.</p>
</li>
<li>
<p><strong>Notice</strong>: <a href="/docs/components/pipelines/sdk-v2/v2-compatibility/">Kubeflow Pipelines SDK v2 compatibility mode</a> (Beta) was recently released. The new mode adds support for tracking pipeline runs and artifacts using ML Metadata. In v1.7 backend, complete UI support and caching capabilities for v2 compatibility mode are newly added. We welcome any <a href="https://github.com/kubeflow/pipelines/issues/6451">feedback</a> on positive experiences or issues you encounter.</p>
</li>
</ul>

</div>



    
	
  
    
    
	
    

<div class="td-content" style="page-break-before: always">
    
	<h1 id="pg-6f46cfeabcf176dd38dca8992b1dc5d5">3.1.4.6 - Compatibility Matrix</h1>
    <div class="lead">Kubeflow Pipelines compatibility matrix with TensorFlow Extended (TFX)</div>
	<h2 id="kubeflow-pipelines-backend-and-tfx-compatibility">Kubeflow Pipelines Backend and TFX compatibility</h2>
<p>Pipelines written in any version of <a href="https://www.tensorflow.org/tfx">TensorFlow Extended (TFX)</a> will execute on any version of Kubeflow Pipelines (KFP) backend. However, some UI features may not be functioning properly if the TFX and Kubeflow Pipelines Backend versions are not compatible.</p>
<p>The following table shows UI feature compatibility for TFX and Kubeflow Pipelines Backend versions:</p>
<table>
<thead>
<tr>
<th><a href="https://github.com/tensorflow/tfx/releases">TFX</a> \ <a href="https://github.com/kubeflow/pipelines/releases">KFP Backend</a></th>
<th><a href="https://github.com/kubeflow/pipelines/releases">KFP Backend</a> &lt;= 1.5</th>
<th><a href="https://github.com/kubeflow/pipelines/releases">KFP Backend</a> &gt;= 1.7</th>
</tr>
</thead>
<tbody>
<tr>
<td><a href="https://github.com/tensorflow/tfx/releases">TFX</a> &lt;= 0.28.0</td>
<td>Fully Compatible  </td>
<td>Metadata UI not compatible<sup><a href="#fn2">2</a></sup></td>
</tr>
<tr>
<td><a href="https://github.com/tensorflow/tfx/releases">TFX</a> 0.29.0, 0.30.0</td>
<td>Visualizations not compatible<sup><a href="#fn1">1</a></sup></td>
<td>Metadata UI not compatible<sup><a href="#fn2">2</a></sup></td>
</tr>
<tr>
<td><a href="https://github.com/tensorflow/tfx/releases">TFX</a> 1.0.0</td>
<td>Metadata UI not compatible<sup><a href="#fn2">2</a></sup></td>
<td>Metadata UI not compatible<sup><a href="#fn2">2</a></sup></td>
</tr>
<tr>
<td><a href="https://github.com/tensorflow/tfx/releases">TFX</a> &gt;= 1.2.0</td>
<td>Metadata UI not compatible<sup><a href="#fn2">2</a></sup></td>
<td>Fully Compatible  </td>
</tr>
</tbody>
</table>
<p>Detailed explanations:</p>
<p><a name="fn1">1.</a> <strong>Visualizations not compatible</strong>: Kubeflow Pipelines UI and TFDV, TFMA visualizations is not compatible. Visualizations throw an error in Kubeflow Pipelines UI.</p>
<p><a name="fn2">2.</a> <strong>Metadata UI not compatible</strong>: Kubeflow Pipelines UI and TFX recorded ML Metadata is not compatible. ML Metadata tab in run details page shows error message &ldquo;Corresponding ML Metadata not found&rdquo;. As a result, visualizations based on ML Metadata do not show up in visualizations tab either.</p>
<!--
Issues that caused the incompatibilities:
* TFX 1.0.0+
	* https://github.com/kubeflow/pipelines/issues/6138#issuecomment-898190223
	* https://github.com/kubeflow/pipelines/issues/6138#issuecomment-899917056
* TFX 0.29.0 https://github.com/tensorflow/tfx/issues/3933
-->

</div>



    
	
  

    
	
  
    
    
	
    

<div class="td-content" style="page-break-before: always">
    
	<h1 id="pg-e1957bf303e6673097b3ee28dfccf6f3">3.1.5 - Pipelines SDK</h1>
    <div class="lead">Information about the Kubeflow Pipelines SDK</div>
	
</div>



    
      
  
  
  
  

  
  

  
    
    
	
    

<div class="td-content" style="">
    
	<h1 id="pg-4c4cc1220583c8dadcf45ac61da1c89f">3.1.5.1 - Introduction to the Pipelines SDK</h1>
    <div class="lead">Overview of using the SDK to build components and pipelines</div>
	<div class="alert alert-primary" role="alert">
This Kubeflow component has <b>stable</b> status. See the
<a href="/docs/started/support/#application-status">Kubeflow versioning policies</a>.
</div>
<p>The <a href="https://kubeflow-pipelines.readthedocs.io/en/stable/source/kfp.html">Kubeflow Pipelines
SDK</a>
provides a set of Python packages that you can use to specify and run your
machine learning (ML) workflows. A <em>pipeline</em> is a description of an ML
workflow, including all of the <em>components</em> that make up the steps in the
workflow and how the components interact with each other.</p>
<p><strong>Note</strong>: The SDK documentation here refers to <a href="https://github.com/kubeflow/pipelines">Kubeflow Pipelines with Argo</a> which is the default.
If you are running <a href="https://github.com/kubeflow/kfp-tekton">Kubeflow Pipelines with Tekton</a> instead,
please follow the <a href="/docs/components/pipelines/sdk/pipelines-with-tekton">Kubeflow Pipelines SDK for Tekton</a> documentation.</p>
<h2 id="sdk-packages">SDK packages</h2>
<p>The Kubeflow Pipelines SDK includes the following packages:</p>
<ul>
<li>
<p><a href="https://kubeflow-pipelines.readthedocs.io/en/stable/source/kfp.compiler.html"><code>kfp.compiler</code></a>
includes classes and methods for compiling pipeline Python DSL into a workflow yaml spec
Methods in this package include, but are not limited
to, the following:</p>
<ul>
<li><code>kfp.compiler.Compiler.compile</code> compiles your Python DSL code into a single
static configuration (in YAML format) that the Kubeflow Pipelines service
can process. The Kubeflow Pipelines service converts the static
configuration into a set of Kubernetes resources for execution.</li>
</ul>
</li>
<li>
<p><a href="https://kubeflow-pipelines.readthedocs.io/en/stable/source/kfp.components.html"><code>kfp.components</code></a>
includes classes and methods for interacting with pipeline components.
Methods in this package include, but are not limited to, the following:</p>
<ul>
<li>
<p><code>kfp.components.func_to_container_op</code> converts a Python function to a
pipeline component and returns a factory function.
You can then call the factory function to construct an instance of a
pipeline task
(<a href="https://kubeflow-pipelines.readthedocs.io/en/stable/source/kfp.dsl.html#kfp.dsl.ContainerOp"><code>ContainerOp</code></a>)
that runs the original function in a container.</p>
</li>
<li>
<p><code>kfp.components.load_component_from_file</code> loads a pipeline component from
a file and returns a factory function.
You can then call the factory function to construct an instance of a
pipeline task
(<a href="https://kubeflow-pipelines.readthedocs.io/en/stable/source/kfp.dsl.html#kfp.dsl.ContainerOp"><code>ContainerOp</code></a>)
that runs the component container image.</p>
</li>
<li>
<p><code>kfp.components.load_component_from_url</code> loads a pipeline component from
a URL and returns a factory function.
You can then call the factory function to construct an instance of a
pipeline task
(<a href="https://kubeflow-pipelines.readthedocs.io/en/stable/source/kfp.dsl.html#kfp.dsl.ContainerOp"><code>ContainerOp</code></a>)
that runs the component container image.</p>
</li>
</ul>
</li>
<li>
<p><a href="https://kubeflow-pipelines.readthedocs.io/en/stable/source/kfp.dsl.html"><code>kfp.dsl</code></a>
contains the domain-specific language (DSL) that you can use to define and
interact with pipelines and components.
Methods, classes, and modules in this package include, but are not limited to,
the following:</p>
<ul>
<li>
<p><code>kfp.dsl.PipelineParam</code> represents a pipeline parameter that you can pass
from one pipeline component to another. See the guide to
<a href="/docs/components/pipelines/sdk/parameters/">pipeline parameters</a>.</p>
</li>
<li>
<p><code>kfp.dsl.component</code> is a decorator for DSL functions that returns a
pipeline component.
(<a href="https://kubeflow-pipelines.readthedocs.io/en/stable/source/kfp.dsl.html#kfp.dsl.ContainerOp"><code>ContainerOp</code></a>).</p>
</li>
<li>
<p><code>kfp.dsl.pipeline</code> is a decorator for Python functions that returns a
pipeline.</p>
</li>
<li>
<p><code>kfp.dsl.python_component</code> is a decorator for Python functions that adds
pipeline component metadata to the function object.</p>
</li>
<li>
<p><a href="https://kubeflow-pipelines.readthedocs.io/en/stable/source/kfp.dsl.types.html"><code>kfp.dsl.types</code></a>
contains a list of types defined by the Kubeflow Pipelines SDK. Types
include basic types like <code>String</code>, <code>Integer</code>, <code>Float</code>, and <code>Bool</code>, as well
as domain-specific types like <code>GCPProjectID</code> and <code>GCRPath</code>.
See the guide to
<a href="/docs/components/pipelines/sdk/static-type-checking">DSL static type checking</a>.</p>
</li>
<li>
<p><a href="https://kubeflow-pipelines.readthedocs.io/en/stable/source/kfp.dsl.html#kfp.dsl.ResourceOp"><code>kfp.dsl.ResourceOp</code></a>
represents a pipeline task (op) which lets you directly manipulate
Kubernetes resources (<code>create</code>, <code>get</code>, <code>apply</code>, &hellip;).</p>
</li>
<li>
<p><a href="https://kubeflow-pipelines.readthedocs.io/en/stable/source/kfp.dsl.html#kfp.dsl.VolumeOp"><code>kfp.dsl.VolumeOp</code></a>
represents a pipeline task (op) which creates a new <code>PersistentVolumeClaim</code>
(PVC). It aims to make the common case of creating a <code>PersistentVolumeClaim</code>
fast.</p>
</li>
<li>
<p><a href="https://kubeflow-pipelines.readthedocs.io/en/stable/source/kfp.dsl.html#kfp.dsl.VolumeSnapshotOp"><code>kfp.dsl.VolumeSnapshotOp</code></a>
represents a pipeline task (op) which creates a new <code>VolumeSnapshot</code>. It
aims to make the common case of creating a <code>VolumeSnapshot</code> fast.</p>
</li>
<li>
<p><a href="https://kubeflow-pipelines.readthedocs.io/en/stable/source/kfp.dsl.html#kfp.dsl.PipelineVolume"><code>kfp.dsl.PipelineVolume</code></a>
represents a volume used to pass data between pipeline steps. <code>ContainerOp</code>s
can mount a <code>PipelineVolume</code> either via the constructor&rsquo;s argument
<code>pvolumes</code> or <code>add_pvolumes()</code> method.</p>
</li>
<li>
<p><a href="https://kubeflow-pipelines.readthedocs.io/en/stable/source/kfp.dsl.html#kfp.dsl.ParallelFor"><code>kfp.dsl.ParallelFor</code></a>
represents a parallel for loop over a static or dynamic set of items in a pipeline.
Each iteration of the for loop is executed in parallel.</p>
</li>
<li>
<p><a href="https://kubeflow-pipelines.readthedocs.io/en/stable/source/kfp.dsl.html#kfp.dsl.ExitHandler"><code>kfp.dsl.ExitHandler</code></a>
represents an exit handler that is invoked upon exiting a pipeline. A typical
usage of <code>ExitHandler</code> is garbage collection.</p>
</li>
<li>
<p><a href="https://kubeflow-pipelines.readthedocs.io/en/stable/source/kfp.dsl.html#kfp.dsl.Condition"><code>kfp.dsl.Condition</code></a>
represents a group of ops, that will only be executed when a certain condition is met.
The condition specified need to be determined at runtime, by incorporating at least one task output,
or PipelineParam in the boolean expression.</p>
</li>
</ul>
</li>
<li>
<p><a href="https://kubeflow-pipelines.readthedocs.io/en/stable/source/kfp.client.html"><code>kfp.Client</code></a>
contains the Python client libraries for the <a href="/docs/components/pipelines/reference/api/kubeflow-pipeline-api-spec/">Kubeflow Pipelines
API</a>.
Methods in this package include, but are not limited to, the following:</p>
<ul>
<li><code>kfp.Client.create_experiment</code> creates a pipeline
<a href="/docs/components/pipelines/concepts/experiment/">experiment</a> and returns an
experiment object.</li>
<li><code>kfp.Client.run_pipeline</code> runs a pipeline and returns a run object.</li>
<li><code>kfp.Client.create_run_from_pipeline_func</code> compiles a pipeline function and submits it
for execution on Kubeflow Pipelines.</li>
<li><code>kfp.Client.create_run_from_pipeline_package</code> runs a local pipeline package on Kubeflow Pipelines.</li>
<li><code>kfp.Client.upload_pipeline</code> uploads a local file to create a new pipeline in Kubeflow Pipelines.</li>
<li><code>kfp.Client.upload_pipeline_version</code> uploads a local file to create a pipeline version. <a href="/docs/components/pipelines/tutorials/sdk-examples">Follow an example to learn more about creating a pipeline version</a>.</li>
</ul>
</li>
<li>
<p><a href="https://kubeflow-pipelines.readthedocs.io/en/stable/source/kfp.extensions.html">Kubeflow Pipelines extension modules</a>
include classes and functions for specific platforms on which you can use
Kubeflow Pipelines. Examples include utility functions for on premises,
Google Cloud Platform (GCP), Amazon Web Services (AWS), and Microsoft Azure.</p>
</li>
<li>
<p><a href="https://github.com/kubeflow/pipelines/tree/sdk/release-1.8/sdk/python/kfp/cli/diagnose_me">Kubeflow Pipelines diagnose_me modules</a> include classes and functions that help with environment diagnostic tasks.</p>
<ul>
<li><code>kfp.cli.diagnose_me.dev_env</code> reports on diagnostic metadata from your development environment, such as your python library version.</li>
<li><code>kfp.cli.diagnose_me.kubernetes_cluster</code> reports on diagnostic data from your Kubernetes cluster, such as Kubernetes secrets.</li>
<li><code>kfp.cli.diagnose_me.gcp</code> reports on diagnostic data related to your GCP environment.</li>
</ul>
</li>
</ul>
<h2 id="kubeflow-pipelines-cli-tool">Kubeflow Pipelines CLI tool</h2>
<p>The Kubeflow Pipelines CLI tool enables you to use a subset of the Kubeflow Pipelines SDK directly from the command line. The Kubeflow Pipelines CLI tool provides the following commands:</p>
<ul>
<li>
<p><code>kfp diagnose_me</code> runs environment diagnostic with specified parameters.</p>
<ul>
<li><code>--json</code> - Indicates that this command must return its results as JSON. Otherwise, results are returned in human readable format.</li>
<li><code>--namespace TEXT</code> - Specifies the Kubernetes namespace to use. all-namespaces is the default value.</li>
<li><code>--project-id TEXT</code> - For GCP deployments, this value specifies the GCP project to use. If this value is not specified, the environment default is used.</li>
</ul>
</li>
<li>
<p><code>kfp pipeline &lt;COMMAND&gt;</code> provides the following commands to help you manage pipelines.</p>
<ul>
<li><code>get</code>  - Gets detailed information about a Kubeflow pipeline from your Kubeflow Pipelines cluster.</li>
<li><code>list</code> - Lists the pipelines that have been uploaded to your Kubeflow Pipelines cluster.</li>
<li><code>upload</code> - Uploads a pipeline to your Kubeflow Pipelines cluster.</li>
</ul>
</li>
<li>
<p><code>kfp run &lt;COMMAND&gt;</code> provides the following commands to help you manage pipeline runs.</p>
<ul>
<li><code>get</code> - Displays the details of a pipeline run.</li>
<li><code>list</code> - Lists recent pipeline runs.</li>
<li><code>submit</code> - Submits a pipeline run.</li>
</ul>
</li>
<li>
<p><code>kfp --endpoint &lt;ENDPOINT&gt;</code> - Specifies the endpoint that the Kubeflow Pipelines CLI should connect to.</p>
</li>
</ul>
<h2 id="installing-the-sdk">Installing the SDK</h2>
<p>Follow the guide to
<a href="/docs/components/pipelines/sdk/install-sdk/">installing the Kubeflow Pipelines SDK</a>.</p>
<h2 id="building-pipelines-and-components">Building pipelines and components</h2>
<p>This section summarizes the ways you can use the SDK to build pipelines and
components.</p>
<p>A Kubeflow <em>pipeline</em> is a portable and scalable definition of an ML workflow.
Each step in your ML workflow, such as preparing data or training a model,
is an instance of a pipeline component.</p>
<p><a href="/docs/components/pipelines/sdk/build-pipeline">Learn more about building pipelines</a>.</p>
<p>A pipeline <em>component</em> is a self-contained set of code that performs one step
in your ML workflow. Components are defined in a component specification, which
defines the following:</p>
<ul>
<li>The components interface, its inputs and outputs.</li>
<li>The components implementation, the container image and the command to
execute.</li>
<li>The components metadata, such as the name and description of the
component.</li>
</ul>
<p>Use the following options to create or reuse pipeline components.</p>
<ul>
<li>
<p>You can build components by defining a component specification for a
containerized application.</p>
<p><a href="/docs/components/pipelines/sdk/component-development">Learn more about building pipeline components</a>.</p>
</li>
<li>
<p>Lightweight Python function-based components make it easier to build a
component by using the Kubeflow Pipelines SDK to generate the component
specification for a Python function.</p>
<p><a href="/docs/components/pipelines/sdk/python-function-components">Learn how to build a Python function-based component</a>.</p>
</li>
<li>
<p>You can reuse prebuilt components in your pipeline.</p>
<p><a href="/docs/examples/shared-resources/">Learn more about reusing prebuilt components</a>.</p>
</li>
</ul>
<h2 id="next-steps">Next steps</h2>
<ul>
<li>Learn how to <a href="/docs/components/pipelines/sdk/dsl-recursion">write recursive functions in the
DSL</a>.</li>
<li>Build a <a href="/docs/components/pipelines/sdk/component-development/">pipeline component</a>.</li>
<li>Find out how to use the DSL to <a href="/docs/components/pipelines/sdk/manipulate-resources/">manipulate Kubernetes resources dynamically
as steps of your pipeline</a>.</li>
</ul>

</div>



    
	
  
    
    
	
    

<div class="td-content" style="page-break-before: always">
    
	<h1 id="pg-18204851ea0a52843d149feaa73750b8">3.1.5.2 - Install the Kubeflow Pipelines SDK</h1>
    <div class="lead">Setting up your Kubeflow Pipelines development environment</div>
	<p>This guide tells you how to install the
<a href="https://github.com/kubeflow/pipelines/tree/sdk/release-1.8/sdk">Kubeflow Pipelines SDK</a>
which you can use to build machine learning pipelines. You can use the SDK
to execute your pipeline, or alternatively you can upload the pipeline to
the Kubeflow Pipelines UI for execution.</p>
<p>All of the SDK&rsquo;s classes and methods are described in the auto-generated <a href="https://kubeflow-pipelines.readthedocs.io/en/stable/">SDK reference docs</a>.</p>
<p><strong>Note:</strong> If you are running <a href="https://github.com/kubeflow/kfp-tekton">Kubeflow Pipelines with Tekton</a>,
instead of the default <a href="https://github.com/kubeflow/pipelines">Kubeflow Pipelines with Argo</a>, you should use the
<a href="/docs/components/pipelines/sdk/pipelines-with-tekton">Kubeflow Pipelines SDK for Tekton</a>.</p>
<h2 id="set-up-python">Set up Python</h2>
<p>You need <strong>Python 3.5</strong> or later to use the Kubeflow Pipelines SDK. This
guide uses Python 3.7.</p>
<p>If you haven&rsquo;t yet set up a Python 3 environment, do so now. This guide
recommends <a href="https://conda.io/miniconda.html">Miniconda</a>, but you can use
a virtual environment manager of your choice, such as <code>virtualenv</code>.</p>
<p>Follow the steps below to set
up Python using <a href="https://conda.io/miniconda.html">Miniconda</a>:</p>
<ol>
<li>
<p>Choose one of the following methods to install Miniconda, depending on your
environment:</p>
<ul>
<li>
<p>Debian/Ubuntu/<a href="https://console.cloud.google.com/cloudshell">Cloud Shell</a>:</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash"><span class="line"><span class="cl">apt-get update<span class="p">;</span> apt-get install -y wget bzip2
</span></span><span class="line"><span class="cl">wget https://repo.continuum.io/miniconda/Miniconda3-latest-Linux-x86_64.sh
</span></span><span class="line"><span class="cl">bash Miniconda3-latest-Linux-x86_64.sh
</span></span></code></pre></div></li>
<li>
<p>Windows: Download the
<a href="https://repo.continuum.io/miniconda/Miniconda3-latest-Windows-x86_64.exe">installer</a>
and make sure you select the option to
<strong>Add Miniconda to my PATH environment variable</strong> during the installation.</p>
</li>
<li>
<p>MacOS: Download the
<a href="https://repo.continuum.io/miniconda/Miniconda3-latest-MacOSX-x86_64.sh">installer</a>
and run the following command:</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash"><span class="line"><span class="cl">bash Miniconda3-latest-MacOSX-x86_64.sh
</span></span></code></pre></div></li>
</ul>
</li>
<li>
<p>Check that the <code>conda</code> command is available:</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash"><span class="line"><span class="cl">which conda
</span></span></code></pre></div><p>If the <code>conda</code> command is not found, add Miniconda to your path:</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash"><span class="line"><span class="cl"><span class="nb">export</span> <span class="nv">PATH</span><span class="o">=</span>&lt;YOUR_MINICONDA_PATH&gt;/bin:<span class="nv">$PATH</span>
</span></span></code></pre></div></li>
<li>
<p>Create a clean Python 3 environment with a name of your choosing. This
example uses Python 3.7 and an environment name of <code>mlpipeline</code>.:</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash"><span class="line"><span class="cl">conda create --name mlpipeline <span class="nv">python</span><span class="o">=</span>3.7
</span></span><span class="line"><span class="cl">conda activate mlpipeline
</span></span></code></pre></div></li>
</ol>
<h2 id="install-the-kubeflow-pipelines-sdk">Install the Kubeflow Pipelines SDK</h2>
<p>Run the following command to install the Kubeflow Pipelines SDK:</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash"><span class="line"><span class="cl">pip3 install kfp --upgrade
</span></span></code></pre></div><p><strong>Note:</strong> If you are not using a virtual environment, such as <code>conda</code>, when installing the Kubeflow Pipelines SDK, you may receive the following error:</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash"><span class="line"><span class="cl">ERROR: Could not install packages due to an EnvironmentError: <span class="o">[</span>Errno 13<span class="o">]</span> Permission denied: <span class="s1">&#39;/usr/local/lib/python3.5/dist-packages/kfp-&lt;version&gt;.dist-info&#39;</span>
</span></span><span class="line"><span class="cl">Consider using the <span class="sb">`</span>--user<span class="sb">`</span> option or check the permissions.
</span></span></code></pre></div><p>If you get this error, install <code>kfp</code> with the <code>--user</code> option:</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash"><span class="line"><span class="cl">pip3 install kfp --upgrade --user
</span></span></code></pre></div><p>This command installs the <code>dsl-compile</code> and <code>kfp</code> binaries under <code>~/.local/bin</code>, which is not part of the PATH in some Linux distributions, such as Ubuntu. You can add <code>~/.local/bin</code> to your PATH by appending the following to a new line at the end of your <code>.bashrc</code> file:</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash"><span class="line"><span class="cl"><span class="nb">export</span> <span class="nv">PATH</span><span class="o">=</span><span class="nv">$PATH</span>:~/.local/bin
</span></span></code></pre></div><p>After successful installation, the command <code>dsl-compile</code> should be available.
You can use this command to verify it:</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash"><span class="line"><span class="cl">which dsl-compile
</span></span></code></pre></div><p>The response should be something like this:</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-fallback" data-lang="fallback"><span class="line"><span class="cl">/&lt;PATH_TO_YOUR_USER_BIN&gt;/miniconda3/envs/mlpipeline/bin/dsl-compile
</span></span></code></pre></div><h2 id="next-steps">Next steps</h2>
<ul>
<li><a href="/docs/components/pipelines/sdk/sdk-overview/">See how to use the SDK</a>.</li>
<li><a href="/docs/components/pipelines/sdk/component-development/">Build a component and a pipeline</a>.</li>
<li><a href="/docs/components/pipelines/overview/quickstart">Get started with the UI</a>.</li>
<li><a href="/docs/components/pipelines/concepts/">Understand pipeline concepts</a>.</li>
</ul>

</div>



    
	
  
    
    
	
    

<div class="td-content" style="page-break-before: always">
    
	<h1 id="pg-16043ffea1aee8a9b986cc1dc4598463">3.1.5.3 - Connect the Pipelines SDK to Kubeflow Pipelines</h1>
    <div class="lead">How to connect the Pipelines SDK to Kubeflow Pipelines in various ways</div>
	<p>How to connect Pipelines SDK to Kubeflow Pipelines will depend on <strong>what kind</strong> of Kubeflow deployment you have, and <strong>from where you are running your code</strong>.</p>
<ul>
<li><a href="#full-kubeflow-subfrom-inside-clustersub">Full Kubeflow (from inside cluster)</a></li>
<li><a href="#full-kubeflow-subfrom-outside-clustersub">Full Kubeflow (from outside cluster)</a></li>
<li><a href="#standalone-kubeflow-pipelines-subfrom-inside-clustersub">Standalone Kubeflow Pipelines (from inside cluster)</a></li>
<li><a href="#standalone-kubeflow-pipelines-subfrom-outside-clustersub">Standalone Kubeflow Pipelines (from outside cluster)</a></li>
</ul>


<div class="alert alert-info" role="alert">
<h4 class="alert-heading">Tip</h4>

    <p>Before you begin, you will need to:</p>
<ul>
<li><a href="/docs/components/pipelines/installation/overview/">Deploy Kubeflow Pipelines</a></li>
<li><a href="/docs/components/pipelines/sdk/install-sdk/">Install the Kubeflow Pipelines SDK</a></li>
</ul>


</div>

<h2 id="full-kubeflow-subfrom-inside-clustersub">Full Kubeflow <sub>(from inside cluster)</sub></h2>
<details>
<summary>Click to expand</summary>
<hr>
<p>When running the Pipelines SDK inside a multi-user Kubeflow cluster, a <a href="https://kubernetes.io/docs/tasks/configure-pod-container/configure-service-account/#service-account-token-volume-projection">ServiceAccount token volume</a>
can be mounted to the Pod, the Kubeflow Pipelines SDK can use this token to authenticate itself with the Kubeflow Pipelines API.</p>
<p>The following code creates a <code>kfp.Client()</code> using a ServiceAccount token for authentication.</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-python" data-lang="python"><span class="line"><span class="cl"><span class="kn">import</span> <span class="nn">kfp</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="c1"># the namespace in which you deployed Kubeflow Pipelines</span>
</span></span><span class="line"><span class="cl"><span class="n">namespace</span> <span class="o">=</span> <span class="s2">&#34;kubeflow&#34;</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="c1"># the KF_PIPELINES_SA_TOKEN_PATH environment variable is used when no `path` is set</span>
</span></span><span class="line"><span class="cl"><span class="c1"># the default KF_PIPELINES_SA_TOKEN_PATH is /var/run/secrets/kubeflow/pipelines/token</span>
</span></span><span class="line"><span class="cl"><span class="n">credentials</span> <span class="o">=</span> <span class="n">kfp</span><span class="o">.</span><span class="n">auth</span><span class="o">.</span><span class="n">ServiceAccountTokenVolumeCredentials</span><span class="p">(</span><span class="n">path</span><span class="o">=</span><span class="kc">None</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="n">client</span> <span class="o">=</span> <span class="n">kfp</span><span class="o">.</span><span class="n">Client</span><span class="p">(</span><span class="n">host</span><span class="o">=</span><span class="sa">f</span><span class="s2">&#34;http://ml-pipeline-ui.</span><span class="si">{</span><span class="n">namespace</span><span class="si">}</span><span class="s2">&#34;</span><span class="p">,</span> <span class="n">credentials</span><span class="o">=</span><span class="n">credentials</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="nb">print</span><span class="p">(</span><span class="n">client</span><span class="o">.</span><span class="n">list_experiments</span><span class="p">())</span>
</span></span></code></pre></div><p>The following Pod demonstrates mounting a ServiceAccount token volume.</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-yaml" data-lang="yaml"><span class="line"><span class="cl"><span class="nt">apiVersion</span><span class="p">:</span><span class="w"> </span><span class="l">v1</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="nt">kind</span><span class="p">:</span><span class="w"> </span><span class="l">Pod</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="nt">metadata</span><span class="p">:</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">  </span><span class="nt">name</span><span class="p">:</span><span class="w"> </span><span class="l">access-kfp-example</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="nt">spec</span><span class="p">:</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">  </span><span class="nt">containers</span><span class="p">:</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">  </span>- <span class="nt">image</span><span class="p">:</span><span class="w"> </span><span class="l">hello-world:latest</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="nt">name</span><span class="p">:</span><span class="w"> </span><span class="l">hello-world</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="nt">env</span><span class="p">:</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">      </span>- <span class="c">## this environment variable is automatically read by `kfp.Client()`</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">        </span><span class="c">## this is the default value, but we show it here for clarity</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">        </span><span class="nt">name</span><span class="p">:</span><span class="w"> </span><span class="l">KF_PIPELINES_SA_TOKEN_PATH</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">        </span><span class="nt">value</span><span class="p">:</span><span class="w"> </span><span class="l">/var/run/secrets/kubeflow/pipelines/token</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="nt">volumeMounts</span><span class="p">:</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">      </span>- <span class="nt">mountPath</span><span class="p">:</span><span class="w"> </span><span class="l">/var/run/secrets/kubeflow/pipelines</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">        </span><span class="nt">name</span><span class="p">:</span><span class="w"> </span><span class="l">volume-kf-pipeline-token</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">        </span><span class="nt">readOnly</span><span class="p">:</span><span class="w"> </span><span class="kc">true</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">  </span><span class="nt">volumes</span><span class="p">:</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span>- <span class="nt">name</span><span class="p">:</span><span class="w"> </span><span class="l">volume-kf-pipeline-token</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">      </span><span class="nt">projected</span><span class="p">:</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">        </span><span class="nt">sources</span><span class="p">:</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">          </span>- <span class="nt">serviceAccountToken</span><span class="p">:</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">              </span><span class="nt">path</span><span class="p">:</span><span class="w"> </span><span class="l">token</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">              </span><span class="nt">expirationSeconds</span><span class="p">:</span><span class="w"> </span><span class="m">7200</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">              </span><span class="c">## defined by the `TOKEN_REVIEW_AUDIENCE` environment variable on the `ml-pipeline` deployment</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">              </span><span class="nt">audience</span><span class="p">:</span><span class="w"> </span><span class="l">pipelines.kubeflow.org      </span><span class="w">
</span></span></span></code></pre></div><p>You may use Kubeflow&rsquo;s <a href="https://github.com/kubeflow/kubeflow/tree/master/components/admission-webhook"><code>PodDefaults</code></a> to inject the required ServiceAccount token volume into your Pods:</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-yaml" data-lang="yaml"><span class="line"><span class="cl"><span class="nt">apiVersion</span><span class="p">:</span><span class="w"> </span><span class="l">kubeflow.org/v1alpha1</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="nt">kind</span><span class="p">:</span><span class="w"> </span><span class="l">PodDefault</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="nt">metadata</span><span class="p">:</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">  </span><span class="nt">name</span><span class="p">:</span><span class="w"> </span><span class="l">access-ml-pipeline</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">  </span><span class="nt">namespace</span><span class="p">:</span><span class="w"> </span><span class="s2">&#34;&lt;YOUR_USER_PROFILE_NAMESPACE&gt;&#34;</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="nt">spec</span><span class="p">:</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">  </span><span class="nt">desc</span><span class="p">:</span><span class="w"> </span><span class="l">Allow access to Kubeflow Pipelines</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">  </span><span class="nt">selector</span><span class="p">:</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="nt">matchLabels</span><span class="p">:</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">      </span><span class="nt">access-ml-pipeline</span><span class="p">:</span><span class="w"> </span><span class="s2">&#34;true&#34;</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">  </span><span class="nt">env</span><span class="p">:</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span>- <span class="c">## this environment variable is automatically read by `kfp.Client()`</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">      </span><span class="c">## this is the default value, but we show it here for clarity</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">      </span><span class="nt">name</span><span class="p">:</span><span class="w"> </span><span class="l">KF_PIPELINES_SA_TOKEN_PATH</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">      </span><span class="nt">value</span><span class="p">:</span><span class="w"> </span><span class="l">/var/run/secrets/kubeflow/pipelines/token</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">  </span><span class="nt">volumes</span><span class="p">:</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span>- <span class="nt">name</span><span class="p">:</span><span class="w"> </span><span class="l">volume-kf-pipeline-token</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">      </span><span class="nt">projected</span><span class="p">:</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">        </span><span class="nt">sources</span><span class="p">:</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">          </span>- <span class="nt">serviceAccountToken</span><span class="p">:</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">              </span><span class="nt">path</span><span class="p">:</span><span class="w"> </span><span class="l">token</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">              </span><span class="nt">expirationSeconds</span><span class="p">:</span><span class="w"> </span><span class="m">7200</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">              </span><span class="c">## defined by the `TOKEN_REVIEW_AUDIENCE` environment variable on the `ml-pipeline` deployment</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">              </span><span class="nt">audience</span><span class="p">:</span><span class="w"> </span><span class="l">pipelines.kubeflow.org      </span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">  </span><span class="nt">volumeMounts</span><span class="p">:</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span>- <span class="nt">mountPath</span><span class="p">:</span><span class="w"> </span><span class="l">/var/run/secrets/kubeflow/pipelines</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">      </span><span class="nt">name</span><span class="p">:</span><span class="w"> </span><span class="l">volume-kf-pipeline-token</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">      </span><span class="nt">readOnly</span><span class="p">:</span><span class="w"> </span><span class="kc">true</span><span class="w">
</span></span></span></code></pre></div>

<div class="alert alert-info" role="alert">
<h4 class="alert-heading">Tip</h4>

    <ul>
<li><code>PodDefaults</code> are namespaced resources, so you need to create one inside <strong>each</strong> of your Kubeflow <code>Profile</code> namespaces.</li>
<li>The Notebook Spawner UI will be aware of any <code>PodDefaults</code> in the user&rsquo;s namespace (they are selectable under the &ldquo;configurations&rdquo; section).</li>
</ul>


</div>

<h3 id="rbac-authorization">RBAC Authorization</h3>
<p>The Kubeflow Pipelines API respects Kubernetes RBAC, and will check RoleBindings assigned to the ServiceAccount before allowing it to take Pipelines API actions.</p>
<p>For example, this RoleBinding allows Pods with the <code>default-editor</code> ServiceAccount in <code>namespace-2</code> to manage Kubeflow Pipelines in <code>namespace-1</code>:</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-yaml" data-lang="yaml"><span class="line"><span class="cl"><span class="nt">apiVersion</span><span class="p">:</span><span class="w"> </span><span class="l">rbac.authorization.k8s.io/v1</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="nt">kind</span><span class="p">:</span><span class="w"> </span><span class="l">RoleBinding</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="nt">metadata</span><span class="p">:</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">  </span><span class="nt">name</span><span class="p">:</span><span class="w"> </span><span class="l">allow-namespace-2-kubeflow-edit</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">  </span><span class="c">## this RoleBinding is in `namespace-1`, because it grants access to `namespace-1`</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">  </span><span class="nt">namespace</span><span class="p">:</span><span class="w"> </span><span class="l">namespace-1</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="nt">roleRef</span><span class="p">:</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">  </span><span class="nt">apiGroup</span><span class="p">:</span><span class="w"> </span><span class="l">rbac.authorization.k8s.io</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">  </span><span class="nt">kind</span><span class="p">:</span><span class="w"> </span><span class="l">ClusterRole</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">  </span><span class="nt">name</span><span class="p">:</span><span class="w"> </span><span class="l">kubeflow-edit</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="nt">subjects</span><span class="p">:</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">  </span>- <span class="nt">kind</span><span class="p">:</span><span class="w"> </span><span class="l">ServiceAccount</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="nt">name</span><span class="p">:</span><span class="w"> </span><span class="l">default-editor</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="c">## the ServiceAccount lives in `namespace-2`</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="nt">namespace</span><span class="p">:</span><span class="w"> </span><span class="l">namespace-2</span><span class="w">
</span></span></span></code></pre></div>

<div class="alert alert-info" role="alert">
<h4 class="alert-heading">Tip</h4>

    <ul>
<li>Review the ClusterRole called <a href="https://github.com/kubeflow/pipelines/blob/efb96135033fc6e6e55078d33814c45a98566e68/manifests/kustomize/base/installs/multi-user/view-edit-cluster-roles.yaml#L36-L99"><code>aggregate-to-kubeflow-pipelines-edit</code></a>
for a list of some important <code>pipelines.kubeflow.org</code> RBAC verbs.</li>
<li>Kubeflow Notebooks pods run as the <code>default-editor</code> ServiceAccount by default, so the RoleBindings for <code>default-editor</code> apply to them
and give them access to submit pipelines in their own namespace.</li>
</ul>


</div>

</details>
<h2 id="full-kubeflow-subfrom-outside-clustersub">Full Kubeflow <sub>(from outside cluster)</sub></h2>
<details>
<summary>Click to expand</summary>
<hr>
<p>The process to authenticate the Pipelines SDK from outside the cluster in multi-user mode will vary by distribution:</p>
<ul>
<li><a href="/docs/distributions/gke/pipelines/authentication-sdk/#connecting-to-kubeflow-pipelines-in-a-full-kubeflow-deployment">Kubeflow on Google Cloud</a></li>
<li><a href="/docs/distributions/aws/pipeline/#authenticate-kubeflow-pipeline-using-sdk-outside-cluster">Kubeflow on AWS</a></li>
<li><a href="https://awslabs.github.io/kubeflow-manifests/docs/component-guides/pipelines/">Kubeflow on Azure</a></li>
<li><a href="/docs/distributions/ibm/pipelines/#2-authenticating-multi-user-kubeflow-pipelines-with-the-sdk">Kubeflow on IBM Cloud</a></li>
</ul>
<h3 id="example-for-dex">Example for Dex</h3>
<p>For the deployments that use <a href="https://dexidp.io/">Dex</a> as their identity provider, this example demonstrates how to authenticate the Pipelines SDK from outside the cluster.</p>
<p><strong>Step 1:</strong> expose your <code>istio-ingressgateway</code> service locally (if your Kubeflow Istio gateway is not already exposed on a domain)</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash"><span class="line"><span class="cl"><span class="c1"># `svc/istio-ingressgateway` may be called something else, or use different ports</span>
</span></span><span class="line"><span class="cl">kubectl port-forward --namespace istio-system svc/istio-ingressgateway 8080:80
</span></span></code></pre></div><p><strong>Step 2:</strong> this Python code defines a <code>get_istio_auth_session()</code> function that returns a session cookie by authenticating with dex</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-python" data-lang="python"><span class="line"><span class="cl"><span class="kn">import</span> <span class="nn">re</span>
</span></span><span class="line"><span class="cl"><span class="kn">import</span> <span class="nn">requests</span>
</span></span><span class="line"><span class="cl"><span class="kn">from</span> <span class="nn">urllib.parse</span> <span class="kn">import</span> <span class="n">urlsplit</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="k">def</span> <span class="nf">get_istio_auth_session</span><span class="p">(</span><span class="n">url</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span> <span class="n">username</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span> <span class="n">password</span><span class="p">:</span> <span class="nb">str</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">dict</span><span class="p">:</span>
</span></span><span class="line"><span class="cl">    <span class="s2">&#34;&#34;&#34;
</span></span></span><span class="line"><span class="cl"><span class="s2">    Determine if the specified URL is secured by Dex and try to obtain a session cookie.
</span></span></span><span class="line"><span class="cl"><span class="s2">    WARNING: only Dex `staticPasswords` and `LDAP` authentication are currently supported
</span></span></span><span class="line"><span class="cl"><span class="s2">             (we default default to using `staticPasswords` if both are enabled)
</span></span></span><span class="line"><span class="cl"><span class="s2">
</span></span></span><span class="line"><span class="cl"><span class="s2">    :param url: Kubeflow server URL, including protocol
</span></span></span><span class="line"><span class="cl"><span class="s2">    :param username: Dex `staticPasswords` or `LDAP` username
</span></span></span><span class="line"><span class="cl"><span class="s2">    :param password: Dex `staticPasswords` or `LDAP` password
</span></span></span><span class="line"><span class="cl"><span class="s2">    :return: auth session information
</span></span></span><span class="line"><span class="cl"><span class="s2">    &#34;&#34;&#34;</span>
</span></span><span class="line"><span class="cl">    <span class="c1"># define the default return object</span>
</span></span><span class="line"><span class="cl">    <span class="n">auth_session</span> <span class="o">=</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">        <span class="s2">&#34;endpoint_url&#34;</span><span class="p">:</span> <span class="n">url</span><span class="p">,</span>    <span class="c1"># KF endpoint URL</span>
</span></span><span class="line"><span class="cl">        <span class="s2">&#34;redirect_url&#34;</span><span class="p">:</span> <span class="kc">None</span><span class="p">,</span>   <span class="c1"># KF redirect URL, if applicable</span>
</span></span><span class="line"><span class="cl">        <span class="s2">&#34;dex_login_url&#34;</span><span class="p">:</span> <span class="kc">None</span><span class="p">,</span>  <span class="c1"># Dex login URL (for POST of credentials)</span>
</span></span><span class="line"><span class="cl">        <span class="s2">&#34;is_secured&#34;</span><span class="p">:</span> <span class="kc">None</span><span class="p">,</span>     <span class="c1"># True if KF endpoint is secured</span>
</span></span><span class="line"><span class="cl">        <span class="s2">&#34;session_cookie&#34;</span><span class="p">:</span> <span class="kc">None</span>  <span class="c1"># Resulting session cookies in the form &#34;key1=value1; key2=value2&#34;</span>
</span></span><span class="line"><span class="cl">    <span class="p">}</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">    <span class="c1"># use a persistent session (for cookies)</span>
</span></span><span class="line"><span class="cl">    <span class="k">with</span> <span class="n">requests</span><span class="o">.</span><span class="n">Session</span><span class="p">()</span> <span class="k">as</span> <span class="n">s</span><span class="p">:</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">        <span class="c1">################</span>
</span></span><span class="line"><span class="cl">        <span class="c1"># Determine if Endpoint is Secured</span>
</span></span><span class="line"><span class="cl">        <span class="c1">################</span>
</span></span><span class="line"><span class="cl">        <span class="n">resp</span> <span class="o">=</span> <span class="n">s</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">url</span><span class="p">,</span> <span class="n">allow_redirects</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">        <span class="k">if</span> <span class="n">resp</span><span class="o">.</span><span class="n">status_code</span> <span class="o">!=</span> <span class="mi">200</span><span class="p">:</span>
</span></span><span class="line"><span class="cl">            <span class="k">raise</span> <span class="ne">RuntimeError</span><span class="p">(</span>
</span></span><span class="line"><span class="cl">                <span class="sa">f</span><span class="s2">&#34;HTTP status code &#39;</span><span class="si">{</span><span class="n">resp</span><span class="o">.</span><span class="n">status_code</span><span class="si">}</span><span class="s2">&#39; for GET against: </span><span class="si">{</span><span class="n">url</span><span class="si">}</span><span class="s2">&#34;</span>
</span></span><span class="line"><span class="cl">            <span class="p">)</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">        <span class="n">auth_session</span><span class="p">[</span><span class="s2">&#34;redirect_url&#34;</span><span class="p">]</span> <span class="o">=</span> <span class="n">resp</span><span class="o">.</span><span class="n">url</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">        <span class="c1"># if we were NOT redirected, then the endpoint is UNSECURED</span>
</span></span><span class="line"><span class="cl">        <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">resp</span><span class="o">.</span><span class="n">history</span><span class="p">)</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
</span></span><span class="line"><span class="cl">            <span class="n">auth_session</span><span class="p">[</span><span class="s2">&#34;is_secured&#34;</span><span class="p">]</span> <span class="o">=</span> <span class="kc">False</span>
</span></span><span class="line"><span class="cl">            <span class="k">return</span> <span class="n">auth_session</span>
</span></span><span class="line"><span class="cl">        <span class="k">else</span><span class="p">:</span>
</span></span><span class="line"><span class="cl">            <span class="n">auth_session</span><span class="p">[</span><span class="s2">&#34;is_secured&#34;</span><span class="p">]</span> <span class="o">=</span> <span class="kc">True</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">        <span class="c1">################</span>
</span></span><span class="line"><span class="cl">        <span class="c1"># Get Dex Login URL</span>
</span></span><span class="line"><span class="cl">        <span class="c1">################</span>
</span></span><span class="line"><span class="cl">        <span class="n">redirect_url_obj</span> <span class="o">=</span> <span class="n">urlsplit</span><span class="p">(</span><span class="n">auth_session</span><span class="p">[</span><span class="s2">&#34;redirect_url&#34;</span><span class="p">])</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">        <span class="c1"># if we are at `/auth?=xxxx` path, we need to select an auth type</span>
</span></span><span class="line"><span class="cl">        <span class="k">if</span> <span class="n">re</span><span class="o">.</span><span class="n">search</span><span class="p">(</span><span class="sa">r</span><span class="s2">&#34;/auth$&#34;</span><span class="p">,</span> <span class="n">redirect_url_obj</span><span class="o">.</span><span class="n">path</span><span class="p">):</span> 
</span></span><span class="line"><span class="cl">            
</span></span><span class="line"><span class="cl">            <span class="c1">#######</span>
</span></span><span class="line"><span class="cl">            <span class="c1"># TIP: choose the default auth type by including ONE of the following</span>
</span></span><span class="line"><span class="cl">            <span class="c1">#######</span>
</span></span><span class="line"><span class="cl">            
</span></span><span class="line"><span class="cl">            <span class="c1"># OPTION 1: set &#34;staticPasswords&#34; as default auth type</span>
</span></span><span class="line"><span class="cl">            <span class="n">redirect_url_obj</span> <span class="o">=</span> <span class="n">redirect_url_obj</span><span class="o">.</span><span class="n">_replace</span><span class="p">(</span>
</span></span><span class="line"><span class="cl">                <span class="n">path</span><span class="o">=</span><span class="n">re</span><span class="o">.</span><span class="n">sub</span><span class="p">(</span><span class="sa">r</span><span class="s2">&#34;/auth$&#34;</span><span class="p">,</span> <span class="s2">&#34;/auth/local&#34;</span><span class="p">,</span> <span class="n">redirect_url_obj</span><span class="o">.</span><span class="n">path</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">            <span class="p">)</span>
</span></span><span class="line"><span class="cl">            <span class="c1"># OPTION 2: set &#34;ldap&#34; as default auth type </span>
</span></span><span class="line"><span class="cl">            <span class="c1"># redirect_url_obj = redirect_url_obj._replace(</span>
</span></span><span class="line"><span class="cl">            <span class="c1">#     path=re.sub(r&#34;/auth$&#34;, &#34;/auth/ldap&#34;, redirect_url_obj.path)</span>
</span></span><span class="line"><span class="cl">            <span class="c1"># )</span>
</span></span><span class="line"><span class="cl">            
</span></span><span class="line"><span class="cl">        <span class="c1"># if we are at `/auth/xxxx/login` path, then no further action is needed (we can use it for login POST)</span>
</span></span><span class="line"><span class="cl">        <span class="k">if</span> <span class="n">re</span><span class="o">.</span><span class="n">search</span><span class="p">(</span><span class="sa">r</span><span class="s2">&#34;/auth/.*/login$&#34;</span><span class="p">,</span> <span class="n">redirect_url_obj</span><span class="o">.</span><span class="n">path</span><span class="p">):</span>
</span></span><span class="line"><span class="cl">            <span class="n">auth_session</span><span class="p">[</span><span class="s2">&#34;dex_login_url&#34;</span><span class="p">]</span> <span class="o">=</span> <span class="n">redirect_url_obj</span><span class="o">.</span><span class="n">geturl</span><span class="p">()</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">        <span class="c1"># else, we need to be redirected to the actual login page</span>
</span></span><span class="line"><span class="cl">        <span class="k">else</span><span class="p">:</span>
</span></span><span class="line"><span class="cl">            <span class="c1"># this GET should redirect us to the `/auth/xxxx/login` path</span>
</span></span><span class="line"><span class="cl">            <span class="n">resp</span> <span class="o">=</span> <span class="n">s</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">redirect_url_obj</span><span class="o">.</span><span class="n">geturl</span><span class="p">(),</span> <span class="n">allow_redirects</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">            <span class="k">if</span> <span class="n">resp</span><span class="o">.</span><span class="n">status_code</span> <span class="o">!=</span> <span class="mi">200</span><span class="p">:</span>
</span></span><span class="line"><span class="cl">                <span class="k">raise</span> <span class="ne">RuntimeError</span><span class="p">(</span>
</span></span><span class="line"><span class="cl">                    <span class="sa">f</span><span class="s2">&#34;HTTP status code &#39;</span><span class="si">{</span><span class="n">resp</span><span class="o">.</span><span class="n">status_code</span><span class="si">}</span><span class="s2">&#39; for GET against: </span><span class="si">{</span><span class="n">redirect_url_obj</span><span class="o">.</span><span class="n">geturl</span><span class="p">()</span><span class="si">}</span><span class="s2">&#34;</span>
</span></span><span class="line"><span class="cl">                <span class="p">)</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">            <span class="c1"># set the login url</span>
</span></span><span class="line"><span class="cl">            <span class="n">auth_session</span><span class="p">[</span><span class="s2">&#34;dex_login_url&#34;</span><span class="p">]</span> <span class="o">=</span> <span class="n">resp</span><span class="o">.</span><span class="n">url</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">        <span class="c1">################</span>
</span></span><span class="line"><span class="cl">        <span class="c1"># Attempt Dex Login</span>
</span></span><span class="line"><span class="cl">        <span class="c1">################</span>
</span></span><span class="line"><span class="cl">        <span class="n">resp</span> <span class="o">=</span> <span class="n">s</span><span class="o">.</span><span class="n">post</span><span class="p">(</span>
</span></span><span class="line"><span class="cl">            <span class="n">auth_session</span><span class="p">[</span><span class="s2">&#34;dex_login_url&#34;</span><span class="p">],</span>
</span></span><span class="line"><span class="cl">            <span class="n">data</span><span class="o">=</span><span class="p">{</span><span class="s2">&#34;login&#34;</span><span class="p">:</span> <span class="n">username</span><span class="p">,</span> <span class="s2">&#34;password&#34;</span><span class="p">:</span> <span class="n">password</span><span class="p">},</span>
</span></span><span class="line"><span class="cl">            <span class="n">allow_redirects</span><span class="o">=</span><span class="kc">True</span>
</span></span><span class="line"><span class="cl">        <span class="p">)</span>
</span></span><span class="line"><span class="cl">        <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">resp</span><span class="o">.</span><span class="n">history</span><span class="p">)</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
</span></span><span class="line"><span class="cl">            <span class="k">raise</span> <span class="ne">RuntimeError</span><span class="p">(</span>
</span></span><span class="line"><span class="cl">                <span class="sa">f</span><span class="s2">&#34;Login credentials were probably invalid - &#34;</span>
</span></span><span class="line"><span class="cl">                <span class="sa">f</span><span class="s2">&#34;No redirect after POST to: </span><span class="si">{</span><span class="n">auth_session</span><span class="p">[</span><span class="s1">&#39;dex_login_url&#39;</span><span class="p">]</span><span class="si">}</span><span class="s2">&#34;</span>
</span></span><span class="line"><span class="cl">            <span class="p">)</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">        <span class="c1"># store the session cookies in a &#34;key1=value1; key2=value2&#34; string</span>
</span></span><span class="line"><span class="cl">        <span class="n">auth_session</span><span class="p">[</span><span class="s2">&#34;session_cookie&#34;</span><span class="p">]</span> <span class="o">=</span> <span class="s2">&#34;; &#34;</span><span class="o">.</span><span class="n">join</span><span class="p">([</span><span class="sa">f</span><span class="s2">&#34;</span><span class="si">{</span><span class="n">c</span><span class="o">.</span><span class="n">name</span><span class="si">}</span><span class="s2">=</span><span class="si">{</span><span class="n">c</span><span class="o">.</span><span class="n">value</span><span class="si">}</span><span class="s2">&#34;</span> <span class="k">for</span> <span class="n">c</span> <span class="ow">in</span> <span class="n">s</span><span class="o">.</span><span class="n">cookies</span><span class="p">])</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">    <span class="k">return</span> <span class="n">auth_session</span>
</span></span></code></pre></div><p><strong>Step 3:</strong> this Python code uses the above <code>get_istio_auth_session()</code> function to create a <code>kfp.Client()</code></p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-python" data-lang="python"><span class="line"><span class="cl"><span class="kn">import</span> <span class="nn">kfp</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="n">KUBEFLOW_ENDPOINT</span> <span class="o">=</span> <span class="s2">&#34;http://localhost:8080&#34;</span>
</span></span><span class="line"><span class="cl"><span class="n">KUBEFLOW_USERNAME</span> <span class="o">=</span> <span class="s2">&#34;user@example.com&#34;</span>
</span></span><span class="line"><span class="cl"><span class="n">KUBEFLOW_PASSWORD</span> <span class="o">=</span> <span class="s2">&#34;12341234&#34;</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="n">auth_session</span> <span class="o">=</span> <span class="n">get_istio_auth_session</span><span class="p">(</span>
</span></span><span class="line"><span class="cl">    <span class="n">url</span><span class="o">=</span><span class="n">KUBEFLOW_ENDPOINT</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">    <span class="n">username</span><span class="o">=</span><span class="n">KUBEFLOW_USERNAME</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">    <span class="n">password</span><span class="o">=</span><span class="n">KUBEFLOW_PASSWORD</span>
</span></span><span class="line"><span class="cl"><span class="p">)</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="n">client</span> <span class="o">=</span> <span class="n">kfp</span><span class="o">.</span><span class="n">Client</span><span class="p">(</span><span class="n">host</span><span class="o">=</span><span class="sa">f</span><span class="s2">&#34;</span><span class="si">{</span><span class="n">KUBEFLOW_ENDPOINT</span><span class="si">}</span><span class="s2">/pipeline&#34;</span><span class="p">,</span> <span class="n">cookies</span><span class="o">=</span><span class="n">auth_session</span><span class="p">[</span><span class="s2">&#34;session_cookie&#34;</span><span class="p">])</span>
</span></span><span class="line"><span class="cl"><span class="nb">print</span><span class="p">(</span><span class="n">client</span><span class="o">.</span><span class="n">list_experiments</span><span class="p">())</span>
</span></span></code></pre></div></details>
<h2 id="standalone-kubeflow-pipelines-subfrom-inside-clustersub">Standalone Kubeflow Pipelines <sub>(from inside cluster)</sub></h2>
<details>
<summary>Click to expand</summary>
<hr>


<div class="alert alert-warning" role="alert">
<h4 class="alert-heading">Warning</h4>

    This information only applies to <em>Standalone Kubeflow Pipelines</em>.

</div>

<p>When running inside the Kubernetes cluster, you may connect Pipelines SDK directly to the <code>ml-pipeline-ui</code> service via <a href="https://kubernetes.io/docs/concepts/services-networking/service/#discovering-services">cluster-internal service DNS resolution</a>.</p>


<div class="alert alert-info" role="alert">
<h4 class="alert-heading">Tip</h4>

    In <a href="/docs/components/pipelines/installation/standalone-deployment/">standalone deployments</a> of Kubeflow Pipelines, there is no authentication enforced on the <code>ml-pipeline-ui</code> service.

</div>

<p>For example, when running in the <strong>same namespace</strong> as Kubeflow:</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-python" data-lang="python"><span class="line"><span class="cl"><span class="kn">import</span> <span class="nn">kfp</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="n">client</span> <span class="o">=</span> <span class="n">kfp</span><span class="o">.</span><span class="n">Client</span><span class="p">(</span><span class="n">host</span><span class="o">=</span><span class="s2">&#34;http://ml-pipeline-ui:80&#34;</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="nb">print</span><span class="p">(</span><span class="n">client</span><span class="o">.</span><span class="n">list_experiments</span><span class="p">())</span>
</span></span></code></pre></div><p>For example, when running in a <strong>different namespace</strong> to Kubeflow:</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-python" data-lang="python"><span class="line"><span class="cl"><span class="kn">import</span> <span class="nn">kfp</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="c1"># the namespace in which you deployed Kubeflow Pipelines</span>
</span></span><span class="line"><span class="cl"><span class="n">namespace</span> <span class="o">=</span> <span class="s2">&#34;kubeflow&#34;</span> 
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="n">client</span> <span class="o">=</span> <span class="n">kfp</span><span class="o">.</span><span class="n">Client</span><span class="p">(</span><span class="n">host</span><span class="o">=</span><span class="sa">f</span><span class="s2">&#34;http://ml-pipeline-ui.</span><span class="si">{</span><span class="n">namespace</span><span class="si">}</span><span class="s2">&#34;</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="nb">print</span><span class="p">(</span><span class="n">client</span><span class="o">.</span><span class="n">list_experiments</span><span class="p">())</span>
</span></span></code></pre></div></details>
<h2 id="standalone-kubeflow-pipelines-subfrom-outside-clustersub">Standalone Kubeflow Pipelines <sub>(from outside cluster)</sub></h2>
<details>
<summary>Click to expand</summary>
<hr>


<div class="alert alert-warning" role="alert">
<h4 class="alert-heading">Warning</h4>

    This information only applies to <em>Standalone Kubeflow Pipelines</em>.

</div>

<p>When running outside the Kubernetes cluster, you may connect Pipelines SDK to the <code>ml-pipeline-ui</code> service by using <a href="https://kubernetes.io/docs/tasks/access-application-cluster/port-forward-access-application-cluster/">kubectl port-forwarding</a>.</p>


<div class="alert alert-info" role="alert">
<h4 class="alert-heading">Tip</h4>

    In <a href="/docs/components/pipelines/installation/standalone-deployment/">standalone deployments</a> of Kubeflow Pipelines, there is no authentication enforced on the <code>ml-pipeline-ui</code> service.

</div>

<p><strong>Step 1:</strong> run the following command on your external system to initiate port-forwarding:</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash"><span class="line"><span class="cl"><span class="c1"># change `--namespace` if you deployed Kubeflow Pipelines into a different namespace</span>
</span></span><span class="line"><span class="cl">kubectl port-forward --namespace kubeflow svc/ml-pipeline-ui 3000:80
</span></span></code></pre></div><p><strong>Step 2:</strong> the following code will create a <code>kfp.Client()</code> against your port-forwarded <code>ml-pipeline-ui</code> service:</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-python" data-lang="python"><span class="line"><span class="cl"><span class="kn">import</span> <span class="nn">kfp</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="n">client</span> <span class="o">=</span> <span class="n">kfp</span><span class="o">.</span><span class="n">Client</span><span class="p">(</span><span class="n">host</span><span class="o">=</span><span class="s2">&#34;http://localhost:3000&#34;</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="nb">print</span><span class="p">(</span><span class="n">client</span><span class="o">.</span><span class="n">list_experiments</span><span class="p">())</span>
</span></span></code></pre></div></details>
<h2 id="next-steps">Next Steps</h2>
<ul>
<li><a href="/docs/components/pipelines/tutorials/sdk-examples/">Using the Kubeflow Pipelines SDK</a></li>
<li><a href="https://kubeflow-pipelines.readthedocs.io/en/stable/">Kubeflow Pipelines SDK Reference</a></li>
<li><a href="/docs/components/pipelines/tutorials/api-pipelines/">Experiment with the Kubeflow Pipelines API</a></li>
</ul>

</div>



    
	
  
    
    
	
    

<div class="td-content" style="page-break-before: always">
    
	<h1 id="pg-95de41d77d62a53dd61ef8fe4dcf3c80">3.1.5.4 - Build a Pipeline</h1>
    <div class="lead">A tutorial on building pipelines to orchestrate your ML workflow</div>
	<!--
AUTOGENERATED FROM content/en/docs/components/pipelines/sdk/build-pipeline.ipynb
PLEASE UPDATE THE JUPYTER NOTEBOOK AND REGENERATE THIS FILE USING scripts/nb_to_md.py.-->
<style>
.notebook-links {display: flex; margin: 1em 0;}
.notebook-links a {padding: .75em; margin-right: .75em; font-weight: bold;}
a.colab-link {
padding-left: 3.25em;
background-image: url(/docs/images/logos/colab.ico);
background-repeat: no-repeat;
background-size: contain;
}
a.github-link {
padding-left: 2.75em;
background-image: url(/docs/images/logos/github.png);
background-repeat: no-repeat;
background-size: auto 75%;
background-position: left center;
}
</style>
<div class="notebook-links">
<a class="colab-link" href="https://colab.research.google.com/github/kubeflow/website/blob/master/content/en/docs/components/pipelines/sdk/build-pipeline.ipynb">Run in Google Colab</a>
<a class="github-link" href="https://github.com/kubeflow/website/blob/master/content/en/docs/components/pipelines/sdk/build-pipeline.ipynb">View source on GitHub</a>
</div>
<p>A Kubeflow pipeline is a portable and scalable definition of a machine learning
(ML) workflow. Each step in your ML workflow, such as preparing data or
training a model, is an instance of a pipeline component. This document
provides an overview of pipeline concepts and best practices, and instructions
describing how to build an ML pipeline.</p>
<h2 id="before-you-begin">Before you begin</h2>
<ol>
<li>Run the following command to install the Kubeflow Pipelines SDK. If you run this command in a Jupyter
notebook, restart the kernel after installing the SDK.</li>
</ol>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-python" data-lang="python"><span class="line"><span class="cl"><span class="err">$</span> <span class="n">pip</span> <span class="n">install</span> <span class="n">kfp</span> <span class="o">--</span><span class="n">upgrade</span>
</span></span></code></pre></div><ol start="2">
<li>Import the <code>kfp</code> and <code>kfp.components</code> packages.</li>
</ol>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-python" data-lang="python"><span class="line"><span class="cl"><span class="kn">import</span> <span class="nn">kfp</span>
</span></span><span class="line"><span class="cl"><span class="kn">import</span> <span class="nn">kfp.components</span> <span class="k">as</span> <span class="nn">comp</span>
</span></span></code></pre></div><h2 id="understanding-pipelines">Understanding pipelines</h2>
<p>A Kubeflow pipeline is a portable and scalable definition of an ML workflow,
based on containers. A pipeline is composed of a set of input parameters and a
list of the steps in this workflow. Each step in a pipeline is an instance of a
component, which is represented as an instance of
<a href="https://kubeflow-pipelines.readthedocs.io/en/latest/source/kfp.dsl.html#kfp.dsl.ContainerOp"><code>ContainerOp</code></a>.</p>
<p>You can use pipelines to:</p>
<ul>
<li>Orchestrate repeatable ML workflows.</li>
<li>Accelerate experimentation by running a workflow with different sets of
hyperparameters.</li>
</ul>
<h3 id="understanding-pipeline-components">Understanding pipeline components</h3>
<p>A pipeline component is a containerized application that performs one step in a
pipeline&rsquo;s workflow. Pipeline components are defined in
<a href="https://www.kubeflow.org/docs/components/pipelines/reference/component-spec/">component specifications</a>, which define the following:</p>
<ul>
<li>The component&rsquo;s interface, its inputs and outputs.</li>
<li>The component&rsquo;s implementation, the container image and the command to
execute.</li>
<li>The component&rsquo;s metadata, such as the name and description of the
component.</li>
</ul>
<p>You can build components by <a href="https://www.kubeflow.org/docs/components/pipelines/sdk/component-development/">defining a component specification for a
containerized application</a>, or you can <a href="https://www.kubeflow.org/docs/components/pipelines/sdk/python-function-components/">use the Kubeflow
Pipelines SDK to generate a component specification for a Python
function</a>. You can also <a href="https://www.kubeflow.org/docs/examples/shared-resources/">reuse prebuilt components
in your pipeline</a>.</p>
<h3 id="understanding-the-pipeline-graph">Understanding the pipeline graph</h3>
<p>Each step in your pipeline&rsquo;s workflow is an instance of a component. When
you define your pipeline, you specify the source of each step&rsquo;s inputs. Step
inputs can be set from the pipeline&rsquo;s input arguments, constants, or step
inputs can depend on the outputs of other steps in this pipeline. Kubeflow
Pipelines uses these dependencies to define your pipeline&rsquo;s workflow as
a graph.</p>
<p>For example, consider a pipeline with the following steps: ingest data,
generate statistics, preprocess data, and train a model. The following
describes the data dependencies between each step.</p>
<ul>
<li><strong>Ingest data</strong>: This step loads data from an external source which is
specified using a pipeline argument, and it outputs a dataset. Since
this step does not depend on the output of any other steps, this step
can run first.</li>
<li><strong>Generate statistics</strong>: This step uses the ingested dataset to generate
and output a set of statistics. Since this step depends on the dataset
produced by the ingest data step, it must run after the ingest data step.</li>
<li><strong>Preprocess data</strong>: This step preprocesses the ingested dataset and
transforms the data into a preprocessed dataset. Since this step depends
on the dataset produced by the ingest data step, it must run after the
ingest data step.</li>
<li><strong>Train a model</strong>: This step trains a model using the preprocessed dataset,
the generated statistics, and pipeline parameters, such as the learning
rate. Since this step depends on the preprocessed data and the generated
statistics, it must run after both the preprocess data and generate
statistics steps are complete.</li>
</ul>
<p>Since the generate statistics and preprocess data steps both depend on the
ingested data, the generate statistics and preprocess data steps can run in
parallel. All other steps are executed once their data dependencies are
available.</p>
<h2 id="designing-your-pipeline">Designing your pipeline</h2>
<p>When designing your pipeline, think about how to split your ML workflow into
pipeline components. The process of splitting an ML workflow into pipeline
components is similar to the process of splitting a monolithic script into
testable functions. The following rules can help you define the components
that you need to build your pipeline.</p>
<ul>
<li>
<p>Components should have a single responsibility. Having a single
responsibility makes it easier to test and reuse a component. For example,
if you have a component that loads data you can reuse that for similar
tasks that load data. If you have a component that loads and transforms
a dataset, the component can be less useful since you can use it only when
you need to load and transform that dataset.</p>
</li>
<li>
<p>Reuse components when possible. Kubeflow Pipelines provides <a href="https://www.kubeflow.org/docs/examples/shared-resources/">components for
common pipeline tasks and for access to cloud
services</a>.</p>
</li>
<li>
<p>Consider what you need to know to debug your pipeline and research the
lineage of the models that your pipeline produces. Kubeflow Pipelines
stores the inputs and outputs of each pipeline step. By interrogating the
artifacts produced by a pipeline run, you can better understand the
variations in model quality between runs or track down bugs in your
workflow.</p>
</li>
</ul>
<p>In general, you should design your components with composability in mind.</p>
<p>Pipelines are composed of component instances, also called steps. Steps can
define their inputs as depending on the output of another step. The
dependencies between steps define the pipeline workflow graph.</p>
<h3 id="building-pipeline-components">Building pipeline components</h3>
<p>Kubeflow pipeline components are containerized applications that perform a
step in your ML workflow. Here are the ways that you can define pipeline
components:</p>
<ul>
<li>
<p>If you have a containerized application that you want to use as a
pipeline component, create a component specification to define this
container image as a pipeline component.</p>
<p>This option provides the flexibility to include code written in any
language in your pipeline, so long as you can package the application
as a container image. Learn more about <a href="https://www.kubeflow.org/docs/components/pipelines/sdk/component-development/">building pipeline
components</a>.</p>
</li>
<li>
<p>If your component code can be expressed as a Python function, <a href="https://www.kubeflow.org/docs/components/pipelines/sdk/python-function-components/">evaluate if
your component can be built as a Python function-based
component</a>. The Kubeflow Pipelines SDK makes it
easier to build lightweight Python function-based components by saving you
the effort of creating a component specification.</p>
</li>
</ul>
<p>Whenever possible, <a href="https://www.kubeflow.org/docs/examples/shared-resources/">reuse prebuilt components</a> to save
yourself the effort of building custom components.</p>
<p>The example in this guide demonstrates how to build a pipeline that uses a
Python function-based component and reuses a prebuilt component.</p>
<h3 id="understanding-how-data-is-passed-between-components">Understanding how data is passed between components</h3>
<p>When Kubeflow Pipelines runs a component, a container image is started in a
Kubernetes Pod and your components inputs are passed in as command-line
arguments. When your component has finished, the component&rsquo;s outputs are
returned as files.</p>
<p>In your component&rsquo;s specification, you define the components inputs and outputs
and how the inputs and output paths are passed to your program as command-line
arguments. You can pass small inputs, such as short strings or numbers, to your
component by value. Large inputs, such as datasets, must be passed to your
component as file paths. Outputs are written to the paths that Kubeflow
Pipelines provides.</p>
<p>Python function-based components make it easier to build pipeline components
by building the component specification for you. Python function-based
components also handle the complexity of passing inputs into your component
and passing your functions outputs back to your pipeline.</p>
<p>Learn more about how <a href="https://www.kubeflow.org/docs/components/pipelines/sdk/python-function-components/#understanding-how-data-is-passed-between-components">Python function-based components handle inputs and
outputs</a>.</p>
<h2 id="getting-started-building-a-pipeline">Getting started building a pipeline</h2>
<p>The following sections demonstrate how to get started building a Kubeflow
pipeline by walking through the process of converting a Python script into
a pipeline.</p>
<h3 id="design-your-pipeline">Design your pipeline</h3>
<p>The following steps walk through some of the design decisions you may face
when designing a pipeline.</p>
<ol>
<li>Evaluate the process. In the following example, a Python function downloads
a zipped tar file (<code>.tar.gz</code>) that contains several CSV files, from a
public website. The function extracts the CSV files and then merges them
into a single file.</li>
</ol>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-python" data-lang="python"><span class="line"><span class="cl"><span class="kn">import</span> <span class="nn">glob</span>
</span></span><span class="line"><span class="cl"><span class="kn">import</span> <span class="nn">pandas</span> <span class="k">as</span> <span class="nn">pd</span>
</span></span><span class="line"><span class="cl"><span class="kn">import</span> <span class="nn">tarfile</span>
</span></span><span class="line"><span class="cl"><span class="kn">import</span> <span class="nn">urllib.request</span>
</span></span><span class="line"><span class="cl">    
</span></span><span class="line"><span class="cl"><span class="k">def</span> <span class="nf">download_and_merge_csv</span><span class="p">(</span><span class="n">url</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span> <span class="n">output_csv</span><span class="p">:</span> <span class="nb">str</span><span class="p">):</span>
</span></span><span class="line"><span class="cl">  <span class="k">with</span> <span class="n">urllib</span><span class="o">.</span><span class="n">request</span><span class="o">.</span><span class="n">urlopen</span><span class="p">(</span><span class="n">url</span><span class="p">)</span> <span class="k">as</span> <span class="n">res</span><span class="p">:</span>
</span></span><span class="line"><span class="cl">    <span class="n">tarfile</span><span class="o">.</span><span class="n">open</span><span class="p">(</span><span class="n">fileobj</span><span class="o">=</span><span class="n">res</span><span class="p">,</span> <span class="n">mode</span><span class="o">=</span><span class="s2">&#34;r|gz&#34;</span><span class="p">)</span><span class="o">.</span><span class="n">extractall</span><span class="p">(</span><span class="s1">&#39;data&#39;</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">  <span class="n">df</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">concat</span><span class="p">(</span>
</span></span><span class="line"><span class="cl">      <span class="p">[</span><span class="n">pd</span><span class="o">.</span><span class="n">read_csv</span><span class="p">(</span><span class="n">csv_file</span><span class="p">,</span> <span class="n">header</span><span class="o">=</span><span class="kc">None</span><span class="p">)</span> 
</span></span><span class="line"><span class="cl">       <span class="k">for</span> <span class="n">csv_file</span> <span class="ow">in</span> <span class="n">glob</span><span class="o">.</span><span class="n">glob</span><span class="p">(</span><span class="s1">&#39;data/*.csv&#39;</span><span class="p">)])</span>
</span></span><span class="line"><span class="cl">  <span class="n">df</span><span class="o">.</span><span class="n">to_csv</span><span class="p">(</span><span class="n">output_csv</span><span class="p">,</span> <span class="n">index</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">header</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
</span></span></code></pre></div><ol start="2">
<li>Run the following Python command to test the function.</li>
</ol>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-python" data-lang="python"><span class="line"><span class="cl"><span class="n">download_and_merge_csv</span><span class="p">(</span>
</span></span><span class="line"><span class="cl">    <span class="n">url</span><span class="o">=</span><span class="s1">&#39;https://storage.googleapis.com/ml-pipeline-playground/iris-csv-files.tar.gz&#39;</span><span class="p">,</span> 
</span></span><span class="line"><span class="cl">    <span class="n">output_csv</span><span class="o">=</span><span class="s1">&#39;merged_data.csv&#39;</span><span class="p">)</span>
</span></span></code></pre></div><ol start="3">
<li>Run the following to print the first few rows of the
merged CSV file.</li>
</ol>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-python" data-lang="python"><span class="line"><span class="cl"><span class="err">$</span> <span class="n">head</span> <span class="n">merged_data</span><span class="o">.</span><span class="n">csv</span>
</span></span></code></pre></div><ol start="4">
<li>
<p>Design your pipeline. For example, consider the following pipeline designs.</p>
<ul>
<li>
<p>Implement the pipeline using a single step. In this case, the pipeline
contains one component that works similarly to the example function.
This is a straightforward function, and implementing a single-step
pipeline is a reasonable approach in this case.</p>
<p>The down side of this approach is that the zipped tar file would not be
an artifact of your pipeline runs. Not having this artifact available
could make it harder to debug this component in production.</p>
</li>
<li>
<p>Implement this as a two-step pipeline. The first step downloads a file
from a website. The second step extracts the CSV files from a zipped
tar file and merges them into a single file.</p>
<p>This approach has a few benefits:</p>
<ul>
<li>You can reuse the <a href="https://github.com/kubeflow/pipelines/blob/sdk/release-1.8/components/web/Download/component.yaml">Web Download component</a>
to implement the first step.</li>
<li>Each step has a single responsibility, which makes the components
easier to reuse.</li>
<li>The zipped tar file is an artifact of the first pipeline step.
This means that you can examine this artifact when debugging
pipelines that use this component.</li>
</ul>
</li>
</ul>
<p>This example implements a two-step pipeline.</p>
</li>
</ol>
<h3 id="build-your-pipeline-components">Build your pipeline components</h3>
<ol>
<li>
<p>Build your pipeline components. This example modifies the initial script to
extract the contents of a zipped tar file, merge the CSV files that were
contained in the zipped tar file, and return the merged CSV file.</p>
<p>This example builds a Python function-based component. You can also package
your component&rsquo;s code as a Docker container image and define the component
using a ComponentSpec.</p>
<p>In this case, the following modifications were required to the original
function.</p>
<ul>
<li>The file download logic was removed. The path to the zipped tar file
is passed as an argument to this function.</li>
<li>The import statements were moved inside of the function. Python
function-based components require standalone Python functions. This
means that any required import statements must be defined within the
function, and any helper functions must be defined within the function.
Learn more about <a href="https://www.kubeflow.org/docs/components/pipelines/sdk/python-function-components/">building Python function-based
components</a>.</li>
<li>The function&rsquo;s arguments are decorated with the
<a href="https://kubeflow-pipelines.readthedocs.io/en/latest/source/kfp.components.html?highlight=inputpath#kfp.components.InputPath"><code>kfp.components.InputPath</code></a> and the
<a href="https://kubeflow-pipelines.readthedocs.io/en/latest/source/kfp.components.html?highlight=outputpath#kfp.components.OutputPath"><code>kfp.components.OutputPath</code></a> annotations. These
annotations let Kubeflow Pipelines know to provide the path to the
zipped tar file and to create a path where your function stores the
merged CSV file.</li>
</ul>
<p>The following example shows the updated <code>merge_csv</code> function.</p>
</li>
</ol>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-python" data-lang="python"><span class="line"><span class="cl"><span class="k">def</span> <span class="nf">merge_csv</span><span class="p">(</span><span class="n">file_path</span><span class="p">:</span> <span class="n">comp</span><span class="o">.</span><span class="n">InputPath</span><span class="p">(</span><span class="s1">&#39;Tarball&#39;</span><span class="p">),</span>
</span></span><span class="line"><span class="cl">              <span class="n">output_csv</span><span class="p">:</span> <span class="n">comp</span><span class="o">.</span><span class="n">OutputPath</span><span class="p">(</span><span class="s1">&#39;CSV&#39;</span><span class="p">)):</span>
</span></span><span class="line"><span class="cl">  <span class="kn">import</span> <span class="nn">glob</span>
</span></span><span class="line"><span class="cl">  <span class="kn">import</span> <span class="nn">pandas</span> <span class="k">as</span> <span class="nn">pd</span>
</span></span><span class="line"><span class="cl">  <span class="kn">import</span> <span class="nn">tarfile</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">  <span class="n">tarfile</span><span class="o">.</span><span class="n">open</span><span class="p">(</span><span class="n">name</span><span class="o">=</span><span class="n">file_path</span><span class="p">,</span> <span class="n">mode</span><span class="o">=</span><span class="s2">&#34;r|gz&#34;</span><span class="p">)</span><span class="o">.</span><span class="n">extractall</span><span class="p">(</span><span class="s1">&#39;data&#39;</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">  <span class="n">df</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">concat</span><span class="p">(</span>
</span></span><span class="line"><span class="cl">      <span class="p">[</span><span class="n">pd</span><span class="o">.</span><span class="n">read_csv</span><span class="p">(</span><span class="n">csv_file</span><span class="p">,</span> <span class="n">header</span><span class="o">=</span><span class="kc">None</span><span class="p">)</span> 
</span></span><span class="line"><span class="cl">       <span class="k">for</span> <span class="n">csv_file</span> <span class="ow">in</span> <span class="n">glob</span><span class="o">.</span><span class="n">glob</span><span class="p">(</span><span class="s1">&#39;data/*.csv&#39;</span><span class="p">)])</span>
</span></span><span class="line"><span class="cl">  <span class="n">df</span><span class="o">.</span><span class="n">to_csv</span><span class="p">(</span><span class="n">output_csv</span><span class="p">,</span> <span class="n">index</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">header</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
</span></span></code></pre></div><ol start="2">
<li>Use <a href="https://kubeflow-pipelines.readthedocs.io/en/latest/source/kfp.components.html#kfp.components.create_component_from_func"><code>kfp.components.create_component_from_func</code></a>
to return a factory function that you can use to create pipeline steps.
This example also specifies the base container image to run this function
in, the path to save the component specification to, and a list of PyPI
packages that need to be installed in the container at runtime.</li>
</ol>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-python" data-lang="python"><span class="line"><span class="cl"><span class="n">create_step_merge_csv</span> <span class="o">=</span> <span class="n">kfp</span><span class="o">.</span><span class="n">components</span><span class="o">.</span><span class="n">create_component_from_func</span><span class="p">(</span>
</span></span><span class="line"><span class="cl">    <span class="n">func</span><span class="o">=</span><span class="n">merge_csv</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">    <span class="n">output_component_file</span><span class="o">=</span><span class="s1">&#39;component.yaml&#39;</span><span class="p">,</span> <span class="c1"># This is optional. It saves the component spec for future use.</span>
</span></span><span class="line"><span class="cl">    <span class="n">base_image</span><span class="o">=</span><span class="s1">&#39;python:3.7&#39;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">    <span class="n">packages_to_install</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;pandas==1.1.4&#39;</span><span class="p">])</span>
</span></span></code></pre></div><h3 id="build-your-pipeline">Build your pipeline</h3>
<ol>
<li>Use <a href="https://kubeflow-pipelines.readthedocs.io/en/latest/source/kfp.components.html?highlight=load_component_from_url#kfp.components.load_component_from_url"><code>kfp.components.load_component_from_url</code></a>
to load the component specification YAML for any components that you are
reusing in this pipeline.</li>
</ol>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-python" data-lang="python"><span class="line"><span class="cl"><span class="n">web_downloader_op</span> <span class="o">=</span> <span class="n">kfp</span><span class="o">.</span><span class="n">components</span><span class="o">.</span><span class="n">load_component_from_url</span><span class="p">(</span>
</span></span><span class="line"><span class="cl">    <span class="s1">&#39;https://raw.githubusercontent.com/kubeflow/pipelines/master/components/contrib/web/Download/component.yaml&#39;</span><span class="p">)</span>
</span></span></code></pre></div><ol start="2">
<li>
<p>Define your pipeline as a Python function.</p>
<p>Your pipeline function&rsquo;s arguments define your pipeline&rsquo;s parameters. Use
pipeline parameters to experiment with different hyperparameters, such as
the learning rate used to train a model, or pass run-level inputs, such as
the path to an input file, into a pipeline run.</p>
<p>Use the factory functions created by
<code>kfp.components.create_component_from_func</code> and
<code>kfp.components.load_component_from_url</code> to create your pipeline&rsquo;s tasks.
The inputs to the component factory functions can be pipeline parameters,
the outputs of other tasks, or a constant value. In this case, the
<code>web_downloader_task</code> task uses the <code>url</code> pipeline parameter, and the
<code>merge_csv_task</code> uses the <code>data</code> output of the <code>web_downloader_task</code>.</p>
</li>
</ol>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-python" data-lang="python"><span class="line"><span class="cl"><span class="c1"># Define a pipeline and create a task from a component:</span>
</span></span><span class="line"><span class="cl"><span class="k">def</span> <span class="nf">my_pipeline</span><span class="p">(</span><span class="n">url</span><span class="p">):</span>
</span></span><span class="line"><span class="cl">  <span class="n">web_downloader_task</span> <span class="o">=</span> <span class="n">web_downloader_op</span><span class="p">(</span><span class="n">url</span><span class="o">=</span><span class="n">url</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">  <span class="n">merge_csv_task</span> <span class="o">=</span> <span class="n">create_step_merge_csv</span><span class="p">(</span><span class="n">file</span><span class="o">=</span><span class="n">web_downloader_task</span><span class="o">.</span><span class="n">outputs</span><span class="p">[</span><span class="s1">&#39;data&#39;</span><span class="p">])</span>
</span></span><span class="line"><span class="cl">  <span class="c1"># The outputs of the merge_csv_task can be referenced using the</span>
</span></span><span class="line"><span class="cl">  <span class="c1"># merge_csv_task.outputs dictionary: merge_csv_task.outputs[&#39;output_csv&#39;]</span>
</span></span></code></pre></div><h3 id="compile-and-run-your-pipeline">Compile and run your pipeline</h3>
<p>After defining the pipeline in Python as described in the preceding section, use one of the following options to compile the pipeline and submit it to the Kubeflow Pipelines service.</p>
<h4 id="option-1-compile-and-then-upload-in-ui">Option 1: Compile and then upload in UI</h4>
<ol>
<li>Run the following to compile your pipeline and save it as <code>pipeline.yaml</code>.</li>
</ol>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-python" data-lang="python"><span class="line"><span class="cl"><span class="n">kfp</span><span class="o">.</span><span class="n">compiler</span><span class="o">.</span><span class="n">Compiler</span><span class="p">()</span><span class="o">.</span><span class="n">compile</span><span class="p">(</span>
</span></span><span class="line"><span class="cl">    <span class="n">pipeline_func</span><span class="o">=</span><span class="n">my_pipeline</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">    <span class="n">package_path</span><span class="o">=</span><span class="s1">&#39;pipeline.yaml&#39;</span><span class="p">)</span>
</span></span></code></pre></div><ol start="2">
<li>Upload and run your <code>pipeline.yaml</code> using the Kubeflow Pipelines user interface.
See the guide to <a href="https://www.kubeflow.org/docs/components/pipelines/overview/quickstart">getting started with the UI</a>.</li>
</ol>
<h4 id="option-2-run-the-pipeline-using-kubeflow-pipelines-sdk-client">Option 2: run the pipeline using Kubeflow Pipelines SDK client</h4>
<ol>
<li>Create an instance of the <a href="https://kubeflow-pipelines.readthedocs.io/en/latest/source/kfp.client.html#kfp.Client"><code>kfp.Client</code> class</a> following steps in <a href="https://www.kubeflow.org/docs/components/pipelines/sdk/connect-api">connecting to Kubeflow Pipelines using the SDK client</a>.</li>
</ol>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-python" data-lang="python"><span class="line"><span class="cl"><span class="n">client</span> <span class="o">=</span> <span class="n">kfp</span><span class="o">.</span><span class="n">Client</span><span class="p">()</span> <span class="c1"># change arguments accordingly</span>
</span></span></code></pre></div><ol start="2">
<li>Run the pipeline using the <code>kfp.Client</code> instance:</li>
</ol>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-python" data-lang="python"><span class="line"><span class="cl"><span class="n">client</span><span class="o">.</span><span class="n">create_run_from_pipeline_func</span><span class="p">(</span>
</span></span><span class="line"><span class="cl">    <span class="n">my_pipeline</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">    <span class="n">arguments</span><span class="o">=</span><span class="p">{</span>
</span></span><span class="line"><span class="cl">        <span class="s1">&#39;url&#39;</span><span class="p">:</span> <span class="s1">&#39;https://storage.googleapis.com/ml-pipeline-playground/iris-csv-files.tar.gz&#39;</span>
</span></span><span class="line"><span class="cl">    <span class="p">})</span>
</span></span></code></pre></div><h2 id="next-steps">Next steps</h2>
<ul>
<li>Learn about advanced pipeline features, such as <a href="https://www.kubeflow.org/docs/components/pipelines/sdk/dsl-recursion/">authoring recursive
components</a> and <a href="https://github.com/kubeflow/pipelines/blob/sdk/release-1.8/samples/tutorials/DSL%20-%20Control%20structures/DSL%20-%20Control%20structures.py">using conditional execution in a
pipeline</a>.</li>
<li>Learn how to <a href="https://www.kubeflow.org/docs/components/pipelines/sdk/manipulate-resources/">manipulate Kubernetes resources in a
pipeline</a> (Experimental).</li>
</ul>
<div class="notebook-links">
<a class="colab-link" href="https://colab.research.google.com/github/kubeflow/website/blob/master/content/en/docs/components/pipelines/sdk/build-pipeline.ipynb">Run in Google Colab</a>
<a class="github-link" href="https://github.com/kubeflow/website/blob/master/content/en/docs/components/pipelines/sdk/build-pipeline.ipynb">View source on GitHub</a>
</div>

</div>



    
	
  
    
    
	
    

<div class="td-content" style="page-break-before: always">
    
	<h1 id="pg-201764e91fc94af83f5f9784d2243490">3.1.5.5 - Building Components</h1>
    <div class="lead">A tutorial on how to create components and use them in a pipeline</div>
	<p>A pipeline component is a self-contained set of code that performs one step in
your ML workflow. This document describes the concepts required to build
components, and demonstrates how to get started building components.</p>
<h2 id="before-you-begin">Before you begin</h2>
<p>Run the following command to install the Kubeflow Pipelines SDK.</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-python" data-lang="python"><span class="line"><span class="cl"><span class="err">$</span> <span class="n">pip3</span> <span class="n">install</span> <span class="n">kfp</span> <span class="o">--</span><span class="n">upgrade</span>
</span></span></code></pre></div><p>For more information about the Kubeflow Pipelines SDK, see the <a href="https://kubeflow-pipelines.readthedocs.io/en/latest/index.html">SDK reference guide</a>.</p>
<h2 id="understanding-pipeline-components">Understanding pipeline components</h2>
<p>Pipeline components are self-contained sets of code that perform one step in
your ML workflow, such as preprocessing data or training a model. To create a
component, you must <em>build the component&rsquo;s implementation</em> and <em>define the
component specification</em>.</p>
<p>Your component&rsquo;s implementation includes the component&rsquo;s executable code and
the Docker container image that the code runs in.  <a href="#design">Learn more about designing
a pipeline component</a>.</p>
<p>Once you have built your component&rsquo;s implementation, you can define your
component&rsquo;s interface as a component specification. A component specification
defines:</p>
<ul>
<li>The component&rsquo;s inputs and outputs.</li>
<li>The container image that your component&rsquo;s code runs in, the command to use
to run your component&rsquo;s code, and the command-line arguments to pass to
your component&rsquo;s code.</li>
<li>The component&rsquo;s metadata, such as the name and description.</li>
</ul>
<p><a href="#component-spec">Learn more about creating a component specification</a>.</p>
<p>If your component&rsquo;s code is implemented as a Python function, use the
Kubeflow Pipelines SDK to package your function as a component. <a href="https://www.kubeflow.org/docs/pipelines/sdk/python-function-components/">Learn more
about building Python function-based components</a>.</p>
<p><a name="design"></a></p>
<h2 id="designing-a-pipeline-component">Designing a pipeline component</h2>
<p>When Kubeflow Pipelines executes a component, a container image is started in a
Kubernetes Pod and your component&rsquo;s inputs are passed in as command-line
arguments. You can pass small inputs, such as strings and numbers, by value.
Larger inputs, such as CSV data, must be passed as paths to files. When your
component has finished, the component&rsquo;s outputs are returned as files.</p>
<p>When you design your component&rsquo;s code, consider the following:</p>
<ul>
<li>Which inputs can be passed to your component by value? Examples of inputs that you
can pass by value include numbers, booleans, and short strings. Any value that you
could reasonably pass as a command-line argument can be passed to your component by
value.  All other inputs are passed to your component by a reference to the input&rsquo;s path.</li>
<li>To return an output from your component, the output&rsquo;s data must be stored as a file.
When you define your component, you let Kubeflow Pipelines know what outputs your
component produces. When your pipeline runs, Kubeflow Pipelines passes the
paths that you use to store your component&rsquo;s outputs as inputs to your component.</li>
<li>Outputs are typically written to a single file. In some cases, you may need to
return a directory of files as an output. In this case, create a directory at the
output path and write the output files to that location. In both cases, it may be
necessary to create parent directories if they do not exist.</li>
<li>Your component&rsquo;s goal may be to create a dataset in an external service,
such as a BigQuery table. In this case, it may make sense for the component
to output an identifier for the produced data, such as a table name,
instead of the data itself. We recommend that you limit this pattern to
cases where the data must be put into an external system instead of keeping it
inside the Kubeflow Pipelines system.</li>
<li>Since your inputs and output paths are passed in as command-line
arguments, your component&rsquo;s code must be able to read inputs from the
command line. If your component is built with Python, libraries such as
<a href="https://docs.python.org/3/library/argparse.html">argparse</a> and
<a href="https://abseil.io/docs/python/guides/flags">absl.flags</a> make it easier to
read your component&rsquo;s inputs.</li>
<li>Your component&rsquo;s code can be implemented in any language, so long as it can
run in a container image.</li>
</ul>
<p>The following is an example program written using Python3. This program reads a
given number of lines from an input file and writes those lines to an output
file. This means that this function accepts three command-line parameters:</p>
<ul>
<li>The path to the input file.</li>
<li>The number of lines to read.</li>
<li>The path to the output file.</li>
</ul>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-python" data-lang="python"><span class="line"><span class="cl"><span class="ch">#!/usr/bin/env python3</span>
</span></span><span class="line"><span class="cl"><span class="kn">import</span> <span class="nn">argparse</span>
</span></span><span class="line"><span class="cl"><span class="kn">from</span> <span class="nn">pathlib</span> <span class="kn">import</span> <span class="n">Path</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="c1"># Function doing the actual work (Outputs first N lines from a text file)</span>
</span></span><span class="line"><span class="cl"><span class="k">def</span> <span class="nf">do_work</span><span class="p">(</span><span class="n">input1_file</span><span class="p">,</span> <span class="n">output1_file</span><span class="p">,</span> <span class="n">param1</span><span class="p">):</span>
</span></span><span class="line"><span class="cl">  <span class="k">for</span> <span class="n">x</span><span class="p">,</span> <span class="n">line</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">input1_file</span><span class="p">):</span>
</span></span><span class="line"><span class="cl">    <span class="k">if</span> <span class="n">x</span> <span class="o">&gt;=</span> <span class="n">param1</span><span class="p">:</span>
</span></span><span class="line"><span class="cl">      <span class="k">break</span>
</span></span><span class="line"><span class="cl">    <span class="n">_</span> <span class="o">=</span> <span class="n">output1_file</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="n">line</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">  
</span></span><span class="line"><span class="cl"><span class="c1"># Defining and parsing the command-line arguments</span>
</span></span><span class="line"><span class="cl"><span class="n">parser</span> <span class="o">=</span> <span class="n">argparse</span><span class="o">.</span><span class="n">ArgumentParser</span><span class="p">(</span><span class="n">description</span><span class="o">=</span><span class="s1">&#39;My program description&#39;</span><span class="p">)</span>
</span></span><span class="line"><span class="cl"><span class="c1"># Paths must be passed in, not hardcoded</span>
</span></span><span class="line"><span class="cl"><span class="n">parser</span><span class="o">.</span><span class="n">add_argument</span><span class="p">(</span><span class="s1">&#39;--input1-path&#39;</span><span class="p">,</span> <span class="nb">type</span><span class="o">=</span><span class="nb">str</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">  <span class="n">help</span><span class="o">=</span><span class="s1">&#39;Path of the local file containing the Input 1 data.&#39;</span><span class="p">)</span>
</span></span><span class="line"><span class="cl"><span class="n">parser</span><span class="o">.</span><span class="n">add_argument</span><span class="p">(</span><span class="s1">&#39;--output1-path&#39;</span><span class="p">,</span> <span class="nb">type</span><span class="o">=</span><span class="nb">str</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">  <span class="n">help</span><span class="o">=</span><span class="s1">&#39;Path of the local file where the Output 1 data should be written.&#39;</span><span class="p">)</span>
</span></span><span class="line"><span class="cl"><span class="n">parser</span><span class="o">.</span><span class="n">add_argument</span><span class="p">(</span><span class="s1">&#39;--param1&#39;</span><span class="p">,</span> <span class="nb">type</span><span class="o">=</span><span class="nb">int</span><span class="p">,</span> <span class="n">default</span><span class="o">=</span><span class="mi">100</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">  <span class="n">help</span><span class="o">=</span><span class="s1">&#39;The number of lines to read from the input and write to the output.&#39;</span><span class="p">)</span>
</span></span><span class="line"><span class="cl"><span class="n">args</span> <span class="o">=</span> <span class="n">parser</span><span class="o">.</span><span class="n">parse_args</span><span class="p">()</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="c1"># Creating the directory where the output file is created (the directory</span>
</span></span><span class="line"><span class="cl"><span class="c1"># may or may not exist).</span>
</span></span><span class="line"><span class="cl"><span class="n">Path</span><span class="p">(</span><span class="n">args</span><span class="o">.</span><span class="n">output1_path</span><span class="p">)</span><span class="o">.</span><span class="n">parent</span><span class="o">.</span><span class="n">mkdir</span><span class="p">(</span><span class="n">parents</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">exist_ok</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="k">with</span> <span class="nb">open</span><span class="p">(</span><span class="n">args</span><span class="o">.</span><span class="n">input1_path</span><span class="p">,</span> <span class="s1">&#39;r&#39;</span><span class="p">)</span> <span class="k">as</span> <span class="n">input1_file</span><span class="p">:</span>
</span></span><span class="line"><span class="cl">    <span class="k">with</span> <span class="nb">open</span><span class="p">(</span><span class="n">args</span><span class="o">.</span><span class="n">output1_path</span><span class="p">,</span> <span class="s1">&#39;w&#39;</span><span class="p">)</span> <span class="k">as</span> <span class="n">output1_file</span><span class="p">:</span>
</span></span><span class="line"><span class="cl">        <span class="n">do_work</span><span class="p">(</span><span class="n">input1_file</span><span class="p">,</span> <span class="n">output1_file</span><span class="p">,</span> <span class="n">args</span><span class="o">.</span><span class="n">param1</span><span class="p">)</span>
</span></span></code></pre></div><p>If this program is saved as <code>program.py</code>, the command-line invocation of this
program is:</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash"><span class="line"><span class="cl">python3 program.py --input1-path &lt;path-to-the-input-file&gt; <span class="se">\
</span></span></span><span class="line"><span class="cl"><span class="se"></span>  --param1 &lt;number-of-lines-to-read&gt; <span class="se">\
</span></span></span><span class="line"><span class="cl"><span class="se"></span>  --output1-path &lt;path-to-write-the-output-to&gt; 
</span></span></code></pre></div><h2 id="containerize-your-components-code">Containerize your component&rsquo;s code</h2>
<p>For Kubeflow Pipelines to run your component, your component must be packaged
as a <a href="https://docs.docker.com/get-started/">Docker</a> container image and published to a container registry
that your Kubernetes cluster can access. The steps to create a container image
are not specific to Kubeflow Pipelines. To make things easier for you, this
section provides some guidelines on standard container creation.</p>
<ol>
<li>
<p>Create a <a href="https://docs.docker.com/engine/reference/builder/">Dockerfile</a> for your container. A Dockerfile
specifies:</p>
<ul>
<li>The base container image. For example, the operating system that your
code runs on.</li>
<li>Any dependencies that need to be installed for your code to run.</li>
<li>Files to copy into the container, such as the runnable code for this
component.</li>
</ul>
<p>The following is an example Dockerfile.</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-fallback" data-lang="fallback"><span class="line"><span class="cl">FROM python:3.7
</span></span><span class="line"><span class="cl">RUN python3 -m pip install keras
</span></span><span class="line"><span class="cl">COPY ./src /pipelines/component/src
</span></span></code></pre></div><p>In this example:</p>
<ul>
<li>The base container image is <a href="https://hub.docker.com/_/python"><code>python:3.7</code></a>.</li>
<li>The <code>keras</code> Python package is installed in the container image.</li>
<li>Files in your <code>./src</code> directory are copied into
<code>/pipelines/component/src</code> in the container image.</li>
</ul>
</li>
<li>
<p>Create a script named <code>build_image.sh</code> that uses Docker to build your
container image and push your container image to a container registry.
Your Kubernetes cluster must be able to access your container registry
to run your component. Examples of container registries include <a href="https://cloud.google.com/container-registry/docs/">Google
Container Registry</a> and
<a href="https://hub.docker.com/">Docker Hub</a>.</p>
<p>The following example builds a container image, pushes it to a container
registry, and outputs the strict image name. It is a best practice to use
the strict image name in your component specification to ensure that you
are using the expected version of a container image in each component
execution.</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash"><span class="line"><span class="cl"><span class="cp">#!/bin/bash -e
</span></span></span><span class="line"><span class="cl"><span class="cp"></span><span class="nv">image_name</span><span class="o">=</span>gcr.io/my-org/my-image
</span></span><span class="line"><span class="cl"><span class="nv">image_tag</span><span class="o">=</span>latest
</span></span><span class="line"><span class="cl"><span class="nv">full_image_name</span><span class="o">=</span><span class="si">${</span><span class="nv">image_name</span><span class="si">}</span>:<span class="si">${</span><span class="nv">image_tag</span><span class="si">}</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="nb">cd</span> <span class="s2">&#34;</span><span class="k">$(</span>dirname <span class="s2">&#34;</span><span class="nv">$0</span><span class="s2">&#34;</span><span class="k">)</span><span class="s2">&#34;</span> 
</span></span><span class="line"><span class="cl">docker build -t <span class="s2">&#34;</span><span class="si">${</span><span class="nv">full_image_name</span><span class="si">}</span><span class="s2">&#34;</span> .
</span></span><span class="line"><span class="cl">docker push <span class="s2">&#34;</span><span class="nv">$full_image_name</span><span class="s2">&#34;</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="c1"># Output the strict image name, which contains the sha256 image digest</span>
</span></span><span class="line"><span class="cl">docker inspect --format<span class="o">=</span><span class="s2">&#34;{{index .RepoDigests 0}}&#34;</span> <span class="s2">&#34;</span><span class="si">${</span><span class="nv">full_image_name</span><span class="si">}</span><span class="s2">&#34;</span>
</span></span></code></pre></div><p>In the preceding example:</p>
<ul>
<li>The <code>image_name</code> specifies the full name of your container image in the
container registry.</li>
<li>The <code>image_tag</code> specifies that this image should be tagged as
<strong>latest</strong>.</li>
</ul>
<p>Save this file and run the following to make this script executable.</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash"><span class="line"><span class="cl">chmod +x build_image.sh
</span></span></code></pre></div></li>
<li>
<p>Run your <code>build_image.sh</code> script to build your container image and push it
to a container registry.</p>
</li>
<li>
<p><a href="https://docs.docker.com/engine/reference/commandline/run/">Use <code>docker run</code> to test your container image locally</a>. If
necessary, revise your application and Dockerfile until your application
works as expected in the container.</p>
</li>
</ol>
<p><a name="component-spec"></a></p>
<h2 id="creating-a-component-specification">Creating a component specification</h2>
<p>To create a component from your containerized program, you must create a
component specification that defines the component&rsquo;s interface and
implementation. The following sections provide an overview of how to create a
component specification by demonstrating how to define the component&rsquo;s
implementation, interface, and metadata.</p>
<p>To learn more about defining a component specification, see the
<a href="/docs/components/pipelines/reference/component-spec/">component specification reference guide</a>.</p>
<h3 id="define-your-components-implementation">Define your component&rsquo;s implementation</h3>
<p>The following example creates a component specification YAML and defines the
component&rsquo;s implementation.</p>
<ol>
<li>
<p>Create a file named <code>component.yaml</code> and open it in a text editor.</p>
</li>
<li>
<p>Create your component&rsquo;s implementation section and specify the strict name
of your container image. The strict image name is provided when you run
your <code>build_image.sh</code> script.</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-yaml" data-lang="yaml"><span class="line"><span class="cl"><span class="nt">implementation</span><span class="p">:</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">  </span><span class="nt">container</span><span class="p">:</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="c"># The strict name of a container image that you&#39;ve pushed to a container registry.</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="nt">image</span><span class="p">:</span><span class="w"> </span><span class="l">gcr.io/my-org/my-image@sha256:a172..752f</span><span class="w">
</span></span></span></code></pre></div></li>
<li>
<p>Define a <code>command</code> for your component&rsquo;s implementation. This field
specifies the command-line arguments that are used to run your program in
the container.</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-yaml" data-lang="yaml"><span class="line"><span class="cl"><span class="nt">implementation</span><span class="p">:</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">  </span><span class="nt">container</span><span class="p">:</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="nt">image</span><span class="p">:</span><span class="w"> </span><span class="l">gcr.io/my-org/my-image@sha256:a172..752f</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="c"># command is a list of strings (command-line arguments). </span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="c"># The YAML language has two syntaxes for lists and you can use either of them. </span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="c"># Here we use the &#34;flow syntax&#34; - comma-separated strings inside square brackets.</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="nt">command</span><span class="p">:</span><span class="w"> </span><span class="p">[</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">      </span><span class="l">python3, </span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">      </span><span class="c"># Path of the program inside the container</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">      </span><span class="l">/pipelines/component/src/program.py,</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">      </span>--<span class="l">input1-path,</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">      </span>{<span class="nt">inputPath</span><span class="p">:</span><span class="w"> </span><span class="l">Input 1},</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">      </span>--<span class="l">param1, </span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">      </span>{<span class="nt">inputValue</span><span class="p">:</span><span class="w"> </span><span class="l">Parameter 1},</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">      </span>--<span class="l">output1-path, </span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">      </span>{<span class="nt">outputPath</span><span class="p">:</span><span class="w"> </span><span class="l">Output 1},</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="p">]</span><span class="w">
</span></span></span></code></pre></div><p>The <code>command</code> is formatted as a list of strings. Each string in the
<code>command</code> is a command-line argument or a placeholder. At runtime,
placeholders are replaced with an input or output. In the preceding
example, two inputs and one output path are passed into a Python script at
<code>/pipelines/component/src/program.py</code>.</p>
<p>There are three types of input/output placeholders:</p>
<ul>
<li>
<p><code>{inputValue: &lt;input-name&gt;}</code>:
This placeholder is replaced with the value of the specified input.
This is useful for small pieces of input data, such as numbers or small
strings.</p>
</li>
<li>
<p><code>{inputPath: &lt;input-name&gt;}</code>:
This placeholder is replaced with the path to this input as a file.
Your component can read the contents of that input at that path during
the pipeline run.</p>
</li>
<li>
<p><code>{outputPath: &lt;output-name&gt;}</code>:
This placeholder is replaced with the path where your program writes
this output&rsquo;s data. This lets the Kubeflow Pipelines system read the
contents of the file and store it as the value of the specified output.</p>
</li>
</ul>
<p>The <code>&lt;input-name&gt;</code> name must match the name of an input in the <code>inputs</code>
section of your component specification. The <code>&lt;output-name&gt;</code> name must
match the name of an output in the <code>outputs</code> section of your component
specification.</p>
</li>
</ol>
<h3 id="define-your-components-interface">Define your component&rsquo;s interface</h3>
<p>The following examples demonstrate how to specify your component&rsquo;s interface.</p>
<ol>
<li>
<p>To define an input in your <code>component.yaml</code>, add an item to the
<code>inputs</code> list with the following attributes:</p>
<ul>
<li><code>name</code>: Human-readable name of this input. Each input&rsquo;s name must be
unique.</li>
<li><code>description</code>: (Optional.) Human-readable description of the input.</li>
<li><code>default</code>: (Optional.) Specifies the default value for this input.</li>
<li><code>type</code>: (Optional.) Specifies the inputs type. Learn more about the
<a href="https://github.com/kubeflow/pipelines/blob/sdk/release-1.8/sdk/python/kfp/dsl/types.py">types defined in the Kubeflow Pipelines SDK</a> and <a href="https://www.kubeflow.org/docs/components/pipelines/sdk/static-type-checking/">how type
checking works in pipelines and components</a>.</li>
<li><code>optional</code>: Specifies if this input is optional. The value of this
attribute is of type <code>Bool</code>, and defaults to <strong>False</strong>.</li>
</ul>
<p>In this example, the Python program has two inputs:</p>
<ul>
<li><code>Input 1</code> contains <code>String</code> data.</li>
<li><code>Parameter 1</code> contains an <code>Integer</code>.</li>
</ul>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-yaml" data-lang="yaml"><span class="line"><span class="cl"><span class="nt">inputs</span><span class="p">:</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span>- {<span class="nt">name: Input 1, type: String, description</span><span class="p">:</span><span class="w"> </span><span class="s1">&#39;Data for input 1&#39;</span>}<span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span>- {<span class="nt">name: Parameter 1, type: Integer, default: &#39;100&#39;, description</span><span class="p">:</span><span class="w"> </span><span class="s1">&#39;Number of lines to copy&#39;</span>}<span class="w">
</span></span></span></code></pre></div><p>Note: <code>Input 1</code> and <code>Parameter 1</code> do not specify any details about how they
are stored or how much data they contain. Consider using naming conventions
to indicate if inputs are expected to be small enough to pass by value.</p>
</li>
<li>
<p>After your component finishes its task, the component&rsquo;s outputs are passed
to your pipeline as paths. At runtime, Kubeflow Pipelines creates a
path for each of your component&rsquo;s outputs. These paths are passed as inputs
to your component&rsquo;s implementation.</p>
<p>To define an output in your component specification YAML, add an item to
the <code>outputs</code> list with the following attributes:</p>
<ul>
<li><code>name</code>: Human-readable name of this output. Each output&rsquo;s name must be
unique.</li>
<li><code>description</code>: (Optional.) Human-readable description of the output.</li>
<li><code>type</code>: (Optional.) Specifies the output&rsquo;s type. Learn more about the
<a href="https://github.com/kubeflow/pipelines/blob/sdk/release-1.8/sdk/python/kfp/dsl/types.py">types defined in the Kubeflow Pipelines SDK</a> and <a href="https://www.kubeflow.org/docs/components/pipelines/sdk/static-type-checking/">how type
checking works in pipelines and components</a>.</li>
</ul>
<p>In this example, the Python program returns one output. The output is named
<code>Output 1</code> and it contains <code>String</code> data.</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-yaml" data-lang="yaml"><span class="line"><span class="cl"><span class="nt">outputs</span><span class="p">:</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span>- {<span class="nt">name: Output 1, type: String, description</span><span class="p">:</span><span class="w"> </span><span class="s1">&#39;Output 1 data.&#39;</span>}<span class="w">
</span></span></span></code></pre></div><p>Note: Consider using naming conventions to indicate if this output is
expected to be small enough to pass by value. You should limit the amount
of data that is passed by value to 200 KB per pipeline run.</p>
</li>
<li>
<p>After you define your component&rsquo;s interface, the <code>component.yaml</code> should be
something like the following:</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-yaml" data-lang="yaml"><span class="line"><span class="cl"><span class="nt">inputs</span><span class="p">:</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span>- {<span class="nt">name: Input 1, type: String, description</span><span class="p">:</span><span class="w"> </span><span class="s1">&#39;Data for input 1&#39;</span>}<span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span>- {<span class="nt">name: Parameter 1, type: Integer, default: &#39;100&#39;, description</span><span class="p">:</span><span class="w"> </span><span class="s1">&#39;Number of lines to copy&#39;</span>}<span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="nt">outputs</span><span class="p">:</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span>- {<span class="nt">name: Output 1, type: String, description</span><span class="p">:</span><span class="w"> </span><span class="s1">&#39;Output 1 data.&#39;</span>}<span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="nt">implementation</span><span class="p">:</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">  </span><span class="nt">container</span><span class="p">:</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="nt">image</span><span class="p">:</span><span class="w"> </span><span class="l">gcr.io/my-org/my-image@sha256:a172..752f</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="c"># command is a list of strings (command-line arguments). </span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="c"># The YAML language has two syntaxes for lists and you can use either of them. </span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="c"># Here we use the &#34;flow syntax&#34; - comma-separated strings inside square brackets.</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="nt">command</span><span class="p">:</span><span class="w"> </span><span class="p">[</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">      </span><span class="l">python3, </span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">      </span><span class="c"># Path of the program inside the container</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">      </span><span class="l">/pipelines/component/src/program.py,</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">      </span>--<span class="l">input1-path,</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">      </span>{<span class="nt">inputPath</span><span class="p">:</span><span class="w"> </span><span class="l">Input 1},</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">      </span>--<span class="l">param1, </span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">      </span>{<span class="nt">inputValue</span><span class="p">:</span><span class="w"> </span><span class="l">Parameter 1},</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">      </span>--<span class="l">output1-path, </span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">      </span>{<span class="nt">outputPath</span><span class="p">:</span><span class="w"> </span><span class="l">Output 1},</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="p">]</span><span class="w">
</span></span></span></code></pre></div></li>
</ol>
<h3 id="specify-your-components-metadata">Specify your component&rsquo;s metadata</h3>
<p>To define your component&rsquo;s metadata, add the <code>name</code> and <code>description</code>
fields to your <code>component.yaml</code></p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-yaml" data-lang="yaml"><span class="line"><span class="cl"><span class="nt">name</span><span class="p">:</span><span class="w"> </span><span class="l">Get Lines</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="nt">description</span><span class="p">:</span><span class="w"> </span><span class="l">Gets the specified number of lines from the input file.</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="nt">inputs</span><span class="p">:</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span>- {<span class="nt">name: Input 1, type: String, description</span><span class="p">:</span><span class="w"> </span><span class="s1">&#39;Data for input 1&#39;</span>}<span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span>- {<span class="nt">name: Parameter 1, type: Integer, default: &#39;100&#39;, description</span><span class="p">:</span><span class="w"> </span><span class="s1">&#39;Number of lines to copy&#39;</span>}<span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="nt">outputs</span><span class="p">:</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span>- {<span class="nt">name: Output 1, type: String, description</span><span class="p">:</span><span class="w"> </span><span class="s1">&#39;Output 1 data.&#39;</span>}<span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="nt">implementation</span><span class="p">:</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">  </span><span class="nt">container</span><span class="p">:</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="nt">image</span><span class="p">:</span><span class="w"> </span><span class="l">gcr.io/my-org/my-image@sha256:a172..752f</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="c"># command is a list of strings (command-line arguments). </span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="c"># The YAML language has two syntaxes for lists and you can use either of them. </span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="c"># Here we use the &#34;flow syntax&#34; - comma-separated strings inside square brackets.</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="nt">command</span><span class="p">:</span><span class="w"> </span><span class="p">[</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">      </span><span class="l">python3, </span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">      </span><span class="c"># Path of the program inside the container</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">      </span><span class="l">/pipelines/component/src/program.py,</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">      </span>--<span class="l">input1-path,</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">      </span>{<span class="nt">inputPath</span><span class="p">:</span><span class="w"> </span><span class="l">Input 1},</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">      </span>--<span class="l">param1, </span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">      </span>{<span class="nt">inputValue</span><span class="p">:</span><span class="w"> </span><span class="l">Parameter 1},</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">      </span>--<span class="l">output1-path, </span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">      </span>{<span class="nt">outputPath</span><span class="p">:</span><span class="w"> </span><span class="l">Output 1},</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="p">]</span><span class="w">
</span></span></span></code></pre></div><h2 id="using-your-component-in-a-pipeline">Using your component in a pipeline</h2>
<p>You can use the Kubeflow Pipelines SDK to load your component using methods
such as the following:</p>
<ul>
<li><a href="https://kubeflow-pipelines.readthedocs.io/en/stable/source/kfp.components.html#kfp.components.load_component_from_file"><code>kfp.components.load_component_from_file</code></a>:
Use this method to load your component from a <code>component.yaml</code> path.</li>
<li><a href="https://kubeflow-pipelines.readthedocs.io/en/stable/source/kfp.components.html#kfp.components.load_component_from_url"><code>kfp.components.load_component_from_url</code></a>:
Use this method to load a <code>component.yaml</code> from a URL.</li>
<li><a href="https://kubeflow-pipelines.readthedocs.io/en/stable/source/kfp.components.html#kfp.components.load_component_from_text"><code>kfp.components.load_component_from_text</code></a>:
Use this method to load your component specification YAML from a string.
This method is useful for rapidly iterating on your component
specification.</li>
</ul>
<p>These functions create a factory function that you can use to create
<a href="https://kubeflow-pipelines.readthedocs.io/en/stable/source/kfp.dsl.html#kfp.dsl.ContainerOp"><code>ContainerOp</code></a> instances to use as steps in your pipeline.
This factory function&rsquo;s input arguments include your component&rsquo;s inputs and
the paths to your component&rsquo;s outputs. The function signature may be modified
in the following ways to ensure that it is valid and Pythonic.</p>
<ul>
<li>Inputs with default values will come after the inputs without default
values and outputs.</li>
<li>Input and output names are converted to Pythonic names (spaces and symbols
are replaced with underscores and letters are converted to lowercase). For
example, an input named <code>Input 1</code> is converted to <code>input_1</code>.</li>
</ul>
<p>The following example demonstrates how to load the text of your component
specification and run it in a two-step pipeline. Before you run this
example, update the component specification to use the component
specification you defined in the previous sections.</p>
<p>To demonstrate data passing between components, we create another component
that simply uses bash commands to write some text value to an output file.
And the output file can be passed to our previous component as an input.</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-python" data-lang="python"><span class="line"><span class="cl"><span class="kn">import</span> <span class="nn">kfp</span>
</span></span><span class="line"><span class="cl"><span class="kn">import</span> <span class="nn">kfp.components</span> <span class="k">as</span> <span class="nn">comp</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="n">create_step_get_lines</span> <span class="o">=</span> <span class="n">comp</span><span class="o">.</span><span class="n">load_component_from_text</span><span class="p">(</span><span class="s2">&#34;&#34;&#34;
</span></span></span><span class="line"><span class="cl"><span class="s2">name: Get Lines
</span></span></span><span class="line"><span class="cl"><span class="s2">description: Gets the specified number of lines from the input file.
</span></span></span><span class="line"><span class="cl"><span class="s2">
</span></span></span><span class="line"><span class="cl"><span class="s2">inputs:
</span></span></span><span class="line"><span class="cl"><span class="s2">- {name: Input 1, type: Data, description: &#39;Data for input 1&#39;}
</span></span></span><span class="line"><span class="cl"><span class="s2">- {name: Parameter 1, type: Integer, default: &#39;100&#39;, description: &#39;Number of lines to copy&#39;}
</span></span></span><span class="line"><span class="cl"><span class="s2">
</span></span></span><span class="line"><span class="cl"><span class="s2">outputs:
</span></span></span><span class="line"><span class="cl"><span class="s2">- {name: Output 1, type: Data, description: &#39;Output 1 data.&#39;}
</span></span></span><span class="line"><span class="cl"><span class="s2">
</span></span></span><span class="line"><span class="cl"><span class="s2">implementation:
</span></span></span><span class="line"><span class="cl"><span class="s2">  container:
</span></span></span><span class="line"><span class="cl"><span class="s2">    image: gcr.io/my-org/my-image@sha256:a172..752f
</span></span></span><span class="line"><span class="cl"><span class="s2">    # command is a list of strings (command-line arguments). 
</span></span></span><span class="line"><span class="cl"><span class="s2">    # The YAML language has two syntaxes for lists and you can use either of them. 
</span></span></span><span class="line"><span class="cl"><span class="s2">    # Here we use the &#34;flow syntax&#34; - comma-separated strings inside square brackets.
</span></span></span><span class="line"><span class="cl"><span class="s2">    command: [
</span></span></span><span class="line"><span class="cl"><span class="s2">      python3, 
</span></span></span><span class="line"><span class="cl"><span class="s2">      # Path of the program inside the container
</span></span></span><span class="line"><span class="cl"><span class="s2">      /pipelines/component/src/program.py,
</span></span></span><span class="line"><span class="cl"><span class="s2">      --input1-path,
</span></span></span><span class="line"><span class="cl"><span class="s2">      {inputPath: Input 1},
</span></span></span><span class="line"><span class="cl"><span class="s2">      --param1, 
</span></span></span><span class="line"><span class="cl"><span class="s2">      {inputValue: Parameter 1},
</span></span></span><span class="line"><span class="cl"><span class="s2">      --output1-path, 
</span></span></span><span class="line"><span class="cl"><span class="s2">      {outputPath: Output 1},
</span></span></span><span class="line"><span class="cl"><span class="s2">    ]&#34;&#34;&#34;</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="c1"># create_step_get_lines is a &#34;factory function&#34; that accepts the arguments</span>
</span></span><span class="line"><span class="cl"><span class="c1"># for the component&#39;s inputs and output paths and returns a pipeline step</span>
</span></span><span class="line"><span class="cl"><span class="c1"># (ContainerOp instance).</span>
</span></span><span class="line"><span class="cl"><span class="c1">#</span>
</span></span><span class="line"><span class="cl"><span class="c1"># To inspect the get_lines_op function in Jupyter Notebook, enter </span>
</span></span><span class="line"><span class="cl"><span class="c1"># &#34;get_lines_op(&#34; in a cell and press Shift+Tab.</span>
</span></span><span class="line"><span class="cl"><span class="c1"># You can also get help by entering `help(get_lines_op)`, `get_lines_op?`,</span>
</span></span><span class="line"><span class="cl"><span class="c1"># or `get_lines_op??`.</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="c1"># Create a simple component using only bash commands. The output of this component</span>
</span></span><span class="line"><span class="cl"><span class="c1"># can be passed to a downstream component that accepts an input with the same type.</span>
</span></span><span class="line"><span class="cl"><span class="n">create_step_write_lines</span> <span class="o">=</span> <span class="n">comp</span><span class="o">.</span><span class="n">load_component_from_text</span><span class="p">(</span><span class="s2">&#34;&#34;&#34;
</span></span></span><span class="line"><span class="cl"><span class="s2">name: Write Lines
</span></span></span><span class="line"><span class="cl"><span class="s2">description: Writes text to a file.
</span></span></span><span class="line"><span class="cl"><span class="s2">
</span></span></span><span class="line"><span class="cl"><span class="s2">inputs:
</span></span></span><span class="line"><span class="cl"><span class="s2">- {name: text, type: String}
</span></span></span><span class="line"><span class="cl"><span class="s2">
</span></span></span><span class="line"><span class="cl"><span class="s2">outputs:
</span></span></span><span class="line"><span class="cl"><span class="s2">- {name: data, type: Data}
</span></span></span><span class="line"><span class="cl"><span class="s2">
</span></span></span><span class="line"><span class="cl"><span class="s2">implementation:
</span></span></span><span class="line"><span class="cl"><span class="s2">  container:
</span></span></span><span class="line"><span class="cl"><span class="s2">    image: busybox
</span></span></span><span class="line"><span class="cl"><span class="s2">    command:
</span></span></span><span class="line"><span class="cl"><span class="s2">    - sh
</span></span></span><span class="line"><span class="cl"><span class="s2">    - -c
</span></span></span><span class="line"><span class="cl"><span class="s2">    - |
</span></span></span><span class="line"><span class="cl"><span class="s2">      mkdir -p &#34;$(dirname &#34;$1&#34;)&#34;
</span></span></span><span class="line"><span class="cl"><span class="s2">      echo &#34;$0&#34; &gt; &#34;$1&#34;
</span></span></span><span class="line"><span class="cl"><span class="s2">    args:
</span></span></span><span class="line"><span class="cl"><span class="s2">    - {inputValue: text}
</span></span></span><span class="line"><span class="cl"><span class="s2">    - {outputPath: data}
</span></span></span><span class="line"><span class="cl"><span class="s2">&#34;&#34;&#34;</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="c1"># Define your pipeline </span>
</span></span><span class="line"><span class="cl"><span class="k">def</span> <span class="nf">my_pipeline</span><span class="p">():</span>
</span></span><span class="line"><span class="cl">    <span class="n">write_lines_step</span> <span class="o">=</span> <span class="n">create_step_write_lines</span><span class="p">(</span>
</span></span><span class="line"><span class="cl">        <span class="n">text</span><span class="o">=</span><span class="s1">&#39;one</span><span class="se">\n</span><span class="s1">two</span><span class="se">\n</span><span class="s1">three</span><span class="se">\n</span><span class="s1">four</span><span class="se">\n</span><span class="s1">five</span><span class="se">\n</span><span class="s1">six</span><span class="se">\n</span><span class="s1">seven</span><span class="se">\n</span><span class="s1">eight</span><span class="se">\n</span><span class="s1">nine</span><span class="se">\n</span><span class="s1">ten&#39;</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">    <span class="n">get_lines_step</span> <span class="o">=</span> <span class="n">create_step_get_lines</span><span class="p">(</span>
</span></span><span class="line"><span class="cl">        <span class="c1"># Input name &#34;Input 1&#34; is converted to pythonic parameter name &#34;input_1&#34;</span>
</span></span><span class="line"><span class="cl">        <span class="n">input_1</span><span class="o">=</span><span class="n">write_lines_step</span><span class="o">.</span><span class="n">outputs</span><span class="p">[</span><span class="s1">&#39;data&#39;</span><span class="p">],</span>
</span></span><span class="line"><span class="cl">        <span class="n">parameter_1</span><span class="o">=</span><span class="s1">&#39;5&#39;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">    <span class="p">)</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="c1"># If you run this command on a Jupyter notebook running on Kubeflow,</span>
</span></span><span class="line"><span class="cl"><span class="c1"># you can exclude the host parameter.</span>
</span></span><span class="line"><span class="cl"><span class="c1"># client = kfp.Client()</span>
</span></span><span class="line"><span class="cl"><span class="n">client</span> <span class="o">=</span> <span class="n">kfp</span><span class="o">.</span><span class="n">Client</span><span class="p">(</span><span class="n">host</span><span class="o">=</span><span class="s1">&#39;&lt;your-kubeflow-pipelines-host-name&gt;&#39;</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="c1"># Compile, upload, and submit this pipeline for execution.</span>
</span></span><span class="line"><span class="cl"><span class="n">client</span><span class="o">.</span><span class="n">create_run_from_pipeline_func</span><span class="p">(</span><span class="n">my_pipeline</span><span class="p">,</span> <span class="n">arguments</span><span class="o">=</span><span class="p">{})</span>
</span></span></code></pre></div><h2 id="organizing-the-component-files">Organizing the component files</h2>
<p>This section provides a recommended way to organize a component&rsquo;s files. There
is no requirement that you must organize the files in this way. However, using
the standard organization makes it possible to reuse the same scripts for
testing, image building, and component versioning.</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-zed" data-lang="zed"><span class="line"><span class="cl"><span class="nn">components/</span><span class="o">&lt;</span><span class="n">component</span><span class="w"> </span><span class="n">group</span><span class="o">&gt;/&lt;</span><span class="n">component</span><span class="w"> </span><span class="n">name</span><span class="o">&gt;/</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="nn">src/</span><span class="o">*</span><span class="w">            </span><span class="err">#</span><span class="w"> </span><span class="n">Component</span><span class="w"> </span><span class="n">source</span><span class="w"> </span><span class="n">code</span><span class="w"> </span><span class="n">files</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="nn">tests/</span><span class="o">*</span><span class="w">          </span><span class="err">#</span><span class="w"> </span><span class="n">Unit</span><span class="w"> </span><span class="n">tests</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="n">run_tests</span><span class="p">.</span><span class="n">sh</span><span class="w">     </span><span class="err">#</span><span class="w"> </span><span class="n">Small</span><span class="w"> </span><span class="n">script</span><span class="w"> </span><span class="n">that</span><span class="w"> </span><span class="n">runs</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="n">tests</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="n">README</span><span class="p">.</span><span class="n">md</span><span class="w">        </span><span class="err">#</span><span class="w"> </span><span class="n">Documentation</span><span class="p">.</span><span class="w"> </span><span class="n">If</span><span class="w"> </span><span class="n">multiple</span><span class="w"> </span><span class="n">files</span><span class="w"> </span><span class="n">are</span><span class="w"> </span><span class="n">needed</span><span class="p">,</span><span class="w"> </span><span class="n">move</span><span class="w"> </span><span class="n">to</span><span class="w"> </span><span class="nn">docs/</span><span class="p">.</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="n">Dockerfile</span><span class="w">       </span><span class="err">#</span><span class="w"> </span><span class="n">Dockerfile</span><span class="w"> </span><span class="n">to</span><span class="w"> </span><span class="n">build</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="n">component</span><span class="w"> </span><span class="n">container</span><span class="w"> </span><span class="n">image</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="n">build_image</span><span class="p">.</span><span class="n">sh</span><span class="w">   </span><span class="err">#</span><span class="w"> </span><span class="n">Small</span><span class="w"> </span><span class="n">script</span><span class="w"> </span><span class="n">that</span><span class="w"> </span><span class="n">runs</span><span class="w"> </span><span class="n">docker</span><span class="w"> </span><span class="n">build</span><span class="w"> </span><span class="n">and</span><span class="w"> </span><span class="n">docker</span><span class="w"> </span><span class="n">push</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="n">component</span><span class="p">.</span><span class="n">yaml</span><span class="w">   </span><span class="err">#</span><span class="w"> </span><span class="n">Component</span><span class="w"> </span><span class="kt">definition</span><span class="w"> </span><span class="n">in</span><span class="w"> </span><span class="n">YAML</span><span class="w"> </span><span class="n">format</span><span class="w">
</span></span></span></code></pre></div><p>See this <a href="https://github.com/kubeflow/pipelines/tree/sdk/release-1.8/components/sample/keras/train_classifier">sample component</a> for a real-life component example.</p>
<h2 id="next-steps">Next steps</h2>
<ul>
<li>Consolidate what you&rsquo;ve learned by reading the
<a href="/docs/components/pipelines/sdk/best-practices">best practices</a> for designing and
writing components.</li>
<li>For quick iteration,
<a href="/docs/components/pipelines/sdk/python-function-components/">build lightweight Python function-based components</a>
directly from Python functions.</li>
<li>See how to <a href="/docs/components/pipelines/sdk/pipelines-metrics/">export metrics from your
pipeline</a>.</li>
<li>Visualize the output of your component by
<a href="/docs/components/pipelines/sdk/output-viewer/">adding metadata for an output
viewer</a>.</li>
<li>Explore the <a href="/docs/examples/shared-resources/">reusable components and other shared
resources</a>.</li>
</ul>

</div>



    
	
  
    
    
	
    

<div class="td-content" style="page-break-before: always">
    
	<h1 id="pg-ec0a69a45422dd2b502a48a36d15bf24">3.1.5.6 - Building Python function-based components</h1>
    <div class="lead">Building your own lightweight pipelines components using Python</div>
	<!--
AUTOGENERATED FROM content/en/docs/components/pipelines/sdk/python-function-components.ipynb
PLEASE UPDATE THE JUPYTER NOTEBOOK AND REGENERATE THIS FILE USING scripts/nb_to_md.py.-->
<style>
.notebook-links {display: flex; margin: 1em 0;}
.notebook-links a {padding: .75em; margin-right: .75em; font-weight: bold;}
a.colab-link {
padding-left: 3.25em;
background-image: url(/docs/images/logos/colab.ico);
background-repeat: no-repeat;
background-size: contain;
}
a.github-link {
padding-left: 2.75em;
background-image: url(/docs/images/logos/github.png);
background-repeat: no-repeat;
background-size: auto 75%;
background-position: left center;
}
</style>
<div class="notebook-links">
<a class="colab-link" href="https://colab.research.google.com/github/kubeflow/website/blob/master/content/en/docs/components/pipelines/sdk/python-function-components.ipynb">Run in Google Colab</a>
<a class="github-link" href="https://github.com/kubeflow/website/blob/master/content/en/docs/components/pipelines/sdk/python-function-components.ipynb">View source on GitHub</a>
</div>
<p>A Kubeflow Pipelines component is a self-contained set of code that performs one step in your
ML workflow. A pipeline component is composed of:</p>
<ul>
<li>
<p>The component code, which implements the logic needed to perform a step in your ML workflow.</p>
</li>
<li>
<p>A component specification, which defines the following:</p>
<ul>
<li>The component&rsquo;s metadata, its name and description.</li>
<li>The component&rsquo;s interface, the component&rsquo;s inputs and outputs.</li>
<li>The component&rsquo;s implementation, the Docker container image
to run, how to pass inputs to your component code, and how
to get the component&rsquo;s outputs.</li>
</ul>
</li>
</ul>
<p>Python function-based components make it easier to iterate quickly by letting you build your
component code as a Python function and generating the <a href="https://www.kubeflow.org/docs/components/pipelines/reference/component-spec/">component specification</a> for you.
This document describes how to build Python function-based components and use them in your pipeline.</p>
<h2 id="before-you-begin">Before you begin</h2>
<ol>
<li>Run the following command to install the Kubeflow Pipelines SDK. If you run this command in a Jupyter
notebook, restart the kernel after installing the SDK.</li>
</ol>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-python" data-lang="python"><span class="line"><span class="cl"><span class="err">$</span> <span class="n">pip3</span> <span class="n">install</span> <span class="n">kfp</span> <span class="o">--</span><span class="n">upgrade</span>
</span></span></code></pre></div><ol start="2">
<li>Import the <code>kfp</code> package.</li>
</ol>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-python" data-lang="python"><span class="line"><span class="cl"><span class="kn">import</span> <span class="nn">kfp</span>
</span></span><span class="line"><span class="cl"><span class="kn">from</span> <span class="nn">kfp.components</span> <span class="kn">import</span> <span class="n">create_component_from_func</span>
</span></span></code></pre></div><ol start="3">
<li>Create an instance of the <a href="https://kubeflow-pipelines.readthedocs.io/en/latest/source/kfp.client.html#kfp.Client"><code>kfp.Client</code> class</a> following steps in <a href="https://www.kubeflow.org/docs/components/pipelines/sdk/connect-api">connecting to Kubeflow Pipelines using the SDK client</a>.</li>
</ol>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-python" data-lang="python"><span class="line"><span class="cl"><span class="n">client</span> <span class="o">=</span> <span class="n">kfp</span><span class="o">.</span><span class="n">Client</span><span class="p">()</span> <span class="c1"># change arguments accordingly</span>
</span></span></code></pre></div><p>For more information about the Kubeflow Pipelines SDK, see the <a href="https://kubeflow-pipelines.readthedocs.io/en/stable/index.html">SDK reference guide</a>.</p>
<h2 id="getting-started-with-python-function-based-components">Getting started with Python function-based components</h2>
<p>This section demonstrates how to get started building Python function-based components by walking
through the process of creating a simple component.</p>
<ol>
<li>Define your component&rsquo;s code as a <a href="#standalone">standalone Python function</a>. In this example,
the function adds two floats and returns the sum of the two arguments.</li>
</ol>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-python" data-lang="python"><span class="line"><span class="cl"><span class="k">def</span> <span class="nf">add</span><span class="p">(</span><span class="n">a</span><span class="p">:</span> <span class="nb">float</span><span class="p">,</span> <span class="n">b</span><span class="p">:</span> <span class="nb">float</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">float</span><span class="p">:</span>
</span></span><span class="line"><span class="cl">  <span class="s1">&#39;&#39;&#39;Calculates sum of two arguments&#39;&#39;&#39;</span>
</span></span><span class="line"><span class="cl">  <span class="k">return</span> <span class="n">a</span> <span class="o">+</span> <span class="n">b</span>
</span></span></code></pre></div><ol start="2">
<li>Use <code>kfp.components.create_component_from_func</code> to generate the component specification YAML and return a
factory function that you can use to create <a href="https://kubeflow-pipelines.readthedocs.io/en/stable/source/kfp.dsl.html#kfp.dsl.ContainerOp"><code>kfp.dsl.ContainerOp</code></a> class instances for your pipeline.
The component specification YAML is a reusable and shareable definition of your component.</li>
</ol>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-python" data-lang="python"><span class="line"><span class="cl"><span class="n">add_op</span> <span class="o">=</span> <span class="n">create_component_from_func</span><span class="p">(</span>
</span></span><span class="line"><span class="cl">    <span class="n">add</span><span class="p">,</span> <span class="n">output_component_file</span><span class="o">=</span><span class="s1">&#39;add_component.yaml&#39;</span><span class="p">)</span>
</span></span></code></pre></div><ol start="3">
<li>Create and run your pipeline. <a href="https://www.kubeflow.org/docs/components/pipelines/sdk/build-component/">Learn more about creating and running pipelines</a>.</li>
</ol>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-python" data-lang="python"><span class="line"><span class="cl"><span class="kn">import</span> <span class="nn">kfp.dsl</span> <span class="k">as</span> <span class="nn">dsl</span>
</span></span><span class="line"><span class="cl"><span class="nd">@dsl</span><span class="o">.</span><span class="n">pipeline</span><span class="p">(</span>
</span></span><span class="line"><span class="cl">  <span class="n">name</span><span class="o">=</span><span class="s1">&#39;Addition pipeline&#39;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">  <span class="n">description</span><span class="o">=</span><span class="s1">&#39;An example pipeline that performs addition calculations.&#39;</span>
</span></span><span class="line"><span class="cl"><span class="p">)</span>
</span></span><span class="line"><span class="cl"><span class="k">def</span> <span class="nf">add_pipeline</span><span class="p">(</span>
</span></span><span class="line"><span class="cl">  <span class="n">a</span><span class="o">=</span><span class="s1">&#39;1&#39;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">  <span class="n">b</span><span class="o">=</span><span class="s1">&#39;7&#39;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl"><span class="p">):</span>
</span></span><span class="line"><span class="cl">  <span class="c1"># Passes a pipeline parameter and a constant value to the `add_op` factory</span>
</span></span><span class="line"><span class="cl">  <span class="c1"># function.</span>
</span></span><span class="line"><span class="cl">  <span class="n">first_add_task</span> <span class="o">=</span> <span class="n">add_op</span><span class="p">(</span><span class="n">a</span><span class="p">,</span> <span class="mi">4</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">  <span class="c1"># Passes an output reference from `first_add_task` and a pipeline parameter</span>
</span></span><span class="line"><span class="cl">  <span class="c1"># to the `add_op` factory function. For operations with a single return</span>
</span></span><span class="line"><span class="cl">  <span class="c1"># value, the output reference can be accessed as `task.output` or</span>
</span></span><span class="line"><span class="cl">  <span class="c1"># `task.outputs[&#39;output_name&#39;]`.</span>
</span></span><span class="line"><span class="cl">  <span class="n">second_add_task</span> <span class="o">=</span> <span class="n">add_op</span><span class="p">(</span><span class="n">first_add_task</span><span class="o">.</span><span class="n">output</span><span class="p">,</span> <span class="n">b</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="c1"># Specify argument values for your pipeline run.</span>
</span></span><span class="line"><span class="cl"><span class="n">arguments</span> <span class="o">=</span> <span class="p">{</span><span class="s1">&#39;a&#39;</span><span class="p">:</span> <span class="s1">&#39;7&#39;</span><span class="p">,</span> <span class="s1">&#39;b&#39;</span><span class="p">:</span> <span class="s1">&#39;8&#39;</span><span class="p">}</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="c1"># Create a pipeline run, using the client you initialized in a prior step.</span>
</span></span><span class="line"><span class="cl"><span class="n">client</span><span class="o">.</span><span class="n">create_run_from_pipeline_func</span><span class="p">(</span><span class="n">add_pipeline</span><span class="p">,</span> <span class="n">arguments</span><span class="o">=</span><span class="n">arguments</span><span class="p">)</span>
</span></span></code></pre></div><h2 id="building-python-function-based-components">Building Python function-based components</h2>
<p>Use the following instructions to build a Python function-based component:</p>
<p><a name="standalone"></a></p>
<ol>
<li>
<p>Define a standalone Python function. This function must meet the following
requirements:</p>
<ul>
<li>It should not use any code declared outside of the function definition.</li>
<li>Import statements must be added inside the function. <a href="#packages">Learn more about
using and installing Python packages in your component</a>.</li>
<li>Helper functions must be defined inside this function.</li>
</ul>
</li>
<li>
<p>Kubeflow Pipelines uses your function&rsquo;s inputs and outputs to define your
component&rsquo;s interface. <a href="#pass-data">Learn more about passing data between
components</a>. Your function&rsquo;s inputs and outputs must meet the
following requirements:</p>
<ul>
<li>If the function accepts or returns large amounts of data or complex
data types, you must pass that data as a file. <a href="#pass-by-file">Learn more about using
large amounts of data as inputs or outputs</a>.</li>
<li>If the function accepts numeric values as parameters, the parameters
must have type hints. Supported types are <code>int</code> and <code>float</code>. Otherwise,
parameters are passed as strings.</li>
<li>If your component returns multiple small outputs (short strings,
numbers, or booleans), annotate your function with the
<a href="https://docs.python.org/3/library/typing.html#typing.NamedTuple"><code>typing.NamedTuple</code></a> type hint and use the
<a href="https://docs.python.org/3/library/collections.html#collections.namedtuple"><code>collections.namedtuple</code></a> function return your function&rsquo;s
outputs as a new subclass of tuple. For an example, read
<a href="#pass-by-value">Passing parameters by value</a>.</li>
</ul>
</li>
<li>
<p>(Optional.) If your function has complex dependencies, choose or build a
container image for your Python function to run in. <a href="#containers">Learn more about
selecting or building your component&rsquo;s container image</a>.</p>
</li>
<li>
<p>Call <a href="https://kubeflow-pipelines.readthedocs.io/en/latest/source/kfp.components.html#kfp.components.create_component_from_func"><code>kfp.components.create_component_from_func(func)</code></a>
to convert your function into a pipeline component.</p>
<ul>
<li><strong>func</strong>: The Python function to convert.</li>
<li><strong>base_image</strong>: (Optional.) Specify the Docker container image to run
this function in. <a href="#containers">Learn more about selecting or building a container
image</a>.</li>
<li><strong>output_component_file</strong>: (Optional.) Writes your component definition
to a file. You can use this file to share the component with colleagues
or reuse it in different pipelines.</li>
<li><strong>packages_to_install</strong>: (Optional.) A list of versioned Python
packages to install before running your function.</li>
</ul>
</li>
</ol>
<p><a name="packages"></a></p>
<h3 id="using-and-installing-python-packages">Using and installing Python packages</h3>
<p>When Kubeflow Pipelines runs your pipeline, each component runs within a Docker
container image on a Kubernetes Pod. To load the packages that your Python
function depends on, one of the following must be true:</p>
<ul>
<li>The package must be installed on the container image.</li>
<li>The package must be defined using the <code>packages_to_install</code> parameter of the
<a href="https://kubeflow-pipelines.readthedocs.io/en/latest/source/kfp.components.html#kfp.components.create_component_from_func"><code>kfp.components.create_component_from_func(func)</code></a>
function.</li>
<li>Your function must install the package. For example, your function can use
the <a href="https://docs.python.org/3/library/subprocess.html"><code>subprocess</code> module</a> to run a command like <code>pip install</code>
that installs a package.</li>
</ul>
<p><a name="containers"></a></p>
<h3 id="selecting-or-building-a-container-image">Selecting or building a container image</h3>
<p>Currently, if you do not specify a container image, your Python-function based
component uses the <a href="https://hub.docker.com/layers/python/library/python/3.7/images/sha256-7eef781ed825f3b95c99f03f4189a8e30e718726e8490651fa1b941c6c815ad1?context=explore"><code>python:3.7</code> container image</a>. If your function
has complex dependencies, you may benefit from using a container image that has
your dependencies preinstalled, or building a custom container image.
Preinstalling your dependencies reduces the amount of time that your component
runs in, since your component does not need to download and install packages
each time it runs.</p>
<p>Many frameworks, such as <a href="https://www.tensorflow.org/install/docker">TensorFlow</a> and <a href="https://hub.docker.com/r/pytorch/pytorch/tags">PyTorch</a>,
and cloud service providers offer prebuilt container images that have common
dependencies installed.</p>
<p>If a prebuilt container is not available, you can build a custom container
image with your Python function&rsquo;s dependencies. For more information about
building a custom container, read the <a href="https://docs.docker.com/engine/reference/builder/">Dockerfile reference guide in the Docker
documentation</a>.</p>
<p>If you build or select a container image, instead of using the default
container image, the container image must use Python 3.5 or later.</p>
<p><a name="pass-data"></a></p>
<h3 id="understanding-how-data-is-passed-between-components">Understanding how data is passed between components</h3>
<p>When Kubeflow Pipelines runs your component, a container image is started in a
Kubernetes Pod and your component&rsquo;s inputs are passed in as command-line
arguments. When your component has finished, the components outputs are
returned as files.</p>
<p>Python function-based components make it easier to build pipeline components by
building the component specification for you. Python function-based components
also handle the complexity of passing inputs into your component and passing
your function&rsquo;s outputs back to your pipeline.</p>
<p>The following sections describe how to pass parameters by value and by file.</p>
<ul>
<li>Parameters that are passed by value include numbers, booleans, and short
strings. Kubeflow Pipelines passes parameters to your component by value,
by passing the values as command-line arguments.</li>
<li>Parameters that are passed by file include CSV, images, and complex types.
These files are stored in a location that is accessible to your component
running on Kubernetes, such as a persistent volume claim or a cloud
storage service. Kubeflow Pipelines passes parameters to your component by
file, by passing their paths as a command-line argument.</li>
</ul>
<p><a name="parameter-names"></a></p>
<h4 id="input-and-output-parameter-names">Input and output parameter names</h4>
<p>When you use the Kubeflow Pipelines SDK to convert your Python function to a
pipeline component, the Kubeflow Pipelines SDK uses the function&rsquo;s interface
to define the interface of your component in the following ways:</p>
<ul>
<li>Some arguments define input parameters.</li>
<li>Some arguments define output parameters.</li>
<li>The function&rsquo;s return value is used as an output parameter. If the return
value is a <a href="https://docs.python.org/3/library/collections.html#collections.namedtuple"><code>collections.namedtuple</code></a>, the named tuple is used
to return several small values.</li>
</ul>
<p>Since you can pass parameters between components as a value or as a path, the
Kubeflow Pipelines SDK removes common parameter suffixes that leak the
component&rsquo;s expected implementation. For example, a Python function-based
component that ingests data and outputs CSV data may have an output argument
that is defined as <code>csv_path: comp.OutputPath(str)</code>. In this case, the output
is the CSV data, not the path. So, the Kubeflow Pipelines SDK simplifies the
output name to <code>csv</code>.</p>
<p>The Kubeflow Pipelines SDK uses the following rules to define the input and
output parameter names in your component&rsquo;s interface:</p>
<ul>
<li>If the argument name ends with <code>_path</code> and the argument is annotated as an
<a href="https://kubeflow-pipelines.readthedocs.io/en/latest/source/kfp.components.html#kfp.components.InputPath"><code>kfp.components.InputPath</code></a> or
<a href="https://kubeflow-pipelines.readthedocs.io/en/latest/source/kfp.components.html#kfp.components.OutputPath"><code>kfp.components.OutputPath</code></a>, the parameter name is the
argument name with the trailing <code>_path</code> removed.</li>
<li>If the argument name ends with <code>_file</code>, the parameter name is the argument
name with the trailing <code>_file</code> removed.</li>
<li>If you return a single small value from your component using the <code>return</code>
statement, the output parameter is named <code>output</code>.</li>
<li>If you return several small values from your component by returning a
<a href="https://docs.python.org/3/library/collections.html#collections.namedtuple"><code>collections.namedtuple</code></a>, the Kubeflow Pipelines SDK uses
the tuple&rsquo;s field names as the output parameter names.</li>
</ul>
<p>Otherwise, the Kubeflow Pipelines SDK uses the argument name as the parameter
name.</p>
<p><a name="pass-by-value"></a></p>
<h4 id="passing-parameters-by-value">Passing parameters by value</h4>
<p>Python function-based components make it easier to pass parameters between
components by value (such as numbers, booleans, and short strings), by letting
you define your components interface by annotating your Python function. The
supported types are <code>int</code>, <code>float</code>, <code>bool</code>, and <code>str</code>. You can also pass
<code>list</code> or <code>dict</code> instances by value, if they contain small values, such as
<code>int</code>, <code>float</code>, <code>bool</code>, or <code>str</code> values. If you do not annotate your function,
these input parameters are passed as strings.</p>
<p>If your component returns multiple outputs by value, annotate your function
with the <a href="https://docs.python.org/3/library/typing.html#typing.NamedTuple"><code>typing.NamedTuple</code></a> type hint and use the
<a href="https://docs.python.org/3/library/collections.html#collections.namedtuple"><code>collections.namedtuple</code></a> function to return your function&rsquo;s
outputs as a new subclass of <code>tuple</code>.</p>
<p>You can also return metadata and metrics from your function.</p>
<ul>
<li>Metadata helps you visualize pipeline results.
<a href="https://www.kubeflow.org/docs/components/pipelines/sdk/output-viewer/">Learn more about visualizing pipeline metadata</a>.</li>
<li>Metrics help you compare pipeline runs.
<a href="https://www.kubeflow.org/docs/components/pipelines/sdk/pipelines-metrics/">Learn more about using pipeline metrics</a>.</li>
</ul>
<p>The following example demonstrates how to return multiple outputs by value,
including component metadata and metrics.</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-python" data-lang="python"><span class="line"><span class="cl"><span class="kn">from</span> <span class="nn">typing</span> <span class="kn">import</span> <span class="n">NamedTuple</span>
</span></span><span class="line"><span class="cl"><span class="k">def</span> <span class="nf">multiple_return_values_example</span><span class="p">(</span><span class="n">a</span><span class="p">:</span> <span class="nb">float</span><span class="p">,</span> <span class="n">b</span><span class="p">:</span> <span class="nb">float</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">NamedTuple</span><span class="p">(</span>
</span></span><span class="line"><span class="cl">  <span class="s1">&#39;ExampleOutputs&#39;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">  <span class="p">[</span>
</span></span><span class="line"><span class="cl">    <span class="p">(</span><span class="s1">&#39;sum&#39;</span><span class="p">,</span> <span class="nb">float</span><span class="p">),</span>
</span></span><span class="line"><span class="cl">    <span class="p">(</span><span class="s1">&#39;product&#39;</span><span class="p">,</span> <span class="nb">float</span><span class="p">),</span>
</span></span><span class="line"><span class="cl">    <span class="p">(</span><span class="s1">&#39;mlpipeline_ui_metadata&#39;</span><span class="p">,</span> <span class="s1">&#39;UI_metadata&#39;</span><span class="p">),</span>
</span></span><span class="line"><span class="cl">    <span class="p">(</span><span class="s1">&#39;mlpipeline_metrics&#39;</span><span class="p">,</span> <span class="s1">&#39;Metrics&#39;</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">  <span class="p">]):</span>
</span></span><span class="line"><span class="cl">  <span class="s2">&#34;&#34;&#34;Example function that demonstrates how to return multiple values.&#34;&#34;&#34;</span>  
</span></span><span class="line"><span class="cl">  <span class="n">sum_value</span> <span class="o">=</span> <span class="n">a</span> <span class="o">+</span> <span class="n">b</span>
</span></span><span class="line"><span class="cl">  <span class="n">product_value</span> <span class="o">=</span> <span class="n">a</span> <span class="o">*</span> <span class="n">b</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">  <span class="c1"># Export a sample tensorboard</span>
</span></span><span class="line"><span class="cl">  <span class="n">metadata</span> <span class="o">=</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">    <span class="s1">&#39;outputs&#39;</span> <span class="p">:</span> <span class="p">[{</span>
</span></span><span class="line"><span class="cl">      <span class="s1">&#39;type&#39;</span><span class="p">:</span> <span class="s1">&#39;tensorboard&#39;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">      <span class="s1">&#39;source&#39;</span><span class="p">:</span> <span class="s1">&#39;gs://ml-pipeline-dataset/tensorboard-train&#39;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">    <span class="p">}]</span>
</span></span><span class="line"><span class="cl">  <span class="p">}</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">  <span class="c1"># Export two metrics</span>
</span></span><span class="line"><span class="cl">  <span class="n">metrics</span> <span class="o">=</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">    <span class="s1">&#39;metrics&#39;</span><span class="p">:</span> <span class="p">[</span>
</span></span><span class="line"><span class="cl">      <span class="p">{</span>
</span></span><span class="line"><span class="cl">        <span class="s1">&#39;name&#39;</span><span class="p">:</span> <span class="s1">&#39;sum&#39;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">        <span class="s1">&#39;numberValue&#39;</span><span class="p">:</span>  <span class="nb">float</span><span class="p">(</span><span class="n">sum_value</span><span class="p">),</span>
</span></span><span class="line"><span class="cl">      <span class="p">},{</span>
</span></span><span class="line"><span class="cl">        <span class="s1">&#39;name&#39;</span><span class="p">:</span> <span class="s1">&#39;product&#39;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">        <span class="s1">&#39;numberValue&#39;</span><span class="p">:</span>  <span class="nb">float</span><span class="p">(</span><span class="n">product_value</span><span class="p">),</span>
</span></span><span class="line"><span class="cl">      <span class="p">}</span>
</span></span><span class="line"><span class="cl">    <span class="p">]</span>  
</span></span><span class="line"><span class="cl">  <span class="p">}</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">  <span class="kn">from</span> <span class="nn">collections</span> <span class="kn">import</span> <span class="n">namedtuple</span>
</span></span><span class="line"><span class="cl">  <span class="n">example_output</span> <span class="o">=</span> <span class="n">namedtuple</span><span class="p">(</span>
</span></span><span class="line"><span class="cl">      <span class="s1">&#39;ExampleOutputs&#39;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">      <span class="p">[</span><span class="s1">&#39;sum&#39;</span><span class="p">,</span> <span class="s1">&#39;product&#39;</span><span class="p">,</span> <span class="s1">&#39;mlpipeline_ui_metadata&#39;</span><span class="p">,</span> <span class="s1">&#39;mlpipeline_metrics&#39;</span><span class="p">])</span>
</span></span><span class="line"><span class="cl">  <span class="k">return</span> <span class="n">example_output</span><span class="p">(</span><span class="n">sum_value</span><span class="p">,</span> <span class="n">product_value</span><span class="p">,</span> <span class="n">metadata</span><span class="p">,</span> <span class="n">metrics</span><span class="p">)</span>
</span></span></code></pre></div><p><a name="pass-by-file"></a></p>
<h4 id="passing-parameters-by-file">Passing parameters by file</h4>
<p>Python function-based components make it easier to pass files to your
component, or to return files from your component, by letting you annotate
your Python function&rsquo;s parameters to specify which parameters refer to a file.
Your Python function&rsquo;s parameters can refer to either input or output files.
If your parameter is an output file, Kubeflow Pipelines passes your function a
path or stream that you can use to store your output file.</p>
<p>The following example accepts a file as an input and returns two files as outputs.</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-python" data-lang="python"><span class="line"><span class="cl"><span class="k">def</span> <span class="nf">split_text_lines</span><span class="p">(</span>
</span></span><span class="line"><span class="cl">    <span class="n">source_path</span><span class="p">:</span> <span class="n">comp</span><span class="o">.</span><span class="n">InputPath</span><span class="p">(</span><span class="nb">str</span><span class="p">),</span>
</span></span><span class="line"><span class="cl">    <span class="n">odd_lines_path</span><span class="p">:</span> <span class="n">comp</span><span class="o">.</span><span class="n">OutputPath</span><span class="p">(</span><span class="nb">str</span><span class="p">),</span>
</span></span><span class="line"><span class="cl">    <span class="n">even_lines_path</span><span class="p">:</span> <span class="n">comp</span><span class="o">.</span><span class="n">OutputPath</span><span class="p">(</span><span class="nb">str</span><span class="p">)):</span>
</span></span><span class="line"><span class="cl">    <span class="s2">&#34;&#34;&#34;Splits a text file into two files, with even lines going to one file
</span></span></span><span class="line"><span class="cl"><span class="s2">    and odd lines to the other.&#34;&#34;&#34;</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">    <span class="k">with</span> <span class="nb">open</span><span class="p">(</span><span class="n">source_path</span><span class="p">,</span> <span class="s1">&#39;r&#39;</span><span class="p">)</span> <span class="k">as</span> <span class="n">reader</span><span class="p">:</span>
</span></span><span class="line"><span class="cl">        <span class="k">with</span> <span class="nb">open</span><span class="p">(</span><span class="n">odd_lines_path</span><span class="p">,</span> <span class="s1">&#39;w&#39;</span><span class="p">)</span> <span class="k">as</span> <span class="n">odd_writer</span><span class="p">:</span>
</span></span><span class="line"><span class="cl">            <span class="k">with</span> <span class="nb">open</span><span class="p">(</span><span class="n">even_lines_path</span><span class="p">,</span> <span class="s1">&#39;w&#39;</span><span class="p">)</span> <span class="k">as</span> <span class="n">even_writer</span><span class="p">:</span>
</span></span><span class="line"><span class="cl">                <span class="k">while</span> <span class="kc">True</span><span class="p">:</span>
</span></span><span class="line"><span class="cl">                    <span class="n">line</span> <span class="o">=</span> <span class="n">reader</span><span class="o">.</span><span class="n">readline</span><span class="p">()</span>
</span></span><span class="line"><span class="cl">                    <span class="k">if</span> <span class="n">line</span> <span class="o">==</span> <span class="s2">&#34;&#34;</span><span class="p">:</span>
</span></span><span class="line"><span class="cl">                        <span class="k">break</span>
</span></span><span class="line"><span class="cl">                    <span class="n">odd_writer</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="n">line</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">                    <span class="n">line</span> <span class="o">=</span> <span class="n">reader</span><span class="o">.</span><span class="n">readline</span><span class="p">()</span>
</span></span><span class="line"><span class="cl">                    <span class="k">if</span> <span class="n">line</span> <span class="o">==</span> <span class="s2">&#34;&#34;</span><span class="p">:</span>
</span></span><span class="line"><span class="cl">                        <span class="k">break</span>
</span></span><span class="line"><span class="cl">                    <span class="n">even_writer</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="n">line</span><span class="p">)</span>
</span></span></code></pre></div><p>In this example, the inputs and outputs are defined as parameters of the
<code>split_text_lines</code> function. This lets Kubeflow Pipelines pass the path to the
source data file and the paths to the output data files into the function.</p>
<p>To accept a file as an input parameter, use one of the following type annotations:</p>
<ul>
<li><a href="https://kubeflow-pipelines.readthedocs.io/en/latest/source/kfp.components.html#kfp.components.InputBinaryFile"><code>kfp.components.InputBinaryFile</code></a>: Use this annotation to
specify that your function expects a parameter to be an
<a href="https://docs.python.org/3/library/io.html#io.BytesIO"><code>io.BytesIO</code></a> instance that this function can read.</li>
<li><a href="https://kubeflow-pipelines.readthedocs.io/en/latest/source/kfp.components.html#kfp.components.InputPath"><code>kfp.components.InputPath</code></a>: Use this annotation to specify that
your function expects a parameter to be the path to the input file as
a <code>string</code>.</li>
<li><a href="https://kubeflow-pipelines.readthedocs.io/en/latest/source/kfp.components.html#kfp.components.InputTextFile"><code>kfp.components.InputTextFile</code></a>: Use this annotation to specify
that your function expects a parameter to be an
<a href="https://docs.python.org/3/library/io.html#io.TextIOWrapper"><code>io.TextIOWrapper</code></a> instance that this function can read.</li>
</ul>
<p>To return a file as an output, use one of the following type annotations:</p>
<ul>
<li><a href="https://kubeflow-pipelines.readthedocs.io/en/latest/source/kfp.components.html#kfp.components.OutputBinaryFile"><code>kfp.components.OutputBinaryFile</code></a>: Use this annotation to
specify that your function expects a parameter to be an
<a href="https://docs.python.org/3/library/io.html#io.BytesIO"><code>io.BytesIO</code></a> instance that this function can write to.</li>
<li><a href="https://kubeflow-pipelines.readthedocs.io/en/latest/source/kfp.components.html#kfp.components.OutputPath"><code>kfp.components.OutputPath</code></a>: Use this annotation to specify that
your function expects a parameter to be the path to store the output file at
as a <code>string</code>.</li>
<li><a href="https://kubeflow-pipelines.readthedocs.io/en/latest/source/kfp.components.html#kfp.components.OutputTextFile"><code>kfp.components.OutputTextFile</code></a>: Use this annotation to specify
that your function expects a parameter to be an
<a href="https://docs.python.org/3/library/io.html#io.TextIOWrapper"><code>io.TextIOWrapper</code></a> that this function can write to.</li>
</ul>
<h2 id="example-python-function-based-component">Example Python function-based component</h2>
<p>This section demonstrates how to build a Python function-based component that uses imports,
helper functions, and produces multiple outputs.</p>
<ol>
<li>Define your function. This example function uses the <code>numpy</code> package to calculate the quotient
and remainder for a given dividend and divisor in a helper function. In addition to the quotient
and remainder, the function also returns metadata for visualization and two metrics.</li>
</ol>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-python" data-lang="python"><span class="line"><span class="cl"><span class="kn">from</span> <span class="nn">typing</span> <span class="kn">import</span> <span class="n">NamedTuple</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="k">def</span> <span class="nf">my_divmod</span><span class="p">(</span>
</span></span><span class="line"><span class="cl">  <span class="n">dividend</span><span class="p">:</span> <span class="nb">float</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">  <span class="n">divisor</span><span class="p">:</span> <span class="nb">float</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">NamedTuple</span><span class="p">(</span>
</span></span><span class="line"><span class="cl">    <span class="s1">&#39;MyDivmodOutput&#39;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">    <span class="p">[</span>
</span></span><span class="line"><span class="cl">      <span class="p">(</span><span class="s1">&#39;quotient&#39;</span><span class="p">,</span> <span class="nb">float</span><span class="p">),</span>
</span></span><span class="line"><span class="cl">      <span class="p">(</span><span class="s1">&#39;remainder&#39;</span><span class="p">,</span> <span class="nb">float</span><span class="p">),</span>
</span></span><span class="line"><span class="cl">      <span class="p">(</span><span class="s1">&#39;mlpipeline_ui_metadata&#39;</span><span class="p">,</span> <span class="s1">&#39;UI_metadata&#39;</span><span class="p">),</span>
</span></span><span class="line"><span class="cl">      <span class="p">(</span><span class="s1">&#39;mlpipeline_metrics&#39;</span><span class="p">,</span> <span class="s1">&#39;Metrics&#39;</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">    <span class="p">]):</span>
</span></span><span class="line"><span class="cl">    <span class="s1">&#39;&#39;&#39;Divides two numbers and calculate  the quotient and remainder&#39;&#39;&#39;</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">    <span class="c1"># Import the numpy package inside the component function</span>
</span></span><span class="line"><span class="cl">    <span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">    <span class="c1"># Define a helper function</span>
</span></span><span class="line"><span class="cl">    <span class="k">def</span> <span class="nf">divmod_helper</span><span class="p">(</span><span class="n">dividend</span><span class="p">,</span> <span class="n">divisor</span><span class="p">):</span>
</span></span><span class="line"><span class="cl">        <span class="k">return</span> <span class="n">np</span><span class="o">.</span><span class="n">divmod</span><span class="p">(</span><span class="n">dividend</span><span class="p">,</span> <span class="n">divisor</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">    <span class="p">(</span><span class="n">quotient</span><span class="p">,</span> <span class="n">remainder</span><span class="p">)</span> <span class="o">=</span> <span class="n">divmod_helper</span><span class="p">(</span><span class="n">dividend</span><span class="p">,</span> <span class="n">divisor</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">    <span class="kn">from</span> <span class="nn">tensorflow.python.lib.io</span> <span class="kn">import</span> <span class="n">file_io</span>
</span></span><span class="line"><span class="cl">    <span class="kn">import</span> <span class="nn">json</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">    <span class="c1"># Export a sample tensorboard</span>
</span></span><span class="line"><span class="cl">    <span class="n">metadata</span> <span class="o">=</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">      <span class="s1">&#39;outputs&#39;</span> <span class="p">:</span> <span class="p">[{</span>
</span></span><span class="line"><span class="cl">        <span class="s1">&#39;type&#39;</span><span class="p">:</span> <span class="s1">&#39;tensorboard&#39;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">        <span class="s1">&#39;source&#39;</span><span class="p">:</span> <span class="s1">&#39;gs://ml-pipeline-dataset/tensorboard-train&#39;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">      <span class="p">}]</span>
</span></span><span class="line"><span class="cl">    <span class="p">}</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">    <span class="c1"># Export two metrics</span>
</span></span><span class="line"><span class="cl">    <span class="n">metrics</span> <span class="o">=</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">      <span class="s1">&#39;metrics&#39;</span><span class="p">:</span> <span class="p">[{</span>
</span></span><span class="line"><span class="cl">          <span class="s1">&#39;name&#39;</span><span class="p">:</span> <span class="s1">&#39;quotient&#39;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">          <span class="s1">&#39;numberValue&#39;</span><span class="p">:</span>  <span class="nb">float</span><span class="p">(</span><span class="n">quotient</span><span class="p">),</span>
</span></span><span class="line"><span class="cl">        <span class="p">},{</span>
</span></span><span class="line"><span class="cl">          <span class="s1">&#39;name&#39;</span><span class="p">:</span> <span class="s1">&#39;remainder&#39;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">          <span class="s1">&#39;numberValue&#39;</span><span class="p">:</span>  <span class="nb">float</span><span class="p">(</span><span class="n">remainder</span><span class="p">),</span>
</span></span><span class="line"><span class="cl">        <span class="p">}]}</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">    <span class="kn">from</span> <span class="nn">collections</span> <span class="kn">import</span> <span class="n">namedtuple</span>
</span></span><span class="line"><span class="cl">    <span class="n">divmod_output</span> <span class="o">=</span> <span class="n">namedtuple</span><span class="p">(</span><span class="s1">&#39;MyDivmodOutput&#39;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">        <span class="p">[</span><span class="s1">&#39;quotient&#39;</span><span class="p">,</span> <span class="s1">&#39;remainder&#39;</span><span class="p">,</span> <span class="s1">&#39;mlpipeline_ui_metadata&#39;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">         <span class="s1">&#39;mlpipeline_metrics&#39;</span><span class="p">])</span>
</span></span><span class="line"><span class="cl">    <span class="k">return</span> <span class="n">divmod_output</span><span class="p">(</span><span class="n">quotient</span><span class="p">,</span> <span class="n">remainder</span><span class="p">,</span> <span class="n">json</span><span class="o">.</span><span class="n">dumps</span><span class="p">(</span><span class="n">metadata</span><span class="p">),</span>
</span></span><span class="line"><span class="cl">                         <span class="n">json</span><span class="o">.</span><span class="n">dumps</span><span class="p">(</span><span class="n">metrics</span><span class="p">))</span>
</span></span></code></pre></div><ol start="2">
<li>Test your function by running it directly, or with unit tests.</li>
</ol>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-python" data-lang="python"><span class="line"><span class="cl"><span class="n">my_divmod</span><span class="p">(</span><span class="mi">100</span><span class="p">,</span> <span class="mi">7</span><span class="p">)</span>
</span></span></code></pre></div><ol start="3">
<li>
<p>This should return a result like the following:</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-fallback" data-lang="fallback"><span class="line"><span class="cl">MyDivmodOutput(quotient=14, remainder=2, mlpipeline_ui_metadata=&#39;{&#34;outputs&#34;: [{&#34;type&#34;: &#34;tensorboard&#34;, &#34;source&#34;: &#34;gs://ml-pipeline-dataset/tensorboard-train&#34;}]}&#39;, mlpipeline_metrics=&#39;{&#34;metrics&#34;: [{&#34;name&#34;: &#34;quotient&#34;, &#34;numberValue&#34;: 14.0}, {&#34;name&#34;: &#34;remainder&#34;, &#34;numberValue&#34;: 2.0}]}&#39;)
</span></span></code></pre></div></li>
<li>
<p>Use <code>kfp.components.create_component_from_func</code> to return a factory function that you can use to create
<a href="https://kubeflow-pipelines.readthedocs.io/en/stable/source/kfp.dsl.html#kfp.dsl.ContainerOp"><code>kfp.dsl.ContainerOp</code></a> class instances for your pipeline. This example also specifies the base container
image to run this function in.</p>
</li>
</ol>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-python" data-lang="python"><span class="line"><span class="cl"><span class="n">divmod_op</span> <span class="o">=</span> <span class="n">comp</span><span class="o">.</span><span class="n">create_component_from_func</span><span class="p">(</span>
</span></span><span class="line"><span class="cl">    <span class="n">my_divmod</span><span class="p">,</span> <span class="n">base_image</span><span class="o">=</span><span class="s1">&#39;tensorflow/tensorflow:1.11.0-py3&#39;</span><span class="p">)</span>
</span></span></code></pre></div><ol start="4">
<li>Define your pipeline. This example uses the <code>divmod_op</code> factory function and the <code>add_op</code>
factory function from an earlier example.</li>
</ol>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-python" data-lang="python"><span class="line"><span class="cl"><span class="kn">import</span> <span class="nn">kfp.dsl</span> <span class="k">as</span> <span class="nn">dsl</span>
</span></span><span class="line"><span class="cl"><span class="nd">@dsl</span><span class="o">.</span><span class="n">pipeline</span><span class="p">(</span>
</span></span><span class="line"><span class="cl">   <span class="n">name</span><span class="o">=</span><span class="s1">&#39;Calculation pipeline&#39;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">   <span class="n">description</span><span class="o">=</span><span class="s1">&#39;An example pipeline that performs arithmetic calculations.&#39;</span>
</span></span><span class="line"><span class="cl"><span class="p">)</span>
</span></span><span class="line"><span class="cl"><span class="k">def</span> <span class="nf">calc_pipeline</span><span class="p">(</span>
</span></span><span class="line"><span class="cl">   <span class="n">a</span><span class="o">=</span><span class="s1">&#39;1&#39;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">   <span class="n">b</span><span class="o">=</span><span class="s1">&#39;7&#39;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">   <span class="n">c</span><span class="o">=</span><span class="s1">&#39;17&#39;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl"><span class="p">):</span>
</span></span><span class="line"><span class="cl">    <span class="c1"># Passes a pipeline parameter and a constant value as operation arguments.</span>
</span></span><span class="line"><span class="cl">    <span class="n">add_task</span> <span class="o">=</span> <span class="n">add_op</span><span class="p">(</span><span class="n">a</span><span class="p">,</span> <span class="mi">4</span><span class="p">)</span> <span class="c1"># The add_op factory function returns</span>
</span></span><span class="line"><span class="cl">                            <span class="c1"># a dsl.ContainerOp class instance. </span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">    <span class="c1"># Passes the output of the add_task and a pipeline parameter as operation</span>
</span></span><span class="line"><span class="cl">    <span class="c1"># arguments. For an operation with a single return value, the output</span>
</span></span><span class="line"><span class="cl">    <span class="c1"># reference is accessed using `task.output` or</span>
</span></span><span class="line"><span class="cl">    <span class="c1"># `task.outputs[&#39;output_name&#39;]`.</span>
</span></span><span class="line"><span class="cl">    <span class="n">divmod_task</span> <span class="o">=</span> <span class="n">divmod_op</span><span class="p">(</span><span class="n">add_task</span><span class="o">.</span><span class="n">output</span><span class="p">,</span> <span class="n">b</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">    <span class="c1"># For an operation with multiple return values, output references are</span>
</span></span><span class="line"><span class="cl">    <span class="c1"># accessed as `task.outputs[&#39;output_name&#39;]`.</span>
</span></span><span class="line"><span class="cl">    <span class="n">result_task</span> <span class="o">=</span> <span class="n">add_op</span><span class="p">(</span><span class="n">divmod_task</span><span class="o">.</span><span class="n">outputs</span><span class="p">[</span><span class="s1">&#39;quotient&#39;</span><span class="p">],</span> <span class="n">c</span><span class="p">)</span>
</span></span></code></pre></div><ol start="5">
<li>Compile and run your pipeline. <a href="https://www.kubeflow.org/docs/components/pipelines/sdk/build-component/">Learn more about compiling and running pipelines</a>.</li>
</ol>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-python" data-lang="python"><span class="line"><span class="cl"><span class="c1"># Specify pipeline argument values</span>
</span></span><span class="line"><span class="cl"><span class="n">arguments</span> <span class="o">=</span> <span class="p">{</span><span class="s1">&#39;a&#39;</span><span class="p">:</span> <span class="s1">&#39;7&#39;</span><span class="p">,</span> <span class="s1">&#39;b&#39;</span><span class="p">:</span> <span class="s1">&#39;8&#39;</span><span class="p">}</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="c1"># Submit a pipeline run</span>
</span></span><span class="line"><span class="cl"><span class="n">client</span><span class="o">.</span><span class="n">create_run_from_pipeline_func</span><span class="p">(</span><span class="n">calc_pipeline</span><span class="p">,</span> <span class="n">arguments</span><span class="o">=</span><span class="n">arguments</span><span class="p">)</span>
</span></span></code></pre></div><div class="notebook-links">
<a class="colab-link" href="https://colab.research.google.com/github/kubeflow/website/blob/master/content/en/docs/components/pipelines/sdk/python-function-components.ipynb">Run in Google Colab</a>
<a class="github-link" href="https://github.com/kubeflow/website/blob/master/content/en/docs/components/pipelines/sdk/python-function-components.ipynb">View source on GitHub</a>
</div>
</div>



    
	
  
    
    
	
    

<div class="td-content" style="page-break-before: always">
    
	<h1 id="pg-affaa52b1b38b301a656c06f43992a9c">3.1.5.7 - Best Practices for Designing Components</h1>
    <div class="lead">Designing and writing components for Kubeflow Pipelines</div>
	

<div class="alert alert-warning" role="alert">
<h4 class="alert-heading">Out of date</h4>

    This guide contains outdated information pertaining to Kubeflow 1.0. This guide
needs to be updated for Kubeflow 1.1.

</div>

<p>This page describes some recommended practices for designing
components. For an application of these best practices, see the
<a href="/docs/components/pipelines/sdk/component-development">component development guide</a>. If
you&rsquo;re new to pipelines, see the conceptual guides to
<a href="/docs/components/pipelines/concepts/pipeline/">pipelines</a>
and <a href="/docs/components/pipelines/concepts/component/">components</a>.</p>
<p><a id="general"></a></p>
<h3 id="general-component-design-rules">General component design rules</h3>
<ul>
<li>Design your components with composability in mind. Think about
upstream and downstream components. What formats to consume as inputs from
the upstream components. What formats to use for output data so that
downstream components can consume it.</li>
<li>Component code must use local files for input/output data (unless impossible
<ul>
<li>for example, Cloud ML Engine and BigQuery require Cloud Storage staging
paths).</li>
</ul>
</li>
<li>Components must be <em>pure</em> - they must not use any outside data except data
that comes through inputs (unless impossible). Everything should either be
inside the container or come from inputs. Network access is strongly
discouraged unless that&rsquo;s the explicit purpose of a component (for example,
upload/download).</li>
</ul>
<h2 id="writing-component-code">Writing component code</h2>
<ul>
<li>
<p>The program must be runnable both locally and inside the Docker
container.</p>
</li>
<li>
<p>Programming languages:</p>
<ul>
<li>Generally, use the language that makes the most sense. If the
component wraps a Java library, then it may make sense to use Java to
expose that library.</li>
<li>For most new components when the performance is not a concern
the Python language is preferred (use version 3 wherever possible).</li>
<li>If a component wraps an existing program, it&rsquo;s preferred to
directly expose the program in the component command line.</li>
<li>If there needs to be some wrapper around the program (small
pre-processing or post-processing like file renaming), it can be done
with a shell script.</li>
<li>Follow the best practices for the chosen language.</li>
</ul>
</li>
<li>
<p>Each output data piece should be written to a separate file (see next line).</p>
</li>
<li>
<p>The input and output file paths must be passed in the command line and
not hard coded:</p>
<ul>
<li>
<p>Typical command line:</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-fallback" data-lang="fallback"><span class="line"><span class="cl">program.py --input-data &lt;input path&gt; --output-data &lt;output path&gt; --param 42
</span></span></code></pre></div></li>
<li>
<p>Do NOT hardcode paths in the program:</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-fallback" data-lang="fallback"><span class="line"><span class="cl">open(&#34;/output.txt&#34;, &#34;w&#34;)
</span></span></code></pre></div></li>
</ul>
</li>
<li>
<p>For temporary data you should use library functions that create
temporary files. For example, for Python use
<a href="https://docs.python.org/3/library/tempfile.html">https://docs.python.org/3/library/tempfile.html</a>.
Do not just write to the root, or testing will be hard.</p>
</li>
<li>
<p>Design the code to be testable.</p>
</li>
</ul>
<h2 id="writing-tests">Writing tests</h2>
<ul>
<li>
<p>Follow the <a href="#general">general rules</a> section so that writing the tests is
easier.</p>
</li>
<li>
<p>Use the unit testing libraries that are standard for the language you&rsquo;re
using.</p>
</li>
<li>
<p>Try to design the component code so that it can be tested using unit tests.
Do not use network unless necessary.</p>
</li>
<li>
<p>Prepare small input data files so that the component code can be tested in
isolation. For example, for an ML prediction component prepare a small model
and evaluation dataset.</p>
</li>
<li>
<p>Use testing best practices.</p>
<ul>
<li>
<p>Test the expected behavior of the code. Don&rsquo;t just verify that
&ldquo;nothing has changed&rdquo;:</p>
<ul>
<li>For training you can look at loss at final iteration.</li>
<li>For prediction you can look at the result metrics.</li>
<li>For data augmenting you can check for some desired post-invariants.</li>
</ul>
</li>
</ul>
</li>
<li>
<p>If the component cannot be tested locally or in isolation, then create a
small proof-of-concept pipeline that tests the component. You can use
conditionals to verify the output values of a particular task and only
enable the &ldquo;success&rdquo; task if the results are expected.</p>
</li>
</ul>
<h2 id="writing-a-dockerfile">Writing a Dockerfile</h2>
<ul>
<li>
<p>Follow the
<a href="https://docs.docker.com/develop/develop-images/dockerfile_best-practices/">Docker best practices</a></p>
</li>
<li>
<p>Structure the Dockerfile so that the required packages are installed
first and the main component scripts/binaries are added last. Ideally, split
the Dockerfile in two parts (base image and component code) so that the
main component image build is fast and more reliable (not require network
access).</p>
</li>
</ul>
<h2 id="writing-a-component-specification-yaml-file">Writing a component specification YAML file</h2>
<p>For the complete definition of a Kubeflow Pipelines component, see the
<a href="/docs/components/pipelines/reference/component-spec/">component specification</a>.
When creating your <code>component.yaml</code> file, you can look at the definitions for
some
<a href="https://github.com/kubeflow/pipelines/search?q=filename%3Acomponent.yaml&amp;unscoped_q=filename%3Acomponent.yaml">existing components</a>.</p>
<ul>
<li>Use the <code>{inputValue: Input name}</code> command-line placeholder for small
values that should be directly inserted into the command-line.</li>
<li>Use the <code>{inputPath: Input name}</code> command-line placeholder for input file
locations.</li>
<li>Use the <code>{outputPath: Output name}</code> command-line placeholder for output file
locations.</li>
<li>Specify the full command line in command:&rsquo; instead of just arguments to the
entry point.</li>
</ul>

</div>



    
	
  
    
    
	
    

<div class="td-content" style="page-break-before: always">
    
	<h1 id="pg-6a9a2a321d5959620aa38f3f01399c97">3.1.5.8 - Pipeline Parameters</h1>
    <div class="lead">Passing data between pipeline components</div>
	<p>The <a href="https://kubeflow-pipelines.readthedocs.io/en/stable/source/kfp.dsl.html#kfp.dsl.PipelineParam"><code>kfp.dsl.PipelineParam</code>
class</a>
represents a reference to future data that will be passed to the pipeline or produced by a task.</p>
<p>Your pipeline function should have parameters, so that they can later be configured in the Kubeflow Pipelines UI.</p>
<p>When your pipeline function is called, each function argument will be a <code>PipelineParam</code> object.
You can pass those objects to the components as arguments to instantiate them and create tasks.
A <code>PipelineParam</code> can also represent an intermediate value that you pass between pipeline tasks.
Each task has outputs and you can get references to them from the <code>task.outputs[&lt;output_name&gt;]</code> dictionary.
The task output references can again be passed to other components as arguments.</p>
<p>In most cases you do not need to construct <code>PipelineParam</code> objects manually.</p>
<p>The following code sample shows how to define a pipeline with parameters:</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-python" data-lang="python"><span class="line"><span class="cl"><span class="nd">@kfp</span><span class="o">.</span><span class="n">dsl</span><span class="o">.</span><span class="n">pipeline</span><span class="p">(</span>
</span></span><span class="line"><span class="cl">  <span class="n">name</span><span class="o">=</span><span class="s1">&#39;My pipeline&#39;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">  <span class="n">description</span><span class="o">=</span><span class="s1">&#39;My machine learning pipeline&#39;</span>
</span></span><span class="line"><span class="cl"><span class="p">)</span>
</span></span><span class="line"><span class="cl"><span class="k">def</span> <span class="nf">my_pipeline</span><span class="p">(</span>
</span></span><span class="line"><span class="cl">    <span class="n">my_num</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="mi">1000</span><span class="p">,</span> 
</span></span><span class="line"><span class="cl">    <span class="n">my_name</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="s1">&#39;some text&#39;</span><span class="p">,</span> 
</span></span><span class="line"><span class="cl">    <span class="n">my_url</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="s1">&#39;http://example.com&#39;</span>
</span></span><span class="line"><span class="cl"><span class="p">):</span>
</span></span><span class="line"><span class="cl">  <span class="o">...</span>
</span></span><span class="line"><span class="cl">  <span class="c1"># In the pipeline function body you can use the `my_num`, `my_name`, </span>
</span></span><span class="line"><span class="cl">  <span class="c1"># `my_url` arguments as PipelineParam objects.</span>
</span></span></code></pre></div><p>For more information, you can refer to the guide on
<a href="/docs/components/pipelines/sdk/component-development/">building components and pipelines</a>.</p>

</div>



    
	
  
    
    
	
    

<div class="td-content" style="page-break-before: always">
    
	<h1 id="pg-6c3616d054a1d9bb69a6a3e81e532406">3.1.5.9 - Visualize Results in the Pipelines UI</h1>
    <div class="lead">Visualizing the results of your pipelines component</div>
	<p>This page shows you how to use the Kubeflow Pipelines UI to visualize output
from a Kubeflow Pipelines component.
For details about how to build a component, see the guide to
<a href="/docs/components/pipelines/sdk/build-component/">building your own component</a>.</p>
<p>Kubeflow Pipelines provides a new method of generating visualizations. See the
guide to <a href="/docs/components/pipelines/sdk/python-based-visualizations/">Python Based Visualizations</a>.</p>
<h2 id="introduction">Introduction</h2>
<p>The Kubeflow Pipelines UI offers built-in support for several types of
visualizations, which you can use to provide rich performance evaluation and
comparison data. Follow the instruction below to write visualization output
data to file system. You can do this at any point during the pipeline execution.</p>
<p>You can view the output visualizations in the following places on the Kubeflow
Pipelines UI:</p>
<ul>
<li>
<p>The <strong>Run output</strong> tab shows the visualizations for all pipeline steps in the
selected run. To open the tab in the Kubeflow Pipelines UI:</p>
<ol>
<li>Click <strong>Experiments</strong> to see your current pipeline experiments.</li>
<li>Click the <em>experiment name</em> of the experiment that you want to view.</li>
<li>Click the <em>run name</em> of the run that you want to view.</li>
<li>Click the <strong>Run output</strong> tab.</li>
</ol>
<p><img src="/docs/images/taxi-tip-run-output.png" 
alt="Output visualization from a pipeline run"
class="mt-3 mb-3 border border-info rounded"></p>
</li>
<li>
<p>The <strong>Visualizations</strong> tab shows the visualization for the selected pipeline step.
To open the tab in the Kubeflow Pipelines UI:</p>
<ol>
<li>Click <strong>Experiments</strong> to see your current pipeline experiments.</li>
<li>Click the <em>experiment name</em> of the experiment that you want to view.</li>
<li>Click the <em>run name</em> of the run that you want to view.</li>
<li>On the <strong>Graph</strong> tab, click the step representing the pipeline component
that you want to view. The step details slide into view, showing the
<strong>Visualizations</strong> tab.</li>
</ol>
<p><img src="/docs/images/pipelines/v1/confusion-matrix-task.png" 
alt="Table-based visualization from a pipeline component"
class="mt-3 mb-3 border border-info rounded"></p>
</li>
</ul>
<p>All screenshots and code snippets on this page come from a
sample pipeline that you can run directly from the Kubeflow Pipelines UI.
See the <a href="#example-source">sample description and links below</a>.</p>
<p><a id="v2-visualization"></a></p>
<h2 id="v2-sdk-use-sdk-visualization-apis">v2 SDK: Use SDK visualization APIs</h2>
<p>For KFP <a href="/docs/components/pipelines/sdk-v2/">SDK v2 and v2 compatible mode</a>, you can use
convenient SDK APIs and system artifact types for metrics visualization. Currently KFP
supports ROC Curve, Confusion Matrix and Scalar Metrics formats. Full pipeline example
of all metrics visualizations can be found in <a href="https://github.com/kubeflow/pipelines/blob/sdk/release-1.8/samples/test/metrics_visualization_v2.py">metrics_visualization_v2.py</a>.</p>
<h3 id="requirements">Requirements</h3>
<ul>
<li>Use Kubeflow Pipelines v1.7.0 or above: <a href="/docs/components/pipelines/installation/standalone-deployment/#upgrading-kubeflow-pipelines">upgrade Kubeflow Pipelines</a>.</li>
<li>Use <code>kfp.dsl.PipelineExecutionMode.V2_COMPATIBLE</code> mode when you <a href="/docs/components/pipelines/sdk-v2/build-pipeline/#compile-and-run-your-pipeline">compile and run your pipelines</a>.</li>
<li>Make sure to use the latest environment kustomize manifest <a href="https://github.com/kubeflow/pipelines/blob/sdk/release-1.8/manifests/kustomize/env/dev/kustomization.yaml">pipelines/manifests/kustomize/env/dev/kustomization.yaml</a>.</li>
</ul>
<p>For a usage guide of each metric visualization output, refer to sections below:</p>
<h3 id="confusion-matrix">Confusion Matrix</h3>
<p>Define <code>Output[ClassificationMetrics]</code> argument in your component function, then
output Confusion Matrix data using API
<code>log_confusion_matrix(self, categories: List[str], matrix: List[List[int]])</code>. <code>categories</code>
provides a list of names for each label, <code>matrix</code> provides prediction performance for corresponding
label. There are multiple APIs you can use for logging Confusion Matrix. Refer to
<a href="https://github.com/kubeflow/pipelines/blob/55a2fb5c20011b01945c9867ddff0d39e9db1964/sdk/python/kfp/v2/components/types/artifact_types.py#L255-L256">artifact_types.py</a> for detail.</p>
<p>Refer to example below for logging Confusion Matrix:</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-fallback" data-lang="fallback"><span class="line"><span class="cl">@component(
</span></span><span class="line"><span class="cl">    packages_to_install=[&#39;sklearn&#39;],
</span></span><span class="line"><span class="cl">    base_image=&#39;python:3.9&#39;
</span></span><span class="line"><span class="cl">)
</span></span><span class="line"><span class="cl">def iris_sgdclassifier(test_samples_fraction: float, metrics: Output[ClassificationMetrics]):
</span></span><span class="line"><span class="cl">    from sklearn import datasets, model_selection
</span></span><span class="line"><span class="cl">    from sklearn.linear_model import SGDClassifier
</span></span><span class="line"><span class="cl">    from sklearn.metrics import confusion_matrix
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">    iris_dataset = datasets.load_iris()
</span></span><span class="line"><span class="cl">    train_x, test_x, train_y, test_y = model_selection.train_test_split(
</span></span><span class="line"><span class="cl">        iris_dataset[&#39;data&#39;], iris_dataset[&#39;target&#39;], test_size=test_samples_fraction)
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">    classifier = SGDClassifier()
</span></span><span class="line"><span class="cl">    classifier.fit(train_x, train_y)
</span></span><span class="line"><span class="cl">    predictions = model_selection.cross_val_predict(classifier, train_x, train_y, cv=3)
</span></span><span class="line"><span class="cl">    metrics.log_confusion_matrix(
</span></span><span class="line"><span class="cl">        [&#39;Setosa&#39;, &#39;Versicolour&#39;, &#39;Virginica&#39;],
</span></span><span class="line"><span class="cl">        confusion_matrix(train_y, predictions).tolist() # .tolist() to convert np array to list.
</span></span><span class="line"><span class="cl">    )
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">@dsl.pipeline(
</span></span><span class="line"><span class="cl">    name=&#39;metrics-visualization-pipeline&#39;)
</span></span><span class="line"><span class="cl">def metrics_visualization_pipeline():
</span></span><span class="line"><span class="cl">    iris_sgdclassifier_op = iris_sgdclassifier(test_samples_fraction=0.3)
</span></span></code></pre></div><p>Visualization of Confusion Matrix is as below:</p>
<p><img src="/docs/images/pipelines/v1/v2-compatible/confusion-matrix.png" 
alt="V2 Confusion matrix visualization"
class="mt-3 mb-3 border border-info rounded"></p>
<h3 id="roc-curve">ROC Curve</h3>
<p>Define <code>Output[ClassificationMetrics]</code> argument in your component function, then
output ROC Curve data using API
<code>log_roc_curve(self, fpr: List[float], tpr: List[float], threshold: List[float])</code>.
<code>fpr</code> defines a list of False Positive Rate values, <code>tpr</code> defines a list of
True Positive Rate values, <code>threshold</code> indicates the level of sensitivity and specificity
of this probability curve. There are multiple APIs you can use for logging ROC Curve. Refer to
<a href="https://github.com/kubeflow/pipelines/blob/55a2fb5c20011b01945c9867ddff0d39e9db1964/sdk/python/kfp/v2/components/types/artifact_types.py#L163-L164">artifact_types.py</a> for detail.</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-fallback" data-lang="fallback"><span class="line"><span class="cl">@component(
</span></span><span class="line"><span class="cl">    packages_to_install=[&#39;sklearn&#39;],
</span></span><span class="line"><span class="cl">    base_image=&#39;python:3.9&#39;,
</span></span><span class="line"><span class="cl">)
</span></span><span class="line"><span class="cl">def wine_classification(metrics: Output[ClassificationMetrics]):
</span></span><span class="line"><span class="cl">    from sklearn.ensemble import RandomForestClassifier
</span></span><span class="line"><span class="cl">    from sklearn.metrics import roc_curve
</span></span><span class="line"><span class="cl">    from sklearn.datasets import load_wine
</span></span><span class="line"><span class="cl">    from sklearn.model_selection import train_test_split, cross_val_predict
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">    X, y = load_wine(return_X_y=True)
</span></span><span class="line"><span class="cl">    # Binary classification problem for label 1.
</span></span><span class="line"><span class="cl">    y = y == 1
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">    X_train, X_test, y_train, y_test = train_test_split(X, y, random_state=42)
</span></span><span class="line"><span class="cl">    rfc = RandomForestClassifier(n_estimators=10, random_state=42)
</span></span><span class="line"><span class="cl">    rfc.fit(X_train, y_train)
</span></span><span class="line"><span class="cl">    y_scores = cross_val_predict(rfc, X_train, y_train, cv=3, method=&#39;predict_proba&#39;)
</span></span><span class="line"><span class="cl">    y_predict = cross_val_predict(rfc, X_train, y_train, cv=3, method=&#39;predict&#39;)
</span></span><span class="line"><span class="cl">    fpr, tpr, thresholds = roc_curve(y_true=y_train, y_score=y_scores[:,1], pos_label=True)
</span></span><span class="line"><span class="cl">    metrics.log_roc_curve(fpr, tpr, thresholds)
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">@dsl.pipeline(
</span></span><span class="line"><span class="cl">    name=&#39;metrics-visualization-pipeline&#39;)
</span></span><span class="line"><span class="cl">def metrics_visualization_pipeline():
</span></span><span class="line"><span class="cl">    wine_classification_op = wine_classification()
</span></span></code></pre></div><p>Visualization of ROC Curve is as below:</p>
<p><img src="/docs/images/pipelines/v1/v2-compatible/roc-curve.png" 
alt="V2 ROC Curve visualization"
class="mt-3 mb-3 border border-info rounded"></p>
<h3 id="scalar-metrics">Scalar Metrics</h3>
<p>Define <code>Output[Metrics]</code> argument in your component function, then
output Scalar data using API <code>log_metric(self, metric: str, value: float)</code>.
You can define any amount of metric by calling this API multiple times.
<code>metric</code> defines the name of metric, <code>value</code> is the value of this metric. Refer to
<a href="https://github.com/kubeflow/pipelines/blob/55a2fb5c20011b01945c9867ddff0d39e9db1964/sdk/python/kfp/v2/components/types/artifact_types.py#L124">artifacts_types.py</a>
for detail.</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-fallback" data-lang="fallback"><span class="line"><span class="cl">@component(
</span></span><span class="line"><span class="cl">    packages_to_install=[&#39;sklearn&#39;],
</span></span><span class="line"><span class="cl">    base_image=&#39;python:3.9&#39;,
</span></span><span class="line"><span class="cl">)
</span></span><span class="line"><span class="cl">def digit_classification(metrics: Output[Metrics]):
</span></span><span class="line"><span class="cl">    from sklearn import model_selection
</span></span><span class="line"><span class="cl">    from sklearn.linear_model import LogisticRegression
</span></span><span class="line"><span class="cl">    from sklearn import datasets
</span></span><span class="line"><span class="cl">    from sklearn.metrics import accuracy_score
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">    # Load digits dataset
</span></span><span class="line"><span class="cl">    iris = datasets.load_iris()
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">    # # Create feature matrix
</span></span><span class="line"><span class="cl">    X = iris.data
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">    # Create target vector
</span></span><span class="line"><span class="cl">    y = iris.target
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">    #test size
</span></span><span class="line"><span class="cl">    test_size = 0.33
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">    seed = 7
</span></span><span class="line"><span class="cl">    #cross-validation settings
</span></span><span class="line"><span class="cl">    kfold = model_selection.KFold(n_splits=10, random_state=seed, shuffle=True)
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">    #Model instance
</span></span><span class="line"><span class="cl">    model = LogisticRegression()
</span></span><span class="line"><span class="cl">    scoring = &#39;accuracy&#39;
</span></span><span class="line"><span class="cl">    results = model_selection.cross_val_score(model, X, y, cv=kfold, scoring=scoring)
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">    #split data
</span></span><span class="line"><span class="cl">    X_train, X_test, y_train, y_test = model_selection.train_test_split(X, y, test_size=test_size, random_state=seed)
</span></span><span class="line"><span class="cl">    #fit model
</span></span><span class="line"><span class="cl">    model.fit(X_train, y_train)
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">    #accuracy on test set
</span></span><span class="line"><span class="cl">    result = model.score(X_test, y_test)
</span></span><span class="line"><span class="cl">    metrics.log_metric(&#39;accuracy&#39;, (result*100.0))
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">@dsl.pipeline(
</span></span><span class="line"><span class="cl">    name=&#39;metrics-visualization-pipeline&#39;)
</span></span><span class="line"><span class="cl">def metrics_visualization_pipeline():
</span></span><span class="line"><span class="cl">    digit_classification_op = digit_classification()
</span></span></code></pre></div><p>Visualization of Scalar Metrics is as below:</p>
<p><img src="/docs/images/pipelines/v1/v2-compatible/scalar-metrics.png" 
alt="V2 Scalar Metrics visualization"
class="mt-3 mb-3 border border-info rounded"></p>
<h3 id="markdown">Markdown</h3>
<p>Define <code>Output[Markdown]</code> argument in your component function, then
write Markdown file to path <code>&lt;artifact_argument_name&gt;.path</code>.
Refer to
<a href="https://github.com/kubeflow/pipelines/blob/55a2fb5c20011b01945c9867ddff0d39e9db1964/sdk/python/kfp/v2/components/types/artifact_types.py#L420-L428">artifact_types.py</a>
for detail.</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-fallback" data-lang="fallback"><span class="line"><span class="cl">@component
</span></span><span class="line"><span class="cl">def markdown_visualization(markdown_artifact: Output[Markdown]):
</span></span><span class="line"><span class="cl">    markdown_content = &#39;## Hello world \n\n Markdown content&#39;
</span></span><span class="line"><span class="cl">    with open(markdown_artifact.path, &#39;w&#39;) as f:
</span></span><span class="line"><span class="cl">        f.write(markdown_content)
</span></span></code></pre></div><p><img src="/docs/images/pipelines/v1/v2-compatible/markdown-visualization.png" 
alt="Markdown visualization in v2 compatible mode"
class="mt-3 mb-3 border border-info rounded"></p>
<h3 id="single-html-file">Single HTML file</h3>
<p>You can specify an HTML file that your component creates, and the Kubeflow Pipelines UI renders that HTML in the output page. The HTML file must be self-contained, with no references to other files in the filesystem. The HTML file can contain absolute references to files on the web. Content running inside the HTML file is sandboxed in an iframe and cannot communicate with the Kubeflow Pipelines UI.</p>
<p>Define <code>Output[HTML]</code> argument in your component function, then
write HTML file to path <code>&lt;artifact_argument_name&gt;.path</code>.
Refer to
<a href="https://github.com/kubeflow/pipelines/blob/55a2fb5c20011b01945c9867ddff0d39e9db1964/sdk/python/kfp/v2/components/types/artifact_types.py#L409-L417">artifact_types.py</a>
for detail.</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-fallback" data-lang="fallback"><span class="line"><span class="cl">@component
</span></span><span class="line"><span class="cl">def html_visualization(html_artifact: Output[HTML]):
</span></span><span class="line"><span class="cl">    html_content = &#39;&lt;!DOCTYPE html&gt;&lt;html&gt;&lt;body&gt;&lt;h1&gt;Hello world&lt;/h1&gt;&lt;/body&gt;&lt;/html&gt;&#39;
</span></span><span class="line"><span class="cl">    with open(html_artifact.path, &#39;w&#39;) as f:
</span></span><span class="line"><span class="cl">        f.write(html_content)
</span></span></code></pre></div><p><img src="/docs/images/taxi-tip-analysis-step-output-webapp-popped-out.png" 
alt="Web app output from a pipeline component"
class="mt-3 mb-3 border border-info rounded"></p>
<h2 id="source-of-v2-examples">Source of v2 examples</h2>
<p>The metric visualization in V2 or V2 compatible mode depends on SDK visualization APIs,
refer to <a href="https://github.com/kubeflow/pipelines/blob/sdk/release-1.8/samples/test/metrics_visualization_v2.py">metrics_visualization_v2.py</a>
for a complete pipeline example. Follow instruction
<a href="/docs/components/pipelines/sdk-v2/build-pipeline/#compile-and-run-your-pipeline">Compile and run your pipeline</a>
to compile in V2 compatible mode.</p>
<h2 id="v1-sdk-writing-out-metadata-for-the-output-viewers">v1 SDK: Writing out metadata for the output viewers</h2>
<p>For KFP v1, the pipeline component must write a JSON file specifying metadata
for the output viewer(s) that you want to use for visualizing the results. The
component must also export a file output artifact with an artifact name of
<code>mlpipeline-ui-metadata</code>, or else the Kubeflow Pipelines UI will not render
the visualization. In other words, the <code>.outputs.artifacts</code> setting for the
generated pipeline component should show:
<code>- {name: mlpipeline-ui-metadata, path: /mlpipeline-ui-metadata.json}</code>.
The JSON filepath does not matter, although <code>/mlpipeline-ui-metadata.json</code>
is used for consistency in the examples below.</p>
<p>The JSON specifies an array of <code>outputs</code>. Each <code>outputs</code> entry describes the
metadata for an output viewer. The JSON structure looks like this:</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-fallback" data-lang="fallback"><span class="line"><span class="cl">{
</span></span><span class="line"><span class="cl">  &#34;version&#34;: 1,
</span></span><span class="line"><span class="cl">  &#34;outputs&#34;: [
</span></span><span class="line"><span class="cl">    {
</span></span><span class="line"><span class="cl">      &#34;type&#34;: &#34;confusion_matrix&#34;,
</span></span><span class="line"><span class="cl">      &#34;format&#34;: &#34;csv&#34;,
</span></span><span class="line"><span class="cl">      &#34;source&#34;: &#34;my-dir/my-matrix.csv&#34;,
</span></span><span class="line"><span class="cl">      &#34;schema&#34;: [
</span></span><span class="line"><span class="cl">        {&#34;name&#34;: &#34;target&#34;, &#34;type&#34;: &#34;CATEGORY&#34;},
</span></span><span class="line"><span class="cl">        {&#34;name&#34;: &#34;predicted&#34;, &#34;type&#34;: &#34;CATEGORY&#34;},
</span></span><span class="line"><span class="cl">        {&#34;name&#34;: &#34;count&#34;, &#34;type&#34;: &#34;NUMBER&#34;},
</span></span><span class="line"><span class="cl">      ],
</span></span><span class="line"><span class="cl">      &#34;labels&#34;: &#34;vocab&#34;
</span></span><span class="line"><span class="cl">    },
</span></span><span class="line"><span class="cl">    {
</span></span><span class="line"><span class="cl">      ...
</span></span><span class="line"><span class="cl">    }
</span></span><span class="line"><span class="cl">  ]
</span></span><span class="line"><span class="cl">}
</span></span></code></pre></div><p>If the component writes such a file to its container filesystem, the Kubeflow
Pipelines system extracts the file, and the Kubeflow Pipelines UI uses the file
to generate the specified viewer(s). The metadata specifies where to load the
artifact data from. The Kubeflow Pipelines UI loads the data <strong>into memory</strong>
and renders it. <em>Note:</em> You should keep this data at a volume that&rsquo;s manageable
by the UI, for example by running a sampling step before exporting the file as
an artifact.</p>
<p>The table below shows the available metadata fields that you can specify in the
<code>outputs</code> array. Each <code>outputs</code> entry must have a <code>type</code>. Depending on value of
<code>type</code>, other fields may also be required as described in the list of output
viewers later on the page.</p>
<div class="table-responsive">
  <table class="table table-bordered">
    <thead class="thead-light">
      <tr>
        <th>Field name</th>
        <th>Description</th>
      </tr>
    </thead>
    <tbody>
      <tr>
        <td><code>format</code></td>
        <td>The format of the artifact data. The default is <code>csv</code>. 
          <em>Note:</em> The only format currently available is 
          <code>csv</code>.
        </td>
      </tr>
      <tr>
        <td><code>header</code></td>
        <td>A list of strings to be used as headers for the artifact data. For 
          example, in a table these strings are used in the first row.</td>
      </tr>
      <tr>
        <td><code>labels</code></td>
        <td>A list of strings to be used as labels for artifact columns or 
          rows.</td>
      </tr>
      <tr>
        <td><code>predicted_col</code></td>
        <td>Name of the predicted column.</td>
      </tr>
      <tr>
        <td><code>schema</code></td>
        <td>A list of <code>{type, name}</code> objects that specify the schema 
          of the artifact data.</td>
      </tr>
      <tr>
        <td><code>source</code></td>
        <td><p>The full path to the data. The available locations
          include <code>http</code>, <code>https</code>, 
          <a href="https://aws.amazon.com/s3/">Amazon S3</a>, 
          <a href="https://docs.minio.io/">Minio</a>, and 
          <a href="https://cloud.google.com/storage/docs/">Google Cloud 
          Storage</a>.</p>
          <p>The path can contain wildcards *, in 
          which case the Kubeflow Pipelines UI concatenates the data from the 
          matching source files.</p>
          <p><code>source</code> can also contain inlined string data instead of
          a path when <code>storage='inline'</code>.</p>
          </td>
      </tr>
      <tr>
        <td><code>storage</code></td>
        <td><p>(Optional) When <code>storage</code> is <code>inline</code>, the value of
        <code>source</code> is parsed as inline data instead of a path. This applies
        to all types of outputs except <code>tensorboard</code>. See 
        <a href="#markdown">Markdown</a> or <a href="#web-app">Web app</a>
        below as examples.</p>
        <p><b>Be aware</b>, support for inline visualizations, other than
        markdown, was introduced in Kubeflow Pipelines 0.2.5. Before using these
        visualizations, [upgrade  your Kubeflow Pipelines cluster](/docs/components/pipelines/upgrade/)
        to version 0.2.5 or higher.</p>
        </td>
      </tr>
      <tr>
        <td><code>target_col</code></td>
        <td>Name of the target column.</td>
      </tr>
      <tr>
        <td><code>type</code></td>
        <td>Name of the viewer to be used to visualize the data. The list 
          <a href="#output-types">below</a> shows the available types.</td>
      </tr>
    </tbody>
  </table>
</div>
<p><a id="output-types"></a></p>
<h2 id="available-output-viewers">Available output viewers</h2>
<p>The sections below describe the available viewer types and the <strong>required</strong>
metadata fields for each type.</p>
<h3 id="confusion-matrix-1">Confusion matrix</h3>
<p><strong>Type:</strong> <code>confusion_matrix</code></p>
<p><strong>Required metadata fields:</strong></p>
<ul>
<li><code>format</code></li>
<li><code>labels</code></li>
<li><code>schema</code></li>
<li><code>source</code></li>
</ul>
<p><strong>Optional metadata fields:</strong></p>
<ul>
<li><code>storage</code></li>
</ul>
<p>The <code>confusion_matrix</code> viewer plots a confusion matrix visualization of the data
from the given <code>source</code> path, using the <code>schema</code> to parse the data. The <code>labels</code>
provide the names of the classes to be plotted on the x and y axes.</p>
<p>Specify <code>'storage': 'inline'</code> to embed raw content of the
confusion matrix CSV file as a string in <code>source</code> field directly.</p>
<p><strong>Example:</strong></p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-Python" data-lang="Python"><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="k">def</span> <span class="nf">confusion_matrix_viz</span><span class="p">(</span><span class="n">mlpipeline_ui_metadata_path</span><span class="p">:</span> <span class="n">kfp</span><span class="o">.</span><span class="n">components</span><span class="o">.</span><span class="n">OutputPath</span><span class="p">()):</span>
</span></span><span class="line"><span class="cl">  <span class="kn">import</span> <span class="nn">json</span>
</span></span><span class="line"><span class="cl">    
</span></span><span class="line"><span class="cl">  <span class="n">metadata</span> <span class="o">=</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">    <span class="s1">&#39;outputs&#39;</span> <span class="p">:</span> <span class="p">[{</span>
</span></span><span class="line"><span class="cl">      <span class="s1">&#39;type&#39;</span><span class="p">:</span> <span class="s1">&#39;confusion_matrix&#39;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">      <span class="s1">&#39;format&#39;</span><span class="p">:</span> <span class="s1">&#39;csv&#39;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">      <span class="s1">&#39;schema&#39;</span><span class="p">:</span> <span class="p">[</span>
</span></span><span class="line"><span class="cl">        <span class="p">{</span><span class="s1">&#39;name&#39;</span><span class="p">:</span> <span class="s1">&#39;target&#39;</span><span class="p">,</span> <span class="s1">&#39;type&#39;</span><span class="p">:</span> <span class="s1">&#39;CATEGORY&#39;</span><span class="p">},</span>
</span></span><span class="line"><span class="cl">        <span class="p">{</span><span class="s1">&#39;name&#39;</span><span class="p">:</span> <span class="s1">&#39;predicted&#39;</span><span class="p">,</span> <span class="s1">&#39;type&#39;</span><span class="p">:</span> <span class="s1">&#39;CATEGORY&#39;</span><span class="p">},</span>
</span></span><span class="line"><span class="cl">        <span class="p">{</span><span class="s1">&#39;name&#39;</span><span class="p">:</span> <span class="s1">&#39;count&#39;</span><span class="p">,</span> <span class="s1">&#39;type&#39;</span><span class="p">:</span> <span class="s1">&#39;NUMBER&#39;</span><span class="p">},</span>
</span></span><span class="line"><span class="cl">      <span class="p">],</span>
</span></span><span class="line"><span class="cl">      <span class="s1">&#39;source&#39;</span><span class="p">:</span> <span class="o">&lt;</span><span class="n">CONFUSION_MATRIX_CSV_FILE</span><span class="o">&gt;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">      <span class="c1"># Convert vocab to string because for bealean values we want &#34;True|False&#34; to match csv data.</span>
</span></span><span class="line"><span class="cl">      <span class="s1">&#39;labels&#39;</span><span class="p">:</span> <span class="nb">list</span><span class="p">(</span><span class="nb">map</span><span class="p">(</span><span class="nb">str</span><span class="p">,</span> <span class="n">vocab</span><span class="p">)),</span>
</span></span><span class="line"><span class="cl">    <span class="p">}]</span>
</span></span><span class="line"><span class="cl">  <span class="p">}</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">  <span class="k">with</span> <span class="nb">open</span><span class="p">(</span><span class="n">mlpipeline_ui_metadata_path</span><span class="p">,</span> <span class="s1">&#39;w&#39;</span><span class="p">)</span> <span class="k">as</span> <span class="n">metadata_file</span><span class="p">:</span>
</span></span><span class="line"><span class="cl">    <span class="n">json</span><span class="o">.</span><span class="n">dump</span><span class="p">(</span><span class="n">metadata</span><span class="p">,</span> <span class="n">metadata_file</span><span class="p">)</span>
</span></span></code></pre></div><p><strong>Visualization on the Kubeflow Pipelines UI:</strong></p>
<p><img src="/docs/images/taxi-tip-confusion-matrix-step-output.png" 
alt="Confusion matrix visualization from a pipeline component"
class="mt-3 mb-3 border border-info rounded"></p>
<p><a id="type-markdown"></a></p>
<h3 id="markdown-1">Markdown</h3>
<p><strong>Type:</strong> <code>markdown</code></p>
<p><strong>Required metadata fields:</strong></p>
<ul>
<li><code>source</code></li>
</ul>
<p><strong>Optional metadata fields:</strong></p>
<ul>
<li><code>storage</code></li>
</ul>
<p>The <code>markdown</code> viewer renders Markdown strings on the Kubeflow Pipelines UI.
The viewer can read the Markdown data from the following locations:</p>
<ul>
<li>A Markdown-formatted string embedded in the <code>source</code> field. The value of the
<code>storage</code> field must be <code>inline</code>.</li>
<li>Markdown code in a remote file, at a path specified in the <code>source</code> field.
The <code>storage</code> field can be empty or contain any value except <code>inline</code>.</li>
</ul>
<p><strong>Example:</strong></p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-Python" data-lang="Python"><span class="line"><span class="cl"><span class="k">def</span> <span class="nf">markdown_vis</span><span class="p">(</span><span class="n">mlpipeline_ui_metadata_path</span><span class="p">:</span> <span class="n">kfp</span><span class="o">.</span><span class="n">components</span><span class="o">.</span><span class="n">OutputPath</span><span class="p">()):</span>
</span></span><span class="line"><span class="cl">  <span class="kn">import</span> <span class="nn">json</span>
</span></span><span class="line"><span class="cl">    
</span></span><span class="line"><span class="cl">  <span class="n">metadata</span> <span class="o">=</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">    <span class="s1">&#39;outputs&#39;</span> <span class="p">:</span> <span class="p">[</span>
</span></span><span class="line"><span class="cl">    <span class="c1"># Markdown that is hardcoded inline</span>
</span></span><span class="line"><span class="cl">    <span class="p">{</span>
</span></span><span class="line"><span class="cl">      <span class="s1">&#39;storage&#39;</span><span class="p">:</span> <span class="s1">&#39;inline&#39;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">      <span class="s1">&#39;source&#39;</span><span class="p">:</span> <span class="s1">&#39;# Inline Markdown</span><span class="se">\n</span><span class="s1">[A link](https://www.kubeflow.org/)&#39;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">      <span class="s1">&#39;type&#39;</span><span class="p">:</span> <span class="s1">&#39;markdown&#39;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">    <span class="p">},</span>
</span></span><span class="line"><span class="cl">    <span class="c1"># Markdown that is read from a file</span>
</span></span><span class="line"><span class="cl">    <span class="p">{</span>
</span></span><span class="line"><span class="cl">      <span class="s1">&#39;source&#39;</span><span class="p">:</span> <span class="s1">&#39;gs://your_project/your_bucket/your_markdown_file&#39;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">      <span class="s1">&#39;type&#39;</span><span class="p">:</span> <span class="s1">&#39;markdown&#39;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">    <span class="p">}]</span>
</span></span><span class="line"><span class="cl">  <span class="p">}</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">  <span class="k">with</span> <span class="nb">open</span><span class="p">(</span><span class="n">mlpipeline_ui_metadata_path</span><span class="p">,</span> <span class="s1">&#39;w&#39;</span><span class="p">)</span> <span class="k">as</span> <span class="n">metadata_file</span><span class="p">:</span>
</span></span><span class="line"><span class="cl">    <span class="n">json</span><span class="o">.</span><span class="n">dump</span><span class="p">(</span><span class="n">metadata</span><span class="p">,</span> <span class="n">metadata_file</span><span class="p">)</span>
</span></span></code></pre></div><p><strong>Visualization on the Kubeflow Pipelines UI:</strong></p>
<p><img src="/docs/images/markdown-output.png" 
alt="Markdown visualization from a pipeline component"
class="mt-3 mb-3 border border-info rounded"></p>
<h3 id="roc-curve-1">ROC curve</h3>
<p><strong>Type:</strong> <code>roc</code></p>
<p><strong>Required metadata fields:</strong></p>
<ul>
<li><code>format</code></li>
<li><code>schema</code></li>
<li><code>source</code></li>
</ul>
<p>The <code>roc</code> viewer plots a receiver operating characteristic
(<a href="https://en.wikipedia.org/wiki/Receiver_operating_characteristic">ROC</a>)
curve using the data from the given source path. The Kubeflow Pipelines UI
assumes that the schema includes three columns with the following names:</p>
<ul>
<li><code>fpr</code> (false positive rate)</li>
<li><code>tpr</code> (true positive rate)</li>
<li><code>thresholds</code></li>
</ul>
<p><strong>Optional metadata fields:</strong></p>
<ul>
<li><code>storage</code></li>
</ul>
<p>When viewing the ROC curve, you can hover your cursor over the ROC curve to see
the threshold value used for the cursor&rsquo;s closest <code>fpr</code> and <code>tpr</code> values.</p>
<p>Specify <code>'storage': 'inline'</code> to embed raw content of the ROC
curve CSV file as a string in <code>source</code> field directly.</p>
<p><strong>Example:</strong></p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-Python" data-lang="Python"><span class="line"><span class="cl"><span class="k">def</span> <span class="nf">roc_vis</span><span class="p">(</span><span class="n">roc_csv_file_path</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span> <span class="n">mlpipeline_ui_metadata_path</span><span class="p">:</span> <span class="n">kfp</span><span class="o">.</span><span class="n">components</span><span class="o">.</span><span class="n">OutputPath</span><span class="p">()):</span>
</span></span><span class="line"><span class="cl">  <span class="kn">import</span> <span class="nn">json</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">  <span class="n">df_roc</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">({</span><span class="s1">&#39;fpr&#39;</span><span class="p">:</span> <span class="n">fpr</span><span class="p">,</span> <span class="s1">&#39;tpr&#39;</span><span class="p">:</span> <span class="n">tpr</span><span class="p">,</span> <span class="s1">&#39;thresholds&#39;</span><span class="p">:</span> <span class="n">thresholds</span><span class="p">})</span>
</span></span><span class="line"><span class="cl">  <span class="n">roc_file</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">roc_csv_file_path</span><span class="p">,</span> <span class="s1">&#39;roc.csv&#39;</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">  <span class="k">with</span> <span class="n">file_io</span><span class="o">.</span><span class="n">FileIO</span><span class="p">(</span><span class="n">roc_file</span><span class="p">,</span> <span class="s1">&#39;w&#39;</span><span class="p">)</span> <span class="k">as</span> <span class="n">f</span><span class="p">:</span>
</span></span><span class="line"><span class="cl">    <span class="n">df_roc</span><span class="o">.</span><span class="n">to_csv</span><span class="p">(</span><span class="n">f</span><span class="p">,</span> <span class="n">columns</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;fpr&#39;</span><span class="p">,</span> <span class="s1">&#39;tpr&#39;</span><span class="p">,</span> <span class="s1">&#39;thresholds&#39;</span><span class="p">],</span> <span class="n">header</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">index</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">  <span class="n">metadata</span> <span class="o">=</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">    <span class="s1">&#39;outputs&#39;</span><span class="p">:</span> <span class="p">[{</span>
</span></span><span class="line"><span class="cl">      <span class="s1">&#39;type&#39;</span><span class="p">:</span> <span class="s1">&#39;roc&#39;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">      <span class="s1">&#39;format&#39;</span><span class="p">:</span> <span class="s1">&#39;csv&#39;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">      <span class="s1">&#39;schema&#39;</span><span class="p">:</span> <span class="p">[</span>
</span></span><span class="line"><span class="cl">        <span class="p">{</span><span class="s1">&#39;name&#39;</span><span class="p">:</span> <span class="s1">&#39;fpr&#39;</span><span class="p">,</span> <span class="s1">&#39;type&#39;</span><span class="p">:</span> <span class="s1">&#39;NUMBER&#39;</span><span class="p">},</span>
</span></span><span class="line"><span class="cl">        <span class="p">{</span><span class="s1">&#39;name&#39;</span><span class="p">:</span> <span class="s1">&#39;tpr&#39;</span><span class="p">,</span> <span class="s1">&#39;type&#39;</span><span class="p">:</span> <span class="s1">&#39;NUMBER&#39;</span><span class="p">},</span>
</span></span><span class="line"><span class="cl">        <span class="p">{</span><span class="s1">&#39;name&#39;</span><span class="p">:</span> <span class="s1">&#39;thresholds&#39;</span><span class="p">,</span> <span class="s1">&#39;type&#39;</span><span class="p">:</span> <span class="s1">&#39;NUMBER&#39;</span><span class="p">},</span>
</span></span><span class="line"><span class="cl">      <span class="p">],</span>
</span></span><span class="line"><span class="cl">      <span class="s1">&#39;source&#39;</span><span class="p">:</span> <span class="n">roc_file</span>
</span></span><span class="line"><span class="cl">    <span class="p">}]</span>
</span></span><span class="line"><span class="cl">  <span class="p">}</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">  <span class="k">with</span> <span class="nb">open</span><span class="p">(</span><span class="n">mlpipeline_ui_metadata_path</span><span class="p">,</span> <span class="s1">&#39;w&#39;</span><span class="p">)</span> <span class="k">as</span> <span class="n">metadata_file</span><span class="p">:</span>
</span></span><span class="line"><span class="cl">    <span class="n">json</span><span class="o">.</span><span class="n">dump</span><span class="p">(</span><span class="n">metadata</span><span class="p">,</span> <span class="n">metadata_file</span><span class="p">)</span>
</span></span></code></pre></div><p><strong>Visualization on the Kubeflow Pipelines UI:</strong></p>
<p><img src="/docs/images/taxi-tip-roc-step-output.png" 
alt="ROC curve visualization from a pipeline component"
class="mt-3 mb-3 border border-info rounded"></p>
<h3 id="table">Table</h3>
<p><strong>Type:</strong> <code>table</code></p>
<p><strong>Required metadata fields:</strong></p>
<ul>
<li><code>format</code></li>
<li><code>header</code></li>
<li><code>source</code></li>
</ul>
<p><strong>Optional metadata fields:</strong></p>
<ul>
<li><code>storage</code></li>
</ul>
<p>The <code>table</code> viewer builds an HTML table out of the data at the given <code>source</code>
path, where the <code>header</code> field specifies the values to be shown in the first row
of the table. The table supports pagination.</p>
<p>Specify <code>'storage': 'inline'</code> to embed CSV table content string
in <code>source</code> field directly.</p>
<p><strong>Example:</strong></p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-Python" data-lang="Python"><span class="line"><span class="cl"><span class="k">def</span> <span class="nf">table_vis</span><span class="p">(</span><span class="n">mlpipeline_ui_metadata_path</span><span class="p">:</span> <span class="n">kfp</span><span class="o">.</span><span class="n">components</span><span class="o">.</span><span class="n">OutputPath</span><span class="p">()):</span>
</span></span><span class="line"><span class="cl">  <span class="kn">import</span> <span class="nn">json</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">  <span class="n">metadata</span> <span class="o">=</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">    <span class="s1">&#39;outputs&#39;</span> <span class="p">:</span> <span class="p">[{</span>
</span></span><span class="line"><span class="cl">      <span class="s1">&#39;type&#39;</span><span class="p">:</span> <span class="s1">&#39;table&#39;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">      <span class="s1">&#39;storage&#39;</span><span class="p">:</span> <span class="s1">&#39;gcs&#39;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">      <span class="s1">&#39;format&#39;</span><span class="p">:</span> <span class="s1">&#39;csv&#39;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">      <span class="s1">&#39;header&#39;</span><span class="p">:</span> <span class="p">[</span><span class="n">x</span><span class="p">[</span><span class="s1">&#39;name&#39;</span><span class="p">]</span> <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="n">schema</span><span class="p">],</span>
</span></span><span class="line"><span class="cl">      <span class="s1">&#39;source&#39;</span><span class="p">:</span> <span class="n">prediction_results</span>
</span></span><span class="line"><span class="cl">    <span class="p">}]</span>
</span></span><span class="line"><span class="cl">  <span class="p">}</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">  <span class="k">with</span> <span class="nb">open</span><span class="p">(</span><span class="n">mlpipeline_ui_metadata_path</span><span class="p">,</span> <span class="s1">&#39;w&#39;</span><span class="p">)</span> <span class="k">as</span> <span class="n">metadata_file</span><span class="p">:</span>
</span></span><span class="line"><span class="cl">    <span class="n">json</span><span class="o">.</span><span class="n">dump</span><span class="p">(</span><span class="n">metadata</span><span class="p">,</span> <span class="n">metadata_file</span><span class="p">)</span>
</span></span></code></pre></div><p><strong>Visualization on the Kubeflow Pipelines UI:</strong></p>
<p><img src="/docs/images/pipelines/v1/taxi-tip-prediction-step-output-table.png" 
alt="Table-based visualization from a pipeline component"
class="mt-3 mb-3 border border-info rounded"></p>
<h3 id="tensorboard">TensorBoard</h3>
<p><strong>Type:</strong> <code>tensorboard</code></p>
<p><strong>Required metadata Fields:</strong></p>
<ul>
<li><code>source</code></li>
</ul>
<p>The <code>tensorboard</code> viewer adds a <strong>Start Tensorboard</strong> button to the output page.</p>
<p>When viewing the output page, you can:</p>
<ul>
<li>Click <strong>Start Tensorboard</strong> to start a
<a href="https://www.tensorflow.org/guide/summaries_and_tensorboard">TensorBoard</a> Pod
in your Kubeflow cluster. The button text switches to <strong>Open Tensorboard</strong>.</li>
<li>Click <strong>Open Tensorboard</strong> to open the TensorBoard interface in a new tab,
pointing to the logdir data specified in the <code>source</code> field.</li>
<li>Click <strong>Delete Tensorboard</strong> to shutdown the Tensorboard instance.</li>
</ul>
<p><strong>Note:</strong> The Kubeflow Pipelines UI doesn&rsquo;t fully manage your TensorBoard
instances. The &ldquo;Start Tensorboard&rdquo; button is a convenience feature so that
you don&rsquo;t have to interrupt your workflow when looking at pipeline runs. You&rsquo;re
responsible for recycling or deleting the TensorBoard Pods using your Kubernetes
management tools.</p>
<p><strong>Example:</strong></p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-Python" data-lang="Python"><span class="line"><span class="cl"><span class="k">def</span> <span class="nf">tensorboard_vis</span><span class="p">(</span><span class="n">mlpipeline_ui_metadata_path</span><span class="p">:</span> <span class="n">kfp</span><span class="o">.</span><span class="n">components</span><span class="o">.</span><span class="n">OutputPath</span><span class="p">()):</span>
</span></span><span class="line"><span class="cl">  <span class="kn">import</span> <span class="nn">json</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">  <span class="n">metadata</span> <span class="o">=</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">    <span class="s1">&#39;outputs&#39;</span> <span class="p">:</span> <span class="p">[{</span>
</span></span><span class="line"><span class="cl">      <span class="s1">&#39;type&#39;</span><span class="p">:</span> <span class="s1">&#39;tensorboard&#39;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">      <span class="s1">&#39;source&#39;</span><span class="p">:</span> <span class="n">args</span><span class="o">.</span><span class="n">job_dir</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">    <span class="p">}]</span>
</span></span><span class="line"><span class="cl">  <span class="p">}</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">  <span class="k">with</span> <span class="nb">open</span><span class="p">(</span><span class="n">mlpipeline_ui_metadata_path</span><span class="p">,</span> <span class="s1">&#39;w&#39;</span><span class="p">)</span> <span class="k">as</span> <span class="n">metadata_file</span><span class="p">:</span>
</span></span><span class="line"><span class="cl">    <span class="n">json</span><span class="o">.</span><span class="n">dump</span><span class="p">(</span><span class="n">metadata</span><span class="p">,</span> <span class="n">metadata_file</span><span class="p">)</span>
</span></span></code></pre></div><p><strong>Visualization on the Kubeflow Pipelines UI:</strong></p>
<p><img src="/docs/images/taxi-tip-training-step-output-tensorboard.png" 
alt="TensorBoard option output from a pipeline component"
class="mt-3 mb-3 border border-info rounded"></p>
<h3 id="web-app">Web app</h3>
<p><strong>Type:</strong> <code>web-app</code></p>
<p><strong>Required metadata fields:</strong></p>
<ul>
<li><code>source</code></li>
</ul>
<p><strong>Optional metadata fields:</strong></p>
<ul>
<li><code>storage</code></li>
</ul>
<p>The <code>web-app</code> viewer provides flexibility for rendering custom output. You can
specify an HTML file that your component creates, and the Kubeflow Pipelines UI
renders that HTML in the output page. The HTML file must be self-contained, with
no references to other files in the filesystem. The HTML file can contain
absolute references to files on the web. Content running inside the web app is
sandboxed in an iframe and cannot communicate with the Kubeflow Pipelines UI.</p>
<p>Specify <code>'storage': 'inline'</code> to embed raw html in <code>source</code> field directly.</p>
<p><strong>Example:</strong></p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-Python" data-lang="Python"><span class="line"><span class="cl"><span class="k">def</span> <span class="nf">tensorboard_vis</span><span class="p">(</span><span class="n">mlpipeline_ui_metadata_path</span><span class="p">:</span> <span class="n">kfp</span><span class="o">.</span><span class="n">components</span><span class="o">.</span><span class="n">OutputPath</span><span class="p">()):</span>
</span></span><span class="line"><span class="cl">  <span class="kn">import</span> <span class="nn">json</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">  <span class="n">static_html_path</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">output_dir</span><span class="p">,</span> <span class="n">_OUTPUT_HTML_FILE</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">  <span class="n">file_io</span><span class="o">.</span><span class="n">write_string_to_file</span><span class="p">(</span><span class="n">static_html_path</span><span class="p">,</span> <span class="n">rendered_template</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">  <span class="n">metadata</span> <span class="o">=</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">    <span class="s1">&#39;outputs&#39;</span> <span class="p">:</span> <span class="p">[{</span>
</span></span><span class="line"><span class="cl">      <span class="s1">&#39;type&#39;</span><span class="p">:</span> <span class="s1">&#39;web-app&#39;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">      <span class="s1">&#39;storage&#39;</span><span class="p">:</span> <span class="s1">&#39;gcs&#39;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">      <span class="s1">&#39;source&#39;</span><span class="p">:</span> <span class="n">static_html_path</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">    <span class="p">},</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">      <span class="s1">&#39;type&#39;</span><span class="p">:</span> <span class="s1">&#39;web-app&#39;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">      <span class="s1">&#39;storage&#39;</span><span class="p">:</span> <span class="s1">&#39;inline&#39;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">      <span class="s1">&#39;source&#39;</span><span class="p">:</span> <span class="s1">&#39;&lt;h1&gt;Hello, World!&lt;/h1&gt;&#39;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">    <span class="p">}]</span>
</span></span><span class="line"><span class="cl">  <span class="p">}</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">  <span class="k">with</span> <span class="nb">open</span><span class="p">(</span><span class="n">mlpipeline_ui_metadata_path</span><span class="p">,</span> <span class="s1">&#39;w&#39;</span><span class="p">)</span> <span class="k">as</span> <span class="n">metadata_file</span><span class="p">:</span>
</span></span><span class="line"><span class="cl">    <span class="n">json</span><span class="o">.</span><span class="n">dump</span><span class="p">(</span><span class="n">metadata</span><span class="p">,</span> <span class="n">metadata_file</span><span class="p">)</span>
</span></span></code></pre></div><p><strong>Visualization on the Kubeflow Pipelines UI:</strong></p>
<p><img src="/docs/images/taxi-tip-analysis-step-output-webapp-popped-out.png" 
alt="Web app output from a pipeline component"
class="mt-3 mb-3 border border-info rounded"></p>
<p><a id="example-source"></a></p>
<h2 id="source-of-v1-examples">Source of v1 examples</h2>
<p>The v1 examples come from the <em>tax tip prediction</em> sample that is
pre-installed when you deploy Kubeflow.</p>
<p>You can run the sample by selecting
<strong>[Sample] ML - TFX - Taxi Tip Prediction Model Trainer</strong> from the
Kubeflow Pipelines UI. For help getting started with the UI, follow the
<a href="/docs/components/pipelines/overview/quickstart/">Kubeflow Pipelines quickstart</a>.</p>
<!--- TODO: Will replace the tfx cab with tfx oss when it is ready.-->
<p>The pipeline uses a number of prebuilt, reusable components, including:</p>
<ul>
<li>The <a href="https://github.com/kubeflow/pipelines/blob/sdk/release-1.8/components/local/confusion_matrix/src/confusion_matrix.py">Confusion Matrix
component</a>
which writes out the data for the <code>confusion_matrix</code> viewer.</li>
<li>The <a href="https://github.com/kubeflow/pipelines/blob/sdk/release-1.8/components/local/roc/src/roc.py">ROC
component</a>
which writes out the data for the <code>roc</code> viewer.</li>
<li>The <a href="https://github.com/kubeflow/pipelines/blob/sdk/release-1.8/components/kubeflow/dnntrainer/src/trainer/task.py">dnntrainer
component</a>
which writes out the data for the <code>tensorboard</code> viewer.</li>
<li>The <a href="https://github.com/kubeflow/pipelines/blob/sdk/release-1.8/components/deprecated/dataflow/tfma/component.yaml">tfma
component</a>
which writes out the data for the <code>web-app</code> viewer.</li>
</ul>
<h2 id="lightweight-python-component-notebook-example">Lightweight Python component Notebook example</h2>
<p>For a complete example of lightweigh Python component, you can refer to
<a href="https://github.com/kubeflow/pipelines/blob/sdk/release-1.8/samples/core/lightweight_component/lightweight_component.ipynb">the lightweight python component notebook example</a> to learn more about declaring output visualizations.</p>
<h2 id="yaml-component-example">YAML component example</h2>
<p>You can also configure visualization in a component.yaml file. Refer to <code>{name: MLPipeline UI Metadata}</code> output in <a href="https://github.com/kubeflow/pipelines/blob/f61048b5d2e1fb5a6a61782d570446b0ec940ff7/components/tensorflow/tensorboard/prepare_tensorboard/component.yaml#L12">Create Tensorboard Visualization component</a>.</p>
<h2 id="next-step">Next step</h2>
<p>See how to <a href="/docs/components/pipelines/metrics/pipelines-metrics/">export metrics from your
pipeline</a>.</p>

</div>



    
	
  
    
    
	
    

<div class="td-content" style="page-break-before: always">
    
	<h1 id="pg-6290e41c026254218090f8aba54b9598">3.1.5.10 - Pipeline Metrics</h1>
    <div class="lead">Export and visualize pipeline metrics</div>
	<p>This page shows you how to export metrics from a Kubeflow Pipelines component.
For details about how to build a component, see the guide to
<a href="/docs/components/pipelines/sdk/component-development/">building your own component</a>.</p>
<h2 id="overview-of-metrics">Overview of metrics</h2>
<p>Kubeflow Pipelines supports the export of scalar metrics. You can write a list
of metrics to a local file to describe the performance of the model. The
pipeline agent uploads the local file as your run-time metrics. You can view the
uploaded metrics as a visualization in the <strong>Runs</strong> page for a particular
experiment in the Kubeflow Pipelines UI.</p>
<h2 id="export-the-metrics-dictionary">Export the metrics dictionary</h2>
<p>To enable metrics, your component must have an output called <code>MLPipeline Metrics</code> and return a JSON-serialized metrics dictionary.
Otherwise the Kubeflow Pipelines UI will
not render the visualization. In other words, the <code>.outputs.artifacts</code> setting
for the generated pipeline template should show:
<code>- {name: mlpipeline-metrics, path: /tmp/outputs/mlpipeline_metrics/data}</code>.
(The file path does not matter.)</p>
<p>An example Lightweight python component that outputs metrics dictionary by writing it to an output file:</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-Python" data-lang="Python"><span class="line"><span class="cl"><span class="kn">from</span> <span class="nn">kfp.components</span> <span class="kn">import</span> <span class="n">InputPath</span><span class="p">,</span> <span class="n">OutputPath</span><span class="p">,</span> <span class="n">create_component_from_func</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="k">def</span> <span class="nf">produce_metrics</span><span class="p">(</span>
</span></span><span class="line"><span class="cl">  <span class="c1"># Note when the `create_component_from_func` method converts the function to a component, the function parameter &#34;mlpipeline_metrics_path&#34; becomes an output with name &#34;mlpipeline_metrics&#34; which is the correct name for metrics output.</span>
</span></span><span class="line"><span class="cl">  <span class="n">mlpipeline_metrics_path</span><span class="p">:</span> <span class="n">OutputPath</span><span class="p">(</span><span class="s1">&#39;Metrics&#39;</span><span class="p">),</span>
</span></span><span class="line"><span class="cl"><span class="p">):</span>
</span></span><span class="line"><span class="cl">  <span class="kn">import</span> <span class="nn">json</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">  <span class="n">accuracy</span> <span class="o">=</span> <span class="mf">0.9</span>
</span></span><span class="line"><span class="cl">  <span class="n">metrics</span> <span class="o">=</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">    <span class="s1">&#39;metrics&#39;</span><span class="p">:</span> <span class="p">[{</span>
</span></span><span class="line"><span class="cl">      <span class="s1">&#39;name&#39;</span><span class="p">:</span> <span class="s1">&#39;accuracy-score&#39;</span><span class="p">,</span> <span class="c1"># The name of the metric. Visualized as the column name in the runs table.</span>
</span></span><span class="line"><span class="cl">      <span class="s1">&#39;numberValue&#39;</span><span class="p">:</span>  <span class="n">accuracy</span><span class="p">,</span> <span class="c1"># The value of the metric. Must be a numeric value.</span>
</span></span><span class="line"><span class="cl">      <span class="s1">&#39;format&#39;</span><span class="p">:</span> <span class="s2">&#34;PERCENTAGE&#34;</span><span class="p">,</span>   <span class="c1"># The optional format of the metric. Supported values are &#34;RAW&#34; (displayed in raw format) and &#34;PERCENTAGE&#34; (displayed in percentage format).</span>
</span></span><span class="line"><span class="cl">    <span class="p">}]</span>
</span></span><span class="line"><span class="cl">  <span class="p">}</span>
</span></span><span class="line"><span class="cl">  <span class="k">with</span> <span class="nb">open</span><span class="p">(</span><span class="n">mlpipeline_metrics_path</span><span class="p">,</span> <span class="s1">&#39;w&#39;</span><span class="p">)</span> <span class="k">as</span> <span class="n">f</span><span class="p">:</span>
</span></span><span class="line"><span class="cl">    <span class="n">json</span><span class="o">.</span><span class="n">dump</span><span class="p">(</span><span class="n">metrics</span><span class="p">,</span> <span class="n">f</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="n">produce_metrics_op</span> <span class="o">=</span> <span class="n">create_component_from_func</span><span class="p">(</span>
</span></span><span class="line"><span class="cl">    <span class="n">produce_metrics</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">    <span class="n">base_image</span><span class="o">=</span><span class="s1">&#39;python:3.7&#39;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">    <span class="n">packages_to_install</span><span class="o">=</span><span class="p">[],</span>
</span></span><span class="line"><span class="cl">    <span class="n">output_component_file</span><span class="o">=</span><span class="s1">&#39;component.yaml&#39;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl"><span class="p">)</span>
</span></span></code></pre></div><p>Here&rsquo;s an example of a lightweight Python component that outputs a metrics dictionary by returning it from the function:</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-Python" data-lang="Python"><span class="line"><span class="cl"><span class="kn">from</span> <span class="nn">typing</span> <span class="kn">import</span> <span class="n">NamedTuple</span>
</span></span><span class="line"><span class="cl"><span class="kn">from</span> <span class="nn">kfp.components</span> <span class="kn">import</span> <span class="n">InputPath</span><span class="p">,</span> <span class="n">OutputPath</span><span class="p">,</span> <span class="n">create_component_from_func</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="k">def</span> <span class="nf">produce_metrics</span><span class="p">()</span> <span class="o">-&gt;</span> <span class="n">NamedTuple</span><span class="p">(</span><span class="s1">&#39;Outputs&#39;</span><span class="p">,</span> <span class="p">[</span>
</span></span><span class="line"><span class="cl">  <span class="p">(</span><span class="s1">&#39;mlpipeline_metrics&#39;</span><span class="p">,</span> <span class="s1">&#39;Metrics&#39;</span><span class="p">),</span>
</span></span><span class="line"><span class="cl"><span class="p">]):</span>
</span></span><span class="line"><span class="cl">  <span class="kn">import</span> <span class="nn">json</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">  <span class="n">accuracy</span> <span class="o">=</span> <span class="mf">0.9</span>
</span></span><span class="line"><span class="cl">  <span class="n">metrics</span> <span class="o">=</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">    <span class="s1">&#39;metrics&#39;</span><span class="p">:</span> <span class="p">[{</span>
</span></span><span class="line"><span class="cl">      <span class="s1">&#39;name&#39;</span><span class="p">:</span> <span class="s1">&#39;accuracy-score&#39;</span><span class="p">,</span> <span class="c1"># The name of the metric. Visualized as the column name in the runs table.</span>
</span></span><span class="line"><span class="cl">      <span class="s1">&#39;numberValue&#39;</span><span class="p">:</span>  <span class="n">accuracy</span><span class="p">,</span> <span class="c1"># The value of the metric. Must be a numeric value.</span>
</span></span><span class="line"><span class="cl">      <span class="s1">&#39;format&#39;</span><span class="p">:</span> <span class="s2">&#34;PERCENTAGE&#34;</span><span class="p">,</span>   <span class="c1"># The optional format of the metric. Supported values are &#34;RAW&#34; (displayed in raw format) and &#34;PERCENTAGE&#34; (displayed in percentage format).</span>
</span></span><span class="line"><span class="cl">    <span class="p">}]</span>
</span></span><span class="line"><span class="cl">  <span class="p">}</span>
</span></span><span class="line"><span class="cl">  <span class="k">return</span> <span class="p">[</span><span class="n">json</span><span class="o">.</span><span class="n">dumps</span><span class="p">(</span><span class="n">metrics</span><span class="p">)]</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="n">produce_metrics_op</span> <span class="o">=</span> <span class="n">create_component_from_func</span><span class="p">(</span>
</span></span><span class="line"><span class="cl">    <span class="n">produce_metrics</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">    <span class="n">base_image</span><span class="o">=</span><span class="s1">&#39;python:3.7&#39;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">    <span class="n">packages_to_install</span><span class="o">=</span><span class="p">[],</span>
</span></span><span class="line"><span class="cl">    <span class="n">output_component_file</span><span class="o">=</span><span class="s1">&#39;component.yaml&#39;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl"><span class="p">)</span>
</span></span></code></pre></div><p>An example script-based <code>component.yaml</code> component:</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-yaml" data-lang="yaml"><span class="line"><span class="cl"><span class="nt">name</span><span class="p">:</span><span class="w"> </span><span class="l">Produce metrics</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="nt">outputs</span><span class="p">:</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span>- {<span class="nt">name: MLPipeline Metrics, type</span><span class="p">:</span><span class="w"> </span><span class="l">Metrics}</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="nt">implementation</span><span class="p">:</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">  </span><span class="nt">container</span><span class="p">:</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="nt">image</span><span class="p">:</span><span class="w"> </span><span class="l">alpine</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="nt">command</span><span class="p">:</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span>- <span class="l">sh</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span>- -<span class="l">exc</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span>- <span class="p">|</span><span class="sd">
</span></span></span><span class="line"><span class="cl"><span class="sd">      output_metrics_path=$0
</span></span></span><span class="line"><span class="cl"><span class="sd">      mkdir -p &#34;$(dirname &#34;$output_metrics_path&#34;)&#34;
</span></span></span><span class="line"><span class="cl"><span class="sd">      echo &#39;{
</span></span></span><span class="line"><span class="cl"><span class="sd">        &#34;metrics&#34;: [{
</span></span></span><span class="line"><span class="cl"><span class="sd">          &#34;name&#34;: &#34;accuracy-score&#34;,
</span></span></span><span class="line"><span class="cl"><span class="sd">          &#34;numberValue&#34;: 0.8,
</span></span></span><span class="line"><span class="cl"><span class="sd">          &#34;format&#34;: &#34;PERCENTAGE&#34;
</span></span></span><span class="line"><span class="cl"><span class="sd">        }]
</span></span></span><span class="line"><span class="cl"><span class="sd">      }&#39; &gt; &#34;$output_metrics_path&#34;</span><span class="w">      
</span></span></span><span class="line"><span class="cl"><span class="w">    </span>- {<span class="nt">outputPath</span><span class="p">:</span><span class="w"> </span><span class="l">MLPipeline Metrics}</span><span class="w">
</span></span></span></code></pre></div><p>Refer to the <a href="https://github.com/kubeflow/pipelines/blob/sdk/release-1.8/components/local/confusion_matrix/src/confusion_matrix.py">full example</a> of a component that generates a confusion matrix data from prediction results.</p>
<ul>
<li>
<p>The output name must be <code>MLPipeline Metrics</code> or <code>MLPipeline_Metrics</code> (case does not matter).</p>
</li>
<li>
<p>The <code>name</code> of each metric must match the following pattern: <code>^[a-zA-Z]([-_a-zA-Z0-9]{0,62}[a-zA-Z0-9])?$</code>.</p>
<p>For Kubeflow Pipelines version 0.5.1 or earlier, name must match the following pattern <code>^[a-z]([-a-z0-9]{0,62}[a-z0-9])?$</code></p>
</li>
<li>
<p><code>numberValue</code> must be a numeric value.</p>
</li>
<li>
<p><code>format</code> can only be <code>PERCENTAGE</code>, <code>RAW</code>, or not set.</p>
</li>
</ul>
<h2 id="view-the-metrics">View the metrics</h2>
<p>To see a visualization of the metrics:</p>
<ol>
<li>Open the <strong>Experiments</strong> page in the Kubeflow Pipelines UI.</li>
<li>Click one of your experiments. The <strong>Runs</strong> page opens showing the top two
metrics, where <em>top</em> is determined by prevalence (that is, the metrics with
the highest count) and then by metric name.
The metrics appear as columns for each run.</li>
</ol>
<p>The following example shows the <strong>accuracy-score</strong> and
<strong>roc-auc-score</strong> metrics for two runs within an experiment:</p>
<p><img src="/docs/images/taxi-tip-run-scores.png" 
alt="Metrics from a pipeline run"
class="mt-3 mb-3 border border-info rounded"></p>
<h2 id="next-step">Next step</h2>
<p>Visualize the output of your component by <a href="/docs/components/pipelines/sdk/output-viewer/">writing out metadata for an output
viewer</a>.</p>

</div>



    
	
  
    
    
	
    

<div class="td-content" style="page-break-before: always">
    
	<h1 id="pg-4539e2425322e75e85f28e46fbd56edf">3.1.5.11 - DSL Static Type Checking</h1>
    <div class="lead">Statically check the component I/O types</div>
	<p>This page describes how to integrate the type information in the pipeline and utilize the
static type checking for fast development iterations.</p>
<h2 id="motivation">Motivation</h2>
<p>A pipeline is a workflow consisting of <a href="/docs/components/pipelines/sdk/build-component#overview-of-pipelines-and-components">components</a> and each
component contains inputs and outputs. The DSL compiler supports static type checking to ensure the type consistency among the component
I/Os within the same pipeline. Static type checking helps you to identify component I/O inconsistencies without running the pipeline.
It also shortens the development cycles by catching the errors early.
This feature is especially useful in two cases:</p>
<ul>
<li>When the pipeline is huge and manually checking the types is infeasible;</li>
<li>When some components are shared ones and the type information is not immediately available.</li>
</ul>
<h2 id="type-system">Type system</h2>
<p>In Kubeflow pipeline, a type is defined as a type name with an <a href="https://github.com/OAI/OpenAPI-Specification/blob/master/versions/3.0.0.md">OpenAPI Schema</a>
property, which defines the input parameter schema. <strong>Warning</strong>: the pipeline system
currently does not check the input value against the schema when you submit a pipeline run. However, this feature will come in the near
future.</p>
<p>There is a set of <a href="https://github.com/kubeflow/pipelines/blob/sdk/release-1.8/sdk/python/kfp/dsl/types.py">core types</a> defined in the
Pipelines SDK and you can use these core types or define your custom types.</p>
<p>In the component YAML, types are specified as a string or a dictionary with the OpenAPI Schema, as illustrated below.
&ldquo;<em>component a</em>&rdquo; expects an input with Integer type and emits three outputs with the type GCSPath, customized_type and GCRPath.
Among these types, Integer, GCSPath, and GCRPath are core types that are predefined in the SDK while customized_type is a user-defined
type.</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-yaml" data-lang="yaml"><span class="line"><span class="cl"><span class="nt">name</span><span class="p">:</span><span class="w"> </span><span class="l">component a</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="nt">description</span><span class="p">:</span><span class="w"> </span><span class="l">component desc</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="nt">inputs</span><span class="p">:</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">  </span>- {<span class="nt">name: field_l, type</span><span class="p">:</span><span class="w"> </span><span class="l">Integer}</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="nt">outputs</span><span class="p">:</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">  </span>- {<span class="nt">name: field_m, type</span><span class="p">:</span><span class="w"> </span>{<span class="nt">GCSPath</span><span class="p">:</span><span class="w"> </span>{<span class="nt">openapi_schema_validator</span><span class="p">:</span><span class="w"> </span>{<span class="nt">type: string, pattern</span><span class="p">:</span><span class="w"> </span><span class="s2">&#34;^gs://.*$&#34;</span><span class="w"> </span>}<span class="w"> </span>}}}<span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">  </span>- {<span class="nt">name: field_n, type</span><span class="p">:</span><span class="w"> </span><span class="l">customized_type}</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">  </span>- {<span class="nt">name: field_o, type</span><span class="p">:</span><span class="w"> </span><span class="l">GCRPath} </span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="nt">implementation</span><span class="p">:</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">  </span><span class="nt">container</span><span class="p">:</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="nt">image</span><span class="p">:</span><span class="w"> </span><span class="l">gcr.io/ml-pipeline/component-a</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="nt">command</span><span class="p">:</span><span class="w"> </span><span class="p">[</span><span class="l">python3, /pipelines/component/src/train.py]</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="nt">args</span><span class="p">:</span><span class="w"> </span><span class="p">[</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">      </span>--<span class="l">field-l, {inputValue: field_l},</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="p">]</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="nt">fileOutputs</span><span class="p">:</span><span class="w"> 
</span></span></span><span class="line"><span class="cl"><span class="w">      </span><span class="nt">field_m</span><span class="p">:</span><span class="w"> </span><span class="l">/schema.txt</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">      </span><span class="nt">field_n</span><span class="p">:</span><span class="w"> </span><span class="l">/feature.txt</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">      </span><span class="nt">field_o</span><span class="p">:</span><span class="w"> </span><span class="l">/output.txt</span><span class="w">
</span></span></span></code></pre></div><p>Similarly, when you write a component with the decorator, you can annotate I/O with types in the function signature, as shown below.</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-python" data-lang="python"><span class="line"><span class="cl"><span class="kn">from</span> <span class="nn">kfp.dsl</span> <span class="kn">import</span> <span class="n">component</span>
</span></span><span class="line"><span class="cl"><span class="kn">from</span> <span class="nn">kfp.dsl.types</span> <span class="kn">import</span> <span class="n">Integer</span><span class="p">,</span> <span class="n">GCRPath</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="nd">@component</span>
</span></span><span class="line"><span class="cl"><span class="k">def</span> <span class="nf">task_factory_a</span><span class="p">(</span><span class="n">field_l</span><span class="p">:</span> <span class="n">Integer</span><span class="p">())</span> <span class="o">-&gt;</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">    <span class="s1">&#39;field_m&#39;</span><span class="p">:</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">        <span class="s1">&#39;GCSPath&#39;</span><span class="p">:</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">            <span class="s1">&#39;openapi_schema_validator&#39;</span><span class="p">:</span>
</span></span><span class="line"><span class="cl">                <span class="s1">&#39;{&#34;type&#34;: &#34;string&#34;, &#34;pattern&#34;: &#34;^gs://.*$&#34;}&#39;</span>
</span></span><span class="line"><span class="cl">        <span class="p">}</span>
</span></span><span class="line"><span class="cl">    <span class="p">},</span>
</span></span><span class="line"><span class="cl">    <span class="s1">&#39;field_n&#39;</span><span class="p">:</span> <span class="s1">&#39;customized_type&#39;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">    <span class="s1">&#39;field_o&#39;</span><span class="p">:</span> <span class="n">GCRPath</span><span class="p">()</span>
</span></span><span class="line"><span class="cl"><span class="p">}:</span>
</span></span><span class="line"><span class="cl">  <span class="k">return</span> <span class="n">ContainerOp</span><span class="p">(</span>
</span></span><span class="line"><span class="cl">      <span class="n">name</span><span class="o">=</span><span class="s1">&#39;operator a&#39;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">      <span class="n">image</span><span class="o">=</span><span class="s1">&#39;gcr.io/ml-pipeline/component-a&#39;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">      <span class="n">command</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;python3&#39;</span><span class="p">,</span> <span class="s1">&#39;/pipelines/component/src/train.py&#39;</span><span class="p">],</span>
</span></span><span class="line"><span class="cl">      <span class="n">arguments</span><span class="o">=</span><span class="p">[</span>
</span></span><span class="line"><span class="cl">          <span class="s1">&#39;--field-l&#39;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">          <span class="n">field_l</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">      <span class="p">],</span>
</span></span><span class="line"><span class="cl">      <span class="n">file_outputs</span><span class="o">=</span><span class="p">{</span>
</span></span><span class="line"><span class="cl">          <span class="s1">&#39;field_m&#39;</span><span class="p">:</span> <span class="s1">&#39;/schema.txt&#39;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">          <span class="s1">&#39;field_n&#39;</span><span class="p">:</span> <span class="s1">&#39;/feature.txt&#39;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">          <span class="s1">&#39;field_o&#39;</span><span class="p">:</span> <span class="s1">&#39;/output.txt&#39;</span>
</span></span><span class="line"><span class="cl">      <span class="p">})</span>
</span></span></code></pre></div><p>You can also annotate pipeline inputs with types and the input are checked against the component I/O types as well. For example,</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-python" data-lang="python"><span class="line"><span class="cl"><span class="nd">@component</span>
</span></span><span class="line"><span class="cl"><span class="k">def</span> <span class="nf">task_factory_a</span><span class="p">(</span>
</span></span><span class="line"><span class="cl">    <span class="n">field_m</span><span class="p">:</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">        <span class="s1">&#39;GCSPath&#39;</span><span class="p">:</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">            <span class="s1">&#39;openapi_schema_validator&#39;</span><span class="p">:</span>
</span></span><span class="line"><span class="cl">                <span class="s1">&#39;{&#34;type&#34;: &#34;string&#34;, &#34;pattern&#34;: &#34;^gs://.*$&#34;}&#39;</span>
</span></span><span class="line"><span class="cl">        <span class="p">}</span>
</span></span><span class="line"><span class="cl">    <span class="p">},</span> <span class="n">field_o</span><span class="p">:</span> <span class="s1">&#39;Integer&#39;</span><span class="p">):</span>
</span></span><span class="line"><span class="cl">  <span class="k">return</span> <span class="n">ContainerOp</span><span class="p">(</span>
</span></span><span class="line"><span class="cl">      <span class="n">name</span><span class="o">=</span><span class="s1">&#39;operator a&#39;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">      <span class="n">image</span><span class="o">=</span><span class="s1">&#39;gcr.io/ml-pipeline/component-a&#39;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">      <span class="n">arguments</span><span class="o">=</span><span class="p">[</span>
</span></span><span class="line"><span class="cl">          <span class="s1">&#39;--field-l&#39;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">          <span class="n">field_m</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">          <span class="s1">&#39;--field-o&#39;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">          <span class="n">field_o</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">      <span class="p">],</span>
</span></span><span class="line"><span class="cl">  <span class="p">)</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="c1"># Pipeline input types are also checked against the component I/O types.</span>
</span></span><span class="line"><span class="cl"><span class="nd">@dsl</span><span class="o">.</span><span class="n">pipeline</span><span class="p">(</span><span class="n">name</span><span class="o">=</span><span class="s1">&#39;type_check&#39;</span><span class="p">,</span> <span class="n">description</span><span class="o">=</span><span class="s1">&#39;&#39;</span><span class="p">)</span>
</span></span><span class="line"><span class="cl"><span class="k">def</span> <span class="nf">pipeline</span><span class="p">(</span>
</span></span><span class="line"><span class="cl">    <span class="n">a</span><span class="p">:</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">        <span class="s1">&#39;GCSPath&#39;</span><span class="p">:</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">            <span class="s1">&#39;openapi_schema_validator&#39;</span><span class="p">:</span>
</span></span><span class="line"><span class="cl">                <span class="s1">&#39;{&#34;type&#34;: &#34;string&#34;, &#34;pattern&#34;: &#34;^gs://.*$&#34;}&#39;</span>
</span></span><span class="line"><span class="cl">        <span class="p">}</span>
</span></span><span class="line"><span class="cl">    <span class="p">}</span> <span class="o">=</span> <span class="s1">&#39;good&#39;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">    <span class="n">b</span><span class="p">:</span> <span class="n">Integer</span><span class="p">()</span> <span class="o">=</span> <span class="mi">12</span><span class="p">):</span>
</span></span><span class="line"><span class="cl">  <span class="n">task_factory_a</span><span class="p">(</span><span class="n">field_m</span><span class="o">=</span><span class="n">a</span><span class="p">,</span> <span class="n">field_o</span><span class="o">=</span><span class="n">b</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="k">try</span><span class="p">:</span>
</span></span><span class="line"><span class="cl">  <span class="n">compiler</span><span class="o">.</span><span class="n">Compiler</span><span class="p">()</span><span class="o">.</span><span class="n">compile</span><span class="p">(</span><span class="n">pipeline</span><span class="p">,</span> <span class="s1">&#39;pipeline.tar.gz&#39;</span><span class="p">,</span> <span class="n">type_check</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
</span></span><span class="line"><span class="cl"><span class="k">except</span> <span class="n">InconsistentTypeException</span> <span class="k">as</span> <span class="n">e</span><span class="p">:</span>
</span></span><span class="line"><span class="cl">  <span class="nb">print</span><span class="p">(</span><span class="n">e</span><span class="p">)</span>
</span></span></code></pre></div><h2 id="how-does-the-type-checking-work">How does the type checking work?</h2>
<p>The basic checking criterion is the equality checking. In other words, type checking passes only when the type name strings are equal
and the corresponding OpenAPI Schema properties are equal. Examples of type checking failure are:</p>
<ul>
<li>&ldquo;GCSPath&rdquo; vs. &ldquo;GCRPath&rdquo;</li>
<li>&ldquo;Integer&rdquo; vs. &ldquo;Float&rdquo;</li>
<li>{&lsquo;GCSPath&rsquo;: {&lsquo;openapi_schema_validator&rsquo;: &lsquo;{&ldquo;type&rdquo;: &ldquo;string&rdquo;, &ldquo;pattern&rdquo;: &ldquo;^gs://.<em>$&rdquo;}&rsquo;}} vs.<br>
{&lsquo;GCSPath&rsquo;: {&lsquo;openapi_schema_validator&rsquo;: &lsquo;{&ldquo;type&rdquo;: &ldquo;string&rdquo;, &ldquo;pattern&rdquo;: &ldquo;^gcs://.</em>$&rdquo;}&rsquo;}}</li>
</ul>
<p>If inconsistent types are detected, it throws an <a href="https://github.com/kubeflow/pipelines/blob/sdk/release-1.8/sdk/python/kfp/dsl/types.py">InconsistentTypeException</a>.</p>
<h2 id="type-checking-configuration">Type checking configuration</h2>
<p>Type checking is enabled by default and it can be disabled in two ways:</p>
<p>If you compile the pipeline programmably:</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-python" data-lang="python"><span class="line"><span class="cl"><span class="n">compiler</span><span class="o">.</span><span class="n">Compiler</span><span class="p">()</span><span class="o">.</span><span class="n">compile</span><span class="p">(</span><span class="n">pipeline_a</span><span class="p">,</span> <span class="s1">&#39;pipeline_a.tar.gz&#39;</span><span class="p">,</span> <span class="n">type_check</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
</span></span></code></pre></div><p>If you compile the pipeline using the dsl-compiler tool:</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash"><span class="line"><span class="cl">dsl-compiler --py pipeline.py --output pipeline.zip --disable-type-check
</span></span></code></pre></div><h3 id="fine-grained-configuration">Fine-grained configuration</h3>
<p>Sometimes, you might want to enable the type checking but disable certain arguments. For example,
when the upstream component generates an output with type &ldquo;<em>Float</em>&rdquo; and the downstream can ingest either
&ldquo;<em>Float</em>&rdquo; or &ldquo;<em>Integer</em>&rdquo;, it might fail if you define the type as &ldquo;<em>Float_or_Integer</em>&rdquo;.
Disabling the type checking per-argument is also supported as shown below.</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-python" data-lang="python"><span class="line"><span class="cl"><span class="nd">@dsl</span><span class="o">.</span><span class="n">pipeline</span><span class="p">(</span><span class="n">name</span><span class="o">=</span><span class="s1">&#39;type_check_a&#39;</span><span class="p">,</span> <span class="n">description</span><span class="o">=</span><span class="s1">&#39;&#39;</span><span class="p">)</span>
</span></span><span class="line"><span class="cl"><span class="k">def</span> <span class="nf">pipeline</span><span class="p">():</span>
</span></span><span class="line"><span class="cl">  <span class="n">a</span> <span class="o">=</span> <span class="n">task_factory_a</span><span class="p">(</span><span class="n">field_l</span><span class="o">=</span><span class="mi">12</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">  <span class="c1"># For each of the arguments, you can also ignore the types by calling</span>
</span></span><span class="line"><span class="cl">  <span class="c1"># ignore_type function.</span>
</span></span><span class="line"><span class="cl">  <span class="n">b</span> <span class="o">=</span> <span class="n">task_factory_b</span><span class="p">(</span>
</span></span><span class="line"><span class="cl">      <span class="n">field_x</span><span class="o">=</span><span class="n">a</span><span class="o">.</span><span class="n">outputs</span><span class="p">[</span><span class="s1">&#39;field_n&#39;</span><span class="p">],</span>
</span></span><span class="line"><span class="cl">      <span class="n">field_y</span><span class="o">=</span><span class="n">a</span><span class="o">.</span><span class="n">outputs</span><span class="p">[</span><span class="s1">&#39;field_o&#39;</span><span class="p">],</span>
</span></span><span class="line"><span class="cl">      <span class="n">field_z</span><span class="o">=</span><span class="n">a</span><span class="o">.</span><span class="n">outputs</span><span class="p">[</span><span class="s1">&#39;field_m&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">ignore_type</span><span class="p">())</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="n">compiler</span><span class="o">.</span><span class="n">Compiler</span><span class="p">()</span><span class="o">.</span><span class="n">compile</span><span class="p">(</span><span class="n">pipeline</span><span class="p">,</span> <span class="s1">&#39;pipeline.tar.gz&#39;</span><span class="p">,</span> <span class="n">type_check</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
</span></span></code></pre></div><h3 id="missing-types">Missing types</h3>
<p>DSL compiler passes the type checking if either of the upstream or the downstream components lack the type information for some parameters.
The effects are the same as that of ignoring the type information. However,
type checking would still fail if some I/Os lack the type information and some I/O types are incompatible.</p>
<h2 id="next-steps">Next steps</h2>
<p>Learn how to define a KubeFlow pipeline with Python DSL and compile the
pipeline with type checking: a
<a href="https://github.com/kubeflow/pipelines/blob/sdk/release-1.8/samples/core/dsl_static_type_checking/dsl_static_type_checking.ipynb">Jupyter notebook demo</a>.</p>

</div>



    
	
  
    
    
	
    

<div class="td-content" style="page-break-before: always">
    
	<h1 id="pg-db2b3d927ec2c0b7fed0512c94bc61ae">3.1.5.12 - DSL Recursion</h1>
    <div class="lead">Author a recursive function in DSL</div>
	

<div class="alert alert-warning" role="alert">
<h4 class="alert-heading">Out of date</h4>

    This guide contains outdated information pertaining to Kubeflow 1.0. This guide
needs to be updated for Kubeflow 1.1.

</div>

<p>This page describes how to write recursive functions in the domain specific language (DSL) provided by the Kubeflow Pipelines SDK.</p>
<h2 id="motivation">Motivation</h2>
<p>Recursion is a feature that is supported by almost all languages to express complex semantics in a succinct way.
In machine learning workflows, recursions are especially important to enable features such as multiple rounds of training,
iterative model analysis, and hypertuning. The recursion support also covers the loop feature since it enables the same code
block to be executed and exited based on dynamic conditions.</p>
<h2 id="how-to-write-a-recursive-function">How to write a recursive function</h2>
<h3 id="decorator">Decorator</h3>
<p>Decorate the recursive function with <a href="https://github.com/kubeflow/pipelines/blob/sdk/release-1.8/sdk/python/kfp/dsl/_component.py">kfp.dsl.graph_component</a>
as illustrated below. The decorator does not require any arguments.</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-python" data-lang="python"><span class="line"><span class="cl"><span class="kn">import</span> <span class="nn">kfp.dsl</span> <span class="k">as</span> <span class="nn">dsl</span>
</span></span><span class="line"><span class="cl"><span class="nd">@dsl</span><span class="o">.</span><span class="n">graph_component</span>
</span></span><span class="line"><span class="cl"><span class="k">def</span> <span class="nf">graph_component_a</span><span class="p">(</span><span class="n">input_x</span><span class="p">):</span>
</span></span><span class="line"><span class="cl">  <span class="k">with</span> <span class="n">dsl</span><span class="o">.</span><span class="n">Condition</span><span class="p">(</span><span class="n">input_x</span> <span class="o">==</span> <span class="s1">&#39;value_x&#39;</span><span class="p">):</span>
</span></span><span class="line"><span class="cl">    <span class="n">op_a</span> <span class="o">=</span> <span class="n">task_factory_a</span><span class="p">(</span><span class="n">input_x</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">    <span class="n">op_b</span> <span class="o">=</span> <span class="n">task_factory_b</span><span class="p">()</span><span class="o">.</span><span class="n">after</span><span class="p">(</span><span class="n">op_a</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">    <span class="n">graph_component_a</span><span class="p">(</span><span class="n">op_b</span><span class="o">.</span><span class="n">output</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">    
</span></span><span class="line"><span class="cl"><span class="nd">@dsl</span><span class="o">.</span><span class="n">pipeline</span><span class="p">(</span>
</span></span><span class="line"><span class="cl">  <span class="n">name</span><span class="o">=</span><span class="s1">&#39;pipeline&#39;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">  <span class="n">description</span><span class="o">=</span><span class="s1">&#39;shows how to use the recursion.&#39;</span>
</span></span><span class="line"><span class="cl"><span class="p">)</span>
</span></span><span class="line"><span class="cl"><span class="k">def</span> <span class="nf">pipeline</span><span class="p">():</span>
</span></span><span class="line"><span class="cl">  <span class="n">op_a</span> <span class="o">=</span> <span class="n">task_factory_a</span><span class="p">()</span>
</span></span><span class="line"><span class="cl">  <span class="n">op_b</span> <span class="o">=</span> <span class="n">task_factory_b</span><span class="p">()</span>
</span></span><span class="line"><span class="cl">  <span class="n">graph_op_a</span> <span class="o">=</span> <span class="n">graph_component_a</span><span class="p">(</span><span class="n">op_a</span><span class="o">.</span><span class="n">output</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">  <span class="n">graph_op_a</span><span class="o">.</span><span class="n">after</span><span class="p">(</span><span class="n">op_b</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">  <span class="n">task_factory_c</span><span class="p">(</span><span class="n">op_a</span><span class="o">.</span><span class="n">output</span><span class="p">)</span><span class="o">.</span><span class="n">after</span><span class="p">(</span><span class="n">graph_op_a</span><span class="p">)</span>
</span></span></code></pre></div><h3 id="function-signature">Function signature</h3>
<p>Define the function signature as a standard Python function. The input parameters are <a href="https://github.com/kubeflow/pipelines/blob/sdk/release-1.8/sdk/python/kfp/dsl/_pipeline_param.py">PipelineParams</a>.</p>
<h3 id="function-body">Function body</h3>
<p>Similar to the pipeline function body, you can instantiate components, create <a href="https://github.com/kubeflow/pipelines/blob/f8b0f5bf0cc0b5aceb8aedfd21e93156e363ea48/sdk/python/kfp/dsl/_ops_group.py#L110">conditions</a>,
use the input parameters from the function signature, and specify dependencies explicitly among components.
In the example above, one condition is created inside the recursive function and
two components <em>op_a</em> and <em>op_b</em> are created inside the condition.</p>
<h3 id="call-the-recursive-function-in-the-pipeline-function">Call the recursive function in the pipeline function</h3>
<p>You can pass pipeline/component output to the recursive function and specify the dependencies explicitly with <em>after()</em> function, similar to
the <a href="https://github.com/kubeflow/pipelines/blob/sdk/release-1.8/sdk/python/kfp/dsl/_container_op.py">ContainerOp</a>. In the example above, the output of <em>op_a</em>
defined in the pipeline is passed to the recursive function and the <em>task_factory_c</em> component is specified to depend on the <em>graph_op_a</em>.
The recursive function can also be explicitly specified to depend on the ContainerOps. For example, <em>graph_op_a</em> depends on <em>op_b</em> in the pipeline.</p>
<h3 id="more-examples">More examples</h3>
<p>Here is another example where the recursive function call is at the end of the function body, similar to <a href="https://en.wikipedia.org/wiki/Do_while_loop">do-while</a> loops.</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-python" data-lang="python"><span class="line"><span class="cl"><span class="kn">import</span> <span class="nn">kfp.dsl</span> <span class="k">as</span> <span class="nn">dsl</span>
</span></span><span class="line"><span class="cl"><span class="nd">@dsl</span><span class="o">.</span><span class="n">graph_component</span>
</span></span><span class="line"><span class="cl"><span class="k">def</span> <span class="nf">graph_component_a</span><span class="p">(</span><span class="n">input_x</span><span class="p">):</span>
</span></span><span class="line"><span class="cl">  <span class="n">op_a</span> <span class="o">=</span> <span class="n">task_factory_a</span><span class="p">(</span><span class="n">input_x</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">  <span class="n">op_b</span> <span class="o">=</span> <span class="n">task_factory_b</span><span class="p">()</span><span class="o">.</span><span class="n">after</span><span class="p">(</span><span class="n">op_a</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">  <span class="k">with</span> <span class="n">dsl</span><span class="o">.</span><span class="n">Condition</span><span class="p">(</span><span class="n">op_b</span><span class="o">.</span><span class="n">output</span> <span class="o">==</span> <span class="s1">&#39;value_x&#39;</span><span class="p">):</span>
</span></span><span class="line"><span class="cl">    <span class="n">graph_component_a</span><span class="p">(</span><span class="n">op_b</span><span class="o">.</span><span class="n">output</span><span class="p">)</span>
</span></span><span class="line"><span class="cl"> 
</span></span><span class="line"><span class="cl"><span class="nd">@dsl</span><span class="o">.</span><span class="n">pipeline</span><span class="p">(</span>
</span></span><span class="line"><span class="cl">  <span class="n">name</span><span class="o">=</span><span class="s1">&#39;pipeline&#39;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">  <span class="n">description</span><span class="o">=</span><span class="s1">&#39;shows how to use the recursion.&#39;</span>
</span></span><span class="line"><span class="cl"><span class="p">)</span>
</span></span><span class="line"><span class="cl"><span class="k">def</span> <span class="nf">pipeline</span><span class="p">():</span>
</span></span><span class="line"><span class="cl">  <span class="n">op_a</span> <span class="o">=</span> <span class="n">task_factory_a</span><span class="p">()</span>
</span></span><span class="line"><span class="cl">  <span class="n">op_b</span> <span class="o">=</span> <span class="n">task_factory_b</span><span class="p">()</span>
</span></span><span class="line"><span class="cl">  <span class="n">graph_op_a</span> <span class="o">=</span> <span class="n">graph_component_a</span><span class="p">(</span><span class="n">op_a</span><span class="o">.</span><span class="n">output</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">  <span class="n">graph_op_a</span><span class="o">.</span><span class="n">after</span><span class="p">(</span><span class="n">op_b</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">  <span class="n">task_factory_c</span><span class="p">(</span><span class="n">op_a</span><span class="o">.</span><span class="n">output</span><span class="p">)</span><span class="o">.</span><span class="n">after</span><span class="p">(</span><span class="n">graph_op_a</span><span class="p">)</span>
</span></span></code></pre></div><h2 id="limitations">Limitations</h2>
<ul>
<li><a href="/docs/components/pipelines/sdk/static-type-checking">Type checking</a> does not work for the recursive functions. In other words, The type information that is annotated to the recursive
function signature will not be checked.</li>
<li>Since the output of the recursive functions cannot be dynamically resolved, the downstream ContainerOps cannot
access the output from the recursive functions.</li>
<li>A known <a href="https://github.com/kubeflow/pipelines/issues/1065">issue</a> is that the recursion fails to work when there are
multiple recursive function calls in the function body.</li>
</ul>
<h2 id="next-steps">Next steps</h2>
<ul>
<li>See <a href="https://github.com/kubeflow/pipelines/blob/sdk/release-1.8/samples/core/recursion/recursion.py">recursion sample</a></li>
</ul>

</div>



    
	
  
    
    
	
    

<div class="td-content" style="page-break-before: always">
    
	<h1 id="pg-6a0dc6801800a3b5b8b4c7cb9a1d4104">3.1.5.13 - Using environment variables in pipelines</h1>
    <div class="lead">How to set and use environment variables in Kubeflow pipelines</div>
	

<div class="alert alert-warning" role="alert">
<h4 class="alert-heading">Out of date</h4>

    This guide contains outdated information pertaining to Kubeflow 1.0. This guide
needs to be updated for Kubeflow 1.1.

</div>

<p>This page describes how to pass environment variables to Kubeflow pipeline
components.</p>
<h2 id="before-you-start">Before you start</h2>
<p>Set up your environment:</p>
<ul>
<li><a href="/docs/started/getting-started/">Install Kubeflow</a></li>
<li><a href="/docs/components/pipelines/sdk/install-sdk/">Install the Kubeflow Pipelines SDK</a></li>
</ul>
<h2 id="using-environment-variables">Using environment variables</h2>
<p>In this example, you pass an environment variable to a lightweight Python
component, which writes the variable&rsquo;s value to the log.</p>
<p><a href="/docs/components/pipelines/sdk/lightweight-python-components/">Learn more about lightweight Python components</a></p>
<p>To build a component, define a stand-alone Python function and then call
<a href="https://kubeflow-pipelines.readthedocs.io/en/stable/source/kfp.components.html#kfp.components.func_to_container_op">kfp.components.func_to_container_op(func)</a> to convert the
function to a component that can be used in a pipeline. The following function gets an
environment variable and writes it to the log.</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-python" data-lang="python"><span class="line"><span class="cl"><span class="k">def</span> <span class="nf">logg_env_function</span><span class="p">():</span>
</span></span><span class="line"><span class="cl">  <span class="kn">import</span> <span class="nn">os</span>
</span></span><span class="line"><span class="cl">  <span class="kn">import</span> <span class="nn">logging</span>
</span></span><span class="line"><span class="cl">  <span class="n">logging</span><span class="o">.</span><span class="n">basicConfig</span><span class="p">(</span><span class="n">level</span><span class="o">=</span><span class="n">logging</span><span class="o">.</span><span class="n">INFO</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">  <span class="n">env_variable</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">getenv</span><span class="p">(</span><span class="s1">&#39;example_env&#39;</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">  <span class="n">logging</span><span class="o">.</span><span class="n">info</span><span class="p">(</span><span class="s1">&#39;The environment variable is: </span><span class="si">{}</span><span class="s1">&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">env_variable</span><span class="p">))</span>
</span></span></code></pre></div><p>Transform the function into a component using
<a href="https://kubeflow-pipelines.readthedocs.io/en/stable/source/kfp.components.html#kfp.components.func_to_container_op">kfp.components.func_to_container_op(func)</a>.</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-python" data-lang="python"><span class="line"><span class="cl"><span class="n">image_name</span> <span class="o">=</span> <span class="s1">&#39;tensorflow/tensorflow:1.11.0-py3&#39;</span>
</span></span><span class="line"><span class="cl"><span class="n">logg_env_function_op</span> <span class="o">=</span> <span class="n">comp</span><span class="o">.</span><span class="n">func_to_container_op</span><span class="p">(</span><span class="n">logg_env_function</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">                                                 <span class="n">base_image</span><span class="o">=</span><span class="n">image_name</span><span class="p">)</span>
</span></span></code></pre></div><p>Add this component to a pipeline. Use <a href="https://kubeflow-pipelines.readthedocs.io/en/stable/source/kfp.dsl.html#kfp.dsl.ContainerOp.container">add_env_variable</a> to pass an
environment variable into the component. This code is the same no matter if your
using python lightweight components or a <a href="https://kubeflow-pipelines.readthedocs.io/en/stable/source/kfp.dsl.html#kfp.dsl.ContainerOp">container operation</a>.</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-python" data-lang="python"><span class="line"><span class="cl"><span class="kn">import</span> <span class="nn">kfp.dsl</span> <span class="k">as</span> <span class="nn">dsl</span>
</span></span><span class="line"><span class="cl"><span class="kn">from</span> <span class="nn">kubernetes.client.models</span> <span class="kn">import</span> <span class="n">V1EnvVar</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="nd">@dsl</span><span class="o">.</span><span class="n">pipeline</span><span class="p">(</span>
</span></span><span class="line"><span class="cl">  <span class="n">name</span><span class="o">=</span><span class="s1">&#39;Env example&#39;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">  <span class="n">description</span><span class="o">=</span><span class="s1">&#39;A pipeline showing how to use environment variables&#39;</span>
</span></span><span class="line"><span class="cl"><span class="p">)</span>
</span></span><span class="line"><span class="cl"><span class="k">def</span> <span class="nf">environment_pipeline</span><span class="p">():</span>
</span></span><span class="line"><span class="cl">  <span class="n">env_var</span> <span class="o">=</span> <span class="n">V1EnvVar</span><span class="p">(</span><span class="n">name</span><span class="o">=</span><span class="s1">&#39;example_env&#39;</span><span class="p">,</span> <span class="n">value</span><span class="o">=</span><span class="s1">&#39;env_variable&#39;</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">  <span class="c1">#Returns a dsl.ContainerOp class instance. </span>
</span></span><span class="line"><span class="cl">  <span class="n">container_op</span> <span class="o">=</span> <span class="n">logg_env_function_op</span><span class="p">()</span><span class="o">.</span><span class="n">add_env_variable</span><span class="p">(</span><span class="n">env_var</span><span class="p">)</span> 
</span></span></code></pre></div><p>To pass more environment variables into a component, add more instances of
<a href="https://kubeflow-pipelines.readthedocs.io/en/stable/source/kfp.dsl.html#kfp.dsl.ContainerOp.container">add_env_variable()</a>. Use the following command to run this pipeline using the
Kubeflow Pipelines SDK.</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-python" data-lang="python"><span class="line"><span class="cl"><span class="c1">#Specify pipeline argument values</span>
</span></span><span class="line"><span class="cl"><span class="n">arguments</span> <span class="o">=</span> <span class="p">{}</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="c1">#Submit a pipeline run</span>
</span></span><span class="line"><span class="cl"><span class="n">kfp</span><span class="o">.</span><span class="n">Client</span><span class="p">()</span><span class="o">.</span><span class="n">create_run_from_pipeline_func</span><span class="p">(</span><span class="n">environment_pipeline</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">                                           <span class="n">arguments</span><span class="o">=</span><span class="n">arguments</span><span class="p">)</span>
</span></span></code></pre></div>
</div>



    
	
  
    
    
	
    

<div class="td-content" style="page-break-before: always">
    
	<h1 id="pg-ad66bcbcfacb2647b3a55cba3d1e76c6">3.1.5.14 - GCP-specific Uses of the SDK</h1>
    <div class="lead">SDK features that are available on Google Cloud Platform (GCP) only</div>
	<p>For pipeline features that are specific to GCP, including SDK features, see the
<a href="/docs/gke/pipelines/">GCP section of the docs</a>.</p>

</div>



    
	
  
    
    
	
    

<div class="td-content" style="page-break-before: always">
    
	<h1 id="pg-af8ccd9f5dc570d16c52b5d3e0ba2cf5">3.1.5.15 - Kubeflow Pipelines SDK for Tekton</h1>
    <div class="lead">How to run Kubeflow Pipelines with Tekton</div>
	<p>You can use the <a href="https://github.com/kubeflow/kfp-tekton/tree/master/sdk">KFP-Tekton SDK</a>
to compile, upload and run your Kubeflow Pipeline DSL Python scripts on a
<a href="https://github.com/kubeflow/kfp-tekton/tree/master/tekton_kfp_guide.md">Kubeflow Pipelines with Tekton backend</a>.</p>
<h2 id="sdk-packages">SDK packages</h2>
<p>The <code>kfp-tekton</code> SDK is an extension to the <a href="/docs/components/pipelines/sdk/sdk-overview/">Kubeflow Pipelines SDK</a>
adding the <code>TektonCompiler</code> and the <code>TektonClient</code>:</p>
<ul>
<li>
<p><code>kfp_tekton.compiler</code> includes classes and methods for compiling pipeline
Python DSL into a Tekton PipelineRun YAML spec. The methods in this package
include, but are not limited to, the following:</p>
<ul>
<li><code>kfp_tekton.compiler.TektonCompiler.compile</code> compiles your Python DSL code
into a single static configuration (in YAML format) that the Kubeflow Pipelines service
can process. The Kubeflow Pipelines service converts the static
configuration into a set of Kubernetes resources for execution.</li>
</ul>
</li>
<li>
<p><code>kfp_tekton.TektonClient</code> contains the Python client libraries for the <a href="/docs/components/pipelines/reference/api/kubeflow-pipeline-api-spec/">Kubeflow Pipelines API</a>.
Methods in this package include, but are not limited to, the following:</p>
<ul>
<li><code>kfp_tekton.TektonClient.upload_pipeline</code> uploads a local file to create a new pipeline in Kubeflow Pipelines.</li>
<li><code>kfp_tekton.TektonClient.create_experiment</code> creates a pipeline
<a href="/docs/components/pipelines/concepts/experiment/">experiment</a> and returns an
experiment object.</li>
<li><code>kfp_tekton.TektonClient.run_pipeline</code> runs a pipeline and returns a run object.</li>
<li><code>kfp_tekton.TektonClient.create_run_from_pipeline_func</code> compiles a pipeline
function and submits it for execution on Kubeflow Pipelines.</li>
<li><code>kfp_tekton.TektonClient.create_run_from_pipeline_package</code> runs a local
pipeline package on Kubeflow Pipelines.</li>
</ul>
</li>
</ul>
<h2 id="installing-the-kfp-tekton-sdk">Installing the KFP-Tekton SDK</h2>
<p>You need <strong>Python 3.5</strong> or later to use the Kubeflow Pipelines SDK for Tekton.
We recommend to create a Python virtual environment first using
<a href="https://conda.io/miniconda.html">Miniconda</a> or a virtual environment
manager such as <code>virtualenv</code> or the Python 3 <code>venv</code> module:</p>
<pre><code>python3 -m venv .venv-kfp-tekton
source .venv-kfp-tekton/bin/activate
</code></pre>
<p>You can install the latest release of the <code>kfp-tekton</code> compiler from
<a href="https://pypi.org/project/kfp-tekton/">PyPi</a>:</p>
<pre><code>pip3 install kfp-tekton --upgrade
</code></pre>
<h2 id="compiling-kubeflow-pipelines-dsl-scripts">Compiling Kubeflow Pipelines DSL scripts</h2>
<p>The <code>kfp-tekton</code> Python package comes with the <code>dsl-compile-tekton</code> command line
executable, which should be available in your terminal shell environment after
installing the <code>kfp-tekton</code> Python package.</p>
<p>If you cloned the <code>kfp-tekton</code> project, you can find example pipelines in the
<code>samples</code> folder or in the <code>sdk/python/tests/compiler/testdata</code> folder.</p>
<pre><code>dsl-compile-tekton \
    --py sdk/python/tests/compiler/testdata/parallel_join.py \
    --output pipeline.yaml
</code></pre>
<p><strong>Note</strong>: If the KFP DSL script contains a <code>__main__</code> method calling the
<code>kfp_tekton.compiler.TektonCompiler.compile()</code> function:</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-Python" data-lang="Python"><span class="line"><span class="cl"><span class="k">if</span> <span class="vm">__name__</span> <span class="o">==</span> <span class="s2">&#34;__main__&#34;</span><span class="p">:</span>
</span></span><span class="line"><span class="cl">    <span class="kn">from</span> <span class="nn">kfp_tekton.compiler</span> <span class="kn">import</span> <span class="n">TektonCompiler</span>
</span></span><span class="line"><span class="cl">    <span class="n">TektonCompiler</span><span class="p">()</span><span class="o">.</span><span class="n">compile</span><span class="p">(</span><span class="n">pipeline_func</span><span class="p">,</span> <span class="s2">&#34;pipeline.yaml&#34;</span><span class="p">)</span>
</span></span></code></pre></div><p>The pipeline can then be compiled by running the DSL script with <code>python3</code>
directly from the command line, producing a Tekton YAML file <code>pipeline.yaml</code>
in the same directory:</p>
<pre><code>python3 pipeline.py
</code></pre>
<h2 id="additional-documentation">Additional documentation</h2>
<ul>
<li><a href="https://github.com/kubeflow/kfp-tekton/blob/master/guides/kfp_tekton_install.md">Installing Kubeflow Pipelines with Tekton Backend</a></li>
<li><a href="https://github.com/kubeflow/kfp-tekton/blob/master/sdk/FEATURES.md">KFP-Tekton Compiler Features</a></li>
<li><a href="https://github.com/kubeflow/kfp-tekton">Kubeflow Pipelines for Tekton on GitHub</a></li>
</ul>

</div>



    
	
  
    
    
	
    

<div class="td-content" style="page-break-before: always">
    
	<h1 id="pg-1399671edb649a321c5d364b2a3c2218">3.1.5.16 - Manipulate Kubernetes Resources as Part of a Pipeline</h1>
    <div class="lead">Overview of using the SDK to manipulate Kubernetes resources dynamically as steps of the pipeline</div>
	

<div class="alert alert-warning" role="alert">
<h4 class="alert-heading">Out of date</h4>

    This guide contains outdated information pertaining to Kubeflow 1.0. This guide
needs to be updated for Kubeflow 1.1.

</div>

<p>This page describes how to manipulate Kubernetes resources through individual
Kubeflow Pipelines components during a pipeline.
Users may handle any Kubernetes resource, while creating
<a href="https://kubernetes.io/docs/concepts/storage/persistent-volumes/">Persistent Volume Claims</a>
and
<a href="https://kubernetes.io/docs/concepts/storage/volume-snapshots/">Volume Snapshots</a>
is rendered easy in the common case.</p>
<h2 id="kubernetes-resources">Kubernetes Resources</h2>
<h3 id="resourceop">ResourceOp</h3>
<p>This class represents a step of the pipeline which manipulates Kubernetes resources.
It implements
<a href="https://github.com/argoproj/argo-workflows/tree/master/examples#kubernetes-resources">Argo&rsquo;s resource template</a>.</p>
<p>This feature allows users to perform some action (<code>get</code>, <code>create</code>, <code>apply</code>,
<code>delete</code>, <code>replace</code>, <code>patch</code>) on Kubernetes resources.
Users are able to set conditions that denote the success or failure of the
step undertaking that action.</p>
<p><a href="https://kubeflow-pipelines.readthedocs.io/en/stable/source/kfp.dsl.html#kfp.dsl.ResourceOp">Link</a>
to the corresponding Python library.</p>
<h4 id="arguments">Arguments</h4>
<p>Only most significant arguments are presented in this section.
For more information, please refer to the aforementioned link to the library.</p>
<ul>
<li><code>k8s_resource</code>: Definition of the Kubernetes resource.
(<em>required</em>)</li>
<li><code>action</code>: Action to be performed (defaults to <code>create</code>).</li>
<li><code>merge_strategy</code>: Merge strategy when action is <code>patch</code>.
(<em>optional</em>)</li>
<li><code>success_condition</code>: Condition to denote success of the step once it is true.
(<em>optional</em>)</li>
<li><code>failure_condition</code>: Condition to denote failure of the step once it is true.
(<em>optional</em>)</li>
<li><code>attribute_outputs</code>: Similar to <code>file_outputs</code> of
<a href="https://kubeflow-pipelines.readthedocs.io/en/stable/source/kfp.dsl.html#kfp.dsl.ContainerOp"><code>kfp.dsl.ContainerOp</code></a>.
Maps output parameter names to JSON paths in the Kubernetes object.
More on that in the following section.
(<em>optional</em>)</li>
</ul>
<h4 id="outputs">Outputs</h4>
<p>ResourceOps can produce output parameters.
They can output field values of the resource which is being manipulated.
For example:</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-python" data-lang="python"><span class="line"><span class="cl"><span class="n">job</span> <span class="o">=</span> <span class="n">kubernetes_client</span><span class="o">.</span><span class="n">V1Job</span><span class="p">(</span><span class="o">...</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="n">rop</span> <span class="o">=</span> <span class="n">kfp</span><span class="o">.</span><span class="n">dsl</span><span class="o">.</span><span class="n">ResourceOp</span><span class="p">(</span>
</span></span><span class="line"><span class="cl">    <span class="n">name</span><span class="o">=</span><span class="s2">&#34;create-job&#34;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">    <span class="n">k8s_resource</span><span class="o">=</span><span class="n">job</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">    <span class="n">action</span><span class="o">=</span><span class="s2">&#34;create&#34;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">    <span class="n">attribute_outputs</span><span class="o">=</span><span class="p">{</span><span class="s2">&#34;name&#34;</span><span class="p">:</span> <span class="s2">&#34;{.metadata.name}&#34;</span><span class="p">}</span>
</span></span><span class="line"><span class="cl"><span class="p">)</span>
</span></span></code></pre></div><p>By default, ResourceOps output the resource&rsquo;s name as well as the whole resource
specification.</p>
<h3 id="samples">Samples</h3>
<p>For better understanding, please refer to the following samples:
<a href="https://github.com/kubeflow/pipelines/blob/sdk/release-1.8/samples/core/resource_ops/resource_ops.py">1</a></p>
<hr>
<h2 id="persistent-volume-claims-pvcs">Persistent Volume Claims (PVCs)</h2>
<p>Request the creation of PVC instances simple and fast.</p>
<h3 id="volumeop">VolumeOp</h3>
<p>A ResourceOp specialized in PVC creation.</p>
<p><a href="https://kubeflow-pipelines.readthedocs.io/en/stable/source/kfp.dsl.html#kfp.dsl.VolumeOp">Link</a>
to the corresponding Python library.</p>
<h4 id="arguments-1">Arguments</h4>
<p>The following arguments are an extension to <code>ResourceOp</code> arguments.
If a <code>k8s_resource</code> is passed, then none of the following should be provided.</p>
<ul>
<li><code>resource_name</code>: The name of the resource which will be created.
This string will be prepended with the workflow name.
This may contain <code>PipelineParam</code>s.
(<em>required</em>)</li>
<li><code>size</code>: The requested size for the PVC.
This may contain <code>PipelineParam</code>s.
(<em>required</em>)</li>
<li><code>storage_class</code>: The storage class to be used.
This may contain <code>PipelineParam</code>s.
(<em>optional</em>)</li>
<li><code>modes</code>: The <code>accessModes</code> of the PVC (defaults to <code>RWM</code>).
Check
<a href="https://kubernetes.io/docs/concepts/storage/persistent-volumes/#access-modes">this documentation</a>
for further information.
The user may find the following modes built-in:
<ul>
<li><code>VOLUME_MODE_RWO</code>: <code>[&quot;ReadWriteOnce&quot;]</code></li>
<li><code>VOLUME_MODE_RWM</code>: <code>[&quot;ReadWriteMany&quot;]</code></li>
<li><code>VOLUME_MODE_ROM</code>: <code>[&quot;ReadOnlyMany&quot;]</code></li>
</ul>
</li>
<li><code>annotations</code>: Annotations to be patched in the PVC.
These may contain <code>PipelineParam</code>s.
(<em>optional</em>)</li>
<li><code>data_source</code>: It is used to create a PVC from a <code>VolumeSnapshot</code>.
It can be either a <code>string</code> or a <code>V1TypedLocalObjectReference</code>, and may contain
<code>PipelineParam</code>s. (<em>Alpha feature</em>, <em>optional</em>)</li>
</ul>
<h4 id="outputs-1">Outputs</h4>
<p>Additionally to the whole specification of the resource and its name
(<code>ResourceOp</code> defaults), a <code>VolumeOp</code> also outputs the storage size of the
bounded Persistent Volume (as <code>step.outputs[&quot;size&quot;]</code>).
However, this may be empty if the storage provisioner has a
<code>WaitForFirstConsumer</code> binding mode.
This value, if not empty, is always greater than or equal to the requested size.</p>
<h4 id="useful-information">Useful information</h4>
<ol>
<li><code>VolumeOp</code> steps have a <code>.volume</code> attribute which is a <code>PipelineVolume</code>
referencing the created PVC.
More information on Pipeline Volumes in the following section.</li>
<li>A <code>ContainerOp</code> has a <code>pvolumes</code> argument in its constructor.
This is a dictionary with mount paths as keys and volumes as values and
functions similarly to <code>file_outputs</code> (which can then be used as
<code>op.outputs[&quot;key&quot;]</code> or <code>op.output</code>).
For example:</li>
</ol>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-python" data-lang="python"><span class="line"><span class="cl"><span class="n">vop</span> <span class="o">=</span> <span class="n">dsl</span><span class="o">.</span><span class="n">VolumeOp</span><span class="p">(</span>
</span></span><span class="line"><span class="cl">    <span class="n">name</span><span class="o">=</span><span class="s2">&#34;volume_creation&#34;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">    <span class="n">resource_name</span><span class="o">=</span><span class="s2">&#34;mypvc&#34;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">    <span class="n">size</span><span class="o">=</span><span class="s2">&#34;1Gi&#34;</span>
</span></span><span class="line"><span class="cl"><span class="p">)</span>
</span></span><span class="line"><span class="cl"><span class="n">step1</span> <span class="o">=</span> <span class="n">dsl</span><span class="o">.</span><span class="n">ContainerOp</span><span class="p">(</span>
</span></span><span class="line"><span class="cl">    <span class="n">name</span><span class="o">=</span><span class="s2">&#34;step1&#34;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">    <span class="o">...</span>
</span></span><span class="line"><span class="cl">    <span class="n">pvolumes</span><span class="o">=</span><span class="p">{</span><span class="s2">&#34;/mnt&#34;</span><span class="p">:</span> <span class="n">vop</span><span class="o">.</span><span class="n">volume</span><span class="p">}</span>  <span class="c1"># Implies execution after vop</span>
</span></span><span class="line"><span class="cl"><span class="p">)</span>
</span></span><span class="line"><span class="cl"><span class="n">step2</span> <span class="o">=</span> <span class="n">dsl</span><span class="o">.</span><span class="n">ContainerOp</span><span class="p">(</span>
</span></span><span class="line"><span class="cl">    <span class="n">name</span><span class="o">=</span><span class="s2">&#34;step2&#34;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">    <span class="o">...</span>
</span></span><span class="line"><span class="cl">    <span class="n">pvolumes</span><span class="o">=</span><span class="p">{</span><span class="s2">&#34;/data&#34;</span><span class="p">:</span> <span class="n">step1</span><span class="o">.</span><span class="n">pvolume</span><span class="p">,</span>  <span class="c1"># Implies execution after step1</span>
</span></span><span class="line"><span class="cl">              <span class="s2">&#34;/mnt&#34;</span><span class="p">:</span> <span class="n">dsl</span><span class="o">.</span><span class="n">PipelineVolume</span><span class="p">(</span><span class="n">pvc</span><span class="o">=</span><span class="s2">&#34;existing-pvc&#34;</span><span class="p">)}</span>
</span></span><span class="line"><span class="cl"><span class="p">)</span>
</span></span><span class="line"><span class="cl"><span class="n">step3</span> <span class="o">=</span> <span class="n">dsl</span><span class="o">.</span><span class="n">ContainerOp</span><span class="p">(</span>
</span></span><span class="line"><span class="cl">    <span class="n">name</span><span class="o">=</span><span class="s2">&#34;step3&#34;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">    <span class="o">...</span>
</span></span><span class="line"><span class="cl">    <span class="n">pvolumes</span><span class="o">=</span><span class="p">{</span><span class="s2">&#34;/common&#34;</span><span class="p">:</span> <span class="n">step2</span><span class="o">.</span><span class="n">pvolumes</span><span class="p">[</span><span class="s2">&#34;/mnt&#34;</span><span class="p">]}</span>  <span class="c1"># Implies execution after step2</span>
</span></span><span class="line"><span class="cl"><span class="p">)</span>
</span></span></code></pre></div><h3 id="pipelinevolume">PipelineVolume</h3>
<p>Reference Kubernetes volumes easily, mount them and express dependencies
through them.</p>
<p>A <code>PipelineVolume</code> is essentially a Kubernetes <code>Volume</code>(*) carrying
dependencies, supplemented with an <code>.after()</code> method extending them.
Those dependencies can then be parsed properly by a <code>ContainerOp</code>, when consumed
in <code>pvolumes</code> argument or <code>add_pvolumes()</code> method, to extend the dependencies
of that step.</p>
<p><a href="https://kubeflow-pipelines.readthedocs.io/en/stable/source/kfp.dsl.html#kfp.dsl.PipelineVolume">Link</a>
to the corresponding Python library.</p>
<p><em>(*) Inherits from V1Volume class of Kubernetes Python client.</em></p>
<h4 id="arguments-2">Arguments</h4>
<p><code>PipelineVolume</code> constructor accepts all arguments <code>V1Volume</code> constructor does.
However, <code>name</code> can be omitted and a pseudo-random name for that volume is
generated instead.</p>
<p>Extra arguments:</p>
<ul>
<li><code>pvc</code>: Name of an existing PVC to be referenced by this <code>PipelineVolume</code>.
This value can be a <code>PipelineParam</code>.</li>
<li><code>volume</code>: Initialize a new <code>PipelineVolume</code> instance from an existing
<code>V1Volume</code>, or its inherited types (e.g. <code>PipelineVolume</code>).</li>
</ul>
<h3 id="samples-1">Samples</h3>
<p>For better understanding, please refer to the following samples:
<a href="https://github.com/kubeflow/pipelines/blob/sdk/release-1.8/samples/core/volume_ops/volume_ops.py">1</a>,
<a href="https://github.com/kubeflow/pipelines/blob/sdk/release-1.8/samples/contrib/volume_ops/volumeop_dag.py">2</a>,
<a href="https://github.com/kubeflow/pipelines/blob/sdk/release-1.8/samples/contrib/volume_ops/volumeop_parallel.py">3</a>,
<a href="https://github.com/kubeflow/pipelines/blob/sdk/release-1.8/samples/contrib/volume_ops/volumeop_sequential.py">4</a></p>
<hr>
<h2 id="volume-snapshots">Volume Snapshots</h2>
<p>Request the creation of Volume Snapshot instances simple and fast.</p>
<h3 id="volumesnapshotop">VolumeSnapshotOp</h3>
<p>A ResourceOp specialized in Volume Snapshot creation.</p>
<p><a href="https://kubeflow-pipelines.readthedocs.io/en/stable/source/kfp.dsl.html#kfp.dsl.VolumeSnapshotOp">Link</a>
to the corresponding Python library.</p>
<p><strong>NOTE:</strong> You should check if your Kubernetes cluster admin has Volume Snapshots
enabled in your cluster.</p>
<h4 id="arguments-3">Arguments</h4>
<p>The following arguments are an extension to the <code>ResourceOp</code> arguments.
If a <code>k8s_resource</code> is passed, then none of the following may be provided.</p>
<ul>
<li><code>resource_name</code>: The name of the resource which will be created.
This string will be prepended with the workflow name.
This may contain <code>PipelineParam</code>s.
(<em>required</em>)</li>
<li><code>pvc</code>: The name of the PVC to be snapshotted.
This may contain <code>PipelineParam</code>s.
(<em>optional</em>)</li>
<li><code>snapshot_class</code>: The snapshot storage class to be used.
This may contain <code>PipelineParam</code>s.
(<em>optional</em>)</li>
<li><code>volume</code>: An instance of a <code>V1Volume</code>, or its inherited type (e.g.
<code>PipelineVolume</code>).
This may contain <code>PipelineParam</code>s.
(<em>optional</em>)</li>
<li><code>annotations</code>: Annotations to be patched in the <code>VolumeSnapshot</code>.
These may contain <code>PipelineParam</code>s.
(<em>optional</em>)</li>
</ul>
<p><strong>NOTE:</strong> One of the <code>pvc</code> or <code>volume</code> needs to be provided.</p>
<h4 id="outputs-2">Outputs</h4>
<p>Additionally to the whole specification of the resource and its name
(<code>ResourceOp</code> defaults), a <code>VolumeSnapshotOp</code> also outputs the <code>restoreSize</code> of
the bounded <code>VolumeSnapshot</code> (as <code>step.outputs[&quot;size&quot;]</code>).
This is the minimum size for a PVC clone of that snapshot.</p>
<h4 id="useful-information-1">Useful information</h4>
<p><code>VolumeSnapshotOp</code> steps have a <code>.snapshot</code> attribute which is a
<code>V1TypedLocalObjectReference</code>.
This can be passed as a <code>data_source</code> to create a PVC out of that
<code>VolumeSnapshot</code>.
The user may otherwise use the <code>step.outputs[&quot;name&quot;]</code> as <code>data_source</code>.</p>
<h3 id="samples-2">Samples</h3>
<p>For better understanding, please refer to the following samples:
<a href="https://github.com/kubeflow/pipelines/blob/sdk/release-1.8/samples/core/volume_snapshot_ops/volume_snapshot_ops.py">1</a>,
<a href="https://github.com/kubeflow/pipelines/blob/sdk/release-1.8/samples/contrib/volume_snapshot_ops/volume_snapshotop_rokurl.py">2</a></p>
<h2 id="next-steps">Next steps</h2>
<ul>
<li>See samples in Kubeflow Pipelines
<a href="https://github.com/kubeflow/pipelines/tree/sdk/release-1.8/samples">repository</a>.
For instance, check these samples of
<a href="https://github.com/kubeflow/pipelines/tree/sdk/release-1.8/samples/core/resource_ops">ResourceOps</a>,
<a href="https://github.com/kubeflow/pipelines/tree/sdk/release-1.8/samples/core/volume_ops">VolumeOps</a>
and
<a href="https://github.com/kubeflow/pipelines/tree/sdk/release-1.8/samples/core/volume_snapshot_ops">VolumeSnapshotOps</a>.</li>
<li>Learn more about the
<a href="/docs/components/pipelines/sdk/dsl-overview/">Kubeflow Pipelines domain-specific language (DSL)</a>,
a set of Python libraries that you can use to specify ML pipelines.</li>
<li>For quick iteration,
<a href="/docs/components/pipelines/sdk/build-component/">build components and pipelines</a>.</li>
</ul>

</div>



    
	
  
    
    
	
    

<div class="td-content" style="page-break-before: always">
    
	<h1 id="pg-67b05544f3675abcc53d37062cf6583a">3.1.5.17 - Python Based Visualizations (Deprecated)</h1>
    <div class="lead">Predefined and custom visualizations of pipeline outputs</div>
	

<div class="alert alert-warning" role="alert">
<h4 class="alert-heading">Deprecated</h4>

    Python based visualization is deprecated. We recommend fetching data via
Kubeflow Pipelines SDK and visualizing from your own notebook instead.

</div>

<p>This page describes Python based visualizations, how to create them, and how to
use them to visualize results within the Kubeflow Pipelines UI. Python based
visualizations are available in Kubeflow Pipelines version
<a href="https://github.com/kubeflow/pipelines/releases/tag/0.1.29">0.1.29</a> and later, and
in Kubeflow version 0.7.0 and later.</p>
<p>While Python based visualizations are intended to be the main method of
visualizing data within the Kubeflow Pipelines UI, they do not replace the
previous method of visualizing data within the Kubeflow Pipelines UI. When
considering which method of visualization to use within your pipeline, check the
limitations of Python based visualizations in the section below and compare
them with the requirements of your visualizations.</p>
<h2 id="introduction">Introduction</h2>
<p>Python based visualizations are a new method to visualize results within the
Kubeflow Pipelines UI. This new method of visualizing results is done through
the usage of <a href="https://github.com/jupyter/nbconvert">nbconvert</a>. Alongside the
usage of nbconvert, results of a pipeline can now be visualized without a
component being included within the pipeline itself because the process of
visualizing results is now decoupled from a pipeline.</p>
<p>Python based visualizations provide two categories of visualizations. The first
being <strong>predefined visualizations</strong>. These visualizations are provided by
default in Kubeflow Pipelines and serve as a way for you and your customers to
easily and quickly generate powerful visualizations. The second category is
<strong>custom visualizations</strong>. Custom visualizations allow for you and your
customers to provided Python visualization code to be used to generate
visualizations. These visualizations allow for rapid development,
experimentation, and customization when visualizing results.</p>
<p><img src="/docs/images/python-based-visualizations1.png"
alt="Confusion matrix visualization from a pipeline component"
class="mt-3 mb-3 border border-info rounded"></p>
<h2 id="using-predefined-visualizations">Using predefined visualizations</h2>
<h3 id="predefined-matrix-visualization">Predefined matrix visualization</h3>
<p><img src="/docs/images/python-based-visualizations2.png"
alt="Confusion matrix visualization from a pipeline component"
class="mt-3 mb-3 border border-info rounded"></p>
<ol>
<li>Open the details of a run.</li>
<li>Select a component.
<ul>
<li>The component that is selected does not matter. But, if you want to
visualize the output of a specific component, it is easier to do that within
that component.</li>
</ul>
</li>
<li>Select the <strong>Artifacts</strong> tab.</li>
<li>At the top of the tab you should see a card named <strong>Visualization Creator</strong>.</li>
<li>Within the card, provide a visualization type, a source, and any necessary
arguments.
<ul>
<li>Any required or optional arguments will be shown as a placeholder.</li>
</ul>
</li>
<li>Click <strong>Generate Visualization</strong>.</li>
<li>View generated visualization by scrolling down.</li>
</ol>
<h3 id="predefined-tfx-visualization">Predefined TFX visualization</h3>
<video width="100%" max-width="100%" height="auto" max-height="100%" controls>
  <source src="/docs/videos/tfdv_example_with_taxi_pipeline.webm" type="video/webm">
</video>
<ol>
<li>On the Pipelines page, click <strong>[Sample] Unified DSL - Taxi Tip Prediction Model Trainer</strong> to open the Pipeline Details page.</li>
<li>On the Pipeline Details page, click <strong>Create run</strong>.</li>
<li>On the Create run page,
<ul>
<li>Use a run name and an experiment name of your choice.</li>
<li>In the <strong>pipeline-root</strong> field, specify a storage bucket that you have permission to write to. For example, enter the path to a Google Cloud Storage bucket or an Amazon S3 bucket.</li>
<li>Click <strong>Start</strong> to create the run.</li>
</ul>
</li>
<li>After the run is complete, on the Run Details page, click any step. For example, click the first step <strong>csvexamplegen</strong> as shown in the video above.</li>
<li>In the side panel of the selected step,
<ul>
<li>Click the <strong>Artifacts</strong> tab.</li>
<li>In the <strong>Visualization Creator</strong> section, choose <strong>TFDV</strong> from the drop down menu.</li>
<li>In the <strong>Source</strong> field, use <strong>gs://ml-pipeline-playground/tfx_taxi_simple/data/data.csv</strong>, which is the input data used for this run.</li>
<li>Click <strong>Generate Visualization</strong> and wait.</li>
</ul>
</li>
<li>Move to the bottom of the <strong>Artifacts</strong> tab to find the generated visualization.</li>
</ol>
<h2 id="using-custom-visualizations">Using custom visualizations</h2>
<p><img src="/docs/images/python-based-visualizations3.png"
alt="Confusion matrix visualization from a pipeline component"
class="mt-3 mb-3 border border-info rounded"></p>
<ol>
<li>Enable custom visualizations within Kubeflow Pipelines.
<ul>
<li>
<p>If you have not yet deployed Kubeflow Pipelines to your cluster,
you can edit the <a href="https://github.com/kubeflow/pipelines/blob/sdk/release-1.8/manifests/kustomize/base/pipeline/ml-pipeline-ui-deployment.yaml">frontend deployment YAML</a>
file to include the following YAML that specifies that custom visualizations
are allowed via environment variables.</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-fallback" data-lang="fallback"><span class="line"><span class="cl">- env:
</span></span><span class="line"><span class="cl">  - name: ALLOW_CUSTOM_VISUALIZATIONS
</span></span><span class="line"><span class="cl">    value: true
</span></span></code></pre></div></li>
<li>
<p>If you already have Kubeflow Pipelines deployed within a cluster, you can
edit the frontend deployment YAML to specify that custom visualizations are
allowed in the same way described above. Details about updating
deployments can be found in the Kubernetes documentation about
<a href="https://kubernetes.io/docs/concepts/workloads/controllers/deployment/#updating-a-deployment">updating a deployment</a>.</p>
</li>
</ul>
</li>
<li>Open the details of a run.</li>
<li>Select a component.
<ul>
<li>The component that is selected does not matter. But, if you want to
visualize the output of a specific component, it is easier to do that within
that component.</li>
</ul>
</li>
<li>Select the <strong>Artifacts</strong> tab.</li>
<li>At the top of the tab you should see a card named <strong>Visualization Creator</strong>.</li>
<li>Within the card, select the <strong>CUSTOM</strong> visualization type then provide a
source, and any necessary arguments (the source and argument variables are
optional for custom visualizations).</li>
<li>Provide the custom visualization code.</li>
<li>Click <strong>Generate Visualization</strong>.</li>
<li>View generated visualization by scrolling down.</li>
</ol>
<p>A demo of the above instructions is as follows.</p>
<video width="100%" max-width="100%" height="auto" max-height="100%" controls>
  <source src="/docs/videos/taxi_custom_visualization.webm" type="video/webm">
</video>
<ol>
<li>On the Pipelines page, click <strong>[Sample] Unified DSL - Taxi Tip Prediction Model Trainer</strong> to open the Pipeline Details page.</li>
<li>On the Pipeline Details page, click <strong>Create run</strong>.</li>
<li>On the Create run page,
<ul>
<li>Use a run name and an experiment name of your choice or simply use the default names chosen for you.</li>
<li>In the <strong>pipeline-root</strong> field, specify a storage bucket that you have permission to write to. For example, enter the path to a Google Cloud Storage bucket or an Amazon S3 bucket.</li>
<li>Click <strong>Start</strong> to create the run.</li>
</ul>
</li>
<li>After the run is complete, on the Run Details page, click the step of <strong>statisticsgen</strong>. This step&rsquo;s output is statistics data generated by Tensorflow Data Validation.</li>
<li>In the side panel of the selected step,
<ul>
<li>Click the <strong>Input/Output</strong> tab to find out the <strong>mlpipeline-ui-metadata</strong> item and click the minio link there. This will open a new browser tab with information on output file path. Copy the output file path as shown in the demo video.</li>
<li>Get back to the Run Details page, and click the <strong>Artifacts</strong> tab.</li>
<li>At the top of the tab you should see a card named <strong>Visualization Creator</strong>, choose <strong>Custom</strong> from the drop down menu.</li>
<li>In the <strong>Custom Visualization Code</strong> field, fill in the following code snippet and replace [output file path] with the output file path you just copied from <strong>mlpipeline-ui-metadata</strong>.</li>
</ul>
 <pre style="overflow-x:scroll;overflow-y:hidden;white-space:pre;">
   import tensorflow_data_validation as tfdv
   stats = tfdv.load_statistics('[output file path]/stats_tfrecord')
   tfdv.visualize_statistics(stats)
 </pre>
<ul>
<li>Click <strong>Generate Visualization</strong> and wait.</li>
</ul>
</li>
<li>Move to the bottom of the <strong>Artifacts</strong> tab to find the generated visualization.</li>
</ol>
<h2 id="known-limitations">Known limitations</h2>
<ul>
<li>
<p>Multiple visualizations cannot be generated concurrently.</p>
<ul>
<li>This is because a single Python kernel is used to generate visualizations.</li>
<li>If visualizations are a major part of your workflow, it is recommended to
increase the number of replicas within the
<a href="https://github.com/kubeflow/pipelines/tree/sdk/release-1.8/manifests/kustomize/base/pipeline/ml-pipeline-visualization-deployment.yaml">visualization deployment YAML</a>
file or within the visualization service deployment itself.
<ul>
<li><em>Please note that this does not directly solve the issue, instead it
decreases the likelihood of experiencing delays when generating
visualizations.</em></li>
</ul>
</li>
</ul>
</li>
<li>
<p>Visualizations that take longer than 30 seconds will fail to generate.</p>
<ul>
<li>
<p>For visualizations where the 30 second timeout is reached, you can add the
<strong>TimeoutValue</strong> header to the request made by the frontend, specifying a
<em>positive integer as ASCII string of at most 8 digits</em> for the length of
time required to generate a visualization as specified by the
<a href="https://github.com/grpc/grpc/blob/master/doc/PROTOCOL-HTTP2.md#requests">grpc documentation</a>.</p>
</li>
<li>
<p>For visualizations that take longer than 100 seconds, you will have to
specify a <strong>TimeoutValue</strong> within the request headers <strong>AND</strong> change the
default kernel timeout of the visualization service. To change the default
kernel timeout of the visualization service, set the <strong>KERNEL_TIMEOUT</strong>
environment variable of the visualization service deployment to be the new
timeout length in seconds within the
<a href="https://github.com/kubeflow/pipelines/tree/sdk/release-1.8/manifests/kustomize/base/pipeline/ml-pipeline-visualization-deployment.yaml">visualization deployment YAML</a>
file or within the visualization service deployment itself.</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-fallback" data-lang="fallback"><span class="line"><span class="cl">- env:
</span></span><span class="line"><span class="cl">  - name: KERNEL_TIMEOUT
</span></span><span class="line"><span class="cl">    value: 100
</span></span></code></pre></div></li>
</ul>
</li>
<li>
<p>The HTML content of the generated visualizations cannot be larger than 4MB.</p>
<ul>
<li>
<p>gRPC by default imposes a limit of 4MB as the maximum size that can be
sent and received by a server. To allow for visualizations that are larger
than 4MB in size to be generated, you must manually set
<strong>MaxCallRecvMsgSize</strong> for gRPC. This can be done by editing the provided
options given to the gRPC server within <a href="https://github.com/kubeflow/pipelines/blob/sdk/release-1.8/backend/src/apiserver/main.go#L128">main.go</a>
to</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-golang" data-lang="golang"><span class="line"><span class="cl"><span class="kd">var</span> <span class="nx">maxCallRecvMsgSize</span> <span class="p">=</span> <span class="mi">4</span> <span class="o">*</span> <span class="mi">1024</span> <span class="o">*</span> <span class="mi">1024</span>
</span></span><span class="line"><span class="cl"><span class="k">if</span> <span class="nx">serviceName</span> <span class="o">==</span> <span class="s">&#34;Visualization&#34;</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">      <span class="c1">// Only change the maxCallRecvMesSize if it is for visualizations
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>      <span class="nx">maxCallRecvMsgSize</span> <span class="p">=</span> <span class="mi">50</span> <span class="o">*</span> <span class="mi">1024</span> <span class="o">*</span> <span class="mi">1024</span>
</span></span><span class="line"><span class="cl"><span class="p">}</span>
</span></span><span class="line"><span class="cl"><span class="nx">opts</span> <span class="o">:=</span> <span class="p">[]</span><span class="nx">grpc</span><span class="p">.</span><span class="nx">DialOption</span><span class="p">{</span>
</span></span><span class="line"><span class="cl">      <span class="nx">grpc</span><span class="p">.</span><span class="nf">WithDefaultCallOptions</span><span class="p">(</span><span class="nx">grpc</span><span class="p">.</span><span class="nf">MaxCallRecvMsgSize</span><span class="p">(</span><span class="nx">maxCallRecvMsgSize</span><span class="p">)),</span>
</span></span><span class="line"><span class="cl">      <span class="nx">grpc</span><span class="p">.</span><span class="nf">WithInsecure</span><span class="p">(),</span>
</span></span><span class="line"><span class="cl"><span class="p">}</span>
</span></span></code></pre></div></li>
</ul>
</li>
</ul>

</div>



    
	
  
    
    
	
    

<div class="td-content" style="page-break-before: always">
    
	<h1 id="pg-6b0621ddf48d2bc7b2827f237fb1eebf">3.1.5.18 - </h1>
    
	<p>approvers:</p>
<ul>
<li>neuromage</li>
<li>Ark-kun</li>
<li>numerology
reviewers:</li>
<li>RFMVasconcelos</li>
</ul>

</div>



    
	
  

    
	
  
    
    
	
    

<div class="td-content" style="page-break-before: always">
    
	<h1 id="pg-5484f729f763ffba2281086c91c3ca4b">3.1.6 - Pipelines SDK (v2)</h1>
    <div class="lead">Information about the Kubeflow Pipelines SDK (v2)</div>
	
</div>



    
      
  
  
  
  

  
  

  
    
    
	
    

<div class="td-content" style="">
    
	<h1 id="pg-7de693453582d12951b61f9fd9caa3ab">3.1.6.1 - Introducing Kubeflow Pipelines SDK v2</h1>
    <div class="lead">Overview of how to get started with Kubeflow Pipelines SDK v2</div>
	<div class="alert alert-warning" role="alert">
  <h4 class="alert-heading">Beta</h4>
  This Kubeflow component has <b>beta</b> status. See the
  <a href="/docs/started/support/#application-status">Kubeflow versioning policies</a>.
  The Kubeflow team is interested in your   
  <a href="https://github.com/kubeflow/pipelines/issues">feedback</a></h4> 
  about the usability of the feature.
</div>
<p>The Kubeflow Pipelines SDK provides a set of Python packages that you can use to specify and run your machine learning (ML) workflow as a pipeline. Version 2 of the SDK adds support for tracking pipeline runs and artifacts using ML Metadata. Starting with Kubeflow Pipelines 1.6, you can build and run pipelines in v2 compatibility mode.</p>
<p>Kubeflow Pipelines SDK v2 compatibility mode lets you use the new pipeline semantics and gain the benefits of logging your metadata to ML Metadata. You can use ML Metadata to help answer questions about the lineage of your pipelines artifacts.</p>
<p>To learn more about the work towards Kubeflow Pipelines v2, read the design documents for <a href="http://bit.ly/kfp-v2">Kubeflow Pipelines v2</a> and <a href="http://bit.ly/kfp-v2-compatible">Kubeflow Pipelines v2 compatible
mode</a>, or join the Kubeflow Pipelines community.</p>
<h2 id="before-you-begin">Before you begin</h2>
<ol>
<li>
<p>Install <a href="/docs/components/pipelines/installation/standalone-deployment">Kubeflow Pipelines Standalone</a> 1.7.0 or higher. Note, support for other distributions is under development, see <a href="#current-caveats">Current Caveats section</a>.</p>
</li>
<li>
<p>Run the following command to install Kubeflow Pipelines SDK v1.7.2 or higher. If you run this command in a Jupyter notebook, restart the kernel after installing the SDK.</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash"><span class="line"><span class="cl">pip install kfp --upgrade
</span></span></code></pre></div></li>
<li>
<p>Import the kfp and kfp.components packages.</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-python" data-lang="python"><span class="line"><span class="cl"><span class="kn">import</span> <span class="nn">kfp</span>
</span></span></code></pre></div></li>
<li>
<p>Create an instance of the kfp.Client class. To find your Kubeflow Pipelines clusters hostname and URL scheme, open the Kubeflow Pipelines user interface in your browser. The URL of the Kubeflow Pipelines user interface is something like <a href="https://my-cluster.my-organization.com/pipelines">https://my-cluster.my-organization.com/pipelines</a>. In this case, the host name and URL scheme are <a href="https://my-cluster.my-organization.com">https://my-cluster.my-organization.com</a>.</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-python" data-lang="python"><span class="line"><span class="cl"><span class="c1"># If you run this command on a Jupyter notebook running on Kubeflow, you can</span>
</span></span><span class="line"><span class="cl"><span class="c1"># exclude the host parameter.</span>
</span></span><span class="line"><span class="cl"><span class="c1"># client = kfp.Client()</span>
</span></span><span class="line"><span class="cl"><span class="n">client</span> <span class="o">=</span> <span class="n">kfp</span><span class="o">.</span><span class="n">Client</span><span class="p">(</span><span class="n">host</span><span class="o">=</span><span class="s1">&#39;&lt;your-kubeflow-pipelines-host-name&gt;&#39;</span><span class="p">)</span>
</span></span></code></pre></div></li>
</ol>
<h2 id="building-pipelines-using-the-kubeflow-pipelines-sdk-v2">Building pipelines using the Kubeflow Pipelines SDK v2</h2>
<p>If you are new to building pipelines, read the following guides to learn more about
using Kubeflow Pipelines SDK v2 to build pipelines and components.</p>
<ul>
<li><a href="/docs/components/pipelines/sdk-v2/build-pipeline/">Get started building pipelines using Pipelines SDK v2</a>.</li>
<li><a href="/docs/components/pipelines/sdk-v2/component-development/">Learn how to build pipeline components using Pipelines SDK v2</a>.</li>
<li><a href="/docs/components/pipelines/sdk-v2/python-function-components/">Build lightweight Python function-based components using Pipelines SDK
v2</a>.</li>
</ul>
<p>If you are familiar with building Kubeflow pipelines, the Kubeflow Pipelines SDK v2
introduces the following changes:</p>
<ul>
<li>
<p>The following changes affect how you build components:</p>
<ul>
<li>
<p>All component inputs and outputs must be annotated with their data type.</p>
</li>
<li>
<p>The Kubeflow Pipelines SDK v2 makes a distinction between inputs and outputs that
are <em>parameters</em> and those that are <em>artifacts</em>.</p>
<ul>
<li>
<p>Parameters are inputs or outputs of type <code>str</code>, <code>int</code>, <code>float</code>, <code>bool</code>, <code>dict</code>, or <code>list</code>
that typically are used to change the behavior of a pipeline. Input parameters
are always passed by value, which means that they are inserted into the
command used to execute the component. Parameters are stored in ML Metadata.</p>
</li>
<li>
<p><a href="https://github.com/kubeflow/pipelines/blob/sdk/release-1.8/sdk/python/kfp/dsl/io_types.py">Artifacts</a>
are larger inputs or outputs, such as datasets or models. Input
artifacts are always passed as a reference to a path.</p>
<p>You can also access an artifact&rsquo;s metadata. For input artifacts, you can
read the artifact&rsquo;s metadata. For output artifacts, you can write key/value
pairs to the metadata dictionary.</p>
</li>
</ul>
</li>
</ul>
</li>
<li>
<p>The following changes affect how you define a pipeline:</p>
<ul>
<li>
<p>Pipeline functions must be decorated with
<a href="https://github.com/kubeflow/pipelines/blob/sdk/release-1.8/sdk/python/kfp/dsl/_pipeline.py"><code>@kfp.dsl.pipeline</code></a>. Specify the following arguments for the
<code>@pipeline</code> annotation.</p>
<ul>
<li>
<p><code>name</code>: The pipeline name is used when querying MLMD to store or lookup
component parameters and artifacts. Reusing pipeline names may result in unexpected behaviors. You can override this name when you run the pipeline.</p>
</li>
<li>
<p><code>description</code>: (Optional.) A user friendly description of this pipeline.</p>
</li>
<li>
<p><code>pipeline_root</code>: (Optional.) The root path where this pipeline&rsquo;s outputs
are stored. This can be a MinIO, Google Cloud Storage, or Amazon Web Services
S3 URI. You can override the pipeline root when you run the pipeline.</p>
<p>If you do not specify the <code>pipeline_root</code>, Kubeflow Pipelines stores your
artifacts using MinIO.</p>
</li>
</ul>
</li>
<li>
<p>The Kubeflow Pipelines SDK v2 compiler checks that data types are used correctly in pipelines,
and that parameters outputs are not passed to artifact inputs and vice versa</p>
<p>You might need to modify existing pipelines to run them in v2 compatibility mode.</p>
</li>
<li>
<p>It is not longer supported to pass constants to artifact inputs.</p>
</li>
<li>
<p>All pipeline parameters must be annotated with their data type.</p>
</li>
</ul>
</li>
</ul>
<h2 id="compiling-and-running-pipelines-in-v2-compatibility-mode">Compiling and running pipelines in v2 compatibility mode</h2>
<p>First we define a v2 compatible pipeline:</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-python" data-lang="python"><span class="line"><span class="cl"><span class="kn">import</span> <span class="nn">kfp</span>
</span></span><span class="line"><span class="cl"><span class="kn">import</span> <span class="nn">kfp.dsl</span> <span class="k">as</span> <span class="nn">dsl</span>
</span></span><span class="line"><span class="cl"><span class="kn">from</span> <span class="nn">kfp.v2.dsl</span> <span class="kn">import</span> <span class="n">component</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="nd">@component</span>
</span></span><span class="line"><span class="cl"><span class="k">def</span> <span class="nf">add</span><span class="p">(</span><span class="n">a</span><span class="p">:</span> <span class="nb">float</span><span class="p">,</span> <span class="n">b</span><span class="p">:</span> <span class="nb">float</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">float</span><span class="p">:</span>
</span></span><span class="line"><span class="cl">  <span class="s1">&#39;&#39;&#39;Calculates sum of two arguments&#39;&#39;&#39;</span>
</span></span><span class="line"><span class="cl">  <span class="k">return</span> <span class="n">a</span> <span class="o">+</span> <span class="n">b</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="nd">@dsl</span><span class="o">.</span><span class="n">pipeline</span><span class="p">(</span>
</span></span><span class="line"><span class="cl">  <span class="n">name</span><span class="o">=</span><span class="s1">&#39;addition-pipeline&#39;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">  <span class="n">description</span><span class="o">=</span><span class="s1">&#39;An example pipeline that performs addition calculations.&#39;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">  <span class="c1"># pipeline_root=&#39;gs://my-pipeline-root/example-pipeline&#39;</span>
</span></span><span class="line"><span class="cl"><span class="p">)</span>
</span></span><span class="line"><span class="cl"><span class="k">def</span> <span class="nf">add_pipeline</span><span class="p">(</span><span class="n">a</span><span class="p">:</span> <span class="nb">float</span> <span class="o">=</span> <span class="mi">1</span><span class="p">,</span> <span class="n">b</span><span class="p">:</span> <span class="nb">float</span> <span class="o">=</span> <span class="mi">7</span><span class="p">):</span>
</span></span><span class="line"><span class="cl">  <span class="n">add_task</span> <span class="o">=</span> <span class="n">add</span><span class="p">(</span><span class="n">a</span><span class="p">,</span> <span class="n">b</span><span class="p">)</span>
</span></span></code></pre></div><p>To compile your pipeline in v2 compatibility mode, specify that
<code>mode=kfp.dsl.PipelineExecutionMode.V2_COMPATIBLE</code> when you initiate the compiler:</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-python" data-lang="python"><span class="line"><span class="cl"><span class="kn">from</span> <span class="nn">kfp</span> <span class="kn">import</span> <span class="n">compiler</span>
</span></span><span class="line"><span class="cl"><span class="n">compiler</span><span class="o">.</span><span class="n">Compiler</span><span class="p">(</span><span class="n">mode</span><span class="o">=</span><span class="n">kfp</span><span class="o">.</span><span class="n">dsl</span><span class="o">.</span><span class="n">PipelineExecutionMode</span><span class="o">.</span><span class="n">V2_COMPATIBLE</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">    <span class="o">.</span><span class="n">compile</span><span class="p">(</span><span class="n">pipeline_func</span><span class="o">=</span><span class="n">add_pipeline</span><span class="p">,</span> <span class="n">package_path</span><span class="o">=</span><span class="s1">&#39;pipeline.yaml&#39;</span><span class="p">)</span>
</span></span></code></pre></div><p>To run your pipeline in v2 compatibility mode:</p>
<ol>
<li>Create an instance of the <a href="https://kubeflow-pipelines.readthedocs.io/en/latest/source/kfp.client.html#kfp.Client"><code>kfp.Client</code> class</a> following steps in <a href="/docs/components/pipelines/sdk/connect-api/">connecting to Kubeflow Pipelines using the SDK client</a>.</li>
<li>Specify that <code>mode=kfp.dsl.PipelineExecutionMode.V2_COMPATIBLE</code> when you create a pipeline
run using <code>create_run_from_pipeline_func</code>.</li>
</ol>
<p>The following example demonstrates how to run a pipeline using v2 compatibility mode.</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-python" data-lang="python"><span class="line"><span class="cl"><span class="n">client</span> <span class="o">=</span> <span class="n">kfp</span><span class="o">.</span><span class="n">Client</span><span class="p">()</span>
</span></span><span class="line"><span class="cl"><span class="c1"># run the pipeline in v2 compatibility mode</span>
</span></span><span class="line"><span class="cl"><span class="n">client</span><span class="o">.</span><span class="n">create_run_from_pipeline_func</span><span class="p">(</span>
</span></span><span class="line"><span class="cl">    <span class="n">add_pipeline</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">    <span class="n">arguments</span><span class="o">=</span><span class="p">{</span><span class="s1">&#39;a&#39;</span><span class="p">:</span> <span class="mi">7</span><span class="p">,</span> <span class="s1">&#39;b&#39;</span><span class="p">:</span> <span class="mi">8</span><span class="p">},</span>
</span></span><span class="line"><span class="cl">    <span class="n">mode</span><span class="o">=</span><span class="n">kfp</span><span class="o">.</span><span class="n">dsl</span><span class="o">.</span><span class="n">PipelineExecutionMode</span><span class="o">.</span><span class="n">V2_COMPATIBLE</span><span class="p">,</span>
</span></span><span class="line"><span class="cl"><span class="p">)</span>
</span></span></code></pre></div><h2 id="current-caveats">Current Caveats</h2>
<p>Kubeflow Pipelines v2 compatible mode is currently in Beta stage. It is under active development and some features may not be complete. To find out its current caveats, refer to <a href="https://github.com/kubeflow/pipelines/issues/6133">v2 compatible mode &ndash; known caveats &amp; breaking changes #6133</a>.</p>

</div>



    
	
  
    
    
	
    

<div class="td-content" style="page-break-before: always">
    
	<h1 id="pg-71afab4db485174bd352d12f64e8e088">3.1.6.2 - Comparing Pipeline Runs</h1>
    <div class="lead">Using the KFPv2 Run Comparison page to compare parameters and metrics across pipeline runs</div>
	<h2 id="prerequisites">Prerequisites</h2>
<p>To compare pipeline runs, you need to first have at least two pipeline runs of the same version!
You can run your first pipeline by following the
<a href="/docs/components/pipelines/overview/quickstart">pipelines quickstart guide</a>.</p>
<p>This page will show the v2 UI, which allows you to compare the following visualization types:</p>
<ul>
<li>Scalar Metrics</li>
<li>Confusion Matrices</li>
<li>ROC Curves</li>
<li>HTML</li>
<li>Markdown</li>
</ul>
<h2 id="basic-layout">Basic Layout</h2>
<p>The KFPv2 Run Comparison page has three major sections:</p>
<ul>
<li>Run overview</li>
<li>Parameters</li>
<li>Metrics</li>
</ul>
<p><strong>KFPv2 Run Comparison Full Page</strong></p>
<p><img src="/docs/images/pipelines/v2/run-comparison/full-page.png" 
alt="KFPv2 Run Comparison Full Page"
class="mt-3 mb-3 p-3 border border-info rounded"></p>
<p>The Run overview section allows the user to view and select specific runs. Any changes to these
selections will automatically update the Parameters and Metrics sections accordingly. The &ldquo;Refresh&rdquo;
button at the top-right of the page will re-fetch the runs, and display any new run status or artifact
information on the page. In order to best use this page, we recommend that run names are
reasonably differentiated, preferably at the start of the run name.</p>
<p>The Parameters section consists of a table that shows the run parameters for each run, even if a run
has no parameters. These parameters are only shown if they are explicitely included in the pipeline
run (default parameters are not present). The new KFPv2 update allows different parameter types
(Double, Integer, String, Boolean, List, and Struct), and the format of the display allows users to
differentiate these data types.</p>
<p><strong>Run Parameters Compare Table</strong></p>
<p><img src="/docs/images/pipelines/v2/run-comparison/run-parameters.png" 
alt="Run Parameters Compare Table"
class="mt-3 mb-3 p-3 border border-info rounded"></p>
<p>The Metrics section has five different tabs, one for each visualization type. The below sections
will review each of these tabs.</p>
<h2 id="scalar-metrics">Scalar Metrics</h2>
<p>The Scalar Metrics tab compares scalar metrics across runs in table form. The top row of this table
groups the executions and artifacts into their runs. The second row shows each artifact via the
format <code>&lt;execution-name&gt;-&lt;artifact-name&gt;</code>, which allows each artifact to be uniquely differentiated.
If a run is not present, then that means it did not have any scalar metrics artifacts. The data is
then presented in the rows below.</p>
<p><em>Note:</em> In the case that an execution or artifact name cannot be found, it will display its
corresponding ID as a placeholder.</p>
<p><strong>Scalar Metrics Compare Table</strong></p>
<p><img src="/docs/images/pipelines/v2/run-comparison/scalar-metrics.png" 
alt="Scalar Metrics Compare Table"
class="mt-3 mb-3 p-3 border border-info rounded"></p>
<h2 id="confusion-matrix-html-and-markdown">Confusion Matrix, HTML, and Markdown</h2>
<p>The display for comparing Confusion Matrices, HTML, and Markdown all use a two-panel layout
to compare the data side-by-side. A specific artifact can be selected via the two-level dropdown;
the first level shows the list of runs with the specified artifact, and the second level shows
the list of selectable artifacts with the naming schema <code>&lt;execution-name&gt;-&lt;artifact-name&gt;</code>.
This dropdown is visible on the HTML tab below.</p>
<p><strong>Confusion Matrix Comparison</strong></p>
<p><img src="/docs/images/pipelines/v2/run-comparison/confusion-matrix.png" 
alt="Confusion Matrix Comparison"
class="mt-3 mb-3 p-3 border border-info rounded"></p>
<p><strong>HTML Comparison</strong></p>
<p><img src="/docs/images/pipelines/v2/run-comparison/html.png" 
alt="HTML Comparison"
class="mt-3 mb-3 p-3 border border-info rounded"></p>
<p><strong>Markdown Comparison</strong></p>
<p><img src="/docs/images/pipelines/v2/run-comparison/markdown.png" 
alt="Markdown Comparison"
class="mt-3 mb-3 p-3 border border-info rounded"></p>
<h2 id="roc-curve">ROC Curve</h2>
<p>The ROC Curve tab consists of two major components: an ROC Curve plot which displays all of the
selected artifacts, and the filter table which allows users to search for and select artifacts.
The plot limits selection up to 10 curves, after which you must de-select artifacts in order to
select more.</p>
<p>The user can hover over any &ldquo;Series&rdquo; item in the plot legend in order to highlight the curve; since
many curves may be identical, this will also bring the selected curve to the forefront. De-selecting
and re-selecting an artifact on the filter table will also bring that curve to the top of the plot.</p>
<p><strong>ROC Curve Plot</strong></p>
<p><img src="/docs/images/pipelines/v2/run-comparison/roc-curve-plot.png" 
alt="ROC Curve Plot"
class="mt-3 mb-3 p-3 border border-info rounded"></p>
<p>The ROC Curve filter table allows you to filter and select artifacts. The user can search by run
name or the combination of <code>[execution-name] &gt; [artifact-name]</code> (which is shown on the first column).
When you select a artifact, the table will assign it a color which you can then use to identify the
Series # and the line on the plot. If you select 10 artifacts while there are more artifacts
available, a warning will pop up indicating that you have reached the maximum number of selected
artifacts, and the remaining artifact checkbox selections will be disabled; this prevents the table
from becoming too cluttered.</p>
<p><strong>ROC Curve Filter Table</strong></p>
<p><img src="/docs/images/pipelines/v2/run-comparison/roc-curve-filter-table.png" 
alt="ROC Curve Filter Table"
class="mt-3 mb-3 p-3 border border-info rounded"></p>
<h2 id="conclusion">Conclusion</h2>
<p>The KFPv2 Run Comparison page allows users to perform faster analysis when comparing their runs
by comparing different visualization types across pipeline run artifacts.</p>
<h2 id="next-steps">Next Steps</h2>
<ul>
<li>Follow the full guide to experimenting with
<a href="/docs/components/pipelines/tutorials/build-pipeline/">the Kubeflow Pipelines samples</a>.</li>
</ul>

</div>



    
	
  
    
    
	
    

<div class="td-content" style="page-break-before: always">
    
	<h1 id="pg-f31ed082c64d3490d1377466dfdc3520">3.1.6.3 - Kubeflow Pipelines v2 Component I/O</h1>
    <div class="lead">Differences between artifacts and parameters, and how to migrate an existing pipeline to be v2 compatible.</div>
	<div class="alert alert-warning" role="alert">
  <h4 class="alert-heading">Beta</h4>
  This Kubeflow component has <b>beta</b> status. See the
  <a href="/docs/started/support/#application-status">Kubeflow versioning policies</a>.
  The Kubeflow team is interested in your   
  <a href="https://github.com/kubeflow/pipelines/issues">feedback</a></h4> 
  about the usability of the feature.
</div>
<h2 id="artifacts-and-parameters">Artifacts and Parameters</h2>
<p>The Kubeflow Pipelines SDK v2 makes a distinction between inputs and outputs that are <em>parameters</em> and those that are <em>artifacts</em>.</p>
<ul>
<li>
<p>Parameters represent values.
They are inputs or outputs of type <code>str</code>, <code>int</code>, <code>float</code>, <code>bool</code>, <code>dict</code>, or <code>list</code> that typically are used to change the behavior of a pipeline.
Parameters are stored in ML Metadata, thus you can query ML Metadata for the values of parameters.
Input parameters are always passed by value, which means that they are inserted into the command used to execute the component.</p>
</li>
<li>
<p>Artifacts represent references to objects&ndash;most commonly files&ndash;that are produced during pipeline executions.
Examples of artifacts include <code>Model</code>, <code>Datasets</code>, <code>Metrics</code>, and so on.
Regardless of the types of artifacts, all artifacts have a <code>name</code>, a <code>uri</code>, and optionally some <code>metadata</code>.
Most commonly, the <code>uri</code> of an artifact is a cloud storage URI such as a Google Cloud Storage URI, or an Amazon Web Services S3 URI.
The <code>name</code>, <code>uri</code>, and <code>metadata</code> of artifacts are stored in ML Metadata, but not the contents referenced by the <code>uri</code>.
Input artifacts are always passed by reference, i.e. the <code>uri</code> of an artifact or a JSON object containing the <code>name</code>, <code>uri</code>, and <code>metadata</code> of an artifact.</p>
</li>
</ul>
<p>Whether an input/output is a parameter or an artifact is decided by its type annotation. Inputs/outputs typed as <code>str</code>, <code>int</code>, <code>float</code>, <code>bool</code>, <code>dict</code>, or <code>list</code> are parameters, while everything else are artifacts. Kubeflow Pipelines SDK v2 defines a list of system artifact types including <code>Model</code>, <code>Dataset</code>, <code>Metrics</code>, <code>ClassificationMetrics</code>, <code>SlicedClassificationMetrics</code>, <code>HTML</code>, <code>Markdown</code>, and the generic <code>Artifact</code>. All unknown types including non-type are treated the same as the generic <code>Artifact</code> type.</p>
<p>Artifacts and parameters cannot be passed to each other. By default, when compiling a pipeline with option <code>type_check=True</code>, only inputs and outputs with the exact same type can be connected together with the exception that the generic <code>Artifact</code> type is compatible with any artifact types.</p>
<h2 id="migrating-from-v1-components">Migrating from v1 components</h2>
<h3 id="review-and-update-inputsoutputs-types">Review and update inputs/outputs types.</h3>
<p>In Kubeflow Pipelines SDK v1, type annotations for inputs/outputs are optional, and when there is no type annotation on an input/output, it is treated as compatible with any type, hence the input/output can be connected to any outputs/inputs regardless of their types. This is no longer the case in v2.
As mentioned above, type annotation in v2 is the sole decision factor on whether an input/output is an artifact or a parameter. Component authors should first decide the category for each input/output, and then explicitly type annotate them accordingly.</p>
<h3 id="review-and-update-inputsoutputs-placeholders-if-applicable">Review and update inputs/outputs placeholders if applicable.</h3>
<p>For components defined via YAML, inputs/outputs are referenced by placeholders in the container command line arguments.</p>
<p>In Kubeflow Pipelines SDK v1, there are three types of input/output placeholders:</p>
<ul>
<li>
<p><code>{inputValue: &lt;input-name&gt;}</code>:
This placeholder is replaced with the value of the specified input.
This is useful for small pieces of input data, such as numbers or small
strings.</p>
</li>
<li>
<p><code>{inputPath: &lt;input-name&gt;}</code>:
This placeholder is replaced with the path to this input as a file.
Your component can read the contents of that input at that path during
the pipeline run.</p>
</li>
<li>
<p><code>{outputPath: &lt;output-name&gt;}</code>:
This placeholder is replaced with the path where your program writes
this output&rsquo;s data. This lets the Kubeflow Pipelines system read the
contents of the file and store it as the value of the specified output.</p>
</li>
</ul>
<p>In Kubeflow Pipelines SDK v2, we introduced two additional input/output placeholders:</p>
<ul>
<li>
<p><code>{inputUri: &lt;input-name&gt;}</code>:
This placeholder is replaced with the URI to this input. In case the
URI is a cloud storage URI, Your component can read the contents of
that input through the corresponding cloud storage client during the
pipeline run.</p>
</li>
<li>
<p><code>{outputUri: &lt;output-name&gt;}</code>:
This placeholder is replaced with URI where your program writes this
output&rsquo;s data. This lets the Kubeflow Pipelines system read the contents
of the file and store it as the value of the specified output.</p>
</li>
</ul>
<p>For the five input/output placeholders, there are rules on which placeholders are valid for artifacts and which are valid for parameters. Specifically,</p>
<ul>
<li>
<p>Placeholders for parameters</p>
<ul>
<li>
<p>For input parameters, the valid placeholder is <code>{inputValue: &lt;input-name&gt;}</code>.</p>
</li>
<li>
<p>For output parameters, the valid placeholder is <code>{outputPath: &lt;output-name&gt;}</code>.</p>
</li>
</ul>
</li>
<li>
<p>Placeholders for artifacts</p>
<ul>
<li>
<p>For input artifacts, the valid placeholders are <code>{inputPath: &lt;input-name&gt;}</code>
and <code>{inputUri: &lt;input-name&gt;}</code>.</p>
</li>
<li>
<p>For output artifacts, the only valid placeholders are <code>{outputPath: &lt;output-name&gt;}</code>
and <code>{outputUri: &lt;output-name&gt;}</code>.</p>
</li>
</ul>
</li>
</ul>
<p>Misuse of input/output placeholders results in compilation errors. When there is a type-placeholder mismatch error, most often it is due to the input/output is mis-typed. You should review if the input/output
is meant to be a parameter or an artifact and type it accordingly. In case when the type is intended, you need to update the placeholder for the input/output. Changing input/output placeholders often requires
updating the code of the component as well. For instance, changing from <code>{inputValue: &lt;input-name&gt;}</code> to <code>{inputPath: &lt;input_name&gt;}</code> means your component code will not receive the actual value of the input but a file path where the value is in the file. In this case, a file read logic should be added to the component code.</p>
<h3 id="use-v2-component-decorator-for-python-function-based-components">Use v2 <code>@component</code> decorator for Python function-based components.</h3>
<p>For Python function-based components created via <code>create_component_from_func</code> or <code>func_to_container_op</code>, we recommend migrating to using the new <code>@component</code> decorator available from <code>kfp.v2.dsl</code> package.</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-python" data-lang="python"><span class="line"><span class="cl"><span class="kn">from</span> <span class="nn">kfp.v2.dsl</span> <span class="kn">import</span> <span class="n">component</span><span class="p">,</span> <span class="n">Input</span><span class="p">,</span> <span class="n">Output</span><span class="p">,</span> <span class="n">OutputPath</span><span class="p">,</span> <span class="n">Dataset</span><span class="p">,</span> <span class="n">Model</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="nd">@component</span>
</span></span><span class="line"><span class="cl"><span class="k">def</span> <span class="nf">train</span><span class="p">(</span>
</span></span><span class="line"><span class="cl">    <span class="c1"># Use Input[T] to get a metadata-rich handle to the input artifact of type `Dataset`.</span>
</span></span><span class="line"><span class="cl">    <span class="n">dataset</span><span class="p">:</span> <span class="n">Input</span><span class="p">[</span><span class="n">Dataset</span><span class="p">],</span>
</span></span><span class="line"><span class="cl">    <span class="c1"># Use Output[T] to get a metadata-rich handle to the output artifact of type `Dataset`.</span>
</span></span><span class="line"><span class="cl">    <span class="n">model</span><span class="p">:</span> <span class="n">Output</span><span class="p">[</span><span class="n">Model</span><span class="p">],</span>
</span></span><span class="line"><span class="cl">    <span class="c1"># An input parameter of type int.</span>
</span></span><span class="line"><span class="cl">    <span class="n">num_steps</span><span class="p">:</span> <span class="nb">int</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">    <span class="c1"># An output parameter of type str.</span>
</span></span><span class="line"><span class="cl">    <span class="n">output_message_path</span><span class="p">:</span> <span class="n">OutputPath</span><span class="p">(</span><span class="nb">str</span><span class="p">),</span>
</span></span><span class="line"><span class="cl"><span class="p">):</span>
</span></span><span class="line"><span class="cl">    <span class="s2">&#34;&#34;&#34;Dummy Training step.&#34;&#34;&#34;</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">    <span class="k">with</span> <span class="nb">open</span><span class="p">(</span><span class="n">dataset</span><span class="o">.</span><span class="n">path</span><span class="p">,</span> <span class="s1">&#39;r&#39;</span><span class="p">)</span> <span class="k">as</span> <span class="n">input_file</span><span class="p">:</span>
</span></span><span class="line"><span class="cl">        <span class="n">dataset_contents</span> <span class="o">=</span> <span class="n">input_file</span><span class="o">.</span><span class="n">read</span><span class="p">()</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">    <span class="k">with</span> <span class="nb">open</span><span class="p">(</span><span class="n">model</span><span class="o">.</span><span class="n">path</span><span class="p">,</span> <span class="s1">&#39;w&#39;</span><span class="p">)</span> <span class="k">as</span> <span class="n">output_file</span><span class="p">:</span>
</span></span><span class="line"><span class="cl">        <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">num_steps</span><span class="p">):</span>
</span></span><span class="line"><span class="cl">            <span class="n">output_file</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;Step </span><span class="si">{</span><span class="n">i</span><span class="si">}</span><span class="se">\n</span><span class="s1">=====</span><span class="se">\n</span><span class="s1">&#39;</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">    <span class="c1"># Model artifact has a `.metadata` dictionary</span>
</span></span><span class="line"><span class="cl">    <span class="c1"># to store arbitrary metadata for the output artifact.</span>
</span></span><span class="line"><span class="cl">    <span class="n">model</span><span class="o">.</span><span class="n">metadata</span><span class="p">[</span><span class="s1">&#39;accuracy&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="mf">0.9</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">    <span class="k">with</span> <span class="nb">open</span><span class="p">(</span><span class="n">output_message_path</span><span class="p">,</span> <span class="s1">&#39;w&#39;</span><span class="p">)</span> <span class="k">as</span> <span class="n">output_file</span><span class="p">:</span>
</span></span><span class="line"><span class="cl">        <span class="n">output_file</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s1">&#39;Model trained successfully.&#39;</span><span class="p">)</span>
</span></span></code></pre></div><p>Using v2 <code>@component</code> decorator, input and output artifacts should be annotated with <code>Input[T]</code> and <code>Output[T]</code>, respectively. And <code>T</code> is the class <a href="https://github.com/kubeflow/pipelines/blob/7875b68654a69ca761cb0ba4a920a30925a0e94b/sdk/python/kfp/v2/components/types/artifact_types.py#L27"><code>Artifact</code></a> or a subclass of it. You can access the properties and methods defined for the specific artifact class, such as <code>dataset.path</code> or <code>model.metadata</code> as shown in the above example.</p>
<p>Note that <code>Input[T]</code> and <code>Output[T]</code> should not be applied on input/output parameters. Input parameters need to be type annotated using one of the parameter types mentioned earlier. Output parameters should be type annotated with <code>OutputPath(T)</code> or via the function return type, just like how it can be specified in v1 lightweight function components.</p>

</div>



    
	
  
    
    
	
    

<div class="td-content" style="page-break-before: always">
    
	<h1 id="pg-3dcf3dde7fbe3043d83871453e9b58d7">3.1.6.4 - Build a Pipeline</h1>
    <div class="lead">A tutorial on using Pipelines SDK v2 to orchestrate your ML workflow as a pipeline</div>
	<!--
AUTOGENERATED FROM content/en/docs/components/pipelines/sdk-v2/build-pipeline.ipynb
PLEASE UPDATE THE JUPYTER NOTEBOOK AND REGENERATE THIS FILE USING scripts/nb_to_md.py.-->
<style>
.notebook-links {display: flex; margin: 1em 0;}
.notebook-links a {padding: .75em; margin-right: .75em; font-weight: bold;}
a.colab-link {
padding-left: 3.25em;
background-image: url(/docs/images/logos/colab.ico);
background-repeat: no-repeat;
background-size: contain;
}
a.github-link {
padding-left: 2.75em;
background-image: url(/docs/images/logos/github.png);
background-repeat: no-repeat;
background-size: auto 75%;
background-position: left center;
}
</style>
<div class="notebook-links">
<a class="colab-link" href="https://colab.research.google.com/github/kubeflow/website/blob/master/content/en/docs/components/pipelines/sdk-v2/build-pipeline.ipynb">Run in Google Colab</a>
<a class="github-link" href="https://github.com/kubeflow/website/blob/master/content/en/docs/components/pipelines/sdk-v2/build-pipeline.ipynb">View source on GitHub</a>
</div>
<p>A Kubeflow pipeline is a portable and scalable definition of a machine learning
(ML) workflow. Each step in your ML workflow, such as preparing data or
training a model, is an instance of a pipeline component. This document
provides an overview of pipeline concepts and best practices, and instructions
describing how to build an ML pipeline.</p>
<p><strong>Note:</strong> This guide demonstrates how to build pipelines using the Pipelines SDK v2.
Currently, Kubeflow Pipelines v2 is in development. You can use this guide to start
building and running pipelines that are compatible with the Pipelines SDK v2.</p>
<p><a href="https://www.kubeflow.org/docs/components/pipelines/sdk-v2/v2-compatibility">Learn more about Pipelines SDK v2</a>.</p>
<h2 id="before-you-begin">Before you begin</h2>
<ol>
<li>Run the following command to install the Kubeflow Pipelines SDK v1.6.2 or higher.
If you run this command in a Jupyter notebook, restart the kernel after
installing the SDK.</li>
</ol>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-python" data-lang="python"><span class="line"><span class="cl"><span class="err">$</span> <span class="n">pip</span> <span class="n">install</span> <span class="o">--</span><span class="n">upgrade</span> <span class="n">kfp</span>
</span></span></code></pre></div><ol start="2">
<li>Import the <code>kfp</code> packages.</li>
</ol>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-python" data-lang="python"><span class="line"><span class="cl"><span class="kn">import</span> <span class="nn">kfp</span>
</span></span><span class="line"><span class="cl"><span class="kn">from</span> <span class="nn">kfp.v2</span> <span class="kn">import</span> <span class="n">dsl</span>
</span></span><span class="line"><span class="cl"><span class="kn">from</span> <span class="nn">kfp.v2.dsl</span> <span class="kn">import</span> <span class="n">component</span>
</span></span><span class="line"><span class="cl"><span class="kn">from</span> <span class="nn">kfp.v2.dsl</span> <span class="kn">import</span> <span class="p">(</span>
</span></span><span class="line"><span class="cl">    <span class="n">Input</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">    <span class="n">Output</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">    <span class="n">Artifact</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">    <span class="n">Dataset</span><span class="p">,</span>
</span></span><span class="line"><span class="cl"><span class="p">)</span>
</span></span></code></pre></div><h2 id="understanding-pipelines">Understanding pipelines</h2>
<p>A Kubeflow pipeline is a portable and scalable definition of an ML workflow,
based on containers. A pipeline is composed of a set of input parameters and a
list of the steps in this workflow. Each step in a pipeline is an instance of a
component, which is represented as an instance of
<a href="https://kubeflow-pipelines.readthedocs.io/en/latest/source/kfp.dsl.html#kfp.dsl.ContainerOp"><code>ContainerOp</code></a>.</p>
<p>You can use pipelines to:</p>
<ul>
<li>Orchestrate repeatable ML workflows.</li>
<li>Accelerate experimentation by running a workflow with different sets of
hyperparameters.</li>
</ul>
<h3 id="understanding-pipeline-components">Understanding pipeline components</h3>
<p>A pipeline component is a containerized application that performs one step in a
pipeline&rsquo;s workflow. Pipeline components are defined in
<a href="https://www.kubeflow.org/docs/components/pipelines/reference/component-spec/">component specifications</a>, which define the following:</p>
<ul>
<li>The component&rsquo;s interface, its inputs and outputs.</li>
<li>The component&rsquo;s implementation, the container image and the command to
execute.</li>
<li>The component&rsquo;s metadata, such as the name and description of the
component.</li>
</ul>
<p>You can build components by <a href="https://www.kubeflow.org/docs/components/pipelines/sdk-v2/component-development/">defining a component specification for a
containerized application</a>, or you can <a href="https://www.kubeflow.org/docs/components/pipelines/sdk-v2/python-function-components/">use the Kubeflow
Pipelines SDK to generate a component specification for a Python
function</a>. You can also <a href="https://www.kubeflow.org/docs/examples/shared-resources/">reuse prebuilt components
in your pipeline</a>.</p>
<h3 id="understanding-the-pipeline-graph">Understanding the pipeline graph</h3>
<p>Each step in your pipeline&rsquo;s workflow is an instance of a component. When
you define your pipeline, you specify the source of each step&rsquo;s inputs. Step
inputs can be set from the pipeline&rsquo;s input arguments, constants, or step
inputs can depend on the outputs of other steps in this pipeline. Kubeflow
Pipelines uses these dependencies to define your pipeline&rsquo;s workflow as
a graph.</p>
<p>For example, consider a pipeline with the following steps: ingest data,
generate statistics, preprocess data, and train a model. The following
describes the data dependencies between each step.</p>
<ul>
<li><strong>Ingest data</strong>: This step loads data from an external source which is
specified using a pipeline argument, and it outputs a dataset. Since
this step does not depend on the output of any other steps, this step
can run first.</li>
<li><strong>Generate statistics</strong>: This step uses the ingested dataset to generate
and output a set of statistics. Since this step depends on the dataset
produced by the ingest data step, it must run after the ingest data step.</li>
<li><strong>Preprocess data</strong>: This step preprocesses the ingested dataset and
transforms the data into a preprocessed dataset. Since this step depends
on the dataset produced by the ingest data step, it must run after the
ingest data step.</li>
<li><strong>Train a model</strong>: This step trains a model using the preprocessed dataset,
the generated statistics, and pipeline parameters, such as the learning
rate. Since this step depends on the preprocessed data and the generated
statistics, it must run after both the preprocess data and generate
statistics steps are complete.</li>
</ul>
<p>Since the generate statistics and preprocess data steps both depend on the
ingested data, the generate statistics and preprocess data steps can run in
parallel. All other steps are executed once their data dependencies are
available.</p>
<h2 id="designing-your-pipeline">Designing your pipeline</h2>
<p>When designing your pipeline, think about how to split your ML workflow into
pipeline components. The process of splitting an ML workflow into pipeline
components is similar to the process of splitting a monolithic script into
testable functions. The following rules can help you define the components
that you need to build your pipeline.</p>
<ul>
<li>
<p>Components should have a single responsibility. Having a single
responsibility makes it easier to test and reuse a component. For example,
if you have a component that loads data you can reuse that for similar
tasks that load data. If you have a component that loads and transforms
a dataset, the component can be less useful since you can use it only when
you need to load and transform that dataset.</p>
</li>
<li>
<p>Reuse components when possible. Kubeflow Pipelines provides <a href="https://www.kubeflow.org/docs/examples/shared-resources/">components for
common pipeline tasks and for access to cloud
services</a>.</p>
<p>Note: Not all prebuilt components are compatible with Pipelines SDK v2.
For example, you might need to update the type hints for component inputs
and outputs.</p>
</li>
<li>
<p>Consider what you need to know to debug your pipeline and research the
lineage of the models that your pipeline produces. Kubeflow Pipelines
stores the inputs and outputs of each pipeline step. By interrogating the
artifacts produced by a pipeline run, you can better understand the
variations in model quality between runs or track down bugs in your
workflow.</p>
</li>
</ul>
<p>In general, you should design your components with composability in mind.</p>
<p>Pipelines are composed of component instances, also called steps. Steps can
define their inputs as depending on the output of another step. The
dependencies between steps define the pipeline workflow graph.</p>
<h3 id="building-pipeline-components">Building pipeline components</h3>
<p>Kubeflow pipeline components are containerized applications that perform a
step in your ML workflow. Here are the ways that you can define pipeline
components:</p>
<ul>
<li>
<p>If you have a containerized application that you want to use as a
pipeline component, create a component specification to define this
container image as a pipeline component.</p>
<p>This option provides the flexibility to include code written in any
language in your pipeline, so long as you can package the application
as a container image. Learn more about <a href="https://www.kubeflow.org/docs/components/pipelines/sdk-v2/component-development/">building pipeline
components</a>.</p>
</li>
<li>
<p>If your component code can be expressed as a Python function, <a href="https://www.kubeflow.org/docs/components/pipelines/sdk-v2/python-function-components/">evaluate if
your component can be built as a Python function-based
component</a>. The Kubeflow Pipelines SDK makes it
easier to build lightweight Python function-based components by saving you
the effort of creating a component specification.</p>
</li>
</ul>
<p>Whenever possible, <a href="https://www.kubeflow.org/docs/examples/shared-resources/">reuse prebuilt components</a> to save
yourself the effort of building custom components.</p>
<p>The example in this guide demonstrates how to build a pipeline that uses a
Python function-based component and reuses a prebuilt component.</p>
<h3 id="understanding-how-data-is-passed-between-components">Understanding how data is passed between components</h3>
<p>When Kubeflow Pipelines runs a component, a container image is started in a
Kubernetes Pod and your components inputs are passed in as command-line
arguments. When your component has finished, the component&rsquo;s outputs are
returned as files.</p>
<p>In your component&rsquo;s specification, you define the components inputs and outputs
and how the inputs and output paths are passed to your program as command-line
arguments.</p>
<p>Component inputs and outputs are classified as either <em>parameters</em> or <em>artifacts</em>,
depending on their data type.</p>
<ul>
<li>
<p>Parameters typically represent settings that affect the behavior of your pipeline.
Parameters are passed into your component by value, and can be of any of
the following types: <code>int</code>, <code>double</code>, <code>float</code>, or <code>str</code>. Since parameters are
passed by value, the quantity of data passed in a parameter must be appropriate
to pass as a command-line argument.</p>
</li>
<li>
<p>Artifacts represent large or complex data structures like datasets or models, and
are passed into components as a reference to a file path.</p>
<p>If you have large amounts of string data to pass to your component, such as a JSON
file, annotate that input or output as a type of <a href="https://github.com/kubeflow/pipelines/blob/sdk/release-1.8/sdk/python/kfp/dsl/io_types.py"><code>Artifact</code></a>, such
as <a href="https://github.com/kubeflow/pipelines/blob/sdk/release-1.8/sdk/python/kfp/dsl/io_types.py"><code>Dataset</code></a>, to let Kubeflow Pipelines know to pass this to
your component as a file.</p>
<p>In addition to the artifacts data, you can also read and write the artifact&rsquo;s
metadata. For output artifacts, you can record metadata as key-value pairs, such
as the accuracy of a trained model. For input artifacts, you can read the
artifact&rsquo;s metadata  for example, you could use metadata to decide if a
model is accurate enough to deploy for predictions.</p>
</li>
</ul>
<p>All outputs are returned as files, using the the paths that Kubeflow Pipelines
provides.</p>
<p>Python function-based components make it easier to build pipeline components
by building the component specification for you. Python function-based
components also handle the complexity of passing inputs into your component
and passing your functions outputs back to your pipeline.</p>
<p>Learn more about how <a href="https://www.kubeflow.org/docs/components/pipelines/sdk-v2/python-function-components/#understanding-how-data-is-passed-between-components">Python function-based components handle inputs and
outputs</a>.</p>
<h2 id="getting-started-building-a-pipeline">Getting started building a pipeline</h2>
<p>The following sections demonstrate how to get started building a Kubeflow
pipeline by walking through the process of converting a Python script into
a pipeline.</p>
<h3 id="design-your-pipeline">Design your pipeline</h3>
<p>The following steps walk through some of the design decisions you may face
when designing a pipeline.</p>
<ol>
<li>Evaluate the process. In the following example, a Python function downloads
a zipped tar file (<code>.tar.gz</code>) that contains several CSV files, from a
public website. The function extracts the CSV files and then merges them
into a single file.</li>
</ol>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-python" data-lang="python"><span class="line"><span class="cl"><span class="kn">import</span> <span class="nn">glob</span>
</span></span><span class="line"><span class="cl"><span class="kn">import</span> <span class="nn">pandas</span> <span class="k">as</span> <span class="nn">pd</span>
</span></span><span class="line"><span class="cl"><span class="kn">import</span> <span class="nn">tarfile</span>
</span></span><span class="line"><span class="cl"><span class="kn">import</span> <span class="nn">urllib.request</span>
</span></span><span class="line"><span class="cl">    
</span></span><span class="line"><span class="cl"><span class="k">def</span> <span class="nf">download_and_merge_csv</span><span class="p">(</span><span class="n">url</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span> <span class="n">output_csv</span><span class="p">:</span> <span class="nb">str</span><span class="p">):</span>
</span></span><span class="line"><span class="cl">  <span class="k">with</span> <span class="n">urllib</span><span class="o">.</span><span class="n">request</span><span class="o">.</span><span class="n">urlopen</span><span class="p">(</span><span class="n">url</span><span class="p">)</span> <span class="k">as</span> <span class="n">res</span><span class="p">:</span>
</span></span><span class="line"><span class="cl">    <span class="n">tarfile</span><span class="o">.</span><span class="n">open</span><span class="p">(</span><span class="n">fileobj</span><span class="o">=</span><span class="n">res</span><span class="p">,</span> <span class="n">mode</span><span class="o">=</span><span class="s2">&#34;r|gz&#34;</span><span class="p">)</span><span class="o">.</span><span class="n">extractall</span><span class="p">(</span><span class="s1">&#39;data&#39;</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">  <span class="n">df</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">concat</span><span class="p">(</span>
</span></span><span class="line"><span class="cl">      <span class="p">[</span><span class="n">pd</span><span class="o">.</span><span class="n">read_csv</span><span class="p">(</span><span class="n">csv_file</span><span class="p">,</span> <span class="n">header</span><span class="o">=</span><span class="kc">None</span><span class="p">)</span> 
</span></span><span class="line"><span class="cl">       <span class="k">for</span> <span class="n">csv_file</span> <span class="ow">in</span> <span class="n">glob</span><span class="o">.</span><span class="n">glob</span><span class="p">(</span><span class="s1">&#39;data/*.csv&#39;</span><span class="p">)])</span>
</span></span><span class="line"><span class="cl">  <span class="n">df</span><span class="o">.</span><span class="n">to_csv</span><span class="p">(</span><span class="n">output_csv</span><span class="p">,</span> <span class="n">index</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">header</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
</span></span></code></pre></div><ol start="2">
<li>Run the following Python command to test the function.</li>
</ol>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-python" data-lang="python"><span class="line"><span class="cl"><span class="n">download_and_merge_csv</span><span class="p">(</span>
</span></span><span class="line"><span class="cl">    <span class="n">url</span><span class="o">=</span><span class="s1">&#39;https://storage.googleapis.com/ml-pipeline-playground/iris-csv-files.tar.gz&#39;</span><span class="p">,</span> 
</span></span><span class="line"><span class="cl">    <span class="n">output_csv</span><span class="o">=</span><span class="s1">&#39;merged_data.csv&#39;</span><span class="p">)</span>
</span></span></code></pre></div><ol start="3">
<li>Run the following to print the first few rows of the
merged CSV file.</li>
</ol>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-python" data-lang="python"><span class="line"><span class="cl"><span class="err">$</span> <span class="n">head</span> <span class="n">merged_data</span><span class="o">.</span><span class="n">csv</span>
</span></span></code></pre></div><ol start="4">
<li>
<p>Design your pipeline. For example, consider the following pipeline designs.</p>
<ul>
<li>
<p>Implement the pipeline using a single step. In this case, the pipeline
contains one component that works similarly to the example function.
This is a straightforward function, and implementing a single-step
pipeline is a reasonable approach in this case.</p>
<p>The down side of this approach is that the zipped tar file would not be
an artifact of your pipeline runs. Not having this artifact available
could make it harder to debug this component in production.</p>
</li>
<li>
<p>Implement this as a two-step pipeline. The first step downloads a file
from a website. The second step extracts the CSV files from a zipped
tar file and merges them into a single file.</p>
<p>This approach has a few benefits:</p>
<ul>
<li>You can reuse the <a href="https://github.com/kubeflow/pipelines/blob/sdk/release-1.8/components/web/Download/component.yaml">Web Download component</a>
to implement the first step.</li>
<li>Each step has a single responsibility, which makes the components
easier to reuse.</li>
<li>The zipped tar file is an artifact of the first pipeline step.
This means that you can examine this artifact when debugging
pipelines that use this component.</li>
</ul>
</li>
</ul>
<p>This example implements a two-step pipeline.</p>
</li>
</ol>
<h3 id="build-your-pipeline-components">Build your pipeline components</h3>
<p>Build your pipeline components. This example modifies the initial script to
extract the contents of a zipped tar file, merge the CSV files that were
contained in the zipped tar file, and return the merged CSV file.</p>
<p>This example builds a Python function-based component. You can also package
your component&rsquo;s code as a Docker container image and define the component
using a ComponentSpec.</p>
<p>In this case, the following modifications were required to the original
function.</p>
<ul>
<li>
<p>The file download logic was removed. The path to the zipped tar file
is passed to this function as the <code>tar_data</code> argument.</p>
</li>
<li>
<p>The import statements were moved inside of the function. Python
function-based components require standalone Python functions. This
means that any required import statements must be defined within the
function, and any helper functions must be defined within the function.</p>
</li>
<li>
<p>The function&rsquo;s arguments are annotated as an <a href="https://github.com/kubeflow/pipelines/blob/sdk/release-1.8/sdk/python/kfp/dsl/io_types.py"><code>kfp.dsl.Input</code></a>
or <a href="https://github.com/kubeflow/pipelines/blob/sdk/release-1.8/sdk/python/kfp/dsl/io_types.py"><code>kfp.dsl.Output</code></a> artifact. These annotations let Kubeflow
Pipelines know to provide the path to the zipped tar file and to
create a path where your function stores the merged CSV file.</p>
</li>
<li>
<p>The function is decorated with the <a href="https://github.com/kubeflow/pipelines/blob/sdk/release-1.8/sdk/python/kfp/dsl/_component.py"><code>kfp.dsl.component</code></a>
annotation. You can also use this annotation to define the following:</p>
<ul>
<li>The container image that your function runs in.</li>
<li>Any PyPI packages that this function depends on, that are not already
installed on the container image.</li>
<li>The location to save the component specification to. You can use the
component specification to share this component with your colleagues.</li>
</ul>
<p>This annotation converts your function into a factory function that
creates pipeline steps. These pipeline steps execute the function you
defined as a part of a pipeline&rsquo;s workflow.</p>
</li>
</ul>
<p>Learn more about <a href="https://www.kubeflow.org/docs/components/pipelines/sdk-v2/python-function-components/">building Python function-based components</a>.</p>
<p>The following example shows the updated <code>merge_csv</code> function.</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-python" data-lang="python"><span class="line"><span class="cl"><span class="nd">@component</span><span class="p">(</span>
</span></span><span class="line"><span class="cl">    <span class="n">packages_to_install</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;pandas==1.1.4&#39;</span><span class="p">],</span>
</span></span><span class="line"><span class="cl">    <span class="n">output_component_file</span><span class="o">=</span><span class="s1">&#39;component.yaml&#39;</span>
</span></span><span class="line"><span class="cl"><span class="p">)</span>
</span></span><span class="line"><span class="cl"><span class="k">def</span> <span class="nf">merge_csv</span><span class="p">(</span><span class="n">tar_data</span><span class="p">:</span> <span class="n">Input</span><span class="p">[</span><span class="n">Artifact</span><span class="p">],</span> <span class="n">output_csv</span><span class="p">:</span> <span class="n">Output</span><span class="p">[</span><span class="n">Dataset</span><span class="p">]):</span>
</span></span><span class="line"><span class="cl">  <span class="kn">import</span> <span class="nn">glob</span>
</span></span><span class="line"><span class="cl">  <span class="kn">import</span> <span class="nn">pandas</span> <span class="k">as</span> <span class="nn">pd</span>
</span></span><span class="line"><span class="cl">  <span class="kn">import</span> <span class="nn">tarfile</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">  <span class="n">tarfile</span><span class="o">.</span><span class="n">open</span><span class="p">(</span><span class="n">name</span><span class="o">=</span><span class="n">tar_data</span><span class="o">.</span><span class="n">path</span><span class="p">,</span> <span class="n">mode</span><span class="o">=</span><span class="s2">&#34;r|gz&#34;</span><span class="p">)</span><span class="o">.</span><span class="n">extractall</span><span class="p">(</span><span class="s1">&#39;data&#39;</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">  <span class="n">df</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">concat</span><span class="p">(</span>
</span></span><span class="line"><span class="cl">      <span class="p">[</span><span class="n">pd</span><span class="o">.</span><span class="n">read_csv</span><span class="p">(</span><span class="n">csv_file</span><span class="p">,</span> <span class="n">header</span><span class="o">=</span><span class="kc">None</span><span class="p">)</span> 
</span></span><span class="line"><span class="cl">       <span class="k">for</span> <span class="n">csv_file</span> <span class="ow">in</span> <span class="n">glob</span><span class="o">.</span><span class="n">glob</span><span class="p">(</span><span class="s1">&#39;data/*.csv&#39;</span><span class="p">)])</span>
</span></span><span class="line"><span class="cl">  <span class="n">df</span><span class="o">.</span><span class="n">to_csv</span><span class="p">(</span><span class="n">output_csv</span><span class="o">.</span><span class="n">path</span><span class="p">,</span> <span class="n">index</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">header</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
</span></span></code></pre></div><h3 id="build-your-pipeline">Build your pipeline</h3>
<ol>
<li>Use <a href="https://kubeflow-pipelines.readthedocs.io/en/latest/source/kfp.components.html?highlight=load_component_from_url#kfp.components.load_component_from_url"><code>kfp.components.load_component_from_url</code></a>
to load the component specification YAML for any components that you are
reusing in this pipeline.</li>
</ol>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-python" data-lang="python"><span class="line"><span class="cl"><span class="n">web_downloader_op</span> <span class="o">=</span> <span class="n">kfp</span><span class="o">.</span><span class="n">components</span><span class="o">.</span><span class="n">load_component_from_url</span><span class="p">(</span>
</span></span><span class="line"><span class="cl">    <span class="s1">&#39;https://raw.githubusercontent.com/kubeflow/pipelines/master/components/web/Download/component-sdk-v2.yaml&#39;</span><span class="p">)</span>
</span></span></code></pre></div><ol start="2">
<li>
<p>Define your pipeline as a Python function.</p>
<p>Your pipeline function&rsquo;s arguments define your pipeline&rsquo;s parameters. Use
pipeline parameters to experiment with different hyperparameters, such as
the learning rate used to train a model, or pass run-level inputs, such as
the path to an input file, into a pipeline run. The data type must be
specified for all pipeline parameters.</p>
<p>Use the factory functions created by
the <code>kfp.dsl.component</code> annotation and the
<code>kfp.components.load_component_from_url</code> function to create your pipeline&rsquo;s tasks.
The inputs to the component factory functions can be pipeline parameters,
the outputs of other tasks, or a constant value. In this case, the
<code>web_downloader_task</code> task uses the <code>url</code> pipeline parameter, and the
<code>merge_csv_task</code> uses the <code>data</code> output of the <code>web_downloader_task</code>.</p>
<p>The <code>kfp.dsl.pipeline</code> annotation lets you specify the following:</p>
<ul>
<li><code>name</code>: The pipeline&rsquo;s name.</li>
<li><code>description</code>: (Optional.) A description of the pipeline&rsquo;s workflow.</li>
<li><code>pipeline_root</code>: The default path where your pipeline&rsquo;s artifacts are
stored. This must be a path that your pipeline can read and write to,
such as a Persistent Volume Claim or a cloud service such as Google
Cloud Storage.</li>
</ul>
</li>
</ol>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-python" data-lang="python"><span class="line"><span class="cl"><span class="c1"># Define a pipeline and create a task from a component:</span>
</span></span><span class="line"><span class="cl"><span class="nd">@dsl</span><span class="o">.</span><span class="n">pipeline</span><span class="p">(</span>
</span></span><span class="line"><span class="cl">    <span class="n">name</span><span class="o">=</span><span class="s1">&#39;my-pipeline&#39;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">    <span class="c1"># You can optionally specify your own pipeline_root</span>
</span></span><span class="line"><span class="cl">    <span class="c1"># pipeline_root=&#39;gs://my-pipeline-root/example-pipeline&#39;,</span>
</span></span><span class="line"><span class="cl"><span class="p">)</span>
</span></span><span class="line"><span class="cl"><span class="k">def</span> <span class="nf">my_pipeline</span><span class="p">(</span><span class="n">url</span><span class="p">:</span> <span class="nb">str</span><span class="p">):</span>
</span></span><span class="line"><span class="cl">  <span class="n">web_downloader_task</span> <span class="o">=</span> <span class="n">web_downloader_op</span><span class="p">(</span><span class="n">url</span><span class="o">=</span><span class="n">url</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">  <span class="n">merge_csv_task</span> <span class="o">=</span> <span class="n">merge_csv</span><span class="p">(</span><span class="n">tar_data</span><span class="o">=</span><span class="n">web_downloader_task</span><span class="o">.</span><span class="n">outputs</span><span class="p">[</span><span class="s1">&#39;data&#39;</span><span class="p">])</span>
</span></span><span class="line"><span class="cl">  <span class="c1"># The outputs of the merge_csv_task can be referenced using the</span>
</span></span><span class="line"><span class="cl">  <span class="c1"># merge_csv_task.outputs dictionary: merge_csv_task.outputs[&#39;output_csv&#39;]</span>
</span></span></code></pre></div><h3 id="compile-and-run-your-pipeline">Compile and run your pipeline</h3>
<p>After defining the pipeline in Python as described in the preceding section, use one of the following options to compile the pipeline and submit it to the Kubeflow Pipelines service.</p>
<h4 id="option-1-compile-and-then-upload-in-ui">Option 1: Compile and then upload in UI</h4>
<ol>
<li>Run the following to compile your pipeline and save it as <code>pipeline.yaml</code>.</li>
</ol>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-python" data-lang="python"><span class="line"><span class="cl"><span class="n">kfp</span><span class="o">.</span><span class="n">compiler</span><span class="o">.</span><span class="n">Compiler</span><span class="p">(</span><span class="n">mode</span><span class="o">=</span><span class="n">kfp</span><span class="o">.</span><span class="n">dsl</span><span class="o">.</span><span class="n">PipelineExecutionMode</span><span class="o">.</span><span class="n">V2_COMPATIBLE</span><span class="p">)</span><span class="o">.</span><span class="n">compile</span><span class="p">(</span>
</span></span><span class="line"><span class="cl">    <span class="n">pipeline_func</span><span class="o">=</span><span class="n">my_pipeline</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">    <span class="n">package_path</span><span class="o">=</span><span class="s1">&#39;pipeline.yaml&#39;</span><span class="p">)</span>
</span></span></code></pre></div><ol start="2">
<li>Upload and run your <code>pipeline.yaml</code> using the Kubeflow Pipelines user interface.
See the guide to <a href="https://www.kubeflow.org/docs/components/pipelines/overview/quickstart">getting started with the UI</a>.</li>
</ol>
<h4 id="option-2-run-the-pipeline-using-kubeflow-pipelines-sdk-client">Option 2: run the pipeline using Kubeflow Pipelines SDK client</h4>
<ol>
<li>Create an instance of the <a href="https://kubeflow-pipelines.readthedocs.io/en/latest/source/kfp.client.html#kfp.Client"><code>kfp.Client</code> class</a> following steps in <a href="https://www.kubeflow.org/docs/components/pipelines/sdk/connect-api">connecting to Kubeflow Pipelines using the SDK client</a>.</li>
</ol>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-python" data-lang="python"><span class="line"><span class="cl"><span class="n">client</span> <span class="o">=</span> <span class="n">kfp</span><span class="o">.</span><span class="n">Client</span><span class="p">()</span> <span class="c1"># change arguments accordingly</span>
</span></span></code></pre></div><ol start="2">
<li>Run the pipeline using the <code>kfp.Client</code> instance:</li>
</ol>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-python" data-lang="python"><span class="line"><span class="cl"><span class="n">client</span><span class="o">.</span><span class="n">create_run_from_pipeline_func</span><span class="p">(</span>
</span></span><span class="line"><span class="cl">    <span class="n">my_pipeline</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">    <span class="n">mode</span><span class="o">=</span><span class="n">kfp</span><span class="o">.</span><span class="n">dsl</span><span class="o">.</span><span class="n">PipelineExecutionMode</span><span class="o">.</span><span class="n">V2_COMPATIBLE</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">    <span class="c1"># You can optionally override your pipeline_root when submitting the run too:</span>
</span></span><span class="line"><span class="cl">    <span class="c1"># pipeline_root=&#39;gs://my-pipeline-root/example-pipeline&#39;,</span>
</span></span><span class="line"><span class="cl">    <span class="n">arguments</span><span class="o">=</span><span class="p">{</span>
</span></span><span class="line"><span class="cl">        <span class="s1">&#39;url&#39;</span><span class="p">:</span> <span class="s1">&#39;https://storage.googleapis.com/ml-pipeline-playground/iris-csv-files.tar.gz&#39;</span>
</span></span><span class="line"><span class="cl">    <span class="p">})</span>
</span></span></code></pre></div><h2 id="next-steps">Next steps</h2>
<ul>
<li>Learn about advanced pipeline features, such as <a href="https://github.com/kubeflow/pipelines/blob/sdk/release-1.8/samples/tutorials/DSL%20-%20Control%20structures/DSL%20-%20Control%20structures.py">using conditional execution in a
pipeline</a>.</li>
</ul>
<div class="notebook-links">
<a class="colab-link" href="https://colab.research.google.com/github/kubeflow/website/blob/master/content/en/docs/components/pipelines/sdk-v2/build-pipeline.ipynb">Run in Google Colab</a>
<a class="github-link" href="https://github.com/kubeflow/website/blob/master/content/en/docs/components/pipelines/sdk-v2/build-pipeline.ipynb">View source on GitHub</a>
</div>
</div>



    
	
  
    
    
	
    

<div class="td-content" style="page-break-before: always">
    
	<h1 id="pg-9184b16f91df608e5869bd5db102ef95">3.1.6.5 - Building Components</h1>
    <div class="lead">A tutorial on how to use the Pipelines SDK v2 to create components and use them in a pipeline</div>
	<p>A pipeline component is a self-contained set of code that performs one step in
your ML workflow. This document describes the concepts required to build
components, and demonstrates how to get started building components.</p>
<p><strong>Note:</strong> This guide demonstrates how to build components using the Pipelines SDK v2.
Currently, Kubeflow Pipelines v2 is in development. You can use this guide to start
building and running pipelines that are compatible with the Pipelines SDK v2.</p>
<p><a href="https://www.kubeflow.org/docs/components/pipelines/sdk-v2/v2-compatibility/">Learn more about Pipelines SDK v2</a>.</p>
<h2 id="before-you-begin">Before you begin</h2>
<p>Run the following command to install the Kubeflow Pipelines SDK v1.6.1 or higher.</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash"><span class="line"><span class="cl">pip install kfp --upgrade
</span></span></code></pre></div><p>For more information about the Kubeflow Pipelines SDK, see the <a href="https://kubeflow-pipelines.readthedocs.io/en/latest/index.html">SDK reference guide</a>.</p>
<h2 id="understanding-pipeline-components">Understanding pipeline components</h2>
<p>Pipeline components are self-contained sets of code that perform one step in
your ML workflow, such as preprocessing data or training a model. To create a
component, you must <em>build the component&rsquo;s implementation</em> and <em>define the
component specification</em>.</p>
<p>Your component&rsquo;s implementation includes the component&rsquo;s executable code and
the Docker container image that the code runs in.  <a href="#design">Learn more about designing
a pipeline component</a>.</p>
<p>Once you have built your component&rsquo;s implementation, you can define your
component&rsquo;s interface as a component specification. A component specification
defines:</p>
<ul>
<li>The component&rsquo;s inputs and outputs.</li>
<li>The container image that your component&rsquo;s code runs in, the command to use
to run your component&rsquo;s code, and the command-line arguments to pass to
your component&rsquo;s code.</li>
<li>The component&rsquo;s metadata, such as the name and description.</li>
</ul>
<p><a href="#component-spec">Learn more about creating a component specification</a>.</p>
<p>If your component&rsquo;s code is implemented as a Python function, use the
Kubeflow Pipelines SDK to package your function as a component. <a href="https://www.kubeflow.org/docs/pipelines/sdk/python-function-components/">Learn more
about building Python function-based components</a>.</p>
<p><a name="design"></a></p>
<h2 id="designing-a-pipeline-component">Designing a pipeline component</h2>
<p>When Kubeflow Pipelines executes a component, a container image is started in a
Kubernetes Pod. Your component&rsquo;s inputs and the paths to your components outputs
are passed in as command-line arguments.</p>
<p>When you design your component&rsquo;s code, consider the following:</p>
<ul>
<li>
<p>Which inputs and outputs are <em>parameters</em> and which are <em>artifacts</em>?
Component inputs and outputs are classified as either <em>parameters</em> or
<em>artifacts</em>, depending on their data type and how they are passed to
components as inputs. All outputs are returned as files, using the the
paths that Kubeflow Pipelines provides.</p>
<p><em>Parameters</em> typically represent settings that affect the behavior of your pipeline.
Parameters are passed into your component by value, and can be of any of
the following types: <code>int</code>, <code>float</code>, <code>str</code>, <code>bool</code>, <code>dict</code>, or <code>list</code>. Since parameters are
passed by value, the quantity of data passed in a parameter must be appropriate
to pass as a command-line argument.</p>
<p><em>Artifacts</em> represent large or complex data structures like datasets or models, and
are passed into components as a reference to a file path.</p>
<p>If you have large amounts of string data to pass to your component, such as a JSON
file, annotate that input or output as a type of <a href="https://github.com/kubeflow/pipelines/blob/sdk/release-1.8/sdk/python/kfp/dsl/io_types.py"><code>Artifact</code></a>, such
as <a href="https://github.com/kubeflow/pipelines/blob/sdk/release-1.8/sdk/python/kfp/dsl/io_types.py"><code>Dataset</code></a>, to let Kubeflow Pipelines know to pass this to
your component as a file.</p>
<p>In addition to the artifacts data, you can also read and write the artifact&rsquo;s
metadata. For output artifacts, you can record metadata as key-value pairs, such
as the accuracy of a trained model. For input artifacts, you can read the
artifact&rsquo;s metadata  for example, you could use metadata to decide if a
model is accurate enough to deploy for predictions.</p>
</li>
<li>
<p>To return an output from your component, the output&rsquo;s data must be stored as a file.
When you define your component, you let Kubeflow Pipelines know what outputs your
component produces. When your pipeline runs, Kubeflow Pipelines passes the
paths that you use to store your component&rsquo;s outputs as inputs to your component.</p>
</li>
<li>
<p>Outputs are typically written to a single file. In some cases, you may need to
return a directory of files as an output. In this case, create a directory at the
output path and write the output files to that location. In both cases, it may be
necessary to create parent directories if they do not exist.</p>
</li>
<li>
<p>Your component&rsquo;s goal may be to create a dataset in an external service,
such as a BigQuery table. In this case, it may make sense for the component
to output an identifier for the produced data, such as a table name,
instead of the data itself. We recommend that you limit this pattern to
cases where the data must be put into an external system instead of keeping it
inside the Kubeflow Pipelines system.</p>
</li>
<li>
<p>Since your inputs and output paths are passed in as command-line
arguments, your component&rsquo;s code must be able to read inputs from the
command line. If your component is built with Python, libraries such as
<a href="https://docs.python.org/3/library/argparse.html">argparse</a> and
<a href="https://abseil.io/docs/python/guides/flags">absl.flags</a> make it easier to
read your component&rsquo;s inputs.</p>
</li>
<li>
<p>Your component&rsquo;s code can be implemented in any language, so long as it can
run in a container image.</p>
</li>
</ul>
<p>The following is an example program written using Python3. This program reads a
given number of lines from an input file and writes those lines to an output
file. This means that this function accepts three command-line parameters:</p>
<ul>
<li>The path to the input file.</li>
<li>The number of lines to read.</li>
<li>The path to the output file.</li>
</ul>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-python" data-lang="python"><span class="line"><span class="cl"><span class="ch">#!/usr/bin/env python3</span>
</span></span><span class="line"><span class="cl"><span class="kn">import</span> <span class="nn">argparse</span>
</span></span><span class="line"><span class="cl"><span class="kn">from</span> <span class="nn">pathlib</span> <span class="kn">import</span> <span class="n">Path</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="c1"># Function doing the actual work (Outputs first N lines from a text file)</span>
</span></span><span class="line"><span class="cl"><span class="k">def</span> <span class="nf">do_work</span><span class="p">(</span><span class="n">input1_file</span><span class="p">,</span> <span class="n">output1_file</span><span class="p">,</span> <span class="n">param1</span><span class="p">):</span>
</span></span><span class="line"><span class="cl">  <span class="k">for</span> <span class="n">x</span><span class="p">,</span> <span class="n">line</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">input1_file</span><span class="p">):</span>
</span></span><span class="line"><span class="cl">    <span class="k">if</span> <span class="n">x</span> <span class="o">&gt;=</span> <span class="n">param1</span><span class="p">:</span>
</span></span><span class="line"><span class="cl">      <span class="k">break</span>
</span></span><span class="line"><span class="cl">    <span class="n">_</span> <span class="o">=</span> <span class="n">output1_file</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="n">line</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">  
</span></span><span class="line"><span class="cl"><span class="c1"># Defining and parsing the command-line arguments</span>
</span></span><span class="line"><span class="cl"><span class="n">parser</span> <span class="o">=</span> <span class="n">argparse</span><span class="o">.</span><span class="n">ArgumentParser</span><span class="p">(</span><span class="n">description</span><span class="o">=</span><span class="s1">&#39;My program description&#39;</span><span class="p">)</span>
</span></span><span class="line"><span class="cl"><span class="c1"># Paths must be passed in, not hardcoded</span>
</span></span><span class="line"><span class="cl"><span class="n">parser</span><span class="o">.</span><span class="n">add_argument</span><span class="p">(</span><span class="s1">&#39;--input1-path&#39;</span><span class="p">,</span> <span class="nb">type</span><span class="o">=</span><span class="nb">str</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">  <span class="n">help</span><span class="o">=</span><span class="s1">&#39;Path of the local file containing the Input 1 data.&#39;</span><span class="p">)</span>
</span></span><span class="line"><span class="cl"><span class="n">parser</span><span class="o">.</span><span class="n">add_argument</span><span class="p">(</span><span class="s1">&#39;--output1-path&#39;</span><span class="p">,</span> <span class="nb">type</span><span class="o">=</span><span class="nb">str</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">  <span class="n">help</span><span class="o">=</span><span class="s1">&#39;Path of the local file where the Output 1 data should be written.&#39;</span><span class="p">)</span>
</span></span><span class="line"><span class="cl"><span class="n">parser</span><span class="o">.</span><span class="n">add_argument</span><span class="p">(</span><span class="s1">&#39;--param1&#39;</span><span class="p">,</span> <span class="nb">type</span><span class="o">=</span><span class="nb">int</span><span class="p">,</span> <span class="n">default</span><span class="o">=</span><span class="mi">100</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">  <span class="n">help</span><span class="o">=</span><span class="s1">&#39;The number of lines to read from the input and write to the output.&#39;</span><span class="p">)</span>
</span></span><span class="line"><span class="cl"><span class="n">args</span> <span class="o">=</span> <span class="n">parser</span><span class="o">.</span><span class="n">parse_args</span><span class="p">()</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="c1"># Creating the directory where the output file is created (the directory</span>
</span></span><span class="line"><span class="cl"><span class="c1"># may or may not exist).</span>
</span></span><span class="line"><span class="cl"><span class="n">Path</span><span class="p">(</span><span class="n">args</span><span class="o">.</span><span class="n">output1_path</span><span class="p">)</span><span class="o">.</span><span class="n">parent</span><span class="o">.</span><span class="n">mkdir</span><span class="p">(</span><span class="n">parents</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">exist_ok</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="k">with</span> <span class="nb">open</span><span class="p">(</span><span class="n">args</span><span class="o">.</span><span class="n">input1_path</span><span class="p">,</span> <span class="s1">&#39;r&#39;</span><span class="p">)</span> <span class="k">as</span> <span class="n">input1_file</span><span class="p">:</span>
</span></span><span class="line"><span class="cl">    <span class="k">with</span> <span class="nb">open</span><span class="p">(</span><span class="n">args</span><span class="o">.</span><span class="n">output1_path</span><span class="p">,</span> <span class="s1">&#39;w&#39;</span><span class="p">)</span> <span class="k">as</span> <span class="n">output1_file</span><span class="p">:</span>
</span></span><span class="line"><span class="cl">        <span class="n">do_work</span><span class="p">(</span><span class="n">input1_file</span><span class="p">,</span> <span class="n">output1_file</span><span class="p">,</span> <span class="n">args</span><span class="o">.</span><span class="n">param1</span><span class="p">)</span>
</span></span></code></pre></div><p>If this program is saved as <code>program.py</code>, the command-line invocation of this
program is:</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash"><span class="line"><span class="cl">python3 program.py --input1-path &lt;path-to-the-input-file&gt; <span class="se">\
</span></span></span><span class="line"><span class="cl"><span class="se"></span>  --param1 &lt;number-of-lines-to-read&gt; <span class="se">\
</span></span></span><span class="line"><span class="cl"><span class="se"></span>  --output1-path &lt;path-to-write-the-output-to&gt; 
</span></span></code></pre></div><h2 id="containerize-your-components-code">Containerize your component&rsquo;s code</h2>
<p>For Kubeflow Pipelines to run your component, your component must be packaged
as a <a href="https://docs.docker.com/get-started/">Docker</a> container image and published to a container registry
that your Kubernetes cluster can access. The steps to create a container image
are not specific to Kubeflow Pipelines. To make things easier for you, this
section provides some guidelines on standard container creation.</p>
<ol>
<li>
<p>Create a <a href="https://docs.docker.com/engine/reference/builder/">Dockerfile</a> for your container. A Dockerfile
specifies:</p>
<ul>
<li>The base container image. For example, the operating system that your
code runs on.</li>
<li>Any dependencies that need to be installed for your code to run.</li>
<li>Files to copy into the container, such as the runnable code for this
component.</li>
</ul>
<p>The following is an example Dockerfile.</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-fallback" data-lang="fallback"><span class="line"><span class="cl">FROM python:3.7
</span></span><span class="line"><span class="cl">RUN python3 -m pip install keras
</span></span><span class="line"><span class="cl">COPY ./src /pipelines/component/src
</span></span></code></pre></div><p>In this example:</p>
<ul>
<li>The base container image is <a href="https://hub.docker.com/_/python"><code>python:3.7</code></a>.</li>
<li>The <code>keras</code> Python package is installed in the container image.</li>
<li>Files in your <code>./src</code> directory are copied into
<code>/pipelines/component/src</code> in the container image.</li>
</ul>
</li>
<li>
<p>Create a script named <code>build_image.sh </code> that uses Docker to build your
container image and push your container image to a container registry.
Your Kubernetes cluster must be able to access your container registry
to run your component. Examples of container registries include <a href="https://cloud.google.com/container-registry/docs/">Google
Container Registry</a> and
<a href="https://hub.docker.com/">Docker Hub</a>.</p>
<p>The following example builds a container image, pushes it to a container
registry, and outputs the strict image name. It is a best practice to use
the strict image name in your component specification to ensure that you
are using the expected version of a container image in each component
execution.</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash"><span class="line"><span class="cl"><span class="cp">#!/bin/bash -e
</span></span></span><span class="line"><span class="cl"><span class="cp"></span><span class="nv">image_name</span><span class="o">=</span>gcr.io/my-org/my-image
</span></span><span class="line"><span class="cl"><span class="nv">image_tag</span><span class="o">=</span>latest
</span></span><span class="line"><span class="cl"><span class="nv">full_image_name</span><span class="o">=</span><span class="si">${</span><span class="nv">image_name</span><span class="si">}</span>:<span class="si">${</span><span class="nv">image_tag</span><span class="si">}</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="nb">cd</span> <span class="s2">&#34;</span><span class="k">$(</span>dirname <span class="s2">&#34;</span><span class="nv">$0</span><span class="s2">&#34;</span><span class="k">)</span><span class="s2">&#34;</span> 
</span></span><span class="line"><span class="cl">docker build -t <span class="s2">&#34;</span><span class="si">${</span><span class="nv">full_image_name</span><span class="si">}</span><span class="s2">&#34;</span> .
</span></span><span class="line"><span class="cl">docker push <span class="s2">&#34;</span><span class="nv">$full_image_name</span><span class="s2">&#34;</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="c1"># Output the strict image name, which contains the sha256 image digest</span>
</span></span><span class="line"><span class="cl">docker inspect --format<span class="o">=</span><span class="s2">&#34;{{index .RepoDigests 0}}&#34;</span> <span class="s2">&#34;</span><span class="si">${</span><span class="nv">full_image_name</span><span class="si">}</span><span class="s2">&#34;</span>
</span></span></code></pre></div><p>In the preceding example:</p>
<ul>
<li>The <code>image_name</code> specifies the full name of your container image in the
container registry.</li>
<li>The <code>image_tag</code> specifies that this image should be tagged as
<strong>latest</strong>.</li>
</ul>
<p>Save this file and run the following to make this script executable.</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash"><span class="line"><span class="cl">chmod +x build_image.sh
</span></span></code></pre></div></li>
<li>
<p>Run your <code>build_image.sh</code> script to build your container image and push it
to a container registry.</p>
</li>
<li>
<p><a href="https://docs.docker.com/engine/reference/commandline/run/">Use <code>docker run</code> to test your container image locally</a>. If
necessary, revise your application and Dockerfile until your application
works as expected in the container.</p>
</li>
</ol>
<p><a name="component-spec"></a></p>
<h2 id="creating-a-component-specification">Creating a component specification</h2>
<p>To create a component from your containerized program, you must create a
component specification that defines the component&rsquo;s interface and
implementation. The following sections provide an overview of how to create a
component specification by demonstrating how to define the component&rsquo;s
implementation, interface, and metadata.</p>
<p>To learn more about defining a component specification, see the
<a href="/docs/components/pipelines/reference/component-spec/">component specification reference guide</a>.</p>
<h3 id="define-your-components-implementation">Define your component&rsquo;s implementation</h3>
<p>The following example creates a component specification YAML and defines the
component&rsquo;s implementation.</p>
<ol>
<li>
<p>Create a file named <code>component.yaml</code> and open it in a text editor.</p>
</li>
<li>
<p>Create your component&rsquo;s implementation section and specify the strict name
of your container image. The strict image name is provided when you run
your <code>build_image.sh</code> script.</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-yaml" data-lang="yaml"><span class="line"><span class="cl"><span class="nt">implementation</span><span class="p">:</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">  </span><span class="nt">container</span><span class="p">:</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="c"># The strict name of a container image that you&#39;ve pushed to a container registry.</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="nt">image</span><span class="p">:</span><span class="w"> </span><span class="l">gcr.io/my-org/my-image@sha256:a172..752f</span><span class="w">
</span></span></span></code></pre></div></li>
<li>
<p>Define a <code>command</code> for your component&rsquo;s implementation. This field
specifies the command-line arguments that are used to run your program in
the container.</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-yaml" data-lang="yaml"><span class="line"><span class="cl"><span class="nt">implementation</span><span class="p">:</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">  </span><span class="nt">container</span><span class="p">:</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="nt">image</span><span class="p">:</span><span class="w"> </span><span class="l">gcr.io/my-org/my-image@sha256:a172..752f</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="c"># command is a list of strings (command-line arguments). </span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="c"># The YAML language has two syntaxes for lists and you can use either of them. </span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="c"># Here we use the &#34;flow syntax&#34; - comma-separated strings inside square brackets.</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="nt">command</span><span class="p">:</span><span class="w"> </span><span class="p">[</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">      </span><span class="l">python3, </span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">      </span><span class="c"># Path of the program inside the container</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">      </span><span class="l">/pipelines/component/src/program.py,</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">      </span>--<span class="l">input1-path,</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">      </span>{<span class="nt">inputPath</span><span class="p">:</span><span class="w"> </span><span class="l">input_1},</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">      </span>--<span class="l">param1, </span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">      </span>{<span class="nt">inputValue</span><span class="p">:</span><span class="w"> </span><span class="l">parameter_1},</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">      </span>--<span class="l">output1-path, </span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">      </span>{<span class="nt">outputPath</span><span class="p">:</span><span class="w"> </span><span class="l">output_1},</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="p">]</span><span class="w">
</span></span></span></code></pre></div><p>The <code>command</code> is formatted as a list of strings. Each string in the
<code>command</code> is a command-line argument or a placeholder. At runtime,
placeholders are replaced with an input or output. In the preceding
example, two inputs and one output path are passed into a Python script at
<code>/pipelines/component/src/program.py</code>.</p>
<p>There are three types of input/output placeholders:</p>
<ul>
<li>
<p><code>{inputValue: &lt;input-name&gt;}</code>:
This placeholder is replaced with the value of the specified input.
This is useful for small pieces of input data, such as numbers or small
strings.</p>
</li>
<li>
<p><code>{inputPath: &lt;input-name&gt;}</code>:
This placeholder is replaced with the path to this input as a file.
Your component can read the contents of that input at that path during
the pipeline run.</p>
</li>
<li>
<p><code>{outputPath: &lt;output-name&gt;}</code>:
This placeholder is replaced with the path where your program writes
this output&rsquo;s data. This lets the Kubeflow Pipelines system read the
contents of the file and store it as the value of the specified output.</p>
</li>
</ul>
<p>The <code>&lt;input-name&gt;</code> name must match the name of an input in the <code>inputs</code>
section of your component specification. The <code>&lt;output-name&gt;</code> name must
match the name of an output in the <code>outputs</code> section of your component
specification.</p>
</li>
</ol>
<h3 id="define-your-components-interface">Define your component&rsquo;s interface</h3>
<p>The following examples demonstrate how to specify your component&rsquo;s interface.</p>
<ol>
<li>
<p>To define an input in your <code>component.yaml</code>, add an item to the
<code>inputs</code> list with the following attributes:</p>
<ul>
<li><code>name</code>: Human-readable name of this input. Each input&rsquo;s name must be
unique.</li>
<li><code>description</code>: (Optional.) Human-readable description of the input.</li>
<li><code>default</code>: (Optional.) Specifies the default value for this input.</li>
<li><code>type</code>: Specifies the inputs type. Learn more about the
<a href="https://github.com/kubeflow/pipelines/blob/sdk/release-1.8/sdk/python/kfp/dsl/types.py">types defined in the Kubeflow Pipelines SDK</a> and <a href="https://www.kubeflow.org/docs/components/pipelines/sdk/static-type-checking/">how type
checking works in pipelines and components</a>.</li>
<li><code>optional</code>: Specifies if this input is optional. The value of this
attribute is of type <code>Bool</code>, and defaults to <strong>False</strong>.</li>
</ul>
<p>In this example, the Python program has two inputs:</p>
<ul>
<li><code>input_1</code> contains <code>String</code> data.</li>
<li><code>Parameter 1</code> contains an <code>Integer</code>.</li>
</ul>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-yaml" data-lang="yaml"><span class="line"><span class="cl"><span class="nt">inputs</span><span class="p">:</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span>- {<span class="nt">name: input_1, type: String, description</span><span class="p">:</span><span class="w"> </span><span class="s1">&#39;Data for input_1&#39;</span>}<span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span>- {<span class="nt">name: parameter_1, type: Integer, default: &#39;100&#39;, description</span><span class="p">:</span><span class="w"> </span><span class="s1">&#39;Number of lines to copy&#39;</span>}<span class="w">
</span></span></span></code></pre></div><p>Note: <code>input_1</code> and <code>parameter_1</code> do not specify any details about how they
are stored or how much data they contain. Consider using naming conventions
to indicate if inputs are expected to be artifacts or parameters.</p>
</li>
<li>
<p>After your component finishes its task, the component&rsquo;s outputs are passed
to your pipeline as paths. At runtime, Kubeflow Pipelines creates a
path for each of your component&rsquo;s outputs. These paths are passed as inputs
to your component&rsquo;s implementation.</p>
<p>To define an output in your component specification YAML, add an item to
the <code>outputs</code> list with the following attributes:</p>
<ul>
<li><code>name</code>: Human-readable name of this output. Each output&rsquo;s name must be
unique.</li>
<li><code>description</code>: (Optional.) Human-readable description of the output.</li>
<li><code>type</code>: Specifies the output&rsquo;s type. Learn more about the
<a href="https://github.com/kubeflow/pipelines/blob/sdk/release-1.8/sdk/python/kfp/dsl/types.py">types defined in the Kubeflow Pipelines SDK</a> and <a href="https://www.kubeflow.org/docs/components/pipelines/sdk/static-type-checking/">how type
checking works in pipelines and components</a>.</li>
</ul>
<p>In this example, the Python program returns one output. The output is named
<code>output_1</code> and it contains <code>String</code> data.</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-yaml" data-lang="yaml"><span class="line"><span class="cl"><span class="nt">outputs</span><span class="p">:</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span>- {<span class="nt">name: output_1, type: String, description</span><span class="p">:</span><span class="w"> </span><span class="s1">&#39;output_1 data.&#39;</span>}<span class="w">
</span></span></span></code></pre></div><p>Note: Consider using naming conventions to indicate if this output is
expected to be small enough to pass by value. You should limit the amount
of data that is passed by value to 200 KB per pipeline run.</p>
</li>
<li>
<p>After you define your component&rsquo;s interface, the <code>component.yaml</code> should be
something like the following:</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-yaml" data-lang="yaml"><span class="line"><span class="cl"><span class="nt">inputs</span><span class="p">:</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span>- {<span class="nt">name: input_1, type: String, description</span><span class="p">:</span><span class="w"> </span><span class="s1">&#39;Data for input_1&#39;</span>}<span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span>- {<span class="nt">name: parameter_1, type: Integer, default: &#39;100&#39;, description</span><span class="p">:</span><span class="w"> </span><span class="s1">&#39;Number of lines to copy&#39;</span>}<span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="nt">outputs</span><span class="p">:</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span>- {<span class="nt">name: output_1, type: String, description</span><span class="p">:</span><span class="w"> </span><span class="s1">&#39;output_1 data.&#39;</span>}<span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="nt">implementation</span><span class="p">:</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">  </span><span class="nt">container</span><span class="p">:</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="nt">image</span><span class="p">:</span><span class="w"> </span><span class="l">gcr.io/my-org/my-image@sha256:a172..752f</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="c"># command is a list of strings (command-line arguments). </span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="c"># The YAML language has two syntaxes for lists and you can use either of them. </span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="c"># Here we use the &#34;flow syntax&#34; - comma-separated strings inside square brackets.</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="nt">command</span><span class="p">:</span><span class="w"> </span><span class="p">[</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">      </span><span class="l">python3, </span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">      </span><span class="c"># Path of the program inside the container</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">      </span><span class="l">/pipelines/component/src/program.py,</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">      </span>--<span class="l">input1-path,</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">      </span>{<span class="nt">inputPath</span><span class="p">:</span><span class="w"> </span><span class="l">input_1},</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">      </span>--<span class="l">param1, </span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">      </span>{<span class="nt">inputValue</span><span class="p">:</span><span class="w"> </span><span class="l">parameter_1},</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">      </span>--<span class="l">output1-path, </span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">      </span>{<span class="nt">outputPath</span><span class="p">:</span><span class="w"> </span><span class="l">output_1},</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="p">]</span><span class="w">
</span></span></span></code></pre></div></li>
</ol>
<h3 id="specify-your-components-metadata">Specify your component&rsquo;s metadata</h3>
<p>To define your component&rsquo;s metadata, add the <code>name</code> and <code>description</code>
fields to your <code>component.yaml</code></p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-yaml" data-lang="yaml"><span class="line"><span class="cl"><span class="nt">name</span><span class="p">:</span><span class="w"> </span><span class="l">Get Lines</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="nt">description</span><span class="p">:</span><span class="w"> </span><span class="l">Gets the specified number of lines from the input file.</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="nt">inputs</span><span class="p">:</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span>- {<span class="nt">name: input_1, type: String, description</span><span class="p">:</span><span class="w"> </span><span class="s1">&#39;Data for input_1&#39;</span>}<span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span>- {<span class="nt">name: parameter_1, type: Integer, default: &#39;100&#39;, description</span><span class="p">:</span><span class="w"> </span><span class="s1">&#39;Number of lines to copy&#39;</span>}<span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="nt">outputs</span><span class="p">:</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span>- {<span class="nt">name: output_1, type: String, description</span><span class="p">:</span><span class="w"> </span><span class="s1">&#39;output_1 data.&#39;</span>}<span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="nt">implementation</span><span class="p">:</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">  </span><span class="nt">container</span><span class="p">:</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="nt">image</span><span class="p">:</span><span class="w"> </span><span class="l">gcr.io/my-org/my-image@sha256:a172..752f</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="c"># command is a list of strings (command-line arguments). </span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="c"># The YAML language has two syntaxes for lists and you can use either of them. </span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="c"># Here we use the &#34;flow syntax&#34; - comma-separated strings inside square brackets.</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="nt">command</span><span class="p">:</span><span class="w"> </span><span class="p">[</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">      </span><span class="l">python3, </span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">      </span><span class="c"># Path of the program inside the container</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">      </span><span class="l">/pipelines/component/src/program.py,</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">      </span>--<span class="l">input1-path,</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">      </span>{<span class="nt">inputPath</span><span class="p">:</span><span class="w"> </span><span class="l">input_1},</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">      </span>--<span class="l">param1, </span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">      </span>{<span class="nt">inputValue</span><span class="p">:</span><span class="w"> </span><span class="l">parameter_1},</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">      </span>--<span class="l">output1-path, </span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">      </span>{<span class="nt">outputPath</span><span class="p">:</span><span class="w"> </span><span class="l">output_1},</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="p">]</span><span class="w">
</span></span></span></code></pre></div><h2 id="using-your-component-in-a-pipeline">Using your component in a pipeline</h2>
<p>You can use the Kubeflow Pipelines SDK to load your component using methods
such as the following:</p>
<ul>
<li><a href="https://kubeflow-pipelines.readthedocs.io/en/stable/source/kfp.components.html#kfp.components.load_component_from_file"><code>kfp.components.load_component_from_file</code></a>:
Use this method to load your component from a <code>component.yaml</code> path.</li>
<li><a href="https://kubeflow-pipelines.readthedocs.io/en/stable/source/kfp.components.html#kfp.components.load_component_from_url"><code>kfp.components.load_component_from_url</code></a>:
Use this method to load a <code>component.yaml</code> from a URL.</li>
<li><a href="https://kubeflow-pipelines.readthedocs.io/en/stable/source/kfp.components.html#kfp.components.load_component_from_text"><code>kfp.components.load_component_from_text</code></a>:
Use this method to load your component specification YAML from a string.
This method is useful for rapidly iterating on your component
specification.</li>
</ul>
<p>These functions create a factory function that you can use to create
<a href="https://kubeflow-pipelines.readthedocs.io/en/stable/source/kfp.dsl.html#kfp.dsl.ContainerOp"><code>ContainerOp</code></a> instances to use as steps in your pipeline.
This factory function&rsquo;s input arguments include your component&rsquo;s inputs and
the paths to your component&rsquo;s outputs. The function signature may be modified
in the following ways to ensure that it is valid and Pythonic.</p>
<ul>
<li>Inputs with default values will come after the inputs without default
values and outputs.</li>
<li>Input and output names are converted to Pythonic names (spaces and symbols
are replaced with underscores and letters are converted to lowercase). For
example, an input named <code>Input 1</code> is converted to <code>input_1</code>.</li>
</ul>
<p>The following example demonstrates how to load the text of your component
specification and run it in a single-step pipeline. Before you run this
example, update the component specification to use the component
specification you defined in the previous sections.</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-python" data-lang="python"><span class="line"><span class="cl"><span class="kn">import</span> <span class="nn">kfp</span>
</span></span><span class="line"><span class="cl"><span class="kn">import</span> <span class="nn">kfp.components</span> <span class="k">as</span> <span class="nn">comp</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="n">create_step_get_lines</span> <span class="o">=</span> <span class="n">comp</span><span class="o">.</span><span class="n">load_component_from_text</span><span class="p">(</span><span class="s2">&#34;&#34;&#34;
</span></span></span><span class="line"><span class="cl"><span class="s2">name: Get Lines
</span></span></span><span class="line"><span class="cl"><span class="s2">description: Gets the specified number of lines from the input file.
</span></span></span><span class="line"><span class="cl"><span class="s2">
</span></span></span><span class="line"><span class="cl"><span class="s2">inputs:
</span></span></span><span class="line"><span class="cl"><span class="s2">- {name: input_1, type: String, description: &#39;Data for input_1&#39;}
</span></span></span><span class="line"><span class="cl"><span class="s2">- {name: parameter_1, type: Integer, default: &#39;100&#39;, description: &#39;Number of lines to copy&#39;}
</span></span></span><span class="line"><span class="cl"><span class="s2">
</span></span></span><span class="line"><span class="cl"><span class="s2">outputs:
</span></span></span><span class="line"><span class="cl"><span class="s2">- {name: output_1, type: String, description: &#39;output_1 data.&#39;}
</span></span></span><span class="line"><span class="cl"><span class="s2">
</span></span></span><span class="line"><span class="cl"><span class="s2">implementation:
</span></span></span><span class="line"><span class="cl"><span class="s2">  container:
</span></span></span><span class="line"><span class="cl"><span class="s2">    image: gcr.io/my-org/my-image@sha256:a172..752f
</span></span></span><span class="line"><span class="cl"><span class="s2">    # command is a list of strings (command-line arguments). 
</span></span></span><span class="line"><span class="cl"><span class="s2">    # The YAML language has two syntaxes for lists and you can use either of them. 
</span></span></span><span class="line"><span class="cl"><span class="s2">    # Here we use the &#34;flow syntax&#34; - comma-separated strings inside square brackets.
</span></span></span><span class="line"><span class="cl"><span class="s2">    command: [
</span></span></span><span class="line"><span class="cl"><span class="s2">      python3, 
</span></span></span><span class="line"><span class="cl"><span class="s2">      # Path of the program inside the container
</span></span></span><span class="line"><span class="cl"><span class="s2">      /pipelines/component/src/program.py,
</span></span></span><span class="line"><span class="cl"><span class="s2">      --input1-path,
</span></span></span><span class="line"><span class="cl"><span class="s2">      {inputPath: input_1},
</span></span></span><span class="line"><span class="cl"><span class="s2">      --param1, 
</span></span></span><span class="line"><span class="cl"><span class="s2">      {inputValue: parameter_1},
</span></span></span><span class="line"><span class="cl"><span class="s2">      --output1-path, 
</span></span></span><span class="line"><span class="cl"><span class="s2">      {outputPath: output_1},
</span></span></span><span class="line"><span class="cl"><span class="s2">    ]&#34;&#34;&#34;</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="c1"># create_step_get_lines is a &#34;factory function&#34; that accepts the arguments</span>
</span></span><span class="line"><span class="cl"><span class="c1"># for the component&#39;s inputs and output paths and returns a pipeline step</span>
</span></span><span class="line"><span class="cl"><span class="c1"># (ContainerOp instance).</span>
</span></span><span class="line"><span class="cl"><span class="c1">#</span>
</span></span><span class="line"><span class="cl"><span class="c1"># To inspect the get_lines_op function in Jupyter Notebook, enter </span>
</span></span><span class="line"><span class="cl"><span class="c1"># &#34;get_lines_op(&#34; in a cell and press Shift+Tab.</span>
</span></span><span class="line"><span class="cl"><span class="c1"># You can also get help by entering `help(get_lines_op)`, `get_lines_op?`,</span>
</span></span><span class="line"><span class="cl"><span class="c1"># or `get_lines_op??`.</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="c1"># Define your pipeline</span>
</span></span><span class="line"><span class="cl"><span class="nd">@dsl</span><span class="o">.</span><span class="n">pipeline</span><span class="p">(</span>
</span></span><span class="line"><span class="cl">    <span class="n">pipeline_root</span><span class="o">=</span><span class="s1">&#39;gs://my-pipeline-root/example-pipeline&#39;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">    <span class="n">name</span><span class="o">=</span><span class="s2">&#34;example-pipeline&#34;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl"><span class="p">)</span> 
</span></span><span class="line"><span class="cl"><span class="k">def</span> <span class="nf">my_pipeline</span><span class="p">():</span>
</span></span><span class="line"><span class="cl">    <span class="n">get_lines_step</span> <span class="o">=</span> <span class="n">create_step_get_lines</span><span class="p">(</span>
</span></span><span class="line"><span class="cl">        <span class="c1"># Input name &#34;Input 1&#34; is converted to pythonic parameter name &#34;input_1&#34;</span>
</span></span><span class="line"><span class="cl">        <span class="n">input_1</span><span class="o">=</span><span class="s1">&#39;one</span><span class="se">\n</span><span class="s1">two</span><span class="se">\n</span><span class="s1">three</span><span class="se">\n</span><span class="s1">four</span><span class="se">\n</span><span class="s1">five</span><span class="se">\n</span><span class="s1">six</span><span class="se">\n</span><span class="s1">seven</span><span class="se">\n</span><span class="s1">eight</span><span class="se">\n</span><span class="s1">nine</span><span class="se">\n</span><span class="s1">ten&#39;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">        <span class="n">parameter_1</span><span class="o">=</span><span class="s1">&#39;5&#39;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">    <span class="p">)</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="c1"># If you run this command on a Jupyter notebook running on Kubeflow,</span>
</span></span><span class="line"><span class="cl"><span class="c1"># you can exclude the host parameter.</span>
</span></span><span class="line"><span class="cl"><span class="c1"># client = kfp.Client()</span>
</span></span><span class="line"><span class="cl"><span class="n">client</span> <span class="o">=</span> <span class="n">kfp</span><span class="o">.</span><span class="n">Client</span><span class="p">(</span><span class="n">host</span><span class="o">=</span><span class="s1">&#39;&lt;your-kubeflow-pipelines-host-name&gt;&#39;</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="c1"># Compile, upload, and submit this pipeline for execution.</span>
</span></span><span class="line"><span class="cl"><span class="n">client</span><span class="o">.</span><span class="n">create_run_from_pipeline_func</span><span class="p">(</span><span class="n">my_pipeline</span><span class="p">,</span> <span class="n">arguments</span><span class="o">=</span><span class="p">{},</span>
</span></span><span class="line"><span class="cl">    <span class="n">mode</span><span class="o">=</span><span class="n">kfp</span><span class="o">.</span><span class="n">dsl</span><span class="o">.</span><span class="n">PipelineExecutionMode</span><span class="o">.</span><span class="n">V2_COMPATIBLE</span><span class="p">)</span>
</span></span></code></pre></div><h2 id="organizing-the-component-files">Organizing the component files</h2>
<p>This section provides a recommended way to organize a component&rsquo;s files. There
is no requirement that you must organize the files in this way. However, using
the standard organization makes it possible to reuse the same scripts for
testing, image building, and component versioning.</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-zed" data-lang="zed"><span class="line"><span class="cl"><span class="nn">components/</span><span class="o">&lt;</span><span class="n">component</span><span class="w"> </span><span class="n">group</span><span class="o">&gt;/&lt;</span><span class="n">component</span><span class="w"> </span><span class="n">name</span><span class="o">&gt;/</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="nn">src/</span><span class="o">*</span><span class="w">            </span><span class="err">#</span><span class="w"> </span><span class="n">Component</span><span class="w"> </span><span class="n">source</span><span class="w"> </span><span class="n">code</span><span class="w"> </span><span class="n">files</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="nn">tests/</span><span class="o">*</span><span class="w">          </span><span class="err">#</span><span class="w"> </span><span class="n">Unit</span><span class="w"> </span><span class="n">tests</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="n">run_tests</span><span class="p">.</span><span class="n">sh</span><span class="w">     </span><span class="err">#</span><span class="w"> </span><span class="n">Small</span><span class="w"> </span><span class="n">script</span><span class="w"> </span><span class="n">that</span><span class="w"> </span><span class="n">runs</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="n">tests</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="n">README</span><span class="p">.</span><span class="n">md</span><span class="w">        </span><span class="err">#</span><span class="w"> </span><span class="n">Documentation</span><span class="p">.</span><span class="w"> </span><span class="n">If</span><span class="w"> </span><span class="n">multiple</span><span class="w"> </span><span class="n">files</span><span class="w"> </span><span class="n">are</span><span class="w"> </span><span class="n">needed</span><span class="p">,</span><span class="w"> </span><span class="n">move</span><span class="w"> </span><span class="n">to</span><span class="w"> </span><span class="nn">docs/</span><span class="p">.</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="n">Dockerfile</span><span class="w">       </span><span class="err">#</span><span class="w"> </span><span class="n">Dockerfile</span><span class="w"> </span><span class="n">to</span><span class="w"> </span><span class="n">build</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="n">component</span><span class="w"> </span><span class="n">container</span><span class="w"> </span><span class="n">image</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="n">build_image</span><span class="p">.</span><span class="n">sh</span><span class="w">   </span><span class="err">#</span><span class="w"> </span><span class="n">Small</span><span class="w"> </span><span class="n">script</span><span class="w"> </span><span class="n">that</span><span class="w"> </span><span class="n">runs</span><span class="w"> </span><span class="n">docker</span><span class="w"> </span><span class="n">build</span><span class="w"> </span><span class="n">and</span><span class="w"> </span><span class="n">docker</span><span class="w"> </span><span class="n">push</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="n">component</span><span class="p">.</span><span class="n">yaml</span><span class="w">   </span><span class="err">#</span><span class="w"> </span><span class="n">Component</span><span class="w"> </span><span class="kt">definition</span><span class="w"> </span><span class="n">in</span><span class="w"> </span><span class="n">YAML</span><span class="w"> </span><span class="n">format</span><span class="w">
</span></span></span></code></pre></div><p>See this <a href="https://github.com/kubeflow/pipelines/tree/sdk/release-1.8/components/sample/keras/train_classifier">sample component</a> for a real-life component example.</p>
<h2 id="next-steps">Next steps</h2>
<ul>
<li>Consolidate what you&rsquo;ve learned by reading the
<a href="/docs/components/pipelines/sdk/best-practices">best practices</a> for designing and
writing components.</li>
<li>For quick iteration,
<a href="/docs/components/pipelines/sdk-v2/python-function-components/">build lightweight Python function-based components</a>
directly from Python functions.</li>
<li>Use SDK APIs to visualize pipeline result, follow
<a href="/docs/components/pipelines/sdk/output-viewer/#v2-visualization">Visualize Results in the Pipelines UI</a>
for various visualization types.</li>
<li>See how to <a href="/docs/components/pipelines/sdk/pipelines-metrics/">export metrics from your
pipeline</a>.</li>
<li>Visualize the output of your component by
<a href="/docs/components/pipelines/sdk/output-viewer/">adding metadata for an output
viewer</a>.</li>
<li>Explore the <a href="/docs/examples/shared-resources/">reusable components and other shared
resources</a>.</li>
</ul>

</div>



    
	
  
    
    
	
    

<div class="td-content" style="page-break-before: always">
    
	<h1 id="pg-1b784a63be21dc3d677420b83ac1439e">3.1.6.6 - Building Python Function-based Components</h1>
    <div class="lead">Building your own lightweight pipelines components using the Pipelines SDK v2 and Python</div>
	<!--
AUTOGENERATED FROM content/en/docs/components/pipelines/sdk-v2/python-function-components.ipynb
PLEASE UPDATE THE JUPYTER NOTEBOOK AND REGENERATE THIS FILE USING scripts/nb_to_md.py.-->
<style>
.notebook-links {display: flex; margin: 1em 0;}
.notebook-links a {padding: .75em; margin-right: .75em; font-weight: bold;}
a.colab-link {
padding-left: 3.25em;
background-image: url(/docs/images/logos/colab.ico);
background-repeat: no-repeat;
background-size: contain;
}
a.github-link {
padding-left: 2.75em;
background-image: url(/docs/images/logos/github.png);
background-repeat: no-repeat;
background-size: auto 75%;
background-position: left center;
}
</style>
<div class="notebook-links">
<a class="colab-link" href="https://colab.research.google.com/github/kubeflow/website/blob/master/content/en/docs/components/pipelines/sdk-v2/python-function-components.ipynb">Run in Google Colab</a>
<a class="github-link" href="https://github.com/kubeflow/website/blob/master/content/en/docs/components/pipelines/sdk-v2/python-function-components.ipynb">View source on GitHub</a>
</div>
<p>A Kubeflow Pipelines component is a self-contained set of code that performs one step in your
ML workflow. A pipeline component is composed of:</p>
<ul>
<li>
<p>The component code, which implements the logic needed to perform a step in your ML workflow.</p>
</li>
<li>
<p>A component specification, which defines the following:</p>
<ul>
<li>The component&rsquo;s metadata, its name and description.</li>
<li>The component&rsquo;s interface, the component&rsquo;s inputs and outputs.</li>
<li>The component&rsquo;s implementation, the Docker container image
to run, how to pass inputs to your component code, and how
to get the component&rsquo;s outputs.</li>
</ul>
</li>
</ul>
<p>Python function-based components make it easier to iterate quickly by letting you build your
component code as a Python function and generating the <a href="https://www.kubeflow.org/docs/components/pipelines/reference/component-spec/">component specification</a> for you.
This document describes how to build Python function-based components and use them in your pipeline.</p>
<p><strong>Note:</strong> This guide demonstrates how to build components using the Pipelines SDK v2.
Currently, Kubeflow Pipelines v2 is in development. You can use this guide to start
building and running pipelines that are compatible with the Pipelines SDK v2.</p>
<p><a href="https://www.kubeflow.org/docs/components/pipelines/sdk-v2/v2-compatibility/">Learn more about Pipelines SDK v2</a>.</p>
<h2 id="before-you-begin">Before you begin</h2>
<ol>
<li>Run the following command to install the Kubeflow Pipelines SDK v1.6.2 or higher. If you run this command in a Jupyter
notebook, restart the kernel after installing the SDK.</li>
</ol>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-python" data-lang="python"><span class="line"><span class="cl"><span class="err">$</span> <span class="n">pip</span> <span class="n">install</span> <span class="o">--</span><span class="n">upgrade</span> <span class="n">kfp</span>
</span></span></code></pre></div><ol start="2">
<li>Import the <code>kfp</code>, <code>kfp.dsl</code>, and <code>kfp.v2.dsl</code> packages.</li>
</ol>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-python" data-lang="python"><span class="line"><span class="cl"><span class="kn">import</span> <span class="nn">kfp</span>
</span></span><span class="line"><span class="cl"><span class="kn">import</span> <span class="nn">kfp.dsl</span> <span class="k">as</span> <span class="nn">dsl</span>
</span></span><span class="line"><span class="cl"><span class="kn">from</span> <span class="nn">kfp.v2.dsl</span> <span class="kn">import</span> <span class="p">(</span>
</span></span><span class="line"><span class="cl">    <span class="n">component</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">    <span class="n">Input</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">    <span class="n">Output</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">    <span class="n">Dataset</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">    <span class="n">Metrics</span><span class="p">,</span>
</span></span><span class="line"><span class="cl"><span class="p">)</span>
</span></span></code></pre></div><ol start="3">
<li>Create an instance of the <a href="https://kubeflow-pipelines.readthedocs.io/en/latest/source/kfp.client.html#kfp.Client"><code>kfp.Client</code> class</a> following steps in <a href="https://www.kubeflow.org/docs/components/pipelines/sdk/connect-api">connecting to Kubeflow Pipelines using the SDK client</a>.</li>
</ol>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-python" data-lang="python"><span class="line"><span class="cl"><span class="n">client</span> <span class="o">=</span> <span class="n">kfp</span><span class="o">.</span><span class="n">Client</span><span class="p">()</span> <span class="c1"># change arguments accordingly</span>
</span></span></code></pre></div><p>For more information about the Kubeflow Pipelines SDK, see the <a href="https://kubeflow-pipelines.readthedocs.io/en/stable/index.html">SDK reference guide</a>.</p>
<h2 id="getting-started-with-python-function-based-components">Getting started with Python function-based components</h2>
<p>This section demonstrates how to get started building Python function-based components by walking
through the process of creating a simple component.</p>
<ol>
<li>Define your component&rsquo;s code as a <a href="#standalone">standalone python function</a>.
In this example, the function adds two floats and returns the sum of the two
arguments. Use the <code>kfp.v2.dsl.component</code> annotation to convert the function
into a factory function that you can use to create
<a href="https://kubeflow-pipelines.readthedocs.io/en/stable/source/kfp.dsl.html#kfp.dsl.ContainerOp"><code>kfp.dsl.ContainerOp</code></a> class instances to use as steps in your pipeline.</li>
</ol>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-python" data-lang="python"><span class="line"><span class="cl"><span class="nd">@component</span>
</span></span><span class="line"><span class="cl"><span class="k">def</span> <span class="nf">add</span><span class="p">(</span><span class="n">a</span><span class="p">:</span> <span class="nb">float</span><span class="p">,</span> <span class="n">b</span><span class="p">:</span> <span class="nb">float</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">float</span><span class="p">:</span>
</span></span><span class="line"><span class="cl">  <span class="s1">&#39;&#39;&#39;Calculates sum of two arguments&#39;&#39;&#39;</span>
</span></span><span class="line"><span class="cl">  <span class="k">return</span> <span class="n">a</span> <span class="o">+</span> <span class="n">b</span>
</span></span></code></pre></div><ol start="2">
<li>Create and run your pipeline. <a href="https://www.kubeflow.org/docs/components/pipelines/sdk-v2/build-pipeline/#compile-and-run-your-pipeline">Learn more about creating and running pipelines</a>.</li>
</ol>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-python" data-lang="python"><span class="line"><span class="cl"><span class="kn">import</span> <span class="nn">kfp.dsl</span> <span class="k">as</span> <span class="nn">dsl</span>
</span></span><span class="line"><span class="cl"><span class="nd">@dsl</span><span class="o">.</span><span class="n">pipeline</span><span class="p">(</span>
</span></span><span class="line"><span class="cl">  <span class="n">name</span><span class="o">=</span><span class="s1">&#39;addition-pipeline&#39;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">  <span class="n">description</span><span class="o">=</span><span class="s1">&#39;An example pipeline that performs addition calculations.&#39;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">  <span class="n">pipeline_root</span><span class="o">=</span><span class="s1">&#39;gs://my-pipeline-root/example-pipeline&#39;</span>
</span></span><span class="line"><span class="cl"><span class="p">)</span>
</span></span><span class="line"><span class="cl"><span class="k">def</span> <span class="nf">add_pipeline</span><span class="p">(</span>
</span></span><span class="line"><span class="cl">  <span class="n">a</span><span class="p">:</span> <span class="nb">float</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">  <span class="n">b</span><span class="p">:</span> <span class="nb">float</span><span class="o">=</span><span class="mi">7</span><span class="p">,</span>
</span></span><span class="line"><span class="cl"><span class="p">):</span>
</span></span><span class="line"><span class="cl">  <span class="c1"># Passes a pipeline parameter and a constant value to the `add` factory</span>
</span></span><span class="line"><span class="cl">  <span class="c1"># function.</span>
</span></span><span class="line"><span class="cl">  <span class="n">first_add_task</span> <span class="o">=</span> <span class="n">add</span><span class="p">(</span><span class="n">a</span><span class="p">,</span> <span class="mi">4</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">  <span class="c1"># Passes an output reference from `first_add_task` and a pipeline parameter</span>
</span></span><span class="line"><span class="cl">  <span class="c1"># to the `add` factory function. For operations with a single return</span>
</span></span><span class="line"><span class="cl">  <span class="c1"># value, the output reference can be accessed as `task.output` or</span>
</span></span><span class="line"><span class="cl">  <span class="c1"># `task.outputs[&#39;output_name&#39;]`.</span>
</span></span><span class="line"><span class="cl">  <span class="n">second_add_task</span> <span class="o">=</span> <span class="n">add</span><span class="p">(</span><span class="n">first_add_task</span><span class="o">.</span><span class="n">output</span><span class="p">,</span> <span class="n">b</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="c1"># Specify pipeline argument values</span>
</span></span><span class="line"><span class="cl"><span class="n">arguments</span> <span class="o">=</span> <span class="p">{</span><span class="s1">&#39;a&#39;</span><span class="p">:</span> <span class="mi">7</span><span class="p">,</span> <span class="s1">&#39;b&#39;</span><span class="p">:</span> <span class="mi">8</span><span class="p">}</span>
</span></span></code></pre></div><ol start="3">
<li>Compile and run your pipeline. <a href="https://www.kubeflow.org/docs/components/pipelines/sdk-v2/build-pipeline/#compile-and-run-your-pipeline">Learn more about compiling and running pipelines</a>.</li>
</ol>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-python" data-lang="python"><span class="line"><span class="cl"><span class="c1"># Submit a pipeline run using the v2 compatible mode</span>
</span></span><span class="line"><span class="cl"><span class="n">client</span><span class="o">.</span><span class="n">create_run_from_pipeline_func</span><span class="p">(</span>
</span></span><span class="line"><span class="cl">    <span class="n">add_pipeline</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">    <span class="n">arguments</span><span class="o">=</span><span class="n">arguments</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">    <span class="n">mode</span><span class="o">=</span><span class="n">kfp</span><span class="o">.</span><span class="n">dsl</span><span class="o">.</span><span class="n">PipelineExecutionMode</span><span class="o">.</span><span class="n">V2_COMPATIBLE</span><span class="p">)</span>
</span></span></code></pre></div><h2 id="building-python-function-based-components">Building Python function-based components</h2>
<p>Use the following instructions to build a Python function-based component:</p>
<p><a name="standalone"></a></p>
<ol>
<li>
<p>Define a standalone Python function. This function must meet the following
requirements:</p>
<ul>
<li>It should not use any code declared outside of the function definition.</li>
<li>Import statements must be added inside the function. <a href="#packages">Learn more about
using and installing Python packages in your component</a>.</li>
<li>Helper functions must be defined inside this function.</li>
</ul>
</li>
<li>
<p>Kubeflow Pipelines uses your function&rsquo;s inputs and outputs to define your
component&rsquo;s interface. <a href="#pass-data">Learn more about passing data between
components</a>. Your function&rsquo;s inputs and outputs must meet the
following requirements:</p>
<ul>
<li>All your function&rsquo;s arguments must have data type annotations.</li>
<li>If the function accepts or returns large amounts of data or complex
data types, you must annotate that argument as an <em>artifact</em>.
<a href="#pass-by-file">Learn more about using large amounts of data as inputs or outputs</a>.</li>
<li>If your component returns multiple outputs, you can annotate your
function with the <a href="https://docs.python.org/3/library/typing.html#typing.NamedTuple"><code>typing.NamedTuple</code></a> type hint
and use the <a href="https://docs.python.org/3/library/collections.html#collections.namedtuple"><code>collections.namedtuple</code></a> function return
your function&rsquo;s outputs as a new subclass of tuple. For an example, read
<a href="#pass-by-value">Passing parameters by value</a>.</li>
</ul>
</li>
<li>
<p>(Optional.) If your function has complex dependencies, choose or build a
container image for your Python function to run in. <a href="#containers">Learn more about
selecting or building your component&rsquo;s container image</a>.</p>
</li>
<li>
<p>Add the <a href="https://github.com/kubeflow/pipelines/blob/sdk/release-1.8/sdk/python/kfp/v2/components/component_decorator.py"><code>kfp.v2.dsl.component</code></a> decorator to convert your function
into a pipeline component. You can specify the following arguments to the decorator:</p>
<ul>
<li><strong>base_image</strong>: (Optional.) Specify the Docker container image to run
this function in. <a href="#containers">Learn more about selecting or building a container
image</a>.</li>
<li><strong>output_component_file</strong>: (Optional.) Writes your component definition
to a file. You can use this file to share the component with colleagues
or reuse it in different pipelines.</li>
<li><strong>packages_to_install</strong>: (Optional.) A list of versioned Python
packages to install before running your function.</li>
</ul>
</li>
</ol>
<p><a name="packages"></a></p>
<h3 id="using-and-installing-python-packages">Using and installing Python packages</h3>
<p>When Kubeflow Pipelines runs your pipeline, each component runs within a Docker
container image on a Kubernetes Pod. To load the packages that your Python
function depends on, one of the following must be true:</p>
<ul>
<li>The package must be installed on the container image.</li>
<li>The package must be defined using the <code>packages_to_install</code> parameter of the
<a href="https://github.com/kubeflow/pipelines/blob/sdk/release-1.8/sdk/python/kfp/v2/components/component_decorator.py"><code>kfp.v2.dsl.component</code></a> decorator.</li>
<li>Your function must install the package. For example, your function can use
the <a href="https://docs.python.org/3/library/subprocess.html"><code>subprocess</code> module</a> to run a command like <code>pip install</code>
that installs a package.</li>
</ul>
<p><a name="containers"></a></p>
<h3 id="selecting-or-building-a-container-image">Selecting or building a container image</h3>
<p>Currently, if you do not specify a container image, your Python-function based
component uses the <a href="https://hub.docker.com/layers/python/library/python/3.7/images/sha256-7eef781ed825f3b95c99f03f4189a8e30e718726e8490651fa1b941c6c815ad1?context=explore"><code>python:3.7</code> container image</a>. If your function
has complex dependencies, you may benefit from using a container image that has
your dependencies preinstalled, or building a custom container image.
Preinstalling your dependencies reduces the amount of time that your component
runs in, since your component does not need to download and install packages
each time it runs.</p>
<p>Many frameworks, such as <a href="https://www.tensorflow.org/install/docker">TensorFlow</a> and <a href="https://hub.docker.com/r/pytorch/pytorch/tags">PyTorch</a>,
and cloud service providers offer prebuilt container images that have common
dependencies installed.</p>
<p>If a prebuilt container is not available, you can build a custom container
image with your Python function&rsquo;s dependencies. For more information about
building a custom container, read the <a href="https://docs.docker.com/engine/reference/builder/">Dockerfile reference guide in the Docker
documentation</a>.</p>
<p>If you build or select a container image, instead of using the default
container image, the container image must use Python 3.5 or later.</p>
<p><a name="pass-data"></a></p>
<h3 id="understanding-how-data-is-passed-between-components">Understanding how data is passed between components</h3>
<p>When Kubeflow Pipelines runs your component, a container image is started in a
Kubernetes Pod and your component&rsquo;s inputs are passed in as command-line
arguments. When your component has finished, the components outputs are
returned as files.</p>
<p>Python function-based components make it easier to build pipeline components by
building the component specification for you. Python function-based components
also handle the complexity of passing inputs into your component and passing
your function&rsquo;s outputs back to your pipeline.</p>
<p>Component inputs and outputs are classified as either <em>parameters</em> or <em>artifacts</em>,
depending on their data type.</p>
<ul>
<li>
<p>Parameters typically represent settings that affect the behavior of your pipeline.
Parameters are passed into your component by value, and can be of any of
the following types: <code>int</code>, <code>double</code>, <code>float</code>, or <code>str</code>. Since parameters are
passed by value, the quantity of data passed in a parameter must be appropriate
to pass as a command-line argument.</p>
</li>
<li>
<p>Artifacts represent large or complex data structures like datasets or models, and
are passed into components as a reference to a file path.</p>
<p>If you have large amounts of string data to pass to your component, such as a JSON
file, annotate that input or output as a type of <a href="https://github.com/kubeflow/pipelines/blob/sdk/release-1.8/sdk/python/kfp/dsl/io_types.py"><code>Artifact</code></a>, such
as <a href="https://github.com/kubeflow/pipelines/blob/sdk/release-1.8/sdk/python/kfp/dsl/io_types.py"><code>Dataset</code></a>, to let Kubeflow Pipelines know to pass this to
your component as a file.</p>
<p>In addition to the artifacts data, you can also read and write the artifact&rsquo;s
metadata. For output artifacts, you can record metadata as key-value pairs, such
as the accuracy of a trained model. For input artifacts, you can read the
artifact&rsquo;s metadata  for example, you could use metadata to decide if a
model is accurate enough to deploy for predictions.</p>
</li>
</ul>
<p>All outputs are returned as files, using the the paths that Kubeflow Pipelines
provides.</p>
<p>The following sections describe how to pass parameters and artifacts to your function.</p>
<p><a name="pass-by-value"></a></p>
<h4 id="passing-parameters-by-value">Passing parameters by value</h4>
<p>Python function-based components make it easier to pass parameters between
components by value (such as numbers, booleans, and short strings), by letting
you define your components interface by annotating your Python function.
Parameters can be of any type that is appropriate to pass as a command-line argument, such as <code>int</code>, <code>float</code>, <code>double</code>, or <code>str</code>.</p>
<p>If your component returns multiple outputs by value, annotate your function
with the <a href="https://docs.python.org/3/library/typing.html#typing.NamedTuple"><code>typing.NamedTuple</code></a> type hint and use the
<a href="https://docs.python.org/3/library/collections.html#collections.namedtuple"><code>collections.namedtuple</code></a> function to return your function&rsquo;s
outputs as a new subclass of <code>tuple</code>.</p>
<p>The following example demonstrates how to return multiple outputs by value.</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-python" data-lang="python"><span class="line"><span class="cl"><span class="kn">from</span> <span class="nn">typing</span> <span class="kn">import</span> <span class="n">NamedTuple</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="nd">@component</span>
</span></span><span class="line"><span class="cl"><span class="k">def</span> <span class="nf">multiple_return_values_example</span><span class="p">(</span><span class="n">a</span><span class="p">:</span> <span class="nb">float</span><span class="p">,</span> <span class="n">b</span><span class="p">:</span> <span class="nb">float</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">NamedTuple</span><span class="p">(</span>
</span></span><span class="line"><span class="cl">  <span class="s1">&#39;ExampleOutputs&#39;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">  <span class="p">[</span>
</span></span><span class="line"><span class="cl">    <span class="p">(</span><span class="s1">&#39;sum&#39;</span><span class="p">,</span> <span class="nb">float</span><span class="p">),</span>
</span></span><span class="line"><span class="cl">    <span class="p">(</span><span class="s1">&#39;product&#39;</span><span class="p">,</span> <span class="nb">float</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">  <span class="p">]):</span>
</span></span><span class="line"><span class="cl">  <span class="s2">&#34;&#34;&#34;Example function that demonstrates how to return multiple values.&#34;&#34;&#34;</span>  
</span></span><span class="line"><span class="cl">  <span class="n">sum_value</span> <span class="o">=</span> <span class="n">a</span> <span class="o">+</span> <span class="n">b</span>
</span></span><span class="line"><span class="cl">  <span class="n">product_value</span> <span class="o">=</span> <span class="n">a</span> <span class="o">*</span> <span class="n">b</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">  <span class="kn">from</span> <span class="nn">collections</span> <span class="kn">import</span> <span class="n">namedtuple</span>
</span></span><span class="line"><span class="cl">  <span class="n">example_output</span> <span class="o">=</span> <span class="n">namedtuple</span><span class="p">(</span><span class="s1">&#39;ExampleOutputs&#39;</span><span class="p">,</span> <span class="p">[</span><span class="s1">&#39;sum&#39;</span><span class="p">,</span> <span class="s1">&#39;product&#39;</span><span class="p">])</span>
</span></span><span class="line"><span class="cl">  <span class="k">return</span> <span class="n">example_output</span><span class="p">(</span><span class="n">sum_value</span><span class="p">,</span> <span class="n">product_value</span><span class="p">)</span>
</span></span></code></pre></div><p><a name="pass-by-file"></a></p>
<h4 id="passing-artifacts-by-file">Passing artifacts by file</h4>
<p>Python function-based components make it easier to pass files to your
component, or to return files from your component, by letting you annotate
your Python function&rsquo;s arguments as <em>artifacts</em>.
Artifacts represent large or complex data structures like datasets or models, and are passed into components as a reference to a file path.</p>
<p>In addition to the artifacts data, you can also read and write the artifact&rsquo;s metadata. For output artifacts, you can record metadata as key-value pairs, such as the accuracy of a trained model. For input artifacts, you can read the artifact&rsquo;s metadata  for example, you could use metadata to decide if a model is accurate enough to deploy for predictions.</p>
<p>If your artifact is an output file, Kubeflow Pipelines passes your function a
path or stream that you can use to store your output file. This path is a
location within your pipeline&rsquo;s <code>pipeline_root</code> that your component can write to.</p>
<p>The following example accepts a file as an input and returns two files as outputs.</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-python" data-lang="python"><span class="line"><span class="cl"><span class="nd">@component</span>
</span></span><span class="line"><span class="cl"><span class="k">def</span> <span class="nf">split_text_lines</span><span class="p">(</span>
</span></span><span class="line"><span class="cl">    <span class="n">source</span><span class="p">:</span> <span class="n">Input</span><span class="p">[</span><span class="n">Dataset</span><span class="p">],</span>
</span></span><span class="line"><span class="cl">    <span class="n">odd_lines</span><span class="p">:</span> <span class="n">Output</span><span class="p">[</span><span class="n">Dataset</span><span class="p">],</span>
</span></span><span class="line"><span class="cl">    <span class="n">even_lines_path</span><span class="p">:</span> <span class="n">Output</span><span class="p">[</span><span class="n">Dataset</span><span class="p">]):</span>
</span></span><span class="line"><span class="cl">    <span class="s2">&#34;&#34;&#34;Splits a text file into two files, with even lines going to one file
</span></span></span><span class="line"><span class="cl"><span class="s2">    and odd lines to the other.&#34;&#34;&#34;</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">    <span class="k">with</span> <span class="nb">open</span><span class="p">(</span><span class="n">source</span><span class="o">.</span><span class="n">path</span><span class="p">,</span> <span class="s1">&#39;r&#39;</span><span class="p">)</span> <span class="k">as</span> <span class="n">reader</span><span class="p">:</span>
</span></span><span class="line"><span class="cl">        <span class="k">with</span> <span class="nb">open</span><span class="p">(</span><span class="n">odd_lines</span><span class="o">.</span><span class="n">path</span><span class="p">,</span> <span class="s1">&#39;w&#39;</span><span class="p">)</span> <span class="k">as</span> <span class="n">odd_writer</span><span class="p">:</span>
</span></span><span class="line"><span class="cl">            <span class="k">with</span> <span class="nb">open</span><span class="p">(</span><span class="n">even_lines_path</span><span class="p">,</span> <span class="s1">&#39;w&#39;</span><span class="p">)</span> <span class="k">as</span> <span class="n">even_writer</span><span class="p">:</span>
</span></span><span class="line"><span class="cl">                <span class="k">while</span> <span class="kc">True</span><span class="p">:</span>
</span></span><span class="line"><span class="cl">                    <span class="n">line</span> <span class="o">=</span> <span class="n">reader</span><span class="o">.</span><span class="n">readline</span><span class="p">()</span>
</span></span><span class="line"><span class="cl">                    <span class="k">if</span> <span class="n">line</span> <span class="o">==</span> <span class="s2">&#34;&#34;</span><span class="p">:</span>
</span></span><span class="line"><span class="cl">                        <span class="k">break</span>
</span></span><span class="line"><span class="cl">                    <span class="n">odd_writer</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="n">line</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">                    <span class="n">line</span> <span class="o">=</span> <span class="n">reader</span><span class="o">.</span><span class="n">readline</span><span class="p">()</span>
</span></span><span class="line"><span class="cl">                    <span class="k">if</span> <span class="n">line</span> <span class="o">==</span> <span class="s2">&#34;&#34;</span><span class="p">:</span>
</span></span><span class="line"><span class="cl">                        <span class="k">break</span>
</span></span><span class="line"><span class="cl">                    <span class="n">even_writer</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="n">line</span><span class="p">)</span>
</span></span></code></pre></div><p>In this example, the inputs and outputs are defined as arguments of the
<code>split_text_lines</code> function. This lets Kubeflow Pipelines pass the path to the
source data file and the paths to the output data files into the function.</p>
<p>To accept a file as an input parameter, use one of the following type annotations:</p>
<ul>
<li><a href="https://github.com/kubeflow/pipelines/blob/c5daa7532d18687b180badfca8d750c801805712/sdk/python/kfp/dsl/io_types.py"><code>kfp.dsl.Input</code></a>: Use this generic type hint to specify that your
function expects this argument to be an <a href="https://github.com/kubeflow/pipelines/blob/sdk/release-1.8/sdk/python/kfp/dsl/io_types.py"><code>Artifact</code></a>. Your
function can use the argument&rsquo;s <code>path</code> property to get the
artifact&rsquo;s path, and the <code>metadata</code> property to read its key/value metadata.</li>
<li><a href="https://kubeflow-pipelines.readthedocs.io/en/latest/source/kfp.components.html#kfp.components.InputBinaryFile"><code>kfp.components.InputBinaryFile</code></a>: Use this annotation to
specify that your function expects an argument to be an
<a href="https://docs.python.org/3/library/io.html#io.BytesIO"><code>io.BytesIO</code></a> instance that this function can read.</li>
<li><a href="https://kubeflow-pipelines.readthedocs.io/en/latest/source/kfp.components.html#kfp.components.InputPath"><code>kfp.components.InputPath</code></a>: Use this annotation to specify that
your function expects an argument to be the path to the input file as
a <code>string</code>.</li>
<li><a href="https://kubeflow-pipelines.readthedocs.io/en/latest/source/kfp.components.html#kfp.components.InputTextFile"><code>kfp.components.InputTextFile</code></a>: Use this annotation to specify
that your function expects an argument to be an
<a href="https://docs.python.org/3/library/io.html#io.TextIOWrapper"><code>io.TextIOWrapper</code></a> instance that this function can read.</li>
</ul>
<p>To return a file as an output, use one of the following type annotations:</p>
<ul>
<li><a href="https://github.com/kubeflow/pipelines/blob/c5daa7532d18687b180badfca8d750c801805712/sdk/python/kfp/dsl/io_types.py"><code>kfp.dsl.Output</code></a>: Use this generic type hin to specify that your
function expects this argument to be an <a href="https://github.com/kubeflow/pipelines/blob/sdk/release-1.8/sdk/python/kfp/dsl/io_types.py"><code>Artifact</code></a>. Your
function can use the argument&rsquo;s <code>path</code> property to get the
artifact path to write to, and the <code>metadata</code> property to log key/value metadata.</li>
<li><a href="https://kubeflow-pipelines.readthedocs.io/en/latest/source/kfp.components.html#kfp.components.OutputBinaryFile"><code>kfp.components.OutputBinaryFile</code></a>: Use this annotation to
specify that your function expects an argument to be an
<a href="https://docs.python.org/3/library/io.html#io.BytesIO"><code>io.BytesIO</code></a> instance that this function can write to.</li>
<li><a href="https://kubeflow-pipelines.readthedocs.io/en/latest/source/kfp.components.html#kfp.components.OutputPath"><code>kfp.components.OutputPath</code></a>: Use this annotation to specify that
your function expects an argument to be the path to store the output file at
as a <code>string</code>.</li>
<li><a href="https://kubeflow-pipelines.readthedocs.io/en/latest/source/kfp.components.html#kfp.components.OutputTextFile"><code>kfp.components.OutputTextFile</code></a>: Use this annotation to specify
that your function expects an argument to be an
<a href="https://docs.python.org/3/library/io.html#io.TextIOWrapper"><code>io.TextIOWrapper</code></a> that this function can write to.</li>
</ul>
<h2 id="example-python-function-based-component">Example Python function-based component</h2>
<p>This section demonstrates how to build a Python function-based component that uses imports,
helper functions, and produces multiple outputs.</p>
<ol>
<li>
<p>Define your function. This example function uses the <code>numpy</code> package to calculate the
quotient and remainder for a given dividend and divisor in a helper function. In
addition to the quotient and remainder, the function also returns two metrics.</p>
<p>By adding the <code>@component</code> annotation, you convert your function into a factory function
that creates pipeline steps that execute this function. This example also specifies the
base container image to run you component in.</p>
</li>
</ol>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-python" data-lang="python"><span class="line"><span class="cl"><span class="kn">from</span> <span class="nn">typing</span> <span class="kn">import</span> <span class="n">NamedTuple</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="nd">@component</span><span class="p">(</span><span class="n">base_image</span><span class="o">=</span><span class="s1">&#39;tensorflow/tensorflow:1.11.0-py3&#39;</span><span class="p">)</span>
</span></span><span class="line"><span class="cl"><span class="k">def</span> <span class="nf">my_divmod</span><span class="p">(</span>
</span></span><span class="line"><span class="cl">  <span class="n">dividend</span><span class="p">:</span> <span class="nb">float</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">  <span class="n">divisor</span><span class="p">:</span> <span class="nb">float</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">  <span class="n">metrics</span><span class="p">:</span> <span class="n">Output</span><span class="p">[</span><span class="n">Metrics</span><span class="p">])</span> <span class="o">-&gt;</span> <span class="n">NamedTuple</span><span class="p">(</span>
</span></span><span class="line"><span class="cl">    <span class="s1">&#39;MyDivmodOutput&#39;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">    <span class="p">[</span>
</span></span><span class="line"><span class="cl">      <span class="p">(</span><span class="s1">&#39;quotient&#39;</span><span class="p">,</span> <span class="nb">float</span><span class="p">),</span>
</span></span><span class="line"><span class="cl">      <span class="p">(</span><span class="s1">&#39;remainder&#39;</span><span class="p">,</span> <span class="nb">float</span><span class="p">),</span>
</span></span><span class="line"><span class="cl">    <span class="p">]):</span>
</span></span><span class="line"><span class="cl">    <span class="s1">&#39;&#39;&#39;Divides two numbers and calculate  the quotient and remainder&#39;&#39;&#39;</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">    <span class="c1"># Import the numpy package inside the component function</span>
</span></span><span class="line"><span class="cl">    <span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">    <span class="c1"># Define a helper function</span>
</span></span><span class="line"><span class="cl">    <span class="k">def</span> <span class="nf">divmod_helper</span><span class="p">(</span><span class="n">dividend</span><span class="p">,</span> <span class="n">divisor</span><span class="p">):</span>
</span></span><span class="line"><span class="cl">        <span class="k">return</span> <span class="n">np</span><span class="o">.</span><span class="n">divmod</span><span class="p">(</span><span class="n">dividend</span><span class="p">,</span> <span class="n">divisor</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">    <span class="p">(</span><span class="n">quotient</span><span class="p">,</span> <span class="n">remainder</span><span class="p">)</span> <span class="o">=</span> <span class="n">divmod_helper</span><span class="p">(</span><span class="n">dividend</span><span class="p">,</span> <span class="n">divisor</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">    <span class="c1"># Export two metrics</span>
</span></span><span class="line"><span class="cl">    <span class="n">metrics</span><span class="o">.</span><span class="n">log_metric</span><span class="p">(</span><span class="s1">&#39;quotient&#39;</span><span class="p">,</span> <span class="nb">float</span><span class="p">(</span><span class="n">quotient</span><span class="p">))</span>
</span></span><span class="line"><span class="cl">    <span class="n">metrics</span><span class="o">.</span><span class="n">log_metric</span><span class="p">(</span><span class="s1">&#39;remainder&#39;</span><span class="p">,</span> <span class="nb">float</span><span class="p">(</span><span class="n">remainder</span><span class="p">))</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">    <span class="kn">from</span> <span class="nn">collections</span> <span class="kn">import</span> <span class="n">namedtuple</span>
</span></span><span class="line"><span class="cl">    <span class="n">divmod_output</span> <span class="o">=</span> <span class="n">namedtuple</span><span class="p">(</span><span class="s1">&#39;MyDivmodOutput&#39;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">        <span class="p">[</span><span class="s1">&#39;quotient&#39;</span><span class="p">,</span> <span class="s1">&#39;remainder&#39;</span><span class="p">])</span>
</span></span><span class="line"><span class="cl">    <span class="k">return</span> <span class="n">divmod_output</span><span class="p">(</span><span class="n">quotient</span><span class="p">,</span> <span class="n">remainder</span><span class="p">)</span>
</span></span></code></pre></div><ol start="2">
<li>Define your pipeline. This example pipeline uses the <code>my_divmod</code> factory
function and the <code>add</code> factory function from an earlier example.</li>
</ol>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-python" data-lang="python"><span class="line"><span class="cl"><span class="kn">import</span> <span class="nn">kfp.dsl</span> <span class="k">as</span> <span class="nn">dsl</span>
</span></span><span class="line"><span class="cl"><span class="nd">@dsl</span><span class="o">.</span><span class="n">pipeline</span><span class="p">(</span>
</span></span><span class="line"><span class="cl">   <span class="n">name</span><span class="o">=</span><span class="s1">&#39;calculation-pipeline&#39;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">   <span class="n">description</span><span class="o">=</span><span class="s1">&#39;An example pipeline that performs arithmetic calculations.&#39;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">   <span class="n">pipeline_root</span><span class="o">=</span><span class="s1">&#39;gs://my-pipeline-root/example-pipeline&#39;</span>
</span></span><span class="line"><span class="cl"><span class="p">)</span>
</span></span><span class="line"><span class="cl"><span class="k">def</span> <span class="nf">calc_pipeline</span><span class="p">(</span>
</span></span><span class="line"><span class="cl">   <span class="n">a</span><span class="p">:</span> <span class="nb">float</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">   <span class="n">b</span><span class="p">:</span> <span class="nb">float</span><span class="o">=</span><span class="mi">7</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">   <span class="n">c</span><span class="p">:</span> <span class="nb">float</span><span class="o">=</span><span class="mi">17</span><span class="p">,</span>
</span></span><span class="line"><span class="cl"><span class="p">):</span>
</span></span><span class="line"><span class="cl">    <span class="c1"># Passes a pipeline parameter and a constant value as operation arguments.</span>
</span></span><span class="line"><span class="cl">    <span class="n">add_task</span> <span class="o">=</span> <span class="n">add</span><span class="p">(</span><span class="n">a</span><span class="p">,</span> <span class="mi">4</span><span class="p">)</span> <span class="c1"># The add_op factory function returns</span>
</span></span><span class="line"><span class="cl">                            <span class="c1"># a dsl.ContainerOp class instance. </span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">    <span class="c1"># Passes the output of the add_task and a pipeline parameter as operation</span>
</span></span><span class="line"><span class="cl">    <span class="c1"># arguments. For an operation with a single return value, the output</span>
</span></span><span class="line"><span class="cl">    <span class="c1"># reference is accessed using `task.output` or</span>
</span></span><span class="line"><span class="cl">    <span class="c1"># `task.outputs[&#39;output_name&#39;]`.</span>
</span></span><span class="line"><span class="cl">    <span class="n">divmod_task</span> <span class="o">=</span> <span class="n">my_divmod</span><span class="p">(</span><span class="n">add_task</span><span class="o">.</span><span class="n">output</span><span class="p">,</span> <span class="n">b</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">    <span class="c1"># For an operation with multiple return values, output references are</span>
</span></span><span class="line"><span class="cl">    <span class="c1"># accessed as `task.outputs[&#39;output_name&#39;]`.</span>
</span></span><span class="line"><span class="cl">    <span class="n">result_task</span> <span class="o">=</span> <span class="n">add</span><span class="p">(</span><span class="n">divmod_task</span><span class="o">.</span><span class="n">outputs</span><span class="p">[</span><span class="s1">&#39;quotient&#39;</span><span class="p">],</span> <span class="n">c</span><span class="p">)</span>
</span></span></code></pre></div><ol start="3">
<li>Compile and run your pipeline. <a href="https://www.kubeflow.org/docs/components/pipelines/sdk-v2/build-pipeline/#compile-and-run-your-pipeline">Learn more about compiling and running pipelines</a>.</li>
</ol>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-python" data-lang="python"><span class="line"><span class="cl"><span class="c1"># Specify pipeline argument values</span>
</span></span><span class="line"><span class="cl"><span class="n">arguments</span> <span class="o">=</span> <span class="p">{</span><span class="s1">&#39;a&#39;</span><span class="p">:</span> <span class="mi">7</span><span class="p">,</span> <span class="s1">&#39;b&#39;</span><span class="p">:</span> <span class="mi">8</span><span class="p">}</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="c1"># Submit a pipeline run</span>
</span></span><span class="line"><span class="cl"><span class="n">client</span><span class="o">.</span><span class="n">create_run_from_pipeline_func</span><span class="p">(</span>
</span></span><span class="line"><span class="cl">    <span class="n">calc_pipeline</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">    <span class="n">arguments</span><span class="o">=</span><span class="n">arguments</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">    <span class="n">mode</span><span class="o">=</span><span class="n">kfp</span><span class="o">.</span><span class="n">dsl</span><span class="o">.</span><span class="n">PipelineExecutionMode</span><span class="o">.</span><span class="n">V2_COMPATIBLE</span><span class="p">)</span>
</span></span></code></pre></div><div class="notebook-links">
<a class="colab-link" href="https://colab.research.google.com/github/kubeflow/website/blob/master/content/en/docs/components/pipelines/sdk-v2/python-function-components.ipynb">Run in Google Colab</a>
<a class="github-link" href="https://github.com/kubeflow/website/blob/master/content/en/docs/components/pipelines/sdk-v2/python-function-components.ipynb">View source on GitHub</a>
</div>
</div>



    
	
  
    
    
	
    

<div class="td-content" style="page-break-before: always">
    
	<h1 id="pg-469c8de604213a6de88b276eeb473f1b">3.1.6.7 - Importer component</h1>
    <div class="lead">Use an importer component to import artifacts from remote storage</div>
	<p>The KFP SDK v2 provides an importer component as a pre-baked component for a specific use case: importing a machine learning from remote storage to machine learning metadata (MLMD).</p>
<p>Typically, the input artifact to a task is an output from an upstream task. In this case, the artifact can be easily accessed from the upstream task using <code>my_task.outputs['artifact_name']</code>. The artifact is also registered in MLMD when it is created by the upstream task.</p>
<p>If you wish to use an existing artifact that is not generated by a task in the current pipeline <em>or</em> wish to use as an artifact an external file that was not generated by a pipeline at all, you can use an importer component to load an artifact from its URI.</p>
<p>You do not need to write an importer component; it can be imported from the <code>dsl</code> module and used directly:</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-python" data-lang="python"><span class="line"><span class="cl"><span class="kn">from</span> <span class="nn">kfp.v2</span> <span class="kn">import</span> <span class="n">dsl</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="nd">@dsl</span><span class="o">.</span><span class="n">pipeline</span><span class="p">(</span><span class="n">name</span><span class="o">=</span><span class="s1">&#39;pipeline-with-importer&#39;</span><span class="p">)</span>
</span></span><span class="line"><span class="cl"><span class="k">def</span> <span class="nf">my_pipeline</span><span class="p">():</span>
</span></span><span class="line"><span class="cl">    <span class="n">task</span> <span class="o">=</span> <span class="n">get_date_string</span><span class="p">()</span>
</span></span><span class="line"><span class="cl">    <span class="n">importer_task</span> <span class="o">=</span> <span class="n">dsl</span><span class="o">.</span><span class="n">importer</span><span class="p">(</span>
</span></span><span class="line"><span class="cl">        <span class="n">artifact_uri</span><span class="o">=</span><span class="s1">&#39;gs://ml-pipeline-playground/shakespeare1.txt&#39;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">        <span class="n">artifact_class</span><span class="o">=</span><span class="n">dsl</span><span class="o">.</span><span class="n">Dataset</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">        <span class="n">reimport</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">        <span class="n">metadata</span><span class="o">=</span><span class="p">{</span><span class="s1">&#39;date&#39;</span><span class="p">:</span> <span class="n">task</span><span class="o">.</span><span class="n">output</span><span class="p">})</span>
</span></span><span class="line"><span class="cl">    <span class="n">other_component</span><span class="p">(</span><span class="n">dataset</span><span class="o">=</span><span class="n">importer_task</span><span class="o">.</span><span class="n">output</span><span class="p">)</span>
</span></span></code></pre></div><p>In addition to the <code>artifact_uri</code>, you must provide an <code>artifact_class</code>, indicating the type of the artifact.</p>
<p>The <code>importer</code> component permits setting artifact metadata via the <code>metadata</code> argument. Metadata can be constructed with outputs from upstream tasks, as is done for the <code>'date'</code> value in the example pipeline.</p>
<p>You may also specify a boolean <code>reimport</code> argument. If <code>reimport</code> is <code>False</code>, KFP will use an existing MLMD artifact if it already exists from an earlier importer execution. If <code>reimport</code> is <code>True</code>, KFP will reimport the artifact as a new artifact, irrespective of whether it was previously imported.</p>

</div>



    
	
  

    
	
  
    
    
	
    

<div class="td-content" style="page-break-before: always">
    
	<h1 id="pg-570360a90228471336a30a660d70070c">3.1.7 - Samples and Tutorials</h1>
    <div class="lead">Samples and tutorials for Kubeflow Pipelines</div>
	
</div>



    
      
  
  
  
  

  
  

  
    
    
	
    

<div class="td-content" style="">
    
	<h1 id="pg-d5325394cc7abd01614d7b4eb37cb40c">3.1.7.1 - Using the Kubeflow Pipelines Benchmark Scripts</h1>
    <div class="lead">How to use the Kubeflow Pipelines Benchmark Scripts</div>
	<p>This guide explains the Kubeflow Pipelines <a href="https://github.com/kubeflow/pipelines/tree/sdk/release-1.8/tools/benchmarks">benchmark scripts</a>
and demonstrates how to use them to collect basic performance data of a given
Kubeflow Pipelines instance.</p>
<h2 id="about-the-kubeflow-pipelines-benchmark-script">About the Kubeflow Pipelines benchmark script</h2>
<p>The Kubeflow Pipelines benchmark scripts simulate typical workloads and record
performance metrics, such as server latencies and pipeline run durations. To simulate a typical workload, the benchmark script uploads a pipeline
manifest file to a Kubeflow Pipelines instance as a pipeline or
a pipeline version, and creates multiple runs simultaneously.</p>
<p>You can specify the pipelines manifest used in the benchmark script, or you can
use one of the preloaded samples pipelines. For example, the preloaded samples
in Kubeflow pipelines can be used.
Moreover, it is also a good practice to use a pipeline manifest that is representative of your particular use case. For example, if your Kubeflow Pipelines cluster is mainly used for pipelines of image recognition tasks, then it would be desirable to use an image recognition pipeline in the benchmark scripts.</p>
<p>After a proper pipeline is chosen, the benchmark scripts will run it multiple
times simultaneously as mentioned before. Among all the operations that the Kubeflow
Pipelines can perform, running a pipeline is arguably the most unpredictable and
costly one. Other operations, such as creating a pipeline (version) or creating an
experiment, usually induce a predictable and moderate cost. For example, creating a
pipeline version will introduce a new row in the pipeline versions table and a new
file in minio server. The new file&rsquo;s size depends on the pipeline version&rsquo;s
manifest. If we exclude the rare case of an extremely large manifest and assume
an average sized manifest for each created pipeline version, the total cost of
creating a pipeline version grows linearly with the number of pipeline versions.
However, on the other hand, the cost of running a pipeline or a pipeline version
involves much more uncertainty and sometimes quite a high cost. A pipeline or a
pipeline version can have arbitrary components and hence running a pipeline or a
pipeline version can incur arbitrary time and space complexities. For example, a step
in a pipeline can use a customized container image which performs a super
expensive training task. In addition, the runs in a Kubeflow Pipelines instance
also consume more DB space than pipelines, pipeline versions, experiments, etc.
Therefore, in order to understand the performance and scalability pain points in
a Kubeflow Pipelines instance, it is more effective to focus on the run operation
in workloads.</p>
<h2 id="prerequisites-for-running-benchmark-scripts">Prerequisites for running benchmark scripts</h2>
<p>To run the provided benchmark scripts, you need the following:</p>
<ul>
<li>A Jupyter notebook environment with access to the Kubeflow Pipelines API on
your Kubeflow Pipelines cluster. For example, you must be able to call the
<code>CREATE</code>, <code>GET</code>, <code>DELETE</code>, and <code>LIST</code> methods of the pipeline, pipeline version,
run, job, and experiment services from your Jupyter notebook environment.</li>
<li>A Kubeflow Pipelines cluster. If you do not have a Kubeflow Pipelines
cluster, learn more about your <a href="/docs/components/pipelines/installation/overview/">options for installing Kubeflow
Pipelines</a>.</li>
<li>A pipeline manifest. For example, this guide uses the
<a href="https://storage.googleapis.com/ml-pipeline/sample-benchmark/taxi_updated_pool.yaml">taxi_updated_pool.yaml</a>
pipeline manifest file.</li>
</ul>
<p>One way of setting up everything and running a benchmark script is shown below
as an example.</p>
<h2 id="running-the-benchmark-scripts">Running the benchmark scripts</h2>
<p>Use the following instructions to run the benchmark script on your Kubeflow
Pipelines cluster.</p>
<ol>
<li>
<p>Download the <a href="https://storage.googleapis.com/ml-pipeline/sample-benchmark/run_service_api.ipynb"><code>run_service_api.ipynb</code></a>
benchmark script in your Jupyter notebook environment.</p>
</li>
<li>
<p>Open <a href="https://storage.googleapis.com/ml-pipeline/sample-benchmark/run_service_api.ipynb"><code>run_service_api.ipynb</code></a>
in the local Jupyter notebook. This benchmark script:</p>
<ol>
<li>Creates a new pipeline.</li>
<li>Uses the default pipeline version of this pipeline to create multiple runs.</li>
<li>Records the number of successful runs.</li>
<li>Records the duration of each of the successful runs.</li>
<li>Records the latency of <code>CREATE</code>, <code>GET</code>, <code>DELETE</code>.</li>
<li>Cleans up the pipeline and its default pipeline version, the experiment and the runs.</li>
</ol>
</li>
<li>
<p>In the benchmark script, enter the correct values for host,
<code>pipeline_file_url</code>, <code>num_runs</code>, <code>run_status_polling_interval_sec</code> in the
benchmark script.</p>
<ul>
<li>
<p><strong>host</strong>: The URL of the API server in your Kubeflow Pipelines cluster.</p>
</li>
<li>
<p><strong>pipeline_file_url</strong>: The URL of the pipeline manifest file to use in
your benchmark.
<a href="https://storage.googleapis.com/ml-pipeline/sample-benchmark/taxi_updated_pool.yaml"><code>taxi_updated_pool.yaml</code></a>
is used in this example. This example pipeline makes use of
<a href="https://kubernetes.io/docs/concepts/scheduling-eviction/assign-pod-node/#nodeselector">nodeSelector</a>
to explicitly schedule the runs of this pipeline onto the node pool named <code>pool-1</code>. If you use the taxi_updated_pool.yaml pipeline manifest in your benchmarks, ensure that a node pool named <code>pool-1</code> exists in your cluster.</p>
<p><strong>NOTE</strong>: Do not use the value <code>https://storage.cloud.google.com/ml-pipeline/sample-benchmark/taxi_updated_pool.yaml</code>
when running your benchmarks. Addresses that start with
<code>storage.cloud.google.com</code> incur a redirect that doesn&rsquo;t work well with
Kubeflow Pipelines.</p>
</li>
<li>
<p><strong>num_runs</strong>: Specifies how many runs will be created in the benchmark script,
and is a direct indicator of the simulated workload.</p>
<p><strong>NOTE</strong>: Running the benchmark script on a cloud
service incurs charges due to the consumption of cloud resources.</p>
</li>
<li>
<p><strong>run_status_polling_interval_sec</strong>: Sets the time interval between two
adjacent pollings of the run status. When a run reaches the success status, the
run duration is recorded. Only the durations of successful runs are recorded.</p>
</li>
</ul>
</li>
<li>
<p>After the parameters are properly set, you can run the
benchmark script in the notebook.</p>
</li>
</ol>
<p>The following snapshot shows the results of running the benchmark script
<a href="https://storage.googleapis.com/ml-pipeline/sample-benchmark/run_service_api.ipynb"><code>run_service_api.ipynb</code></a>
using the <a href="https://storage.googleapis.com/ml-pipeline/sample-benchmark/taxi_updated_pool.yaml"><code>taxi_updated_pool.yaml</code></a>
pipeline manifest for 50 runs on a Kubernetes cluster with two node pools.
Each node pool has three nodes of machine type <code>n1-standard-8</code>.</p>
<p><img src="/docs/images/benchmark-snapshot-1.png"
alt="Benchmark Sample Output Plots"
class="mt-3 mb-3 border border-info rounded"></p>
<h2 id="interpreting-the-results">Interpreting the results</h2>
<p>In the above example output, there are two types of plots. One is the
distribution plot, for latency and duration measurement; the other is the count
plot, for counting succeeded and failed runs. The reading of those plots is in
general straightforward.</p>
<p>In a count plot, the x-axis represents the possible run status: success or fail;
and the y-axis shows how many runs fall into certain status respectively.</p>
<p>In a distribution plot, both histogram plot and rug plot are shown. In addition,
it is also possible to show a KDE (Kernel Density Estimate) plot. If the KDE plot is
desirable, use <code>kde=True</code> in the <code>distplot()</code> method.</p>
<h2 id="tuning-with-different-configurations">Tuning with different configurations</h2>
<p>The above example shows one performance report via running the benchmark script.
In fact, there are multiple ways of tuning the pipeline and/or the Kubernetes
clusters to acquire performance reports. The common ways are trying with</p>
<ul>
<li>
<p>Different cluster sizes/zones, different numbers of pools in a cluster,
different numbers of nodes in each pool, different node configurations (for
example, RAM and disk configuration for each node, CPU or GPU configuration for
each node)</p>
</li>
<li>
<p>Different number of runs</p>
</li>
<li>
<p>Different sizes/complexities of a pipeline, for example, the number of steps
in a pipeline</p>
</li>
<li>
<p>Different running configurations, for example, specifying the node pools for
running components or pipelines</p>
</li>
<li>
<p>Etc.</p>
</li>
</ul>
<h2 id="limitations-and-future-work">Limitations and future work</h2>
<p>When the benchmark script is tuned to generate a moderate workload, for example, 50
runs in the above example, the latency and run duration measurements can be
made properly. However, it is also interesting to see how a Kubeflow Pipelines
instance behaves or breaks under some extremely heavy workloads, or in
other words, to probe the Kubeflow Pipelines instance. The example benchmark
script can be used for that purpose as well. In that case, the measurement plots
of the benchmark script are no longer the expected output. Instead, the errors
and error logs provide information on the performance and scalability of the
Kubeflow Pipelines deployment. With them, bugs and pain points can be discovered and then fixed. Moreover, when probing the
Kubeflow Pipelines instance with extreme workloads, it will be really helpful
to add internal monitoring to the server code to track server performance.
For example, in the future, it would be desirable to use <a href="https://prometheus.io/">Prometheus</a>
to track and visualize metrics for Kubeflow Pipelines servers.</p>
<p>The internal performance monitoring inside the servers is complementary to the
performance measurement from the client-side. When the example benchmark script
measures the latencies from the client-side, the resulting measurements depend
on both the Kubeflow Pipelines instance and the network transmission. On the
other hand, the internal monitoring focuses on the actual processing cost inside
the server given certain requests. Therefore, having both the client-side
measurements and server side monitoring are useful in profiling accurately the
performance and scalability of Kubeflow Pipelines.</p>
<h2 id="contact">Contact</h2>
<p>If you run into any issues with the benchmark script and have any suggestions in
profiling the performance and scalability of Kubeflow Pipelines, <a href="https://github.com/kubeflow/pipelines/issues/new">open an
issue</a> with us.</p>

</div>



    
	
  
    
    
	
    

<div class="td-content" style="page-break-before: always">
    
	<h1 id="pg-55ead7004b3cd366b5decb7eba327a38">3.1.7.2 - Using the Kubeflow Pipelines SDK</h1>
    <div class="lead">How to use the Kubeflow Pipelines SDK</div>
	<p>This guide provides examples that demonstrate how to use the Kubeflow Pipelines SDK.</p>
<h2 id="before-you-start">Before you start</h2>
<p>To follow the examples in this guide, you must have Kubeflow Pipelines SDK
version 0.2.5 or higher installed. Use the following instructions to install
the Kubeflow Pipelines SDK and check the SDK version.</p>
<ol>
<li>Install the <a href="/docs/components/pipelines/sdk/install-sdk/">Kubeflow Pipelines SDK</a></li>
<li>Run the following command to check the version of the SDK
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-fallback" data-lang="fallback"><span class="line"><span class="cl">pip list | grep kfp
</span></span></code></pre></div>The response should be something like this:
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-fallback" data-lang="fallback"><span class="line"><span class="cl">kfp                      0.2.5
</span></span><span class="line"><span class="cl">kfp-server-api           0.2.5
</span></span></code></pre></div></li>
</ol>
<h2 id="examples">Examples</h2>
<p>Use the following examples to learn more about the Kubeflow Pipelines SDK.</p>
<h3 id="example-1-creating-a-pipeline-and-a-pipeline-version-using-the-sdk">Example 1: Creating a pipeline and a pipeline version using the SDK</h3>
<p>The following example demonstrates how to use the Kubeflow Pipelines SDK to
create a pipeline and a pipeline version.</p>
<p>In this example, you:</p>
<ul>
<li>Use <code>kfp.Client</code> to create a pipeline from a local file. When the pipeline
is created, a default pipeline version is automatically created.</li>
<li>Use <code>kfp.Client</code> to add a pipeline version to the pipeline that was created
in the previous step.</li>
</ul>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-python" data-lang="python"><span class="line"><span class="cl"><span class="kn">import</span> <span class="nn">kfp</span>
</span></span><span class="line"><span class="cl"><span class="kn">import</span> <span class="nn">os</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="n">host</span> <span class="o">=</span> <span class="o">&lt;</span><span class="n">host</span><span class="o">&gt;</span>
</span></span><span class="line"><span class="cl"><span class="n">pipeline_file_path</span> <span class="o">=</span> <span class="o">&lt;</span><span class="n">path</span> <span class="n">to</span> <span class="n">pipeline</span> <span class="n">file</span><span class="o">&gt;</span>
</span></span><span class="line"><span class="cl"><span class="n">pipeline_name</span> <span class="o">=</span> <span class="o">&lt;</span><span class="n">pipeline</span> <span class="n">name</span><span class="o">&gt;</span>
</span></span><span class="line"><span class="cl"><span class="n">pipeline_version_file_path</span> <span class="o">=</span> <span class="o">&lt;</span><span class="n">path</span> <span class="n">to</span> <span class="n">pipeline</span> <span class="n">version</span> <span class="n">file</span><span class="o">&gt;</span>
</span></span><span class="line"><span class="cl"><span class="n">pipeline_version_name</span> <span class="o">=</span> <span class="o">&lt;</span><span class="n">pipeline</span> <span class="n">version</span> <span class="n">name</span><span class="o">&gt;</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="n">client</span> <span class="o">=</span> <span class="n">kfp</span><span class="o">.</span><span class="n">Client</span><span class="p">(</span><span class="n">host</span><span class="p">)</span>
</span></span><span class="line"><span class="cl"><span class="n">pipeline_file</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">pipeline_file_path</span><span class="p">)</span>
</span></span><span class="line"><span class="cl"><span class="n">pipeline</span> <span class="o">=</span> <span class="n">client</span><span class="o">.</span><span class="n">pipeline_uploads</span><span class="o">.</span><span class="n">upload_pipeline</span><span class="p">(</span><span class="n">pipeline_file</span><span class="p">,</span> <span class="n">name</span><span class="o">=</span><span class="n">pipeline_name</span><span class="p">)</span>
</span></span><span class="line"><span class="cl"><span class="n">pipeline_version_file</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">pipeline_version_file_path</span><span class="p">)</span>
</span></span><span class="line"><span class="cl"><span class="n">pipeline_version</span> <span class="o">=</span> <span class="n">client</span><span class="o">.</span><span class="n">pipeline_uploads</span><span class="o">.</span><span class="n">upload_pipeline_version</span><span class="p">(</span><span class="n">pipeline_version_file</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">                                                                   <span class="n">name</span><span class="o">=</span><span class="n">pipeline_version_name</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">                                                                   <span class="n">pipelineid</span><span class="o">=</span><span class="n">pipeline</span><span class="o">.</span><span class="n">id</span><span class="p">)</span>
</span></span></code></pre></div><ul>
<li><strong>host</strong>: Your Kubeflow Pipelines cluster&rsquo;s host name.</li>
<li><strong>path to pipeline file</strong>: The path to the directory where your pipeline YAML
is stored.</li>
<li><strong>pipeline name</strong>: Your pipeline&rsquo;s file name.</li>
<li><strong>path to pipeline version file</strong>: The path to the directory where the new
version of your pipeline YAML is stored.</li>
<li><strong>pipeline version name</strong>: Your pipeline version&rsquo;s file name.</li>
</ul>
<p><strong>Note:</strong> Pipeline names need to be unique across your Kubeflow Pipelines
cluster. Pipeline version names need to be unique within each pipeline.</p>
<h4 id="adding-a-version-to-an-existing-pipeline-using-the-sdk">Adding a version to an existing pipeline using the SDK</h4>
<p>To add a pipeline version for an existing pipeline, you must find the
pipeline&rsquo;s ID and use it with the <code>upload_pipeline_version</code> method. To
find a pipeline&rsquo;s ID:</p>
<ol>
<li>Open the Kubeflow Pipelines UI. A list of your pipelines appears.</li>
<li>Click the <strong>name of your pipeline</strong>. The pipeline details page appears.</li>
<li>The pipeline ID is listed in the summary card, as shown below.</li>
</ol>
<p><img src="/docs/images/sdk-examples-snapshot-1.png"
alt="Pipeline ID in Summary Card"
class="mt-3 mb-3 border border-info rounded"></p>
<h3 id="example-2-listing-pipelines-with-a-filter">Example 2: Listing pipelines with a filter</h3>
<p>The following example demonstrates how to use the Kubeflow Pipelines SDK to
list pipelines with a particular pipeline name. If list_pipelines method is
called without any input parameters, it will list all the pipelines. However,
you can specify a filter as an input parameter to list pipelines with a
particular name. Given that Kubeflow Pipelines requires pipeline names to be
unique, listing pipelines with a particular name returns at most one pipeline.</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-python" data-lang="python"><span class="line"><span class="cl"><span class="kn">import</span> <span class="nn">kfp</span>
</span></span><span class="line"><span class="cl"><span class="kn">import</span> <span class="nn">json</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="c1"># &#39;host&#39; is your Kubeflow Pipelines API server&#39;s host address.</span>
</span></span><span class="line"><span class="cl"><span class="n">host</span> <span class="o">=</span> <span class="o">&lt;</span><span class="n">host</span><span class="o">&gt;</span>
</span></span><span class="line"><span class="cl"><span class="c1"># &#39;pipeline_name&#39; is the name of the pipeline you want to list.</span>
</span></span><span class="line"><span class="cl"><span class="n">pipeline_name</span> <span class="o">=</span> <span class="o">&lt;</span><span class="n">pipeline</span> <span class="n">name</span><span class="o">&gt;</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="n">client</span> <span class="o">=</span> <span class="n">kfp</span><span class="o">.</span><span class="n">Client</span><span class="p">(</span><span class="n">host</span><span class="p">)</span>
</span></span><span class="line"><span class="cl"><span class="c1"># To filter on pipeline name, you can use a predicate indicating that the pipeline</span>
</span></span><span class="line"><span class="cl"><span class="c1"># name is equal to the given name.</span>
</span></span><span class="line"><span class="cl"><span class="c1"># A predicate includes &#39;key&#39;, &#39;op&#39; and &#39;string_value&#39; fields.</span>
</span></span><span class="line"><span class="cl"><span class="c1"># The &#39;key&#39; specifies the property you want to apply the filter to. For example,</span>
</span></span><span class="line"><span class="cl"><span class="c1"># if you want to filter on the pipeline name, then &#39;key&#39; is set to &#39;name&#39; as</span>
</span></span><span class="line"><span class="cl"><span class="c1"># shown below.</span>
</span></span><span class="line"><span class="cl"><span class="c1"># The &#39;op&#39; specifies the operator used in a predicate. The operator can be</span>
</span></span><span class="line"><span class="cl"><span class="c1"># EQUALS, NOT_EQUALS, GREATER_THAN, etc. The complete list is at [filter.proto](https://github.com/kubeflow/pipelines/blob/sdk/release-1.8/backend/api/filter.proto#L32)</span>
</span></span><span class="line"><span class="cl"><span class="c1"># When using the operator in a string-typed predicate, you need to use the</span>
</span></span><span class="line"><span class="cl"><span class="c1"># corresponding integer value of the enum. For Example, you can use the integer</span>
</span></span><span class="line"><span class="cl"><span class="c1"># value 1 to indicate EQUALS as shown below.</span>
</span></span><span class="line"><span class="cl"><span class="c1"># The &#39;string_value&#39; specifies the value you want to filter with.</span>
</span></span><span class="line"><span class="cl"><span class="nb">filter</span> <span class="o">=</span> <span class="n">json</span><span class="o">.</span><span class="n">dumps</span><span class="p">({</span><span class="s1">&#39;predicates&#39;</span><span class="p">:</span> <span class="p">[{</span><span class="s1">&#39;key&#39;</span><span class="p">:</span> <span class="s1">&#39;name&#39;</span><span class="p">,</span> <span class="s1">&#39;op&#39;</span><span class="p">:</span> <span class="mi">1</span><span class="p">,</span> <span class="s1">&#39;string_value&#39;</span><span class="p">:</span> <span class="s1">&#39;</span><span class="si">{}</span><span class="s1">&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">pipeline_name</span><span class="p">)}]})</span>
</span></span><span class="line"><span class="cl"><span class="n">pipelines</span> <span class="o">=</span> <span class="n">client</span><span class="o">.</span><span class="n">pipelines</span><span class="o">.</span><span class="n">list_pipelines</span><span class="p">(</span><span class="nb">filter</span><span class="o">=</span><span class="nb">filter</span><span class="p">)</span>
</span></span><span class="line"><span class="cl"><span class="c1"># The pipeline with the given pipeline_name, if exists, is in pipelines.pipelines[0].</span>
</span></span></code></pre></div><h3 id="example-3-creating-a-run-using-a-pipeline-version">Example 3: Creating a run using a pipeline version</h3>
<p>Examine the run_service_api.ipynb notebook to <a href="https://github.com/kubeflow/pipelines/blob/sdk/release-1.8/tools/benchmarks/run_service_api.ipynb">learn more about creating a run using a pipeline version</a>.</p>

</div>



    
	
  
    
    
	
    

<div class="td-content" style="page-break-before: always">
    
	<h1 id="pg-47b3be3dd816e4ac0c83ba23d8a169d5">3.1.7.3 - Experiment with the Kubeflow Pipelines API</h1>
    <div class="lead">Get started with the Kubeflow Pipelines API</div>
	<p>This tutorial demonstrates how to use the Kubeflow Pipelines API to build, run, and manage pipelines. This guide is recommended for users who would like to learn how to manage Kubeflow Pipelines using the REST API.</p>
<h2 id="before-you-start">Before you start</h2>
<p>This tutorial assumes that you have access to the <code>ml-pipeline</code> service. If Kubeflow is not configured to use an identity provider, use port-forwarding to directly access the service.</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-fallback" data-lang="fallback"><span class="line"><span class="cl">SVC_PORT=$(kubectl -n kubeflow get svc/ml-pipeline -o json | jq &#34;.spec.ports[0].port&#34;)
</span></span><span class="line"><span class="cl">kubectl port-forward -n kubeflow svc/ml-pipeline ${SVC_PORT}:8888
</span></span></code></pre></div><p>This tutorial assumes that the service is accessible on localhost.</p>
<p>You also need to install <a href="https://stedolan.github.io/jq/download/">jq</a>, and the <a href="/docs/components/pipelines/sdk/install-sdk/">Kubeflow Pipelines SDK</a>.</p>
<h2 id="building-and-running-a-pipeline">Building and running a pipeline</h2>
<p>Follow this guide to download, compile, and run the <a href="https://github.com/kubeflow/pipelines/blob/sdk/release-1.8/samples/core/sequential/sequential.py"><code>sequential.py</code> sample pipeline</a>. To learn how to compile and run pipelines using the Kubeflow Pipelines SDK or a Jupyter notebook, follow the <a href="/docs/components/pipelines/tutorials/build-pipeline/">experimenting with Kubeflow Pipelines samples tutorial</a>.</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-fallback" data-lang="fallback"><span class="line"><span class="cl">PIPELINE_URL=https://raw.githubusercontent.com/kubeflow/pipelines/master/samples/core/sequential/sequential.py
</span></span><span class="line"><span class="cl">PIPELINE_FILE=${PIPELINE_URL##*/}
</span></span><span class="line"><span class="cl">PIPELINE_NAME=${PIPELINE_FILE%.*}
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">wget -O ${PIPELINE_FILE} ${PIPELINE_URL}
</span></span><span class="line"><span class="cl">dsl-compile --py ${PIPELINE_FILE} --output ${PIPELINE_NAME}.tar.gz
</span></span></code></pre></div><p>After running the commands above, you should get two files in your current directory: <code>sequential.py</code> and <code>sequential.tar.gz</code>. Run the following command to deploy the generated <code>.tar.gz</code> file as you would do using the <a href="/docs/components/pipelines/sdk/build-component/#deploy-the-pipeline">Kubeflow Pipelines UI</a>, but this time using the REST API.</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-fallback" data-lang="fallback"><span class="line"><span class="cl">SVC=localhost:8888
</span></span><span class="line"><span class="cl">PIPELINE_ID=$(curl -F &#34;uploadfile=@${PIPELINE_NAME}.tar.gz&#34; ${SVC}/apis/v1beta1/pipelines/upload | jq -r .id)
</span></span></code></pre></div><p>If the operation was successful, you should see the pipeline in the central dashboard. You can also get the details using the <code>PIPELINE_ID</code> with the following API call.</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-fallback" data-lang="fallback"><span class="line"><span class="cl">curl ${SVC}/apis/v1beta1/pipelines/${PIPELINE_ID} | jq
</span></span></code></pre></div><p>The response should be similar to the following one:</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-fallback" data-lang="fallback"><span class="line"><span class="cl">{
</span></span><span class="line"><span class="cl">  &#34;id&#34;: &#34;d30d28d7-0bfc-4f0c-8a57-6844a8ec9742&#34;,
</span></span><span class="line"><span class="cl">  &#34;created_at&#34;: &#34;2020-02-20T16:15:02Z&#34;,
</span></span><span class="line"><span class="cl">  &#34;name&#34;: &#34;sequential.tar.gz&#34;,
</span></span><span class="line"><span class="cl">  &#34;parameters&#34;: [
</span></span><span class="line"><span class="cl">    {
</span></span><span class="line"><span class="cl">      &#34;name&#34;: &#34;url&#34;,
</span></span><span class="line"><span class="cl">      &#34;value&#34;: &#34;gs://ml-pipeline-playground/shakespeare1.txt&#34;
</span></span><span class="line"><span class="cl">    }
</span></span><span class="line"><span class="cl">  ],
</span></span><span class="line"><span class="cl">  &#34;default_version&#34;: {
</span></span><span class="line"><span class="cl">    &#34;id&#34;: &#34;d30d28d7-0bfc-4f0c-8a57-6844a8ec9742&#34;,
</span></span><span class="line"><span class="cl">    &#34;name&#34;: &#34;sequential.tar.gz&#34;,
</span></span><span class="line"><span class="cl">    &#34;created_at&#34;: &#34;2020-02-20T16:15:02Z&#34;,
</span></span><span class="line"><span class="cl">    &#34;parameters&#34;: [
</span></span><span class="line"><span class="cl">      {
</span></span><span class="line"><span class="cl">        &#34;name&#34;: &#34;url&#34;,
</span></span><span class="line"><span class="cl">        &#34;value&#34;: &#34;gs://ml-pipeline-playground/shakespeare1.txt&#34;
</span></span><span class="line"><span class="cl">      }
</span></span><span class="line"><span class="cl">    ],
</span></span><span class="line"><span class="cl">    &#34;resource_references&#34;: [
</span></span><span class="line"><span class="cl">      {
</span></span><span class="line"><span class="cl">        &#34;key&#34;: {
</span></span><span class="line"><span class="cl">          &#34;type&#34;: &#34;PIPELINE&#34;,
</span></span><span class="line"><span class="cl">          &#34;id&#34;: &#34;d30d28d7-0bfc-4f0c-8a57-6844a8ec9742&#34;
</span></span><span class="line"><span class="cl">        },
</span></span><span class="line"><span class="cl">        &#34;relationship&#34;: &#34;OWNER&#34;
</span></span><span class="line"><span class="cl">      }
</span></span><span class="line"><span class="cl">    ]
</span></span><span class="line"><span class="cl">  }
</span></span><span class="line"><span class="cl">}
</span></span></code></pre></div><p>Finally, use the <code>PIPELINE_ID</code> to trigger a run of your pipeline.</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-fallback" data-lang="fallback"><span class="line"><span class="cl">RUN_ID=$((
</span></span><span class="line"><span class="cl">curl -H &#34;Content-Type: application/json&#34; -X POST ${SVC}/apis/v1beta1/runs \
</span></span><span class="line"><span class="cl">-d @- &lt;&lt; EOF
</span></span><span class="line"><span class="cl">{
</span></span><span class="line"><span class="cl">   &#34;name&#34;:&#34;${PIPELINE_NAME}_run&#34;,
</span></span><span class="line"><span class="cl">   &#34;pipeline_spec&#34;:{
</span></span><span class="line"><span class="cl">      &#34;pipeline_id&#34;:&#34;${PIPELINE_ID}&#34;
</span></span><span class="line"><span class="cl">   }
</span></span><span class="line"><span class="cl">}
</span></span><span class="line"><span class="cl">EOF
</span></span><span class="line"><span class="cl">) | jq -r .run.id)
</span></span></code></pre></div><p>Run the following command occasionally to see how the status of your run changes. After a while, the status of your pipeline should change to <strong>Succeeded</strong>.</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-fallback" data-lang="fallback"><span class="line"><span class="cl">curl ${SVC}/apis/v1beta1/runs/${RUN_ID} | jq
</span></span></code></pre></div><p>The response should be similar to the following one:</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-fallback" data-lang="fallback"><span class="line"><span class="cl">{
</span></span><span class="line"><span class="cl">  &#34;run&#34;: {
</span></span><span class="line"><span class="cl">    &#34;id&#34;: &#34;4ff0debd-d6d7-4681-8593-21ec002e6e0c&#34;,
</span></span><span class="line"><span class="cl">    &#34;name&#34;: &#34;sequential_run&#34;,
</span></span><span class="line"><span class="cl">    &#34;pipeline_spec&#34;: {
</span></span><span class="line"><span class="cl">      &#34;pipeline_id&#34;: &#34;d30d28d7-0bfc-4f0c-8a57-6844a8ec9742&#34;,
</span></span><span class="line"><span class="cl">      &#34;pipeline_name&#34;: &#34;sequential.tar.gz&#34;,
</span></span><span class="line"><span class="cl">      &#34;workflow_manifest&#34;: &#34;{...}&#34;
</span></span><span class="line"><span class="cl">    },
</span></span><span class="line"><span class="cl">    &#34;resource_references&#34;: [
</span></span><span class="line"><span class="cl">      {
</span></span><span class="line"><span class="cl">        &#34;key&#34;: {
</span></span><span class="line"><span class="cl">          &#34;type&#34;: &#34;EXPERIMENT&#34;,
</span></span><span class="line"><span class="cl">          &#34;id&#34;: &#34;27af7eee-ce0a-44ba-a44d-07142abfc83c&#34;
</span></span><span class="line"><span class="cl">        },
</span></span><span class="line"><span class="cl">        &#34;name&#34;: &#34;Default&#34;,
</span></span><span class="line"><span class="cl">        &#34;relationship&#34;: &#34;OWNER&#34;
</span></span><span class="line"><span class="cl">      }
</span></span><span class="line"><span class="cl">    ],
</span></span><span class="line"><span class="cl">    &#34;created_at&#34;: &#34;2020-02-20T16:18:58Z&#34;,
</span></span><span class="line"><span class="cl">    &#34;scheduled_at&#34;: &#34;1970-01-01T00:00:00Z&#34;,
</span></span><span class="line"><span class="cl">    &#34;finished_at&#34;: &#34;1970-01-01T00:00:00Z&#34;,
</span></span><span class="line"><span class="cl">    &#34;status&#34;: &#34;Succeeded&#34;
</span></span><span class="line"><span class="cl">  },
</span></span><span class="line"><span class="cl">  &#34;pipeline_runtime&#34;: {
</span></span><span class="line"><span class="cl">    &#34;workflow_manifest&#34;: &#34;{...}&#34;
</span></span><span class="line"><span class="cl">  }
</span></span><span class="line"><span class="cl">}
</span></span></code></pre></div><p>Read <a href="/docs/components/pipelines/reference/api/kubeflow-pipeline-api-spec/">Kubeflow Pipelines API Reference</a> to learn more about how to use the API.</p>

</div>



    
	
  
    
    
	
    

<div class="td-content" style="page-break-before: always">
    
	<h1 id="pg-d0b87844f0fd8f7f5d00526028c9c2c6">3.1.7.4 - Experiment with the Pipelines Samples</h1>
    <div class="lead">Get started with the Kubeflow Pipelines notebooks and samples</div>
	<p>You can learn how to build and deploy pipelines by running the samples
provided in the Kubeflow Pipelines repository or by walking through a
Jupyter notebook that describes the process.</p>
<h2 id="compiling-the-samples-on-the-command-line">Compiling the samples on the command line</h2>
<p>This section shows you how to compile the
<a href="https://github.com/kubeflow/pipelines/tree/sdk/release-1.8/samples">Kubeflow Pipelines samples</a>
and deploy them using the Kubeflow Pipelines UI.</p>
<h3 id="before-you-start">Before you start</h3>
<p>Set up your environment:</p>
<ol>
<li>
<p>Clone or download the
<a href="https://github.com/kubeflow/pipelines/tree/sdk/release-1.8/samples">Kubeflow Pipelines samples</a>.</p>
</li>
<li>
<p>Install the <a href="/docs/components/pipelines/sdk/install-sdk/">Kubeflow Pipelines SDK</a>.</p>
</li>
<li>
<p>Activate your Python 3 environment if you haven&rsquo;t done so already:</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-fallback" data-lang="fallback"><span class="line"><span class="cl">source activate &lt;YOUR-PYTHON-ENVIRONMENT-NAME&gt;
</span></span></code></pre></div><p>For example:</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-fallback" data-lang="fallback"><span class="line"><span class="cl">source activate mlpipeline
</span></span></code></pre></div></li>
</ol>
<h3 id="choose-and-compile-a-pipeline">Choose and compile a pipeline</h3>
<p>Examine the pipeline samples that you downloaded and choose one to work with.
The
<a href="https://github.com/kubeflow/pipelines/blob/sdk/release-1.8/samples/core/sequential/sequential.py"><code>sequential.py</code> sample pipeline</a>:
is a good one to start with.</p>
<p>Each pipeline is defined as a Python program. Before you can submit a pipeline
to the Kubeflow Pipelines service, you must compile the
pipeline to an intermediate representation. The intermediate representation
takes the form of a YAML file compressed into a
<code>.tar.gz</code> file.</p>
<p>Use the <code>dsl-compile</code> command to compile the pipeline that you chose:</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash"><span class="line"><span class="cl">dsl-compile --py <span class="o">[</span>path/to/python/file<span class="o">]</span> --output <span class="o">[</span>path/to/output/tar.gz<span class="o">]</span>
</span></span></code></pre></div><p>For example, to compile the
<a href="https://github.com/kubeflow/pipelines/blob/sdk/release-1.8/samples/core/sequential/sequential.py"><code>sequential.py</code> sample pipeline</a>:</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash"><span class="line"><span class="cl"><span class="nb">export</span> <span class="nv">DIR</span><span class="o">=[</span>YOUR PIPELINES REPO DIRECTORY<span class="o">]</span>/samples/core/sequential
</span></span><span class="line"><span class="cl">dsl-compile --py <span class="si">${</span><span class="nv">DIR</span><span class="si">}</span>/sequential.py --output <span class="si">${</span><span class="nv">DIR</span><span class="si">}</span>/sequential.tar.gz
</span></span></code></pre></div><h3 id="deploy-the-pipeline">Deploy the pipeline</h3>
<p>Upload the generated <code>.tar.gz</code> file through the Kubeflow Pipelines UI. See the
guide to <a href="/docs/components/pipelines/overview/quickstart">getting started with the UI</a>.</p>
<h2 id="building-a-pipeline-in-a-jupyter-notebook">Building a pipeline in a Jupyter notebook</h2>
<p>You can choose to build your pipeline in a Jupyter notebook. The
<a href="https://github.com/kubeflow/pipelines/tree/sdk/release-1.8/samples/core">sample notebooks</a>
walk you through the process.</p>
<p>It&rsquo;s easiest to use the Jupyter services that are installed in the same cluster as
the Kubeflow Pipelines system.</p>
<p>Note: The notebook samples don&rsquo;t work on Jupyter notebooks outside the same
cluster, because the Python library communicates with the Kubeflow Pipelines
system through in-cluster service names.</p>
<p>Follow these steps to start a notebook:</p>
<ol>
<li>
<p>Deploy Kubeflow:</p>
<ul>
<li>
<p>Follow the <a href="/docs/gke/deploy/">GCP deployment guide</a>, including the step
to deploy Kubeflow using the
<a href="https://deploy.kubeflow.cloud/">Kubeflow deployment UI</a>.</p>
</li>
<li>
<p>When Kubeflow is running, access the Kubeflow UI at a URL of the form
<code>https://&lt;deployment-name&gt;.endpoints.&lt;project&gt;.cloud.goog/</code>.</p>
</li>
</ul>
</li>
<li>
<p>Follow the <a href="/docs/components/notebooks/setup/">Kubeflow notebooks setup guide</a> to
create a Jupyter notebook server and open the Jupyter UI.</p>
</li>
<li>
<p>Download the sample notebooks from
<a href="https://github.com/kubeflow/pipelines/tree/sdk/release-1.8/samples/core">https://github.com/kubeflow/pipelines/tree/sdk/release-1.8/samples/core</a>.</p>
</li>
<li>
<p>Upload these notebooks from the Jupyter UI: In Jupyter, go to the tree view
and find the <strong>upload</strong> button in the top right-hand area of the screen.</p>
</li>
<li>
<p>Open one of the uploaded notebooks.</p>
</li>
<li>
<p>Make sure the notebook kernel is set to Python 3. The Python version is at
the top right-hand corner in the Jupyter notebook view.</p>
</li>
<li>
<p>Follow the instructions in the notebook.</p>
</li>
</ol>
<p>The following notebooks are available:</p>
<ul>
<li>
<p><a href="https://github.com/kubeflow/pipelines/blob/sdk/release-1.8/samples/core/tfx-oss/TFX%20Example.ipynb">KubeFlow pipeline using TFX OSS components</a>:
This notebook demonstrates how to build a machine learning pipeline based on
<a href="https://www.tensorflow.org/tfx/">TensorFlow Extended (TFX)</a> components.
The pipeline includes a TFDV step to infer the schema, a TFT preprocessor, a
TensorFlow trainer, a TFMA analyzer, and a model deployer which deploys the
trained model to <code>tf-serving</code> in the same cluster. The notebook also
demonstrates how to build a component based on Python 3 inside the notebook,
including how to build a Docker container.</p>
</li>
<li>
<p><a href="https://github.com/kubeflow/pipelines/blob/sdk/release-1.8/samples/core/lightweight_component/lightweight_component.ipynb">Lightweight Python components</a>:
This notebook demonstrates how to build simple Python components based on
Python 3 and use them in a pipeline with fast iterations. If you use this
technique, you don&rsquo;t need to build a Docker container when you build a
component. Note that the container image may not be self contained because the
source code is not built into the container.</p>
</li>
</ul>
<h2 id="next-steps">Next steps</h2>
<ul>
<li>Learn the various ways to use the <a href="/docs/components/pipelines/sdk/sdk-overview/">Kubeflow Pipelines
SDK</a>.</li>
<li>See how to
<a href="/docs/components/pipelines/sdk/build-component/">build your own pipeline components</a>.</li>
<li>Read more about
<a href="/docs/components/pipelines/sdk/lightweight-python-components/">building lightweight components</a>.</li>
</ul>

</div>



    
	
  
    
    
	
    

<div class="td-content" style="page-break-before: always">
    
	<h1 id="pg-5c47ad4da8e3c2a4edddeb4460d4b3ef">3.1.7.5 - Run a Cloud-specific Pipelines Tutorial</h1>
    <div class="lead">Choose the Kubeflow Pipelines tutorial to suit your deployment</div>
	

<div class="alert alert-info" role="alert">
<h4 class="alert-heading">Opportunity to add cloud tutorials</h4>

    <b>Invitation:</b> Create a cloud-specific tutorial and link it here.
See the <a href="/docs/about/style-guide/">style guide for the Kubeflow docs</a>.

</div>

<ul>
<li><a href="/docs/azure/azureendtoend/">Pipelines End-to-end on Azure</a>: An end-to-end tutorial for Kubeflow Pipelines on Microsoft Azure.</li>
<li><a href="https://g.co/codelabs/kfp-gis">Pipelines on Google Cloud Platform</a> : This GCP tutorial walks through a Kubeflow Pipelines example that shows training a Tensor2Tensor model for GitHub issue summarization, both via the Pipelines Dashboard UI, and from a Jupyter notebook</li>
</ul>

</div>



    
	
  

    
	
  
    
    
	
    

<div class="td-content" style="page-break-before: always">
    
	<h1 id="pg-102daf76bac1d475739853b0c616283c">3.1.8 - Troubleshooting</h1>
    <div class="lead">Troubleshooting guide for Kubeflow Pipelines</div>
	<p>This page presents some hints for troubleshooting specific problems that you
may encounter.</p>
<h2 id="diagnosing-problems-in-your-kubeflow-pipelines-environment">Diagnosing problems in your Kubeflow Pipelines environment</h2>
<p>For help diagnosing environment issues that affect Kubeflow Pipelines, run
the <a href="/docs/components/pipelines/sdk/sdk-overview/#kfp-cli-tool"><code>kfp diagnose_me</code> command-line tool</a>.</p>
<p>The <code>kfp diagnose_me</code> CLI reports on the configuration of your local
development environment, Kubernetes cluster, or Google Cloud environment.
Use this command to help resolve issues like the following:</p>
<ul>
<li>Python library dependencies</li>
<li>Trouble accessing resources or APIs using Kubernetes secrets</li>
<li>Trouble accessing Persistent Volume Claims</li>
</ul>
<p>To use the <code>kfp diagnose_me</code> CLI, follow these steps:</p>
<ol>
<li>Install the <a href="/docs/components/pipelines/sdk/install-sdk/">Kubeflow Pipelines SDK</a>.</li>
<li>Follow the <a href="https://kubernetes.io/docs/reference/access-authn-authz/authentication/">guide to configuring access to Kubernetes clusters</a>,
to update your kubeconfig file with appropriate credentials and endpoint
information to access your Kubeflow cluster.
If your Kubeflow Pipelines cluster is hosted on a cloud provider like
Google Cloud, use your cloud provider&rsquo;s instructions for configuring
access to your Kubernetes cluster.</li>
<li>Run the <code>kfp diagnose_me</code> command.</li>
<li>Analyze the results to troubleshoot your environment.</li>
</ol>
<h2 id="troubleshooting-the-kubeflow-pipelines-sdk">Troubleshooting the Kubeflow Pipelines SDK</h2>
<p>The following sections describe how to resolve issues that can occur when
installing or using the Kubeflow Pipelines SDK.</p>
<h3 id="error-could-not-find-a-version-that-satisfies-the-requirement-kfp">Error: Could not find a version that satisfies the requirement kfp</h3>
<p>This error indicates that you have not installed the <code>kfp</code> package in your
Python3 environment. Follow the instructions in the <a href="/docs/components/pipelines/sdk/install-sdk/">Kubeflow Pipelines SDK
installation guide</a>, if you have not already
installed the SDK.</p>
<p>If you have already installed the Kubeflow Pipelines SDK, check that you have
Python 3.5 or higher:</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-fallback" data-lang="fallback"><span class="line"><span class="cl">python3 -V
</span></span></code></pre></div><p>The response should be something like the following:</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-fallback" data-lang="fallback"><span class="line"><span class="cl">Python 3.7.3
</span></span></code></pre></div><p>If you do not have Python 3.5 or higher, you can
<a href="https://www.python.org/downloads/">download Python</a> from the Python
Software Foundation.</p>
<h3 id="kfp-or-dsl-compile-command-not-found">kfp or dsl-compile command not found</h3>
<p>If your install the Kubeflow Pipelines SDK with the <code>--user</code> flag, you may
get the following error when using the <code>kfp</code> or <code>dsl-compile</code> command-line
tools.</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-fallback" data-lang="fallback"><span class="line"><span class="cl">bash: kfp: command not found
</span></span></code></pre></div><p>This error occurs because installing the Kubeflow Pipelines SDK with
<code>--user</code> stores <code>kfp</code> and <code>dsl-compile</code> in your <code>~/.local/bin</code> directory.
In some Linux distributions, the <code>~/.local/bin</code> directory is not part of the
$PATH environment variable.</p>
<p>You can resolve this issue by using one of the following options:</p>
<ul>
<li>Add <code>export $PATH=$PATH:~/.local/bin</code> to the end of your <code>~/.bashrc</code> file.
Then restart your terminal session or run <code>source ~/.bashrc</code>.</li>
<li>Run the <code>kfp</code> and <code>dsl-compile</code> commands as <code>~/.local/bin/kfp</code> and
<code>~/.local/bin/dsl-compile</code>.</li>
</ul>
<h2 id="tfx-visualizations-do-not-show-up-or-throw-an-error">TFX visualizations do not show up or throw an error</h2>
<p>Confirm your Kubeflow Pipelines backend version is compatible with your TFX version, refer to <a href="/docs/components/pipelines/installation/compatibility-matrix/">Kubeflow Pipelines Compatibility Matrix</a>.</p>

</div>



    
	
  
    
    
	
    

<div class="td-content" style="page-break-before: always">
    
	<h1 id="pg-65b28e2fec48a1a03fd11b7057352a68">3.1.9 - Reference</h1>
    <div class="lead">Reference docs for Kubeflow Pipelines</div>
	
</div>



    
      
  
  
  
  

  
  

  
    
    
	
    

<div class="td-content" style="">
    
	<h1 id="pg-7830028a1fe66e561a2e983210d902e0">3.1.9.1 - Component Specification</h1>
    <div class="lead">Definition of a Kubeflow Pipelines component</div>
	

<div class="alert alert-warning" role="alert">
<h4 class="alert-heading">Out of date</h4>

    This guide contains outdated information pertaining to Kubeflow 1.0. This guide
needs to be updated for Kubeflow 1.1.

</div>

<p>This specification describes the container component data model for Kubeflow
Pipelines. The data model is serialized to a file in YAML format for sharing.</p>
<p>Below are the main parts of the component definition:</p>
<ul>
<li><strong>Metadata:</strong> Name, description, and other metadata.</li>
<li><strong>Interface (inputs and outputs):</strong> Name, type, default value.</li>
<li><strong>Implementation:</strong> How to run the component, given the input arguments.</li>
</ul>
<h2 id="example-of-a-component-specification">Example of a component specification</h2>
<p>A component specification takes the form of a YAML file, <code>component.yaml</code>. Below
is an example:</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-yaml" data-lang="yaml"><span class="line"><span class="cl"><span class="nt">name</span><span class="p">:</span><span class="w"> </span><span class="l">xgboost4j - Train classifier</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="nt">description</span><span class="p">:</span><span class="w"> </span><span class="l">Trains a boosted tree ensemble classifier using xgboost4j</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="nt">inputs</span><span class="p">:</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span>- {<span class="nt">name</span><span class="p">:</span><span class="w"> </span><span class="l">Training data}</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span>- {<span class="nt">name: Rounds, type: Integer, default: &#39;30&#39;, description</span><span class="p">:</span><span class="w"> </span><span class="s1">&#39;Number of training rounds&#39;</span>}<span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="nt">outputs</span><span class="p">:</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span>- {<span class="nt">name: Trained model, type: XGBoost model, description</span><span class="p">:</span><span class="w"> </span><span class="s1">&#39;Trained XGBoost model&#39;</span>}<span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="nt">implementation</span><span class="p">:</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">  </span><span class="nt">container</span><span class="p">:</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="nt">image</span><span class="p">:</span><span class="w"> </span><span class="l">gcr.io/ml-pipeline/xgboost-classifier-train@sha256:b3a64d57</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="nt">command</span><span class="p">:</span><span class="w"> </span><span class="p">[</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">      </span><span class="l">/ml/train.py,</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">      </span>--<span class="l">train-set, {inputPath: Training data},</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">      </span>--<span class="l">rounds,    {inputValue: Rounds},</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">      </span>--<span class="l">out-model, {outputPath: Trained model},</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="p">]</span><span class="w">
</span></span></span></code></pre></div><p>See some examples of real-world
<a href="https://github.com/kubeflow/pipelines/search?q=filename%3Acomponent.yaml&amp;unscoped_q=filename%3Acomponent.yaml">component specifications</a>.</p>
<h2 id="detailed-specification-componentspec">Detailed specification (ComponentSpec)</h2>
<p>This section describes the
<a href="https://github.com/kubeflow/pipelines/blob/sdk/release-1.8/sdk/python/kfp/components/_structures.py">ComponentSpec</a>.</p>
<h3 id="metadata">Metadata</h3>
<ul>
<li>
<p><code>name</code>: Human-readable name of the component.</p>
</li>
<li>
<p><code>description</code>: Description of the component.</p>
</li>
<li>
<p><code>metadata</code>: Standard object&rsquo;s metadata:</p>
<ul>
<li><code>annotations</code>: A string key-value map used to add information about the component.
Currently, the annotations get translated to Kubernetes annotations when the component task is executed on Kubernetes. Current limitation: the key cannot contain more that one slash (&quot;/&quot;). See more information in the
<a href="http://kubernetes.io/docs/user-guide/annotations">Kubernetes user guide</a>.</li>
<li><code>labels</code>: Deprecated. Use <code>annotations</code>.</li>
</ul>
</li>
</ul>
<h3 id="interface">Interface</h3>
<ul>
<li>
<p><code>inputs</code> and <code>outputs</code>:
Specifies the list of inputs/outputs and their properties. Each input or
output has the following properties:</p>
<ul>
<li><code>name</code>: Human-readable name of the input/output. Name must be
unique inside the inputs or outputs section, but an output may have the
same name as an input.</li>
<li><code>description</code>: Human-readable description of the input/output.</li>
<li><code>default</code>: Specifies the default value for an input. <strong>Only
valid for inputs.</strong></li>
<li><code>type</code>: Specifies the type of input/output. The types are used
as hints for pipeline authors and can be used by the pipeline system/UI
to validate arguments and connections between components. Basic types
are <strong>String</strong>, <strong>Integer</strong>, <strong>Float</strong>, and <strong>Bool</strong>. See the full list
of <a href="https://github.com/kubeflow/pipelines/blob/sdk/release-1.8/sdk/python/kfp/dsl/types.py">types</a>
defined by the Kubeflow Pipelines SDK.</li>
<li><code>optional</code>: Specifies if input is optional or not. This is of type
<strong>Bool</strong>, and defaults to <strong>False</strong>. <strong>Only valid for inputs.</strong></li>
</ul>
</li>
</ul>
<h3 id="implementation">Implementation</h3>
<ul>
<li>
<p><code>implementation</code>: Specifies how to execute the component instance.
There are two implementation types,  <code>container</code> and <code>graph</code>. (The latter is
not in scope for this document.) In future we may introduce more
implementation types like <code>daemon</code> or <code>K8sResource</code>.</p>
<ul>
<li>
<p><code>container</code>:
Describes the Docker container that implements the component. A portable
subset of the Kubernetes
<a href="https://kubernetes.io/docs/reference/generated/kubernetes-api/v1.12/#container-v1-core">Container v1 spec</a>.</p>
<ul>
<li><code>image</code>: Name of the Docker image.</li>
<li><code>command</code>: Entrypoint array. The Docker image&rsquo;s
ENTRYPOINT is used if this is not provided. Each item is either a
string or a placeholder. The most common placeholders are
<code>{inputValue: Input name}</code>, <code>{inputPath: Input name}</code> and <code>{outputPath: Output name}</code>.</li>
<li><code>args</code>: Arguments to the entrypoint. The Docker
image&rsquo;s CMD is used if this is not provided. Each item is either a
string or a placeholder. The most common placeholders are
<code>{inputValue: Input name}</code>, <code>{inputPath: Input name}</code> and <code>{outputPath: Output name}</code>.</li>
<li><code>env</code>: Map of environment variables to set in the container.</li>
<li><code>fileOutputs</code>: Legacy property that is only needed in
cases where the container always stores the output data in some
hard-coded non-configurable local location. This property specifies
a map between some outputs and local file paths where the program
writes the output data files. Only needed for components that have
hard-coded output paths. Such containers need to be fixed by
modifying the program or adding a wrapper script that copies the
output to a configurable location. Otherwise the component may be
incompatible with future storage systems.</li>
</ul>
</li>
</ul>
</li>
</ul>
<p>You can set all other Kubernetes container properties when you
use the component inside a pipeline.</p>
<h2 id="using-placeholders-for-command-line-arguments">Using placeholders for command-line arguments</h2>
<h3 id="consuming-input-by-value">Consuming input by value</h3>
<p>The <code>{inputValue: &lt;Input name&gt;}</code> placeholder is replaced by the value of the input argument:</p>
<ul>
<li>
<p>In <code>component.yaml</code>:</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-yaml" data-lang="yaml"><span class="line"><span class="cl"><span class="nt">command</span><span class="p">:</span><span class="w"> </span><span class="p">[</span><span class="l">program.py, --rounds, {inputValue: Rounds}]</span><span class="w">
</span></span></span></code></pre></div></li>
<li>
<p>In the pipeline code:</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-python" data-lang="python"><span class="line"><span class="cl"><span class="n">task1</span> <span class="o">=</span> <span class="n">component1</span><span class="p">(</span><span class="n">rounds</span><span class="o">=</span><span class="mi">150</span><span class="p">)</span>
</span></span></code></pre></div></li>
<li>
<p>Resulting command-line code (showing the value of the input argument that
has replaced the placeholder):</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-shell" data-lang="shell"><span class="line"><span class="cl">program.py --rounds <span class="m">150</span>
</span></span></code></pre></div></li>
</ul>
<h3 id="consuming-input-by-file">Consuming input by file</h3>
<p>The <code>{inputPath: &lt;Input name&gt;}</code> placeholder is replaced by the (auto-generated) local file path where the system has put the argument data passed for the &ldquo;Input name&rdquo; input.</p>
<ul>
<li>
<p>In <code>component.yaml</code>:</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-yaml" data-lang="yaml"><span class="line"><span class="cl"><span class="nt">command</span><span class="p">:</span><span class="w"> </span><span class="p">[</span><span class="l">program.py, --train-set, {inputPath: training_data}]</span><span class="w">
</span></span></span></code></pre></div></li>
<li>
<p>In the pipeline code:</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-python" data-lang="python"><span class="line"><span class="cl"><span class="n">task2</span> <span class="o">=</span> <span class="n">component1</span><span class="p">(</span><span class="n">training_data</span><span class="o">=</span><span class="n">some_task1</span><span class="o">.</span><span class="n">outputs</span><span class="p">[</span><span class="s1">&#39;some_data&#39;</span><span class="p">])</span>
</span></span></code></pre></div></li>
<li>
<p>Resulting command-line code (the placeholder is replaced by the
generated path):</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-shell" data-lang="shell"><span class="line"><span class="cl">program.py --train-set /inputs/train_data/data
</span></span></code></pre></div></li>
</ul>
<h3 id="producing-outputs">Producing outputs</h3>
<p>The <code>{outputPath: &lt;Output name&gt;}</code> placeholder is replaced by a (generated) local file path where the component program is supposed to write the output data.
The parent directories of the path may or may not not exist. Your
program must handle both cases without error.</p>
<ul>
<li>
<p>In <code>component.yaml</code>:</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-yaml" data-lang="yaml"><span class="line"><span class="cl"><span class="nt">command</span><span class="p">:</span><span class="w"> </span><span class="p">[</span><span class="l">program.py, --out-model, {outputPath: trained_model}]</span><span class="w">
</span></span></span></code></pre></div></li>
<li>
<p>In the pipeline code:</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-python" data-lang="python"><span class="line"><span class="cl"><span class="n">task1</span> <span class="o">=</span> <span class="n">component1</span><span class="p">()</span>
</span></span><span class="line"><span class="cl"><span class="c1"># You can now pass `task1.outputs[&#39;trained_model&#39;]` to other components as argument.</span>
</span></span></code></pre></div></li>
<li>
<p>Resulting command-line code (the placeholder is replaced by the
generated path):</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-shell" data-lang="shell"><span class="line"><span class="cl">program.py --out-model /outputs/trained_model/data
</span></span></code></pre></div></li>
</ul>

</div>



    
	
  
    
    
	
    

<div class="td-content" style="page-break-before: always">
    
	<h1 id="pg-00ac3f50c5b8788374edc5630970f6f6">3.1.9.2 - Pipelines API Reference</h1>
    <div class="lead">Reference documentation for the Kubeflow Pipelines API</div>
	<!DOCTYPE html>
<html>
<head>
    <style>/*!
 * Bootstrap v3.4.1 (https://getbootstrap.com/)
 * Copyright 2011-2019 Twitter, Inc.
 * Licensed under MIT (https://github.com/twbs/bootstrap/blob/master/LICENSE)
 *//*! normalize.css v3.0.3 | MIT License | github.com/necolas/normalize.css */html{font-family:sans-serif;-ms-text-size-adjust:100%;-webkit-text-size-adjust:100%}body{margin:0}article,aside,details,figcaption,figure,footer,header,hgroup,main,menu,nav,section,summary{display:block}audio,canvas,progress,video{display:inline-block;vertical-align:baseline}audio:not([controls]){display:none;height:0}[hidden],template{display:none}a{background-color:transparent}a:active,a:hover{outline:0}abbr[title]{border-bottom:none;text-decoration:underline;text-decoration:underline dotted}b,strong{font-weight:bold}dfn{font-style:italic}h1{font-size:2em;margin:.67em 0}mark{background:#ff0;color:#000}small{font-size:80%}sub,sup{font-size:75%;line-height:0;position:relative;vertical-align:baseline}sup{top:-0.5em}sub{bottom:-0.25em}img{border:0}svg:not(:root){overflow:hidden}figure{margin:1em 40px}hr{box-sizing:content-box;height:0}pre{overflow:auto}code,kbd,pre,samp,.json-schema--regex{font-family:monospace, monospace;font-size:1em}button,input,optgroup,select,textarea{color:inherit;font:inherit;margin:0}button{overflow:visible}button,select{text-transform:none}button,html input[type="button"],input[type="reset"],input[type="submit"]{-webkit-appearance:button;cursor:pointer}button[disabled],html input[disabled]{cursor:default}button::-moz-focus-inner,input::-moz-focus-inner{border:0;padding:0}input{line-height:normal}input[type="checkbox"],input[type="radio"]{box-sizing:border-box;padding:0}input[type="number"]::-webkit-inner-spin-button,input[type="number"]::-webkit-outer-spin-button{height:auto}input[type="search"]{-webkit-appearance:textfield;box-sizing:content-box}input[type="search"]::-webkit-search-cancel-button,input[type="search"]::-webkit-search-decoration{-webkit-appearance:none}fieldset{border:1px solid #c0c0c0;margin:0 2px;padding:.35em .625em .75em}legend{border:0;padding:0}textarea{overflow:auto}optgroup{font-weight:bold}table{border-collapse:collapse;border-spacing:0}td,th{padding:0}/*! Source: https://github.com/h5bp/html5-boilerplate/blob/master/src/css/main.css */@media print{*,*:before,*:after{color:#000 !important;text-shadow:none !important;background:transparent !important;box-shadow:none !important}a,a:visited{text-decoration:underline}a[href]:after{content:" (" attr(href) ")"}abbr[title]:after{content:" (" attr(title) ")"}a[href^="#"]:after,a[href^="javascript:"]:after{content:""}pre,blockquote{border:1px solid #999;page-break-inside:avoid}thead{display:table-header-group}tr,img{page-break-inside:avoid}img{max-width:100% !important}p,h2,h3{orphans:3;widows:3}h2,h3{page-break-after:avoid}.navbar{display:none}.btn>.caret,.dropup>.btn>.caret{border-top-color:#000 !important}.label{border:1px solid #000}.table{border-collapse:collapse !important}.table td,.table th{background-color:#fff !important}.table-bordered th,.table-bordered td{border:1px solid #ddd !important}}@font-face{font-family:"Glyphicons Halflings";src:url("../fonts/glyphicons-halflings-regular.eot");src:url("../fonts/glyphicons-halflings-regular.eot?#iefix") format("embedded-opentype"),url("../fonts/glyphicons-halflings-regular.woff2") format("woff2"),url("../fonts/glyphicons-halflings-regular.woff") format("woff"),url("../fonts/glyphicons-halflings-regular.ttf") format("truetype"),url("../fonts/glyphicons-halflings-regular.svg#glyphicons_halflingsregular") format("svg")}.glyphicon{position:relative;top:1px;display:inline-block;font-family:"Glyphicons Halflings";font-style:normal;font-weight:400;line-height:1;-webkit-font-smoothing:antialiased;-moz-osx-font-smoothing:grayscale}.glyphicon-asterisk:before{content:"\002a"}.glyphicon-plus:before{content:"\002b"}.glyphicon-euro:before,.glyphicon-eur:before{content:"\20ac"}.glyphicon-minus:before{content:"\2212"}.glyphicon-cloud:before{content:"\2601"}.glyphicon-envelope:before{content:"\2709"}.glyphicon-pencil:before{content:"\270f"}.glyphicon-glass:before{content:"\e001"}.glyphicon-music:before{content:"\e002"}.glyphicon-search:before{content:"\e003"}.glyphicon-heart:before{content:"\e005"}.glyphicon-star:before{content:"\e006"}.glyphicon-star-empty:before{content:"\e007"}.glyphicon-user:before{content:"\e008"}.glyphicon-film:before{content:"\e009"}.glyphicon-th-large:before{content:"\e010"}.glyphicon-th:before{content:"\e011"}.glyphicon-th-list:before{content:"\e012"}.glyphicon-ok:before{content:"\e013"}.glyphicon-remove:before{content:"\e014"}.glyphicon-zoom-in:before{content:"\e015"}.glyphicon-zoom-out:before{content:"\e016"}.glyphicon-off:before{content:"\e017"}.glyphicon-signal:before{content:"\e018"}.glyphicon-cog:before{content:"\e019"}.glyphicon-trash:before{content:"\e020"}.glyphicon-home:before{content:"\e021"}.glyphicon-file:before{content:"\e022"}.glyphicon-time:before{content:"\e023"}.glyphicon-road:before{content:"\e024"}.glyphicon-download-alt:before{content:"\e025"}.glyphicon-download:before{content:"\e026"}.glyphicon-upload:before{content:"\e027"}.glyphicon-inbox:before{content:"\e028"}.glyphicon-play-circle:before{content:"\e029"}.glyphicon-repeat:before{content:"\e030"}.glyphicon-refresh:before{content:"\e031"}.glyphicon-list-alt:before{content:"\e032"}.glyphicon-lock:before{content:"\e033"}.glyphicon-flag:before{content:"\e034"}.glyphicon-headphones:before{content:"\e035"}.glyphicon-volume-off:before{content:"\e036"}.glyphicon-volume-down:before{content:"\e037"}.glyphicon-volume-up:before{content:"\e038"}.glyphicon-qrcode:before{content:"\e039"}.glyphicon-barcode:before{content:"\e040"}.glyphicon-tag:before{content:"\e041"}.glyphicon-tags:before{content:"\e042"}.glyphicon-book:before{content:"\e043"}.glyphicon-bookmark:before{content:"\e044"}.glyphicon-print:before{content:"\e045"}.glyphicon-camera:before{content:"\e046"}.glyphicon-font:before{content:"\e047"}.glyphicon-bold:before{content:"\e048"}.glyphicon-italic:before{content:"\e049"}.glyphicon-text-height:before{content:"\e050"}.glyphicon-text-width:before{content:"\e051"}.glyphicon-align-left:before{content:"\e052"}.glyphicon-align-center:before{content:"\e053"}.glyphicon-align-right:before{content:"\e054"}.glyphicon-align-justify:before{content:"\e055"}.glyphicon-list:before{content:"\e056"}.glyphicon-indent-left:before{content:"\e057"}.glyphicon-indent-right:before{content:"\e058"}.glyphicon-facetime-video:before{content:"\e059"}.glyphicon-picture:before{content:"\e060"}.glyphicon-map-marker:before{content:"\e062"}.glyphicon-adjust:before{content:"\e063"}.glyphicon-tint:before{content:"\e064"}.glyphicon-edit:before{content:"\e065"}.glyphicon-share:before{content:"\e066"}.glyphicon-check:before{content:"\e067"}.glyphicon-move:before{content:"\e068"}.glyphicon-step-backward:before{content:"\e069"}.glyphicon-fast-backward:before{content:"\e070"}.glyphicon-backward:before{content:"\e071"}.glyphicon-play:before{content:"\e072"}.glyphicon-pause:before{content:"\e073"}.glyphicon-stop:before{content:"\e074"}.glyphicon-forward:before{content:"\e075"}.glyphicon-fast-forward:before{content:"\e076"}.glyphicon-step-forward:before{content:"\e077"}.glyphicon-eject:before{content:"\e078"}.glyphicon-chevron-left:before{content:"\e079"}.glyphicon-chevron-right:before{content:"\e080"}.glyphicon-plus-sign:before{content:"\e081"}.glyphicon-minus-sign:before{content:"\e082"}.glyphicon-remove-sign:before{content:"\e083"}.glyphicon-ok-sign:before{content:"\e084"}.glyphicon-question-sign:before{content:"\e085"}.glyphicon-info-sign:before{content:"\e086"}.glyphicon-screenshot:before{content:"\e087"}.glyphicon-remove-circle:before{content:"\e088"}.glyphicon-ok-circle:before{content:"\e089"}.glyphicon-ban-circle:before{content:"\e090"}.glyphicon-arrow-left:before{content:"\e091"}.glyphicon-arrow-right:before{content:"\e092"}.glyphicon-arrow-up:before{content:"\e093"}.glyphicon-arrow-down:before{content:"\e094"}.glyphicon-share-alt:before{content:"\e095"}.glyphicon-resize-full:before{content:"\e096"}.glyphicon-resize-small:before{content:"\e097"}.glyphicon-exclamation-sign:before{content:"\e101"}.glyphicon-gift:before{content:"\e102"}.glyphicon-leaf:before{content:"\e103"}.glyphicon-fire:before{content:"\e104"}.glyphicon-eye-open:before{content:"\e105"}.glyphicon-eye-close:before{content:"\e106"}.glyphicon-warning-sign:before{content:"\e107"}.glyphicon-plane:before{content:"\e108"}.glyphicon-calendar:before{content:"\e109"}.glyphicon-random:before{content:"\e110"}.glyphicon-comment:before{content:"\e111"}.glyphicon-magnet:before{content:"\e112"}.glyphicon-chevron-up:before{content:"\e113"}.glyphicon-chevron-down:before{content:"\e114"}.glyphicon-retweet:before{content:"\e115"}.glyphicon-shopping-cart:before{content:"\e116"}.glyphicon-folder-close:before{content:"\e117"}.glyphicon-folder-open:before{content:"\e118"}.glyphicon-resize-vertical:before{content:"\e119"}.glyphicon-resize-horizontal:before{content:"\e120"}.glyphicon-hdd:before{content:"\e121"}.glyphicon-bullhorn:before{content:"\e122"}.glyphicon-bell:before{content:"\e123"}.glyphicon-certificate:before{content:"\e124"}.glyphicon-thumbs-up:before{content:"\e125"}.glyphicon-thumbs-down:before{content:"\e126"}.glyphicon-hand-right:before{content:"\e127"}.glyphicon-hand-left:before{content:"\e128"}.glyphicon-hand-up:before{content:"\e129"}.glyphicon-hand-down:before{content:"\e130"}.glyphicon-circle-arrow-right:before{content:"\e131"}.glyphicon-circle-arrow-left:before{content:"\e132"}.glyphicon-circle-arrow-up:before{content:"\e133"}.glyphicon-circle-arrow-down:before{content:"\e134"}.glyphicon-globe:before{content:"\e135"}.glyphicon-wrench:before{content:"\e136"}.glyphicon-tasks:before{content:"\e137"}.glyphicon-filter:before{content:"\e138"}.glyphicon-briefcase:before{content:"\e139"}.glyphicon-fullscreen:before{content:"\e140"}.glyphicon-dashboard:before{content:"\e141"}.glyphicon-paperclip:before{content:"\e142"}.glyphicon-heart-empty:before{content:"\e143"}.glyphicon-link:before{content:"\e144"}.glyphicon-phone:before{content:"\e145"}.glyphicon-pushpin:before{content:"\e146"}.glyphicon-usd:before{content:"\e148"}.glyphicon-gbp:before{content:"\e149"}.glyphicon-sort:before{content:"\e150"}.glyphicon-sort-by-alphabet:before{content:"\e151"}.glyphicon-sort-by-alphabet-alt:before{content:"\e152"}.glyphicon-sort-by-order:before{content:"\e153"}.glyphicon-sort-by-order-alt:before{content:"\e154"}.glyphicon-sort-by-attributes:before{content:"\e155"}.glyphicon-sort-by-attributes-alt:before{content:"\e156"}.glyphicon-unchecked:before{content:"\e157"}.glyphicon-expand:before{content:"\e158"}.glyphicon-collapse-down:before{content:"\e159"}.glyphicon-collapse-up:before{content:"\e160"}.glyphicon-log-in:before{content:"\e161"}.glyphicon-flash:before{content:"\e162"}.glyphicon-log-out:before{content:"\e163"}.glyphicon-new-window:before{content:"\e164"}.glyphicon-record:before{content:"\e165"}.glyphicon-save:before{content:"\e166"}.glyphicon-open:before{content:"\e167"}.glyphicon-saved:before{content:"\e168"}.glyphicon-import:before{content:"\e169"}.glyphicon-export:before{content:"\e170"}.glyphicon-send:before{content:"\e171"}.glyphicon-floppy-disk:before{content:"\e172"}.glyphicon-floppy-saved:before{content:"\e173"}.glyphicon-floppy-remove:before{content:"\e174"}.glyphicon-floppy-save:before{content:"\e175"}.glyphicon-floppy-open:before{content:"\e176"}.glyphicon-credit-card:before{content:"\e177"}.glyphicon-transfer:before{content:"\e178"}.glyphicon-cutlery:before{content:"\e179"}.glyphicon-header:before{content:"\e180"}.glyphicon-compressed:before{content:"\e181"}.glyphicon-earphone:before{content:"\e182"}.glyphicon-phone-alt:before{content:"\e183"}.glyphicon-tower:before{content:"\e184"}.glyphicon-stats:before{content:"\e185"}.glyphicon-sd-video:before{content:"\e186"}.glyphicon-hd-video:before{content:"\e187"}.glyphicon-subtitles:before{content:"\e188"}.glyphicon-sound-stereo:before{content:"\e189"}.glyphicon-sound-dolby:before{content:"\e190"}.glyphicon-sound-5-1:before{content:"\e191"}.glyphicon-sound-6-1:before{content:"\e192"}.glyphicon-sound-7-1:before{content:"\e193"}.glyphicon-copyright-mark:before{content:"\e194"}.glyphicon-registration-mark:before{content:"\e195"}.glyphicon-cloud-download:before{content:"\e197"}.glyphicon-cloud-upload:before{content:"\e198"}.glyphicon-tree-conifer:before{content:"\e199"}.glyphicon-tree-deciduous:before{content:"\e200"}.glyphicon-cd:before{content:"\e201"}.glyphicon-save-file:before{content:"\e202"}.glyphicon-open-file:before{content:"\e203"}.glyphicon-level-up:before{content:"\e204"}.glyphicon-copy:before{content:"\e205"}.glyphicon-paste:before{content:"\e206"}.glyphicon-alert:before{content:"\e209"}.glyphicon-equalizer:before{content:"\e210"}.glyphicon-king:before{content:"\e211"}.glyphicon-queen:before{content:"\e212"}.glyphicon-pawn:before{content:"\e213"}.glyphicon-bishop:before{content:"\e214"}.glyphicon-knight:before{content:"\e215"}.glyphicon-baby-formula:before{content:"\e216"}.glyphicon-tent:before{content:"\26fa"}.glyphicon-blackboard:before{content:"\e218"}.glyphicon-bed:before{content:"\e219"}.glyphicon-apple:before{content:"\f8ff"}.glyphicon-erase:before{content:"\e221"}.glyphicon-hourglass:before{content:"\231b"}.glyphicon-lamp:before{content:"\e223"}.glyphicon-duplicate:before{content:"\e224"}.glyphicon-piggy-bank:before{content:"\e225"}.glyphicon-scissors:before{content:"\e226"}.glyphicon-bitcoin:before{content:"\e227"}.glyphicon-btc:before{content:"\e227"}.glyphicon-xbt:before{content:"\e227"}.glyphicon-yen:before{content:"\00a5"}.glyphicon-jpy:before{content:"\00a5"}.glyphicon-ruble:before{content:"\20bd"}.glyphicon-rub:before{content:"\20bd"}.glyphicon-scale:before{content:"\e230"}.glyphicon-ice-lolly:before{content:"\e231"}.glyphicon-ice-lolly-tasted:before{content:"\e232"}.glyphicon-education:before{content:"\e233"}.glyphicon-option-horizontal:before{content:"\e234"}.glyphicon-option-vertical:before{content:"\e235"}.glyphicon-menu-hamburger:before{content:"\e236"}.glyphicon-modal-window:before{content:"\e237"}.glyphicon-oil:before{content:"\e238"}.glyphicon-grain:before{content:"\e239"}.glyphicon-sunglasses:before{content:"\e240"}.glyphicon-text-size:before{content:"\e241"}.glyphicon-text-color:before{content:"\e242"}.glyphicon-text-background:before{content:"\e243"}.glyphicon-object-align-top:before{content:"\e244"}.glyphicon-object-align-bottom:before{content:"\e245"}.glyphicon-object-align-horizontal:before{content:"\e246"}.glyphicon-object-align-left:before{content:"\e247"}.glyphicon-object-align-vertical:before{content:"\e248"}.glyphicon-object-align-right:before{content:"\e249"}.glyphicon-triangle-right:before{content:"\e250"}.glyphicon-triangle-left:before{content:"\e251"}.glyphicon-triangle-bottom:before{content:"\e252"}.glyphicon-triangle-top:before{content:"\e253"}.glyphicon-console:before{content:"\e254"}.glyphicon-superscript:before{content:"\e255"}.glyphicon-subscript:before{content:"\e256"}.glyphicon-menu-left:before{content:"\e257"}.glyphicon-menu-right:before{content:"\e258"}.glyphicon-menu-down:before{content:"\e259"}.glyphicon-menu-up:before{content:"\e260"}*{-webkit-box-sizing:border-box;-moz-box-sizing:border-box;box-sizing:border-box}*:before,*:after{-webkit-box-sizing:border-box;-moz-box-sizing:border-box;box-sizing:border-box}html{font-size:10px;-webkit-tap-highlight-color:rgba(0,0,0,0)}body{font-family:"Helvetica Neue",Helvetica,Arial,sans-serif;font-size:14px;line-height:1.42857143;color:#333;background-color:#fff}input,button,select,textarea{font-family:inherit;font-size:inherit;line-height:inherit}a{color:#337ab7;text-decoration:none}a:hover,a:focus{color:#23527c;text-decoration:underline}a:focus{outline:5px auto -webkit-focus-ring-color;outline-offset:-2px}figure{margin:0}img{vertical-align:middle}.img-responsive,.thumbnail>img,.thumbnail a>img,.carousel-inner>.item>img,.carousel-inner>.item>a>img{display:block;max-width:100%;height:auto}.img-rounded{border-radius:6px}.img-thumbnail{padding:4px;line-height:1.42857143;background-color:#fff;border:1px solid #ddd;border-radius:4px;-webkit-transition:all .2s ease-in-out;-o-transition:all .2s ease-in-out;transition:all .2s ease-in-out;display:inline-block;max-width:100%;height:auto}.img-circle{border-radius:50%}hr{margin-top:20px;margin-bottom:20px;border:0;border-top:1px solid #eee}.sr-only{position:absolute;width:1px;height:1px;padding:0;margin:-1px;overflow:hidden;clip:rect(0, 0, 0, 0);border:0}.sr-only-focusable:active,.sr-only-focusable:focus{position:static;width:auto;height:auto;margin:0;overflow:visible;clip:auto}[role="button"]{cursor:pointer}h1,h2,h3,h4,h5,h6,.h1,.h2,.h3,.h4,.h5,.h6{font-family:inherit;font-weight:500;line-height:1.1;color:inherit}h1 small,h2 small,h3 small,h4 small,h5 small,h6 small,.h1 small,.h2 small,.h3 small,.h4 small,.h5 small,.h6 small,h1 .small,h2 .small,h3 .small,h4 .small,h5 .small,h6 .small,.h1 .small,.h2 .small,.h3 .small,.h4 .small,.h5 .small,.h6 .small{font-weight:400;line-height:1;color:#777}h1,.h1,h2,.h2,h3,.h3{margin-top:20px;margin-bottom:10px}h1 small,.h1 small,h2 small,.h2 small,h3 small,.h3 small,h1 .small,.h1 .small,h2 .small,.h2 .small,h3 .small,.h3 .small{font-size:65%}h4,.h4,h5,.h5,h6,.h6{margin-top:10px;margin-bottom:10px}h4 small,.h4 small,h5 small,.h5 small,h6 small,.h6 small,h4 .small,.h4 .small,h5 .small,.h5 .small,h6 .small,.h6 .small{font-size:75%}h1,.h1{font-size:36px}h2,.h2{font-size:30px}h3,.h3{font-size:24px}h4,.h4{font-size:18px}h5,.h5{font-size:14px}h6,.h6{font-size:12px}p{margin:0 0 10px}.lead{margin-bottom:20px;font-size:16px;font-weight:300;line-height:1.4}@media (min-width:768px){.lead{font-size:21px}}small,.small{font-size:85%}mark,.mark{padding:.2em;background-color:#fcf8e3}.text-left{text-align:left}.text-right{text-align:right}.text-center{text-align:center}.text-justify{text-align:justify}.text-nowrap{white-space:nowrap}.text-lowercase{text-transform:lowercase}.text-uppercase{text-transform:uppercase}.text-capitalize{text-transform:capitalize}.text-muted{color:#777}.text-primary{color:#337ab7}a.text-primary:hover,a.text-primary:focus{color:#286090}.text-success{color:#3c763d}a.text-success:hover,a.text-success:focus{color:#2b542c}.text-info{color:#31708f}a.text-info:hover,a.text-info:focus{color:#245269}.text-warning{color:#8a6d3b}a.text-warning:hover,a.text-warning:focus{color:#66512c}.text-danger{color:#a94442}a.text-danger:hover,a.text-danger:focus{color:#843534}.bg-primary{color:#fff;background-color:#337ab7}a.bg-primary:hover,a.bg-primary:focus{background-color:#286090}.bg-success{background-color:#dff0d8}a.bg-success:hover,a.bg-success:focus{background-color:#c1e2b3}.bg-info{background-color:#d9edf7}a.bg-info:hover,a.bg-info:focus{background-color:#afd9ee}.bg-warning{background-color:#fcf8e3}a.bg-warning:hover,a.bg-warning:focus{background-color:#f7ecb5}.bg-danger{background-color:#f2dede}a.bg-danger:hover,a.bg-danger:focus{background-color:#e4b9b9}.page-header{padding-bottom:9px;margin:40px 0 20px;border-bottom:1px solid #eee}ul,ol{margin-top:0;margin-bottom:10px}ul ul,ol ul,ul ol,ol ol{margin-bottom:0}.list-unstyled{padding-left:0;list-style:none}.list-inline{padding-left:0;list-style:none;margin-left:-5px}.list-inline>li{display:inline-block;padding-right:5px;padding-left:5px}dl{margin-top:0;margin-bottom:20px}dt,dd{line-height:1.42857143}dt{font-weight:700}dd{margin-left:0}@media (min-width:768px){.dl-horizontal dt{float:left;width:160px;clear:left;text-align:right;overflow:hidden;text-overflow:ellipsis;white-space:nowrap}.dl-horizontal dd{margin-left:180px}}abbr[title],abbr[data-original-title]{cursor:help}.initialism{font-size:90%;text-transform:uppercase}blockquote{padding:10px 20px;margin:0 0 20px;font-size:17.5px;border-left:5px solid #eee}blockquote p:last-child,blockquote ul:last-child,blockquote ol:last-child{margin-bottom:0}blockquote footer,blockquote small,blockquote .small{display:block;font-size:80%;line-height:1.42857143;color:#777}blockquote footer:before,blockquote small:before,blockquote .small:before{content:"\2014 \00A0"}.blockquote-reverse,blockquote.pull-right{padding-right:15px;padding-left:0;text-align:right;border-right:5px solid #eee;border-left:0}.blockquote-reverse footer:before,blockquote.pull-right footer:before,.blockquote-reverse small:before,blockquote.pull-right small:before,.blockquote-reverse .small:before,blockquote.pull-right .small:before{content:""}.blockquote-reverse footer:after,blockquote.pull-right footer:after,.blockquote-reverse small:after,blockquote.pull-right small:after,.blockquote-reverse .small:after,blockquote.pull-right .small:after{content:"\00A0 \2014"}address{margin-bottom:20px;font-style:normal;line-height:1.42857143}code,kbd,pre,samp,.json-schema--regex{font-family:Menlo,Monaco,Consolas,"Courier New",monospace}code,.json-schema--regex{padding:2px 4px;font-size:90%;color:#c7254e;background-color:#f9f2f4;border-radius:4px}kbd{padding:2px 4px;font-size:90%;color:#fff;background-color:#333;border-radius:3px;box-shadow:inset 0 -1px 0 rgba(0,0,0,0.25)}kbd kbd{padding:0;font-size:100%;font-weight:700;box-shadow:none}pre{display:block;padding:9.5px;margin:0 0 10px;font-size:13px;line-height:1.42857143;color:#333;word-break:break-all;word-wrap:break-word;background-color:#f5f5f5;border:1px solid #ccc;border-radius:4px}pre code{padding:0;font-size:inherit;color:inherit;white-space:pre-wrap;background-color:transparent;border-radius:0}.pre-scrollable{max-height:340px;overflow-y:scroll}.container{padding-right:15px;padding-left:15px;margin-right:auto;margin-left:auto}@media (min-width:768px){.container{width:800px}}@media (min-width:992px){.container{width:970px}}@media (min-width:1200px){.container{width:900px}}.container-fluid{padding-right:15px;padding-left:15px;margin-right:auto;margin-left:auto}.row{margin-right:-15px;margin-left:-15px}.row-no-gutters{margin-right:0;margin-left:0}.row-no-gutters [class*="col-"]{padding-right:0;padding-left:0}.col-xs-1,.col-sm-1,.col-md-1,.col-lg-1,.col-xs-2,.col-sm-2,.col-md-2,.col-lg-2,.col-xs-3,.col-sm-3,.col-md-3,.col-lg-3,.col-xs-4,.col-sm-4,.col-md-4,.col-lg-4,.col-xs-5,.col-sm-5,.col-md-5,.col-lg-5,.col-xs-6,.col-sm-6,.col-md-6,.col-lg-6,.col-xs-7,.col-sm-7,.col-md-7,.col-lg-7,.col-xs-8,.col-sm-8,.col-md-8,.col-lg-8,.col-xs-9,.col-sm-9,.col-md-9,.col-lg-9,.col-xs-10,.col-sm-10,.col-md-10,.col-lg-10,.col-xs-11,.col-sm-11,.col-md-11,.col-lg-11,.col-xs-12,.col-sm-12,.col-md-12,.col-lg-12{position:relative;min-height:1px;padding-right:15px;padding-left:15px}.col-xs-1,.col-xs-2,.col-xs-3,.col-xs-4,.col-xs-5,.col-xs-6,.col-xs-7,.col-xs-8,.col-xs-9,.col-xs-10,.col-xs-11,.col-xs-12{float:left}.col-xs-12{width:100%}.col-xs-11{width:91.66666667%}.col-xs-10{width:83.33333333%}.col-xs-9{width:75%}.col-xs-8{width:66.66666667%}.col-xs-7{width:58.33333333%}.col-xs-6{width:50%}.col-xs-5{width:41.66666667%}.col-xs-4{width:33.33333333%}.col-xs-3{width:25%}.col-xs-2{width:16.66666667%}.col-xs-1{width:8.33333333%}.col-xs-pull-12{right:100%}.col-xs-pull-11{right:91.66666667%}.col-xs-pull-10{right:83.33333333%}.col-xs-pull-9{right:75%}.col-xs-pull-8{right:66.66666667%}.col-xs-pull-7{right:58.33333333%}.col-xs-pull-6{right:50%}.col-xs-pull-5{right:41.66666667%}.col-xs-pull-4{right:33.33333333%}.col-xs-pull-3{right:25%}.col-xs-pull-2{right:16.66666667%}.col-xs-pull-1{right:8.33333333%}.col-xs-pull-0{right:auto}.col-xs-push-12{left:100%}.col-xs-push-11{left:91.66666667%}.col-xs-push-10{left:83.33333333%}.col-xs-push-9{left:75%}.col-xs-push-8{left:66.66666667%}.col-xs-push-7{left:58.33333333%}.col-xs-push-6{left:50%}.col-xs-push-5{left:41.66666667%}.col-xs-push-4{left:33.33333333%}.col-xs-push-3{left:25%}.col-xs-push-2{left:16.66666667%}.col-xs-push-1{left:8.33333333%}.col-xs-push-0{left:auto}.col-xs-offset-12{margin-left:100%}.col-xs-offset-11{margin-left:91.66666667%}.col-xs-offset-10{margin-left:83.33333333%}.col-xs-offset-9{margin-left:75%}.col-xs-offset-8{margin-left:66.66666667%}.col-xs-offset-7{margin-left:58.33333333%}.col-xs-offset-6{margin-left:50%}.col-xs-offset-5{margin-left:41.66666667%}.col-xs-offset-4{margin-left:33.33333333%}.col-xs-offset-3{margin-left:25%}.col-xs-offset-2{margin-left:16.66666667%}.col-xs-offset-1{margin-left:8.33333333%}.col-xs-offset-0{margin-left:0%}@media (min-width:768px){.col-sm-1,.col-sm-2,.col-sm-3,.col-sm-4,.col-sm-5,.col-sm-6,.col-sm-7,.col-sm-8,.col-sm-9,.col-sm-10,.col-sm-11,.col-sm-12{float:left}.col-sm-12{width:100%}.col-sm-11{width:91.66666667%}.col-sm-10{width:83.33333333%}.col-sm-9{width:75%}.col-sm-8{width:66.66666667%}.col-sm-7{width:58.33333333%}.col-sm-6{width:50%}.col-sm-5{width:41.66666667%}.col-sm-4{width:33.33333333%}.col-sm-3{width:25%}.col-sm-2{width:16.66666667%}.col-sm-1{width:8.33333333%}.col-sm-pull-12{right:100%}.col-sm-pull-11{right:91.66666667%}.col-sm-pull-10{right:83.33333333%}.col-sm-pull-9{right:75%}.col-sm-pull-8{right:66.66666667%}.col-sm-pull-7{right:58.33333333%}.col-sm-pull-6{right:50%}.col-sm-pull-5{right:41.66666667%}.col-sm-pull-4{right:33.33333333%}.col-sm-pull-3{right:25%}.col-sm-pull-2{right:16.66666667%}.col-sm-pull-1{right:8.33333333%}.col-sm-pull-0{right:auto}.col-sm-push-12{left:100%}.col-sm-push-11{left:91.66666667%}.col-sm-push-10{left:83.33333333%}.col-sm-push-9{left:75%}.col-sm-push-8{left:66.66666667%}.col-sm-push-7{left:58.33333333%}.col-sm-push-6{left:50%}.col-sm-push-5{left:41.66666667%}.col-sm-push-4{left:33.33333333%}.col-sm-push-3{left:25%}.col-sm-push-2{left:16.66666667%}.col-sm-push-1{left:8.33333333%}.col-sm-push-0{left:auto}.col-sm-offset-12{margin-left:100%}.col-sm-offset-11{margin-left:91.66666667%}.col-sm-offset-10{margin-left:83.33333333%}.col-sm-offset-9{margin-left:75%}.col-sm-offset-8{margin-left:66.66666667%}.col-sm-offset-7{margin-left:58.33333333%}.col-sm-offset-6{margin-left:50%}.col-sm-offset-5{margin-left:41.66666667%}.col-sm-offset-4{margin-left:33.33333333%}.col-sm-offset-3{margin-left:25%}.col-sm-offset-2{margin-left:16.66666667%}.col-sm-offset-1{margin-left:8.33333333%}.col-sm-offset-0{margin-left:0%}}@media (min-width:992px){.col-md-1,.col-md-2,.col-md-3,.col-md-4,.col-md-5,.col-md-6,.col-md-7,.col-md-8,.col-md-9,.col-md-10,.col-md-11,.col-md-12{float:left}.col-md-12{width:100%}.col-md-11{width:91.66666667%}.col-md-10{width:83.33333333%}.col-md-9{width:75%}.col-md-8{width:66.66666667%}.col-md-7{width:58.33333333%}.col-md-6{width:50%}.col-md-5{width:41.66666667%}.col-md-4{width:33.33333333%}.col-md-3{width:25%}.col-md-2{width:16.66666667%}.col-md-1{width:8.33333333%}.col-md-pull-12{right:100%}.col-md-pull-11{right:91.66666667%}.col-md-pull-10{right:83.33333333%}.col-md-pull-9{right:75%}.col-md-pull-8{right:66.66666667%}.col-md-pull-7{right:58.33333333%}.col-md-pull-6{right:50%}.col-md-pull-5{right:41.66666667%}.col-md-pull-4{right:33.33333333%}.col-md-pull-3{right:25%}.col-md-pull-2{right:16.66666667%}.col-md-pull-1{right:8.33333333%}.col-md-pull-0{right:auto}.col-md-push-12{left:100%}.col-md-push-11{left:91.66666667%}.col-md-push-10{left:83.33333333%}.col-md-push-9{left:75%}.col-md-push-8{left:66.66666667%}.col-md-push-7{left:58.33333333%}.col-md-push-6{left:50%}.col-md-push-5{left:41.66666667%}.col-md-push-4{left:33.33333333%}.col-md-push-3{left:25%}.col-md-push-2{left:16.66666667%}.col-md-push-1{left:8.33333333%}.col-md-push-0{left:auto}.col-md-offset-12{margin-left:100%}.col-md-offset-11{margin-left:91.66666667%}.col-md-offset-10{margin-left:83.33333333%}.col-md-offset-9{margin-left:75%}.col-md-offset-8{margin-left:66.66666667%}.col-md-offset-7{margin-left:58.33333333%}.col-md-offset-6{margin-left:50%}.col-md-offset-5{margin-left:41.66666667%}.col-md-offset-4{margin-left:33.33333333%}.col-md-offset-3{margin-left:25%}.col-md-offset-2{margin-left:16.66666667%}.col-md-offset-1{margin-left:8.33333333%}.col-md-offset-0{margin-left:0%}}@media (min-width:1200px){.col-lg-1,.col-lg-2,.col-lg-3,.col-lg-4,.col-lg-5,.col-lg-6,.col-lg-7,.col-lg-8,.col-lg-9,.col-lg-10,.col-lg-11,.col-lg-12{float:left}.col-lg-12{width:100%}.col-lg-11{width:91.66666667%}.col-lg-10{width:83.33333333%}.col-lg-9{width:75%}.col-lg-8{width:66.66666667%}.col-lg-7{width:58.33333333%}.col-lg-6{width:50%}.col-lg-5{width:41.66666667%}.col-lg-4{width:33.33333333%}.col-lg-3{width:25%}.col-lg-2{width:16.66666667%}.col-lg-1{width:8.33333333%}.col-lg-pull-12{right:100%}.col-lg-pull-11{right:91.66666667%}.col-lg-pull-10{right:83.33333333%}.col-lg-pull-9{right:75%}.col-lg-pull-8{right:66.66666667%}.col-lg-pull-7{right:58.33333333%}.col-lg-pull-6{right:50%}.col-lg-pull-5{right:41.66666667%}.col-lg-pull-4{right:33.33333333%}.col-lg-pull-3{right:25%}.col-lg-pull-2{right:16.66666667%}.col-lg-pull-1{right:8.33333333%}.col-lg-pull-0{right:auto}.col-lg-push-12{left:100%}.col-lg-push-11{left:91.66666667%}.col-lg-push-10{left:83.33333333%}.col-lg-push-9{left:75%}.col-lg-push-8{left:66.66666667%}.col-lg-push-7{left:58.33333333%}.col-lg-push-6{left:50%}.col-lg-push-5{left:41.66666667%}.col-lg-push-4{left:33.33333333%}.col-lg-push-3{left:25%}.col-lg-push-2{left:16.66666667%}.col-lg-push-1{left:8.33333333%}.col-lg-push-0{left:auto}.col-lg-offset-12{margin-left:100%}.col-lg-offset-11{margin-left:91.66666667%}.col-lg-offset-10{margin-left:83.33333333%}.col-lg-offset-9{margin-left:75%}.col-lg-offset-8{margin-left:66.66666667%}.col-lg-offset-7{margin-left:58.33333333%}.col-lg-offset-6{margin-left:50%}.col-lg-offset-5{margin-left:41.66666667%}.col-lg-offset-4{margin-left:33.33333333%}.col-lg-offset-3{margin-left:25%}.col-lg-offset-2{margin-left:16.66666667%}.col-lg-offset-1{margin-left:8.33333333%}.col-lg-offset-0{margin-left:0%}}table{background-color:transparent}table col[class*="col-"]{position:static;display:table-column;float:none}table td[class*="col-"],table th[class*="col-"]{position:static;display:table-cell;float:none}caption{padding-top:8px;padding-bottom:8px;color:#777;text-align:left}th{text-align:left}.table{width:100%;max-width:100%;margin-bottom:20px}.table>thead>tr>th,.table>tbody>tr>th,.table>tfoot>tr>th,.table>thead>tr>td,.table>tbody>tr>td,.table>tfoot>tr>td{padding:8px;line-height:1.42857143;vertical-align:top;border-top:1px solid #ddd}.table>thead>tr>th{vertical-align:bottom;border-bottom:2px solid #ddd}.table>caption+thead>tr:first-child>th,.table>colgroup+thead>tr:first-child>th,.table>thead:first-child>tr:first-child>th,.table>caption+thead>tr:first-child>td,.table>colgroup+thead>tr:first-child>td,.table>thead:first-child>tr:first-child>td{border-top:0}.table>tbody+tbody{border-top:2px solid #ddd}.table .table{background-color:#fff}.table-condensed>thead>tr>th,.table-condensed>tbody>tr>th,.table-condensed>tfoot>tr>th,.table-condensed>thead>tr>td,.table-condensed>tbody>tr>td,.table-condensed>tfoot>tr>td{padding:5px}.table-bordered{border:1px solid #ddd}.table-bordered>thead>tr>th,.table-bordered>tbody>tr>th,.table-bordered>tfoot>tr>th,.table-bordered>thead>tr>td,.table-bordered>tbody>tr>td,.table-bordered>tfoot>tr>td{border:1px solid #ddd}.table-bordered>thead>tr>th,.table-bordered>thead>tr>td{border-bottom-width:2px}.table-striped>tbody>tr:nth-of-type(odd){background-color:#f9f9f9}.table-hover>tbody>tr:hover{background-color:#f5f5f5}.table>thead>tr>td.active,.table>tbody>tr>td.active,.table>tfoot>tr>td.active,.table>thead>tr>th.active,.table>tbody>tr>th.active,.table>tfoot>tr>th.active,.table>thead>tr.active>td,.table>tbody>tr.active>td,.table>tfoot>tr.active>td,.table>thead>tr.active>th,.table>tbody>tr.active>th,.table>tfoot>tr.active>th{background-color:#f5f5f5}.table-hover>tbody>tr>td.active:hover,.table-hover>tbody>tr>th.active:hover,.table-hover>tbody>tr.active:hover>td,.table-hover>tbody>tr:hover>.active,.table-hover>tbody>tr.active:hover>th{background-color:#e8e8e8}.table>thead>tr>td.success,.table>tbody>tr>td.success,.table>tfoot>tr>td.success,.table>thead>tr>th.success,.table>tbody>tr>th.success,.table>tfoot>tr>th.success,.table>thead>tr.success>td,.table>tbody>tr.success>td,.table>tfoot>tr.success>td,.table>thead>tr.success>th,.table>tbody>tr.success>th,.table>tfoot>tr.success>th{background-color:#dff0d8}.table-hover>tbody>tr>td.success:hover,.table-hover>tbody>tr>th.success:hover,.table-hover>tbody>tr.success:hover>td,.table-hover>tbody>tr:hover>.success,.table-hover>tbody>tr.success:hover>th{background-color:#d0e9c6}.table>thead>tr>td.info,.table>tbody>tr>td.info,.table>tfoot>tr>td.info,.table>thead>tr>th.info,.table>tbody>tr>th.info,.table>tfoot>tr>th.info,.table>thead>tr.info>td,.table>tbody>tr.info>td,.table>tfoot>tr.info>td,.table>thead>tr.info>th,.table>tbody>tr.info>th,.table>tfoot>tr.info>th{background-color:#d9edf7}.table-hover>tbody>tr>td.info:hover,.table-hover>tbody>tr>th.info:hover,.table-hover>tbody>tr.info:hover>td,.table-hover>tbody>tr:hover>.info,.table-hover>tbody>tr.info:hover>th{background-color:#c4e3f3}.table>thead>tr>td.warning,.table>tbody>tr>td.warning,.table>tfoot>tr>td.warning,.table>thead>tr>th.warning,.table>tbody>tr>th.warning,.table>tfoot>tr>th.warning,.table>thead>tr.warning>td,.table>tbody>tr.warning>td,.table>tfoot>tr.warning>td,.table>thead>tr.warning>th,.table>tbody>tr.warning>th,.table>tfoot>tr.warning>th{background-color:#fcf8e3}.table-hover>tbody>tr>td.warning:hover,.table-hover>tbody>tr>th.warning:hover,.table-hover>tbody>tr.warning:hover>td,.table-hover>tbody>tr:hover>.warning,.table-hover>tbody>tr.warning:hover>th{background-color:#faf2cc}.table>thead>tr>td.danger,.table>tbody>tr>td.danger,.table>tfoot>tr>td.danger,.table>thead>tr>th.danger,.table>tbody>tr>th.danger,.table>tfoot>tr>th.danger,.table>thead>tr.danger>td,.table>tbody>tr.danger>td,.table>tfoot>tr.danger>td,.table>thead>tr.danger>th,.table>tbody>tr.danger>th,.table>tfoot>tr.danger>th{background-color:#f2dede}.table-hover>tbody>tr>td.danger:hover,.table-hover>tbody>tr>th.danger:hover,.table-hover>tbody>tr.danger:hover>td,.table-hover>tbody>tr:hover>.danger,.table-hover>tbody>tr.danger:hover>th{background-color:#ebcccc}.table-responsive{min-height:.01%;overflow-x:auto}@media screen and (max-width:767px){.table-responsive{width:100%;margin-bottom:15px;overflow-y:hidden;-ms-overflow-style:-ms-autohiding-scrollbar;border:1px solid #ddd}.table-responsive>.table{margin-bottom:0}.table-responsive>.table>thead>tr>th,.table-responsive>.table>tbody>tr>th,.table-responsive>.table>tfoot>tr>th,.table-responsive>.table>thead>tr>td,.table-responsive>.table>tbody>tr>td,.table-responsive>.table>tfoot>tr>td{white-space:nowrap}.table-responsive>.table-bordered{border:0}.table-responsive>.table-bordered>thead>tr>th:first-child,.table-responsive>.table-bordered>tbody>tr>th:first-child,.table-responsive>.table-bordered>tfoot>tr>th:first-child,.table-responsive>.table-bordered>thead>tr>td:first-child,.table-responsive>.table-bordered>tbody>tr>td:first-child,.table-responsive>.table-bordered>tfoot>tr>td:first-child{border-left:0}.table-responsive>.table-bordered>thead>tr>th:last-child,.table-responsive>.table-bordered>tbody>tr>th:last-child,.table-responsive>.table-bordered>tfoot>tr>th:last-child,.table-responsive>.table-bordered>thead>tr>td:last-child,.table-responsive>.table-bordered>tbody>tr>td:last-child,.table-responsive>.table-bordered>tfoot>tr>td:last-child{border-right:0}.table-responsive>.table-bordered>tbody>tr:last-child>th,.table-responsive>.table-bordered>tfoot>tr:last-child>th,.table-responsive>.table-bordered>tbody>tr:last-child>td,.table-responsive>.table-bordered>tfoot>tr:last-child>td{border-bottom:0}}fieldset{min-width:0;padding:0;margin:0;border:0}legend{display:block;width:100%;padding:0;margin-bottom:20px;font-size:21px;line-height:inherit;color:#333;border:0;border-bottom:1px solid #e5e5e5}label{display:inline-block;max-width:100%;margin-bottom:5px;font-weight:700}input[type="search"]{-webkit-box-sizing:border-box;-moz-box-sizing:border-box;box-sizing:border-box;-webkit-appearance:none;appearance:none}input[type="radio"],input[type="checkbox"]{margin:4px 0 0;margin-top:1px \9;line-height:normal}input[type="radio"][disabled],input[type="checkbox"][disabled],input[type="radio"].disabled,input[type="checkbox"].disabled,fieldset[disabled] input[type="radio"],fieldset[disabled] input[type="checkbox"]{cursor:not-allowed}input[type="file"]{display:block}input[type="range"]{display:block;width:100%}select[multiple],select[size]{height:auto}input[type="file"]:focus,input[type="radio"]:focus,input[type="checkbox"]:focus{outline:5px auto -webkit-focus-ring-color;outline-offset:-2px}output{display:block;padding-top:7px;font-size:14px;line-height:1.42857143;color:#555}.form-control{display:block;width:100%;height:34px;padding:6px 12px;font-size:14px;line-height:1.42857143;color:#555;background-color:#fff;background-image:none;border:1px solid #ccc;border-radius:4px;-webkit-box-shadow:inset 0 1px 1px rgba(0,0,0,0.075);box-shadow:inset 0 1px 1px rgba(0,0,0,0.075);-webkit-transition:border-color ease-in-out .15s, box-shadow ease-in-out .15s;-o-transition:border-color ease-in-out .15s, box-shadow ease-in-out .15s;transition:border-color ease-in-out .15s, box-shadow ease-in-out .15s}.form-control:focus{border-color:#66afe9;outline:0;-webkit-box-shadow:inset 0 1px 1px rgba(0, 0, 0, .075), 0 0 8px rgba(102, 175, 233, 0.6);box-shadow:inset 0 1px 1px rgba(0, 0, 0, .075), 0 0 8px rgba(102, 175, 233, 0.6)}.form-control::-moz-placeholder{color:#999;opacity:1}.form-control:-ms-input-placeholder{color:#999}.form-control::-webkit-input-placeholder{color:#999}.form-control::-ms-expand{background-color:transparent;border:0}.form-control[disabled],.form-control[readonly],fieldset[disabled] .form-control{background-color:#eee;opacity:1}.form-control[disabled],fieldset[disabled] .form-control{cursor:not-allowed}textarea.form-control{height:auto}@media screen and (-webkit-min-device-pixel-ratio:0){input[type="date"].form-control,input[type="time"].form-control,input[type="datetime-local"].form-control,input[type="month"].form-control{line-height:34px}input[type="date"].input-sm,input[type="time"].input-sm,input[type="datetime-local"].input-sm,input[type="month"].input-sm,.input-group-sm input[type="date"],.input-group-sm input[type="time"],.input-group-sm input[type="datetime-local"],.input-group-sm input[type="month"]{line-height:30px}input[type="date"].input-lg,input[type="time"].input-lg,input[type="datetime-local"].input-lg,input[type="month"].input-lg,.input-group-lg input[type="date"],.input-group-lg input[type="time"],.input-group-lg input[type="datetime-local"],.input-group-lg input[type="month"]{line-height:46px}}.form-group{margin-bottom:15px}.radio,.checkbox{position:relative;display:block;margin-top:10px;margin-bottom:10px}.radio.disabled label,.checkbox.disabled label,fieldset[disabled] .radio label,fieldset[disabled] .checkbox label{cursor:not-allowed}.radio label,.checkbox label{min-height:20px;padding-left:20px;margin-bottom:0;font-weight:400;cursor:pointer}.radio input[type="radio"],.radio-inline input[type="radio"],.checkbox input[type="checkbox"],.checkbox-inline input[type="checkbox"]{position:absolute;margin-top:4px \9;margin-left:-20px}.radio+.radio,.checkbox+.checkbox{margin-top:-5px}.radio-inline,.checkbox-inline{position:relative;display:inline-block;padding-left:20px;margin-bottom:0;font-weight:400;vertical-align:middle;cursor:pointer}.radio-inline.disabled,.checkbox-inline.disabled,fieldset[disabled] .radio-inline,fieldset[disabled] .checkbox-inline{cursor:not-allowed}.radio-inline+.radio-inline,.checkbox-inline+.checkbox-inline{margin-top:0;margin-left:10px}.form-control-static{min-height:34px;padding-top:7px;padding-bottom:7px;margin-bottom:0}.form-control-static.input-lg,.form-control-static.input-sm{padding-right:0;padding-left:0}.input-sm{height:30px;padding:5px 10px;font-size:12px;line-height:1.5;border-radius:3px}select.input-sm{height:30px;line-height:30px}textarea.input-sm,select[multiple].input-sm{height:auto}.form-group-sm .form-control{height:30px;padding:5px 10px;font-size:12px;line-height:1.5;border-radius:3px}.form-group-sm select.form-control{height:30px;line-height:30px}.form-group-sm textarea.form-control,.form-group-sm select[multiple].form-control{height:auto}.form-group-sm .form-control-static{height:30px;min-height:32px;padding:6px 10px;font-size:12px;line-height:1.5}.input-lg{height:46px;padding:10px 16px;font-size:18px;line-height:1.3333333;border-radius:6px}select.input-lg{height:46px;line-height:46px}textarea.input-lg,select[multiple].input-lg{height:auto}.form-group-lg .form-control{height:46px;padding:10px 16px;font-size:18px;line-height:1.3333333;border-radius:6px}.form-group-lg select.form-control{height:46px;line-height:46px}.form-group-lg textarea.form-control,.form-group-lg select[multiple].form-control{height:auto}.form-group-lg .form-control-static{height:46px;min-height:38px;padding:11px 16px;font-size:18px;line-height:1.3333333}.has-feedback{position:relative}.has-feedback .form-control{padding-right:42.5px}.form-control-feedback{position:absolute;top:0;right:0;z-index:2;display:block;width:34px;height:34px;line-height:34px;text-align:center;pointer-events:none}.input-lg+.form-control-feedback,.input-group-lg+.form-control-feedback,.form-group-lg .form-control+.form-control-feedback{width:46px;height:46px;line-height:46px}.input-sm+.form-control-feedback,.input-group-sm+.form-control-feedback,.form-group-sm .form-control+.form-control-feedback{width:30px;height:30px;line-height:30px}.has-success .help-block,.has-success .control-label,.has-success .radio,.has-success .checkbox,.has-success .radio-inline,.has-success .checkbox-inline,.has-success.radio label,.has-success.checkbox label,.has-success.radio-inline label,.has-success.checkbox-inline label{color:#3c763d}.has-success .form-control{border-color:#3c763d;-webkit-box-shadow:inset 0 1px 1px rgba(0,0,0,0.075);box-shadow:inset 0 1px 1px rgba(0,0,0,0.075)}.has-success .form-control:focus{border-color:#2b542c;-webkit-box-shadow:inset 0 1px 1px rgba(0,0,0,0.075),0 0 6px #67b168;box-shadow:inset 0 1px 1px rgba(0,0,0,0.075),0 0 6px #67b168}.has-success .input-group-addon{color:#3c763d;background-color:#dff0d8;border-color:#3c763d}.has-success .form-control-feedback{color:#3c763d}.has-warning .help-block,.has-warning .control-label,.has-warning .radio,.has-warning .checkbox,.has-warning .radio-inline,.has-warning .checkbox-inline,.has-warning.radio label,.has-warning.checkbox label,.has-warning.radio-inline label,.has-warning.checkbox-inline label{color:#8a6d3b}.has-warning .form-control{border-color:#8a6d3b;-webkit-box-shadow:inset 0 1px 1px rgba(0,0,0,0.075);box-shadow:inset 0 1px 1px rgba(0,0,0,0.075)}.has-warning .form-control:focus{border-color:#66512c;-webkit-box-shadow:inset 0 1px 1px rgba(0,0,0,0.075),0 0 6px #c0a16b;box-shadow:inset 0 1px 1px rgba(0,0,0,0.075),0 0 6px #c0a16b}.has-warning .input-group-addon{color:#8a6d3b;background-color:#fcf8e3;border-color:#8a6d3b}.has-warning .form-control-feedback{color:#8a6d3b}.has-error .help-block,.has-error .control-label,.has-error .radio,.has-error .checkbox,.has-error .radio-inline,.has-error .checkbox-inline,.has-error.radio label,.has-error.checkbox label,.has-error.radio-inline label,.has-error.checkbox-inline label{color:#a94442}.has-error .form-control{border-color:#a94442;-webkit-box-shadow:inset 0 1px 1px rgba(0,0,0,0.075);box-shadow:inset 0 1px 1px rgba(0,0,0,0.075)}.has-error .form-control:focus{border-color:#843534;-webkit-box-shadow:inset 0 1px 1px rgba(0,0,0,0.075),0 0 6px #ce8483;box-shadow:inset 0 1px 1px rgba(0,0,0,0.075),0 0 6px #ce8483}.has-error .input-group-addon{color:#a94442;background-color:#f2dede;border-color:#a94442}.has-error .form-control-feedback{color:#a94442}.has-feedback label~.form-control-feedback{top:25px}.has-feedback label.sr-only~.form-control-feedback{top:0}.help-block{display:block;margin-top:5px;margin-bottom:10px;color:#737373}@media (min-width:768px){.form-inline .form-group{display:inline-block;margin-bottom:0;vertical-align:middle}.form-inline .form-control{display:inline-block;width:auto;vertical-align:middle}.form-inline .form-control-static{display:inline-block}.form-inline .input-group{display:inline-table;vertical-align:middle}.form-inline .input-group .input-group-addon,.form-inline .input-group .input-group-btn,.form-inline .input-group .form-control{width:auto}.form-inline .input-group>.form-control{width:100%}.form-inline .control-label{margin-bottom:0;vertical-align:middle}.form-inline .radio,.form-inline .checkbox{display:inline-block;margin-top:0;margin-bottom:0;vertical-align:middle}.form-inline .radio label,.form-inline .checkbox label{padding-left:0}.form-inline .radio input[type="radio"],.form-inline .checkbox input[type="checkbox"]{position:relative;margin-left:0}.form-inline .has-feedback .form-control-feedback{top:0}}.form-horizontal .radio,.form-horizontal .checkbox,.form-horizontal .radio-inline,.form-horizontal .checkbox-inline{padding-top:7px;margin-top:0;margin-bottom:0}.form-horizontal .radio,.form-horizontal .checkbox{min-height:27px}.form-horizontal .form-group{margin-right:-15px;margin-left:-15px}@media (min-width:768px){.form-horizontal .control-label{padding-top:7px;margin-bottom:0;text-align:right}}.form-horizontal .has-feedback .form-control-feedback{right:15px}@media (min-width:768px){.form-horizontal .form-group-lg .control-label{padding-top:11px;font-size:18px}}@media (min-width:768px){.form-horizontal .form-group-sm .control-label{padding-top:6px;font-size:12px}}.btn{display:inline-block;margin-bottom:0;font-weight:normal;text-align:center;white-space:nowrap;vertical-align:middle;touch-action:manipulation;cursor:pointer;background-image:none;border:1px solid transparent;padding:6px 12px;font-size:14px;line-height:1.42857143;border-radius:4px;-webkit-user-select:none;-moz-user-select:none;-ms-user-select:none;user-select:none}.btn:focus,.btn:active:focus,.btn.active:focus,.btn.focus,.btn:active.focus,.btn.active.focus{outline:5px auto -webkit-focus-ring-color;outline-offset:-2px}.btn:hover,.btn:focus,.btn.focus{color:#333;text-decoration:none}.btn:active,.btn.active{background-image:none;outline:0;-webkit-box-shadow:inset 0 3px 5px rgba(0,0,0,0.125);box-shadow:inset 0 3px 5px rgba(0,0,0,0.125)}.btn.disabled,.btn[disabled],fieldset[disabled] .btn{cursor:not-allowed;filter:alpha(opacity=65);opacity:.65;-webkit-box-shadow:none;box-shadow:none}a.btn.disabled,fieldset[disabled] a.btn{pointer-events:none}.btn-default{color:#333;background-color:#fff;border-color:#ccc}.btn-default:focus,.btn-default.focus{color:#333;background-color:#e6e6e6;border-color:#8c8c8c}.btn-default:hover{color:#333;background-color:#e6e6e6;border-color:#adadad}.btn-default:active,.btn-default.active,.open>.dropdown-toggle.btn-default{color:#333;background-color:#e6e6e6;background-image:none;border-color:#adadad}.btn-default:active:hover,.btn-default.active:hover,.open>.dropdown-toggle.btn-default:hover,.btn-default:active:focus,.btn-default.active:focus,.open>.dropdown-toggle.btn-default:focus,.btn-default:active.focus,.btn-default.active.focus,.open>.dropdown-toggle.btn-default.focus{color:#333;background-color:#d4d4d4;border-color:#8c8c8c}.btn-default.disabled:hover,.btn-default[disabled]:hover,fieldset[disabled] .btn-default:hover,.btn-default.disabled:focus,.btn-default[disabled]:focus,fieldset[disabled] .btn-default:focus,.btn-default.disabled.focus,.btn-default[disabled].focus,fieldset[disabled] .btn-default.focus{background-color:#fff;border-color:#ccc}.btn-default .badge{color:#fff;background-color:#333}.btn-primary{color:#fff;background-color:#337ab7;border-color:#2e6da4}.btn-primary:focus,.btn-primary.focus{color:#fff;background-color:#286090;border-color:#122b40}.btn-primary:hover{color:#fff;background-color:#286090;border-color:#204d74}.btn-primary:active,.btn-primary.active,.open>.dropdown-toggle.btn-primary{color:#fff;background-color:#286090;background-image:none;border-color:#204d74}.btn-primary:active:hover,.btn-primary.active:hover,.open>.dropdown-toggle.btn-primary:hover,.btn-primary:active:focus,.btn-primary.active:focus,.open>.dropdown-toggle.btn-primary:focus,.btn-primary:active.focus,.btn-primary.active.focus,.open>.dropdown-toggle.btn-primary.focus{color:#fff;background-color:#204d74;border-color:#122b40}.btn-primary.disabled:hover,.btn-primary[disabled]:hover,fieldset[disabled] .btn-primary:hover,.btn-primary.disabled:focus,.btn-primary[disabled]:focus,fieldset[disabled] .btn-primary:focus,.btn-primary.disabled.focus,.btn-primary[disabled].focus,fieldset[disabled] .btn-primary.focus{background-color:#337ab7;border-color:#2e6da4}.btn-primary .badge{color:#337ab7;background-color:#fff}.btn-success{color:#fff;background-color:#5cb85c;border-color:#4cae4c}.btn-success:focus,.btn-success.focus{color:#fff;background-color:#449d44;border-color:#255625}.btn-success:hover{color:#fff;background-color:#449d44;border-color:#398439}.btn-success:active,.btn-success.active,.open>.dropdown-toggle.btn-success{color:#fff;background-color:#449d44;background-image:none;border-color:#398439}.btn-success:active:hover,.btn-success.active:hover,.open>.dropdown-toggle.btn-success:hover,.btn-success:active:focus,.btn-success.active:focus,.open>.dropdown-toggle.btn-success:focus,.btn-success:active.focus,.btn-success.active.focus,.open>.dropdown-toggle.btn-success.focus{color:#fff;background-color:#398439;border-color:#255625}.btn-success.disabled:hover,.btn-success[disabled]:hover,fieldset[disabled] .btn-success:hover,.btn-success.disabled:focus,.btn-success[disabled]:focus,fieldset[disabled] .btn-success:focus,.btn-success.disabled.focus,.btn-success[disabled].focus,fieldset[disabled] .btn-success.focus{background-color:#5cb85c;border-color:#4cae4c}.btn-success .badge{color:#5cb85c;background-color:#fff}.btn-info{color:#fff;background-color:#5bc0de;border-color:#46b8da}.btn-info:focus,.btn-info.focus{color:#fff;background-color:#31b0d5;border-color:#1b6d85}.btn-info:hover{color:#fff;background-color:#31b0d5;border-color:#269abc}.btn-info:active,.btn-info.active,.open>.dropdown-toggle.btn-info{color:#fff;background-color:#31b0d5;background-image:none;border-color:#269abc}.btn-info:active:hover,.btn-info.active:hover,.open>.dropdown-toggle.btn-info:hover,.btn-info:active:focus,.btn-info.active:focus,.open>.dropdown-toggle.btn-info:focus,.btn-info:active.focus,.btn-info.active.focus,.open>.dropdown-toggle.btn-info.focus{color:#fff;background-color:#269abc;border-color:#1b6d85}.btn-info.disabled:hover,.btn-info[disabled]:hover,fieldset[disabled] .btn-info:hover,.btn-info.disabled:focus,.btn-info[disabled]:focus,fieldset[disabled] .btn-info:focus,.btn-info.disabled.focus,.btn-info[disabled].focus,fieldset[disabled] .btn-info.focus{background-color:#5bc0de;border-color:#46b8da}.btn-info .badge{color:#5bc0de;background-color:#fff}.btn-warning{color:#fff;background-color:#f0ad4e;border-color:#eea236}.btn-warning:focus,.btn-warning.focus{color:#fff;background-color:#ec971f;border-color:#985f0d}.btn-warning:hover{color:#fff;background-color:#ec971f;border-color:#d58512}.btn-warning:active,.btn-warning.active,.open>.dropdown-toggle.btn-warning{color:#fff;background-color:#ec971f;background-image:none;border-color:#d58512}.btn-warning:active:hover,.btn-warning.active:hover,.open>.dropdown-toggle.btn-warning:hover,.btn-warning:active:focus,.btn-warning.active:focus,.open>.dropdown-toggle.btn-warning:focus,.btn-warning:active.focus,.btn-warning.active.focus,.open>.dropdown-toggle.btn-warning.focus{color:#fff;background-color:#d58512;border-color:#985f0d}.btn-warning.disabled:hover,.btn-warning[disabled]:hover,fieldset[disabled] .btn-warning:hover,.btn-warning.disabled:focus,.btn-warning[disabled]:focus,fieldset[disabled] .btn-warning:focus,.btn-warning.disabled.focus,.btn-warning[disabled].focus,fieldset[disabled] .btn-warning.focus{background-color:#f0ad4e;border-color:#eea236}.btn-warning .badge{color:#f0ad4e;background-color:#fff}.btn-danger{color:#fff;background-color:#d9534f;border-color:#d43f3a}.btn-danger:focus,.btn-danger.focus{color:#fff;background-color:#c9302c;border-color:#761c19}.btn-danger:hover{color:#fff;background-color:#c9302c;border-color:#ac2925}.btn-danger:active,.btn-danger.active,.open>.dropdown-toggle.btn-danger{color:#fff;background-color:#c9302c;background-image:none;border-color:#ac2925}.btn-danger:active:hover,.btn-danger.active:hover,.open>.dropdown-toggle.btn-danger:hover,.btn-danger:active:focus,.btn-danger.active:focus,.open>.dropdown-toggle.btn-danger:focus,.btn-danger:active.focus,.btn-danger.active.focus,.open>.dropdown-toggle.btn-danger.focus{color:#fff;background-color:#ac2925;border-color:#761c19}.btn-danger.disabled:hover,.btn-danger[disabled]:hover,fieldset[disabled] .btn-danger:hover,.btn-danger.disabled:focus,.btn-danger[disabled]:focus,fieldset[disabled] .btn-danger:focus,.btn-danger.disabled.focus,.btn-danger[disabled].focus,fieldset[disabled] .btn-danger.focus{background-color:#d9534f;border-color:#d43f3a}.btn-danger .badge{color:#d9534f;background-color:#fff}.btn-link{font-weight:400;color:#337ab7;border-radius:0}.btn-link,.btn-link:active,.btn-link.active,.btn-link[disabled],fieldset[disabled] .btn-link{background-color:transparent;-webkit-box-shadow:none;box-shadow:none}.btn-link,.btn-link:hover,.btn-link:focus,.btn-link:active{border-color:transparent}.btn-link:hover,.btn-link:focus{color:#23527c;text-decoration:underline;background-color:transparent}.btn-link[disabled]:hover,fieldset[disabled] .btn-link:hover,.btn-link[disabled]:focus,fieldset[disabled] .btn-link:focus{color:#777;text-decoration:none}.btn-lg,.btn-group-lg>.btn{padding:10px 16px;font-size:18px;line-height:1.3333333;border-radius:6px}.btn-sm,.btn-group-sm>.btn{padding:5px 10px;font-size:12px;line-height:1.5;border-radius:3px}.btn-xs,.btn-group-xs>.btn{padding:1px 5px;font-size:12px;line-height:1.5;border-radius:3px}.btn-block{display:block;width:100%}.btn-block+.btn-block{margin-top:5px}input[type="submit"].btn-block,input[type="reset"].btn-block,input[type="button"].btn-block{width:100%}.fade{opacity:0;-webkit-transition:opacity .15s linear;-o-transition:opacity .15s linear;transition:opacity .15s linear}.fade.in{opacity:1}.collapse{display:none}.collapse.in{display:block}tr.collapse.in{display:table-row}tbody.collapse.in{display:table-row-group}.collapsing{position:relative;height:0;overflow:hidden;-webkit-transition-property:height, visibility;transition-property:height, visibility;-webkit-transition-duration:.35s;transition-duration:.35s;-webkit-transition-timing-function:ease;transition-timing-function:ease}.caret{display:inline-block;width:0;height:0;margin-left:2px;vertical-align:middle;border-top:4px dashed;border-top:4px solid \9;border-right:4px solid transparent;border-left:4px solid transparent}.dropup,.dropdown{position:relative}.dropdown-toggle:focus{outline:0}.dropdown-menu{position:absolute;top:100%;left:0;z-index:1000;display:none;float:left;min-width:160px;padding:5px 0;margin:2px 0 0;font-size:14px;text-align:left;list-style:none;background-color:#fff;background-clip:padding-box;border:1px solid #ccc;border:1px solid rgba(0,0,0,0.15);border-radius:4px;-webkit-box-shadow:0 6px 12px rgba(0,0,0,0.175);box-shadow:0 6px 12px rgba(0,0,0,0.175)}.dropdown-menu.pull-right{right:0;left:auto}.dropdown-menu .divider{height:1px;margin:9px 0;overflow:hidden;background-color:#e5e5e5}.dropdown-menu>li>a{display:block;padding:3px 20px;clear:both;font-weight:400;line-height:1.42857143;color:#333;white-space:nowrap}.dropdown-menu>li>a:hover,.dropdown-menu>li>a:focus{color:#262626;text-decoration:none;background-color:#f5f5f5}.dropdown-menu>.active>a,.dropdown-menu>.active>a:hover,.dropdown-menu>.active>a:focus{color:#fff;text-decoration:none;background-color:#337ab7;outline:0}.dropdown-menu>.disabled>a,.dropdown-menu>.disabled>a:hover,.dropdown-menu>.disabled>a:focus{color:#777}.dropdown-menu>.disabled>a:hover,.dropdown-menu>.disabled>a:focus{text-decoration:none;cursor:not-allowed;background-color:transparent;background-image:none;filter:progid:DXImageTransform.Microsoft.gradient(enabled = false)}.open>.dropdown-menu{display:block}.open>a{outline:0}.dropdown-menu-right{right:0;left:auto}.dropdown-menu-left{right:auto;left:0}.dropdown-header{display:block;padding:3px 20px;font-size:12px;line-height:1.42857143;color:#777;white-space:nowrap}.dropdown-backdrop{position:fixed;top:0;right:0;bottom:0;left:0;z-index:990}.pull-right>.dropdown-menu{right:0;left:auto}.dropup .caret,.navbar-fixed-bottom .dropdown .caret{content:"";border-top:0;border-bottom:4px dashed;border-bottom:4px solid \9}.dropup .dropdown-menu,.navbar-fixed-bottom .dropdown .dropdown-menu{top:auto;bottom:100%;margin-bottom:2px}@media (min-width:768px){.navbar-right .dropdown-menu{right:0;left:auto}.navbar-right .dropdown-menu-left{right:auto;left:0}}.btn-group,.btn-group-vertical{position:relative;display:inline-block;vertical-align:middle}.btn-group>.btn,.btn-group-vertical>.btn{position:relative;float:left}.btn-group>.btn:hover,.btn-group-vertical>.btn:hover,.btn-group>.btn:focus,.btn-group-vertical>.btn:focus,.btn-group>.btn:active,.btn-group-vertical>.btn:active,.btn-group>.btn.active,.btn-group-vertical>.btn.active{z-index:2}.btn-group .btn+.btn,.btn-group .btn+.btn-group,.btn-group .btn-group+.btn,.btn-group .btn-group+.btn-group{margin-left:-1px}.btn-toolbar{margin-left:-5px}.btn-toolbar .btn,.btn-toolbar .btn-group,.btn-toolbar .input-group{float:left}.btn-toolbar>.btn,.btn-toolbar>.btn-group,.btn-toolbar>.input-group{margin-left:5px}.btn-group>.btn:not(:first-child):not(:last-child):not(.dropdown-toggle){border-radius:0}.btn-group>.btn:first-child{margin-left:0}.btn-group>.btn:first-child:not(:last-child):not(.dropdown-toggle){border-top-right-radius:0;border-bottom-right-radius:0}.btn-group>.btn:last-child:not(:first-child),.btn-group>.dropdown-toggle:not(:first-child){border-top-left-radius:0;border-bottom-left-radius:0}.btn-group>.btn-group{float:left}.btn-group>.btn-group:not(:first-child):not(:last-child)>.btn{border-radius:0}.btn-group>.btn-group:first-child:not(:last-child)>.btn:last-child,.btn-group>.btn-group:first-child:not(:last-child)>.dropdown-toggle{border-top-right-radius:0;border-bottom-right-radius:0}.btn-group>.btn-group:last-child:not(:first-child)>.btn:first-child{border-top-left-radius:0;border-bottom-left-radius:0}.btn-group .dropdown-toggle:active,.btn-group.open .dropdown-toggle{outline:0}.btn-group>.btn+.dropdown-toggle{padding-right:8px;padding-left:8px}.btn-group>.btn-lg+.dropdown-toggle{padding-right:12px;padding-left:12px}.btn-group.open .dropdown-toggle{-webkit-box-shadow:inset 0 3px 5px rgba(0,0,0,0.125);box-shadow:inset 0 3px 5px rgba(0,0,0,0.125)}.btn-group.open .dropdown-toggle.btn-link{-webkit-box-shadow:none;box-shadow:none}.btn .caret{margin-left:0}.btn-lg .caret{border-width:5px 5px 0;border-bottom-width:0}.dropup .btn-lg .caret{border-width:0 5px 5px}.btn-group-vertical>.btn,.btn-group-vertical>.btn-group,.btn-group-vertical>.btn-group>.btn{display:block;float:none;width:100%;max-width:100%}.btn-group-vertical>.btn-group>.btn{float:none}.btn-group-vertical>.btn+.btn,.btn-group-vertical>.btn+.btn-group,.btn-group-vertical>.btn-group+.btn,.btn-group-vertical>.btn-group+.btn-group{margin-top:-1px;margin-left:0}.btn-group-vertical>.btn:not(:first-child):not(:last-child){border-radius:0}.btn-group-vertical>.btn:first-child:not(:last-child){border-top-left-radius:4px;border-top-right-radius:4px;border-bottom-right-radius:0;border-bottom-left-radius:0}.btn-group-vertical>.btn:last-child:not(:first-child){border-top-left-radius:0;border-top-right-radius:0;border-bottom-right-radius:4px;border-bottom-left-radius:4px}.btn-group-vertical>.btn-group:not(:first-child):not(:last-child)>.btn{border-radius:0}.btn-group-vertical>.btn-group:first-child:not(:last-child)>.btn:last-child,.btn-group-vertical>.btn-group:first-child:not(:last-child)>.dropdown-toggle{border-bottom-right-radius:0;border-bottom-left-radius:0}.btn-group-vertical>.btn-group:last-child:not(:first-child)>.btn:first-child{border-top-left-radius:0;border-top-right-radius:0}.btn-group-justified{display:table;width:100%;table-layout:fixed;border-collapse:separate}.btn-group-justified>.btn,.btn-group-justified>.btn-group{display:table-cell;float:none;width:1%}.btn-group-justified>.btn-group .btn{width:100%}.btn-group-justified>.btn-group .dropdown-menu{left:auto}[data-toggle="buttons"]>.btn input[type="radio"],[data-toggle="buttons"]>.btn-group>.btn input[type="radio"],[data-toggle="buttons"]>.btn input[type="checkbox"],[data-toggle="buttons"]>.btn-group>.btn input[type="checkbox"]{position:absolute;clip:rect(0, 0, 0, 0);pointer-events:none}.input-group{position:relative;display:table;border-collapse:separate}.input-group[class*="col-"]{float:none;padding-right:0;padding-left:0}.input-group .form-control{position:relative;z-index:2;float:left;width:100%;margin-bottom:0}.input-group .form-control:focus{z-index:3}.input-group-lg>.form-control,.input-group-lg>.input-group-addon,.input-group-lg>.input-group-btn>.btn{height:46px;padding:10px 16px;font-size:18px;line-height:1.3333333;border-radius:6px}select.input-group-lg>.form-control,select.input-group-lg>.input-group-addon,select.input-group-lg>.input-group-btn>.btn{height:46px;line-height:46px}textarea.input-group-lg>.form-control,textarea.input-group-lg>.input-group-addon,textarea.input-group-lg>.input-group-btn>.btn,select[multiple].input-group-lg>.form-control,select[multiple].input-group-lg>.input-group-addon,select[multiple].input-group-lg>.input-group-btn>.btn{height:auto}.input-group-sm>.form-control,.input-group-sm>.input-group-addon,.input-group-sm>.input-group-btn>.btn{height:30px;padding:5px 10px;font-size:12px;line-height:1.5;border-radius:3px}select.input-group-sm>.form-control,select.input-group-sm>.input-group-addon,select.input-group-sm>.input-group-btn>.btn{height:30px;line-height:30px}textarea.input-group-sm>.form-control,textarea.input-group-sm>.input-group-addon,textarea.input-group-sm>.input-group-btn>.btn,select[multiple].input-group-sm>.form-control,select[multiple].input-group-sm>.input-group-addon,select[multiple].input-group-sm>.input-group-btn>.btn{height:auto}.input-group-addon,.input-group-btn,.input-group .form-control{display:table-cell}.input-group-addon:not(:first-child):not(:last-child),.input-group-btn:not(:first-child):not(:last-child),.input-group .form-control:not(:first-child):not(:last-child){border-radius:0}.input-group-addon,.input-group-btn{width:1%;white-space:nowrap;vertical-align:middle}.input-group-addon{padding:6px 12px;font-size:14px;font-weight:400;line-height:1;color:#555;text-align:center;background-color:#eee;border:1px solid #ccc;border-radius:4px}.input-group-addon.input-sm{padding:5px 10px;font-size:12px;border-radius:3px}.input-group-addon.input-lg{padding:10px 16px;font-size:18px;border-radius:6px}.input-group-addon input[type="radio"],.input-group-addon input[type="checkbox"]{margin-top:0}.input-group .form-control:first-child,.input-group-addon:first-child,.input-group-btn:first-child>.btn,.input-group-btn:first-child>.btn-group>.btn,.input-group-btn:first-child>.dropdown-toggle,.input-group-btn:last-child>.btn:not(:last-child):not(.dropdown-toggle),.input-group-btn:last-child>.btn-group:not(:last-child)>.btn{border-top-right-radius:0;border-bottom-right-radius:0}.input-group-addon:first-child{border-right:0}.input-group .form-control:last-child,.input-group-addon:last-child,.input-group-btn:last-child>.btn,.input-group-btn:last-child>.btn-group>.btn,.input-group-btn:last-child>.dropdown-toggle,.input-group-btn:first-child>.btn:not(:first-child),.input-group-btn:first-child>.btn-group:not(:first-child)>.btn{border-top-left-radius:0;border-bottom-left-radius:0}.input-group-addon:last-child{border-left:0}.input-group-btn{position:relative;font-size:0;white-space:nowrap}.input-group-btn>.btn{position:relative}.input-group-btn>.btn+.btn{margin-left:-1px}.input-group-btn>.btn:hover,.input-group-btn>.btn:focus,.input-group-btn>.btn:active{z-index:2}.input-group-btn:first-child>.btn,.input-group-btn:first-child>.btn-group{margin-right:-1px}.input-group-btn:last-child>.btn,.input-group-btn:last-child>.btn-group{z-index:2;margin-left:-1px}.nav{padding-left:0;margin-bottom:0;list-style:none}.nav>li{position:relative;display:block}.nav>li>a{position:relative;display:block;padding:10px 15px}.nav>li>a:hover,.nav>li>a:focus{text-decoration:none;background-color:#eee}.nav>li.disabled>a{color:#777}.nav>li.disabled>a:hover,.nav>li.disabled>a:focus{color:#777;text-decoration:none;cursor:not-allowed;background-color:transparent}.nav .open>a,.nav .open>a:hover,.nav .open>a:focus{background-color:#eee;border-color:#337ab7}.nav .nav-divider{height:1px;margin:9px 0;overflow:hidden;background-color:#e5e5e5}.nav>li>a>img{max-width:none}.nav-tabs{border-bottom:1px solid #ddd}.nav-tabs>li{float:left;margin-bottom:-1px}.nav-tabs>li>a{margin-right:2px;line-height:1.42857143;border:1px solid transparent;border-radius:4px 4px 0 0}.nav-tabs>li>a:hover{border-color:#eee #eee #ddd}.nav-tabs>li.active>a,.nav-tabs>li.active>a:hover,.nav-tabs>li.active>a:focus{color:#555;cursor:default;background-color:#fff;border:1px solid #ddd;border-bottom-color:transparent}.nav-tabs.nav-justified{width:100%;border-bottom:0}.nav-tabs.nav-justified>li{float:none}.nav-tabs.nav-justified>li>a{margin-bottom:5px;text-align:center}.nav-tabs.nav-justified>.dropdown .dropdown-menu{top:auto;left:auto}@media (min-width:768px){.nav-tabs.nav-justified>li{display:table-cell;width:1%}.nav-tabs.nav-justified>li>a{margin-bottom:0}}.nav-tabs.nav-justified>li>a{margin-right:0;border-radius:4px}.nav-tabs.nav-justified>.active>a,.nav-tabs.nav-justified>.active>a:hover,.nav-tabs.nav-justified>.active>a:focus{border:1px solid #ddd}@media (min-width:768px){.nav-tabs.nav-justified>li>a{border-bottom:1px solid #ddd;border-radius:4px 4px 0 0}.nav-tabs.nav-justified>.active>a,.nav-tabs.nav-justified>.active>a:hover,.nav-tabs.nav-justified>.active>a:focus{border-bottom-color:#fff}}.nav-pills>li{float:left}.nav-pills>li>a{border-radius:4px}.nav-pills>li+li{margin-left:2px}.nav-pills>li.active>a,.nav-pills>li.active>a:hover,.nav-pills>li.active>a:focus{color:#fff;background-color:#337ab7}.nav-stacked>li{float:none}.nav-stacked>li+li{margin-top:2px;margin-left:0}.nav-justified{width:100%}.nav-justified>li{float:none}.nav-justified>li>a{margin-bottom:5px;text-align:center}.nav-justified>.dropdown .dropdown-menu{top:auto;left:auto}@media (min-width:768px){.nav-justified>li{display:table-cell;width:1%}.nav-justified>li>a{margin-bottom:0}}.nav-tabs-justified{border-bottom:0}.nav-tabs-justified>li>a{margin-right:0;border-radius:4px}.nav-tabs-justified>.active>a,.nav-tabs-justified>.active>a:hover,.nav-tabs-justified>.active>a:focus{border:1px solid #ddd}@media (min-width:768px){.nav-tabs-justified>li>a{border-bottom:1px solid #ddd;border-radius:4px 4px 0 0}.nav-tabs-justified>.active>a,.nav-tabs-justified>.active>a:hover,.nav-tabs-justified>.active>a:focus{border-bottom-color:#fff}}.tab-content>.tab-pane{display:none}.tab-content>.active{display:block}.nav-tabs .dropdown-menu{margin-top:-1px;border-top-left-radius:0;border-top-right-radius:0}.navbar{position:relative;min-height:50px;margin-bottom:20px;border:1px solid transparent}@media (min-width:768px){.navbar{border-radius:4px}}@media (min-width:768px){.navbar-header{float:left}}.navbar-collapse{padding-right:15px;padding-left:15px;overflow-x:visible;border-top:1px solid transparent;box-shadow:inset 0 1px 0 rgba(255,255,255,0.1);-webkit-overflow-scrolling:touch}.navbar-collapse.in{overflow-y:auto}@media (min-width:768px){.navbar-collapse{width:auto;border-top:0;box-shadow:none}.navbar-collapse.collapse{display:block !important;height:auto !important;padding-bottom:0;overflow:visible !important}.navbar-collapse.in{overflow-y:visible}.navbar-fixed-top .navbar-collapse,.navbar-static-top .navbar-collapse,.navbar-fixed-bottom .navbar-collapse{padding-right:0;padding-left:0}}.navbar-fixed-top,.navbar-fixed-bottom{position:fixed;right:0;left:0;z-index:1030}.navbar-fixed-top .navbar-collapse,.navbar-fixed-bottom .navbar-collapse{max-height:340px}@media (max-device-width:480px) and (orientation:landscape){.navbar-fixed-top .navbar-collapse,.navbar-fixed-bottom .navbar-collapse{max-height:200px}}@media (min-width:768px){.navbar-fixed-top,.navbar-fixed-bottom{border-radius:0}}.navbar-fixed-top{top:0;border-width:0 0 1px}.navbar-fixed-bottom{bottom:0;margin-bottom:0;border-width:1px 0 0}.container>.navbar-header,.container-fluid>.navbar-header,.container>.navbar-collapse,.container-fluid>.navbar-collapse{margin-right:-15px;margin-left:-15px}@media (min-width:768px){.container>.navbar-header,.container-fluid>.navbar-header,.container>.navbar-collapse,.container-fluid>.navbar-collapse{margin-right:0;margin-left:0}}.navbar-static-top{z-index:1000;border-width:0 0 1px}@media (min-width:768px){.navbar-static-top{border-radius:0}}.navbar-brand{float:left;height:50px;padding:15px 15px;font-size:18px;line-height:20px}.navbar-brand:hover,.navbar-brand:focus{text-decoration:none}.navbar-brand>img{display:block}@media (min-width:768px){.navbar>.container .navbar-brand,.navbar>.container-fluid .navbar-brand{margin-left:-15px}}.navbar-toggle{position:relative;float:right;padding:9px 10px;margin-right:15px;margin-top:8px;margin-bottom:8px;background-color:transparent;background-image:none;border:1px solid transparent;border-radius:4px}.navbar-toggle:focus{outline:0}.navbar-toggle .icon-bar{display:block;width:22px;height:2px;border-radius:1px}.navbar-toggle .icon-bar+.icon-bar{margin-top:4px}@media (min-width:768px){.navbar-toggle{display:none}}.navbar-nav{margin:7.5px -15px}.navbar-nav>li>a{padding-top:10px;padding-bottom:10px;line-height:20px}@media (max-width:767px){.navbar-nav .open .dropdown-menu{position:static;float:none;width:auto;margin-top:0;background-color:transparent;border:0;box-shadow:none}.navbar-nav .open .dropdown-menu>li>a,.navbar-nav .open .dropdown-menu .dropdown-header{padding:5px 15px 5px 25px}.navbar-nav .open .dropdown-menu>li>a{line-height:20px}.navbar-nav .open .dropdown-menu>li>a:hover,.navbar-nav .open .dropdown-menu>li>a:focus{background-image:none}}@media (min-width:768px){.navbar-nav{float:left;margin:0}.navbar-nav>li{float:left}.navbar-nav>li>a{padding-top:15px;padding-bottom:15px}}.navbar-form{padding:10px 15px;margin-right:-15px;margin-left:-15px;border-top:1px solid transparent;border-bottom:1px solid transparent;-webkit-box-shadow:inset 0 1px 0 rgba(255,255,255,0.1),0 1px 0 rgba(255,255,255,0.1);box-shadow:inset 0 1px 0 rgba(255,255,255,0.1),0 1px 0 rgba(255,255,255,0.1);margin-top:8px;margin-bottom:8px}@media (min-width:768px){.navbar-form .form-group{display:inline-block;margin-bottom:0;vertical-align:middle}.navbar-form .form-control{display:inline-block;width:auto;vertical-align:middle}.navbar-form .form-control-static{display:inline-block}.navbar-form .input-group{display:inline-table;vertical-align:middle}.navbar-form .input-group .input-group-addon,.navbar-form .input-group .input-group-btn,.navbar-form .input-group .form-control{width:auto}.navbar-form .input-group>.form-control{width:100%}.navbar-form .control-label{margin-bottom:0;vertical-align:middle}.navbar-form .radio,.navbar-form .checkbox{display:inline-block;margin-top:0;margin-bottom:0;vertical-align:middle}.navbar-form .radio label,.navbar-form .checkbox label{padding-left:0}.navbar-form .radio input[type="radio"],.navbar-form .checkbox input[type="checkbox"]{position:relative;margin-left:0}.navbar-form .has-feedback .form-control-feedback{top:0}}@media (max-width:767px){.navbar-form .form-group{margin-bottom:5px}.navbar-form .form-group:last-child{margin-bottom:0}}@media (min-width:768px){.navbar-form{width:auto;padding-top:0;padding-bottom:0;margin-right:0;margin-left:0;border:0;-webkit-box-shadow:none;box-shadow:none}}.navbar-nav>li>.dropdown-menu{margin-top:0;border-top-left-radius:0;border-top-right-radius:0}.navbar-fixed-bottom .navbar-nav>li>.dropdown-menu{margin-bottom:0;border-top-left-radius:4px;border-top-right-radius:4px;border-bottom-right-radius:0;border-bottom-left-radius:0}.navbar-btn{margin-top:8px;margin-bottom:8px}.navbar-btn.btn-sm{margin-top:10px;margin-bottom:10px}.navbar-btn.btn-xs{margin-top:14px;margin-bottom:14px}.navbar-text{margin-top:15px;margin-bottom:15px}@media (min-width:768px){.navbar-text{float:left;margin-right:15px;margin-left:15px}}@media (min-width:768px){.navbar-left{float:left !important}.navbar-right{float:right !important;margin-right:-15px}.navbar-right~.navbar-right{margin-right:0}}.navbar-default{background-color:#f8f8f8;border-color:#e7e7e7}.navbar-default .navbar-brand{color:#777}.navbar-default .navbar-brand:hover,.navbar-default .navbar-brand:focus{color:#5e5e5e;background-color:transparent}.navbar-default .navbar-text{color:#777}.navbar-default .navbar-nav>li>a{color:#777}.navbar-default .navbar-nav>li>a:hover,.navbar-default .navbar-nav>li>a:focus{color:#333;background-color:transparent}.navbar-default .navbar-nav>.active>a,.navbar-default .navbar-nav>.active>a:hover,.navbar-default .navbar-nav>.active>a:focus{color:#555;background-color:#e7e7e7}.navbar-default .navbar-nav>.disabled>a,.navbar-default .navbar-nav>.disabled>a:hover,.navbar-default .navbar-nav>.disabled>a:focus{color:#ccc;background-color:transparent}.navbar-default .navbar-nav>.open>a,.navbar-default .navbar-nav>.open>a:hover,.navbar-default .navbar-nav>.open>a:focus{color:#555;background-color:#e7e7e7}@media (max-width:767px){.navbar-default .navbar-nav .open .dropdown-menu>li>a{color:#777}.navbar-default .navbar-nav .open .dropdown-menu>li>a:hover,.navbar-default .navbar-nav .open .dropdown-menu>li>a:focus{color:#333;background-color:transparent}.navbar-default .navbar-nav .open .dropdown-menu>.active>a,.navbar-default .navbar-nav .open .dropdown-menu>.active>a:hover,.navbar-default .navbar-nav .open .dropdown-menu>.active>a:focus{color:#555;background-color:#e7e7e7}.navbar-default .navbar-nav .open .dropdown-menu>.disabled>a,.navbar-default .navbar-nav .open .dropdown-menu>.disabled>a:hover,.navbar-default .navbar-nav .open .dropdown-menu>.disabled>a:focus{color:#ccc;background-color:transparent}}.navbar-default .navbar-toggle{border-color:#ddd}.navbar-default .navbar-toggle:hover,.navbar-default .navbar-toggle:focus{background-color:#ddd}.navbar-default .navbar-toggle .icon-bar{background-color:#888}.navbar-default .navbar-collapse,.navbar-default .navbar-form{border-color:#e7e7e7}.navbar-default .navbar-link{color:#777}.navbar-default .navbar-link:hover{color:#333}.navbar-default .btn-link{color:#777}.navbar-default .btn-link:hover,.navbar-default .btn-link:focus{color:#333}.navbar-default .btn-link[disabled]:hover,fieldset[disabled] .navbar-default .btn-link:hover,.navbar-default .btn-link[disabled]:focus,fieldset[disabled] .navbar-default .btn-link:focus{color:#ccc}.navbar-inverse{background-color:#222;border-color:#080808}.navbar-inverse .navbar-brand{color:#9d9d9d}.navbar-inverse .navbar-brand:hover,.navbar-inverse .navbar-brand:focus{color:#fff;background-color:transparent}.navbar-inverse .navbar-text{color:#9d9d9d}.navbar-inverse .navbar-nav>li>a{color:#9d9d9d}.navbar-inverse .navbar-nav>li>a:hover,.navbar-inverse .navbar-nav>li>a:focus{color:#fff;background-color:transparent}.navbar-inverse .navbar-nav>.active>a,.navbar-inverse .navbar-nav>.active>a:hover,.navbar-inverse .navbar-nav>.active>a:focus{color:#fff;background-color:#080808}.navbar-inverse .navbar-nav>.disabled>a,.navbar-inverse .navbar-nav>.disabled>a:hover,.navbar-inverse .navbar-nav>.disabled>a:focus{color:#444;background-color:transparent}.navbar-inverse .navbar-nav>.open>a,.navbar-inverse .navbar-nav>.open>a:hover,.navbar-inverse .navbar-nav>.open>a:focus{color:#fff;background-color:#080808}@media (max-width:767px){.navbar-inverse .navbar-nav .open .dropdown-menu>.dropdown-header{border-color:#080808}.navbar-inverse .navbar-nav .open .dropdown-menu .divider{background-color:#080808}.navbar-inverse .navbar-nav .open .dropdown-menu>li>a{color:#9d9d9d}.navbar-inverse .navbar-nav .open .dropdown-menu>li>a:hover,.navbar-inverse .navbar-nav .open .dropdown-menu>li>a:focus{color:#fff;background-color:transparent}.navbar-inverse .navbar-nav .open .dropdown-menu>.active>a,.navbar-inverse .navbar-nav .open .dropdown-menu>.active>a:hover,.navbar-inverse .navbar-nav .open .dropdown-menu>.active>a:focus{color:#fff;background-color:#080808}.navbar-inverse .navbar-nav .open .dropdown-menu>.disabled>a,.navbar-inverse .navbar-nav .open .dropdown-menu>.disabled>a:hover,.navbar-inverse .navbar-nav .open .dropdown-menu>.disabled>a:focus{color:#444;background-color:transparent}}.navbar-inverse .navbar-toggle{border-color:#333}.navbar-inverse .navbar-toggle:hover,.navbar-inverse .navbar-toggle:focus{background-color:#333}.navbar-inverse .navbar-toggle .icon-bar{background-color:#fff}.navbar-inverse .navbar-collapse,.navbar-inverse .navbar-form{border-color:#101010}.navbar-inverse .navbar-link{color:#9d9d9d}.navbar-inverse .navbar-link:hover{color:#fff}.navbar-inverse .btn-link{color:#9d9d9d}.navbar-inverse .btn-link:hover,.navbar-inverse .btn-link:focus{color:#fff}.navbar-inverse .btn-link[disabled]:hover,fieldset[disabled] .navbar-inverse .btn-link:hover,.navbar-inverse .btn-link[disabled]:focus,fieldset[disabled] .navbar-inverse .btn-link:focus{color:#444}.breadcrumb{padding:8px 15px;margin-bottom:20px;list-style:none;background-color:#f5f5f5;border-radius:4px}.breadcrumb>li{display:inline-block}.breadcrumb>li+li:before{padding:0 5px;color:#ccc;content:"/\00a0"}.breadcrumb>.active{color:#777}.pagination{display:inline-block;padding-left:0;margin:20px 0;border-radius:4px}.pagination>li{display:inline}.pagination>li>a,.pagination>li>span{position:relative;float:left;padding:6px 12px;margin-left:-1px;line-height:1.42857143;color:#337ab7;text-decoration:none;background-color:#fff;border:1px solid #ddd}.pagination>li>a:hover,.pagination>li>span:hover,.pagination>li>a:focus,.pagination>li>span:focus{z-index:2;color:#23527c;background-color:#eee;border-color:#ddd}.pagination>li:first-child>a,.pagination>li:first-child>span{margin-left:0;border-top-left-radius:4px;border-bottom-left-radius:4px}.pagination>li:last-child>a,.pagination>li:last-child>span{border-top-right-radius:4px;border-bottom-right-radius:4px}.pagination>.active>a,.pagination>.active>span,.pagination>.active>a:hover,.pagination>.active>span:hover,.pagination>.active>a:focus,.pagination>.active>span:focus{z-index:3;color:#fff;cursor:default;background-color:#337ab7;border-color:#337ab7}.pagination>.disabled>span,.pagination>.disabled>span:hover,.pagination>.disabled>span:focus,.pagination>.disabled>a,.pagination>.disabled>a:hover,.pagination>.disabled>a:focus{color:#777;cursor:not-allowed;background-color:#fff;border-color:#ddd}.pagination-lg>li>a,.pagination-lg>li>span{padding:10px 16px;font-size:18px;line-height:1.3333333}.pagination-lg>li:first-child>a,.pagination-lg>li:first-child>span{border-top-left-radius:6px;border-bottom-left-radius:6px}.pagination-lg>li:last-child>a,.pagination-lg>li:last-child>span{border-top-right-radius:6px;border-bottom-right-radius:6px}.pagination-sm>li>a,.pagination-sm>li>span{padding:5px 10px;font-size:12px;line-height:1.5}.pagination-sm>li:first-child>a,.pagination-sm>li:first-child>span{border-top-left-radius:3px;border-bottom-left-radius:3px}.pagination-sm>li:last-child>a,.pagination-sm>li:last-child>span{border-top-right-radius:3px;border-bottom-right-radius:3px}.pager{padding-left:0;margin:20px 0;text-align:center;list-style:none}.pager li{display:inline}.pager li>a,.pager li>span{display:inline-block;padding:5px 14px;background-color:#fff;border:1px solid #ddd;border-radius:15px}.pager li>a:hover,.pager li>a:focus{text-decoration:none;background-color:#eee}.pager .next>a,.pager .next>span{float:right}.pager .previous>a,.pager .previous>span{float:left}.pager .disabled>a,.pager .disabled>a:hover,.pager .disabled>a:focus,.pager .disabled>span{color:#777;cursor:not-allowed;background-color:#fff}.label{display:inline;padding:.2em .6em .3em;font-size:75%;font-weight:700;line-height:1;color:#fff;text-align:center;white-space:nowrap;vertical-align:baseline;border-radius:.25em}a.label:hover,a.label:focus{color:#fff;text-decoration:none;cursor:pointer}.label:empty{display:none}.btn .label{position:relative;top:-1px}.label-default{background-color:#777}.label-default[href]:hover,.label-default[href]:focus{background-color:#5e5e5e}.label-primary{background-color:#337ab7}.label-primary[href]:hover,.label-primary[href]:focus{background-color:#286090}.label-success{background-color:#5cb85c}.label-success[href]:hover,.label-success[href]:focus{background-color:#449d44}.label-info{background-color:#5bc0de}.label-info[href]:hover,.label-info[href]:focus{background-color:#31b0d5}.label-warning{background-color:#f0ad4e}.label-warning[href]:hover,.label-warning[href]:focus{background-color:#ec971f}.label-danger{background-color:#d9534f}.label-danger[href]:hover,.label-danger[href]:focus{background-color:#c9302c}.badge{display:inline-block;min-width:10px;padding:3px 7px;font-size:12px;font-weight:bold;line-height:1;color:#fff;text-align:center;white-space:nowrap;vertical-align:middle;background-color:#777;border-radius:10px}.badge:empty{display:none}.btn .badge{position:relative;top:-1px}.btn-xs .badge,.btn-group-xs>.btn .badge{top:0;padding:1px 5px}a.badge:hover,a.badge:focus{color:#fff;text-decoration:none;cursor:pointer}.list-group-item.active>.badge,.nav-pills>.active>a>.badge{color:#337ab7;background-color:#fff}.list-group-item>.badge{float:right}.list-group-item>.badge+.badge{margin-right:5px}.nav-pills>li>a>.badge{margin-left:3px}.jumbotron{padding-top:30px;padding-bottom:30px;margin-bottom:30px;color:inherit;background-color:#eee}.jumbotron h1,.jumbotron .h1{color:inherit}.jumbotron p{margin-bottom:15px;font-size:21px;font-weight:200}.jumbotron>hr{border-top-color:#d5d5d5}.container .jumbotron,.container-fluid .jumbotron{padding-right:15px;padding-left:15px;border-radius:6px}.jumbotron .container{max-width:100%}@media screen and (min-width:768px){.jumbotron{padding-top:48px;padding-bottom:48px}.container .jumbotron,.container-fluid .jumbotron{padding-right:60px;padding-left:60px}.jumbotron h1,.jumbotron .h1{font-size:63px}}.thumbnail{display:block;padding:4px;margin-bottom:20px;line-height:1.42857143;background-color:#fff;border:1px solid #ddd;border-radius:4px;-webkit-transition:border .2s ease-in-out;-o-transition:border .2s ease-in-out;transition:border .2s ease-in-out}.thumbnail>img,.thumbnail a>img{margin-right:auto;margin-left:auto}a.thumbnail:hover,a.thumbnail:focus,a.thumbnail.active{border-color:#337ab7}.thumbnail .caption{padding:9px;color:#333}.alert{padding:15px;margin-bottom:20px;border:1px solid transparent;border-radius:4px}.alert h4{margin-top:0;color:inherit}.alert .alert-link{font-weight:bold}.alert>p,.alert>ul{margin-bottom:0}.alert>p+p{margin-top:5px}.alert-dismissable,.alert-dismissible{padding-right:35px}.alert-dismissable .close,.alert-dismissible .close{position:relative;top:-2px;right:-21px;color:inherit}.alert-success{color:#3c763d;background-color:#dff0d8;border-color:#d6e9c6}.alert-success hr{border-top-color:#c9e2b3}.alert-success .alert-link{color:#2b542c}.alert-info{color:#31708f;background-color:#d9edf7;border-color:#bce8f1}.alert-info hr{border-top-color:#a6e1ec}.alert-info .alert-link{color:#245269}.alert-warning{color:#8a6d3b;background-color:#fcf8e3;border-color:#faebcc}.alert-warning hr{border-top-color:#f7e1b5}.alert-warning .alert-link{color:#66512c}.alert-danger{color:#a94442;background-color:#f2dede;border-color:#ebccd1}.alert-danger hr{border-top-color:#e4b9c0}.alert-danger .alert-link{color:#843534}@-webkit-keyframes progress-bar-stripes{from{background-position:40px 0}to{background-position:0 0}}@keyframes progress-bar-stripes{from{background-position:40px 0}to{background-position:0 0}}.progress{height:20px;margin-bottom:20px;overflow:hidden;background-color:#f5f5f5;border-radius:4px;-webkit-box-shadow:inset 0 1px 2px rgba(0,0,0,0.1);box-shadow:inset 0 1px 2px rgba(0,0,0,0.1)}.progress-bar{float:left;width:0%;height:100%;font-size:12px;line-height:20px;color:#fff;text-align:center;background-color:#337ab7;-webkit-box-shadow:inset 0 -1px 0 rgba(0,0,0,0.15);box-shadow:inset 0 -1px 0 rgba(0,0,0,0.15);-webkit-transition:width .6s ease;-o-transition:width .6s ease;transition:width .6s ease}.progress-striped .progress-bar,.progress-bar-striped{background-image:-webkit-linear-gradient(45deg, rgba(255,255,255,0.15) 25%, transparent 25%, transparent 50%, rgba(255,255,255,0.15) 50%, rgba(255,255,255,0.15) 75%, transparent 75%, transparent);background-image:-o-linear-gradient(45deg, rgba(255,255,255,0.15) 25%, transparent 25%, transparent 50%, rgba(255,255,255,0.15) 50%, rgba(255,255,255,0.15) 75%, transparent 75%, transparent);background-image:linear-gradient(45deg, rgba(255,255,255,0.15) 25%, transparent 25%, transparent 50%, rgba(255,255,255,0.15) 50%, rgba(255,255,255,0.15) 75%, transparent 75%, transparent);background-size:40px 40px}.progress.active .progress-bar,.progress-bar.active{-webkit-animation:progress-bar-stripes 2s linear infinite;-o-animation:progress-bar-stripes 2s linear infinite;animation:progress-bar-stripes 2s linear infinite}.progress-bar-success{background-color:#5cb85c}.progress-striped .progress-bar-success{background-image:-webkit-linear-gradient(45deg, rgba(255,255,255,0.15) 25%, transparent 25%, transparent 50%, rgba(255,255,255,0.15) 50%, rgba(255,255,255,0.15) 75%, transparent 75%, transparent);background-image:-o-linear-gradient(45deg, rgba(255,255,255,0.15) 25%, transparent 25%, transparent 50%, rgba(255,255,255,0.15) 50%, rgba(255,255,255,0.15) 75%, transparent 75%, transparent);background-image:linear-gradient(45deg, rgba(255,255,255,0.15) 25%, transparent 25%, transparent 50%, rgba(255,255,255,0.15) 50%, rgba(255,255,255,0.15) 75%, transparent 75%, transparent)}.progress-bar-info{background-color:#5bc0de}.progress-striped .progress-bar-info{background-image:-webkit-linear-gradient(45deg, rgba(255,255,255,0.15) 25%, transparent 25%, transparent 50%, rgba(255,255,255,0.15) 50%, rgba(255,255,255,0.15) 75%, transparent 75%, transparent);background-image:-o-linear-gradient(45deg, rgba(255,255,255,0.15) 25%, transparent 25%, transparent 50%, rgba(255,255,255,0.15) 50%, rgba(255,255,255,0.15) 75%, transparent 75%, transparent);background-image:linear-gradient(45deg, rgba(255,255,255,0.15) 25%, transparent 25%, transparent 50%, rgba(255,255,255,0.15) 50%, rgba(255,255,255,0.15) 75%, transparent 75%, transparent)}.progress-bar-warning{background-color:#f0ad4e}.progress-striped .progress-bar-warning{background-image:-webkit-linear-gradient(45deg, rgba(255,255,255,0.15) 25%, transparent 25%, transparent 50%, rgba(255,255,255,0.15) 50%, rgba(255,255,255,0.15) 75%, transparent 75%, transparent);background-image:-o-linear-gradient(45deg, rgba(255,255,255,0.15) 25%, transparent 25%, transparent 50%, rgba(255,255,255,0.15) 50%, rgba(255,255,255,0.15) 75%, transparent 75%, transparent);background-image:linear-gradient(45deg, rgba(255,255,255,0.15) 25%, transparent 25%, transparent 50%, rgba(255,255,255,0.15) 50%, rgba(255,255,255,0.15) 75%, transparent 75%, transparent)}.progress-bar-danger{background-color:#d9534f}.progress-striped .progress-bar-danger{background-image:-webkit-linear-gradient(45deg, rgba(255,255,255,0.15) 25%, transparent 25%, transparent 50%, rgba(255,255,255,0.15) 50%, rgba(255,255,255,0.15) 75%, transparent 75%, transparent);background-image:-o-linear-gradient(45deg, rgba(255,255,255,0.15) 25%, transparent 25%, transparent 50%, rgba(255,255,255,0.15) 50%, rgba(255,255,255,0.15) 75%, transparent 75%, transparent);background-image:linear-gradient(45deg, rgba(255,255,255,0.15) 25%, transparent 25%, transparent 50%, rgba(255,255,255,0.15) 50%, rgba(255,255,255,0.15) 75%, transparent 75%, transparent)}.media{margin-top:15px}.media:first-child{margin-top:0}.media,.media-body{overflow:hidden;zoom:1}.media-body{width:10000px}.media-object{display:block}.media-object.img-thumbnail{max-width:none}.media-right,.media>.pull-right{padding-left:10px}.media-left,.media>.pull-left{padding-right:10px}.media-left,.media-right,.media-body{display:table-cell;vertical-align:top}.media-middle{vertical-align:middle}.media-bottom{vertical-align:bottom}.media-heading{margin-top:0;margin-bottom:5px}.media-list{padding-left:0;list-style:none}.list-group{padding-left:0;margin-bottom:20px}.list-group-item{position:relative;display:block;padding:10px 15px;margin-bottom:-1px;background-color:#fff;border:1px solid #ddd}.list-group-item:first-child{border-top-left-radius:4px;border-top-right-radius:4px}.list-group-item:last-child{margin-bottom:0;border-bottom-right-radius:4px;border-bottom-left-radius:4px}.list-group-item.disabled,.list-group-item.disabled:hover,.list-group-item.disabled:focus{color:#777;cursor:not-allowed;background-color:#eee}.list-group-item.disabled .list-group-item-heading,.list-group-item.disabled:hover .list-group-item-heading,.list-group-item.disabled:focus .list-group-item-heading{color:inherit}.list-group-item.disabled .list-group-item-text,.list-group-item.disabled:hover .list-group-item-text,.list-group-item.disabled:focus .list-group-item-text{color:#777}.list-group-item.active,.list-group-item.active:hover,.list-group-item.active:focus{z-index:2;color:#fff;background-color:#337ab7;border-color:#337ab7}.list-group-item.active .list-group-item-heading,.list-group-item.active:hover .list-group-item-heading,.list-group-item.active:focus .list-group-item-heading,.list-group-item.active .list-group-item-heading>small,.list-group-item.active:hover .list-group-item-heading>small,.list-group-item.active:focus .list-group-item-heading>small,.list-group-item.active .list-group-item-heading>.small,.list-group-item.active:hover .list-group-item-heading>.small,.list-group-item.active:focus .list-group-item-heading>.small{color:inherit}.list-group-item.active .list-group-item-text,.list-group-item.active:hover .list-group-item-text,.list-group-item.active:focus .list-group-item-text{color:#c7ddef}a.list-group-item,button.list-group-item{color:#555}a.list-group-item .list-group-item-heading,button.list-group-item .list-group-item-heading{color:#333}a.list-group-item:hover,button.list-group-item:hover,a.list-group-item:focus,button.list-group-item:focus{color:#555;text-decoration:none;background-color:#f5f5f5}button.list-group-item{width:100%;text-align:left}.list-group-item-success{color:#3c763d;background-color:#dff0d8}a.list-group-item-success,button.list-group-item-success{color:#3c763d}a.list-group-item-success .list-group-item-heading,button.list-group-item-success .list-group-item-heading{color:inherit}a.list-group-item-success:hover,button.list-group-item-success:hover,a.list-group-item-success:focus,button.list-group-item-success:focus{color:#3c763d;background-color:#d0e9c6}a.list-group-item-success.active,button.list-group-item-success.active,a.list-group-item-success.active:hover,button.list-group-item-success.active:hover,a.list-group-item-success.active:focus,button.list-group-item-success.active:focus{color:#fff;background-color:#3c763d;border-color:#3c763d}.list-group-item-info{color:#31708f;background-color:#d9edf7}a.list-group-item-info,button.list-group-item-info{color:#31708f}a.list-group-item-info .list-group-item-heading,button.list-group-item-info .list-group-item-heading{color:inherit}a.list-group-item-info:hover,button.list-group-item-info:hover,a.list-group-item-info:focus,button.list-group-item-info:focus{color:#31708f;background-color:#c4e3f3}a.list-group-item-info.active,button.list-group-item-info.active,a.list-group-item-info.active:hover,button.list-group-item-info.active:hover,a.list-group-item-info.active:focus,button.list-group-item-info.active:focus{color:#fff;background-color:#31708f;border-color:#31708f}.list-group-item-warning{color:#8a6d3b;background-color:#fcf8e3}a.list-group-item-warning,button.list-group-item-warning{color:#8a6d3b}a.list-group-item-warning .list-group-item-heading,button.list-group-item-warning .list-group-item-heading{color:inherit}a.list-group-item-warning:hover,button.list-group-item-warning:hover,a.list-group-item-warning:focus,button.list-group-item-warning:focus{color:#8a6d3b;background-color:#faf2cc}a.list-group-item-warning.active,button.list-group-item-warning.active,a.list-group-item-warning.active:hover,button.list-group-item-warning.active:hover,a.list-group-item-warning.active:focus,button.list-group-item-warning.active:focus{color:#fff;background-color:#8a6d3b;border-color:#8a6d3b}.list-group-item-danger{color:#a94442;background-color:#f2dede}a.list-group-item-danger,button.list-group-item-danger{color:#a94442}a.list-group-item-danger .list-group-item-heading,button.list-group-item-danger .list-group-item-heading{color:inherit}a.list-group-item-danger:hover,button.list-group-item-danger:hover,a.list-group-item-danger:focus,button.list-group-item-danger:focus{color:#a94442;background-color:#ebcccc}a.list-group-item-danger.active,button.list-group-item-danger.active,a.list-group-item-danger.active:hover,button.list-group-item-danger.active:hover,a.list-group-item-danger.active:focus,button.list-group-item-danger.active:focus{color:#fff;background-color:#a94442;border-color:#a94442}.list-group-item-heading{margin-top:0;margin-bottom:5px}.list-group-item-text{margin-bottom:0;line-height:1.3}.panel{margin-bottom:20px;background-color:#fff;border:1px solid transparent;border-radius:4px;-webkit-box-shadow:0 1px 1px rgba(0,0,0,0.05);box-shadow:0 1px 1px rgba(0,0,0,0.05)}.panel-body{padding:15px}.panel-heading{padding:10px 15px;border-bottom:1px solid transparent;border-top-left-radius:3px;border-top-right-radius:3px}.panel-heading>.dropdown .dropdown-toggle{color:inherit}.panel-title{margin-top:0;margin-bottom:0;font-size:16px;color:inherit}.panel-title>a,.panel-title>small,.panel-title>.small,.panel-title>small>a,.panel-title>.small>a{color:inherit}.panel-footer{padding:10px 15px;background-color:#f5f5f5;border-top:1px solid #ddd;border-bottom-right-radius:3px;border-bottom-left-radius:3px}.panel>.list-group,.panel>.panel-collapse>.list-group{margin-bottom:0}.panel>.list-group .list-group-item,.panel>.panel-collapse>.list-group .list-group-item{border-width:1px 0;border-radius:0}.panel>.list-group:first-child .list-group-item:first-child,.panel>.panel-collapse>.list-group:first-child .list-group-item:first-child{border-top:0;border-top-left-radius:3px;border-top-right-radius:3px}.panel>.list-group:last-child .list-group-item:last-child,.panel>.panel-collapse>.list-group:last-child .list-group-item:last-child{border-bottom:0;border-bottom-right-radius:3px;border-bottom-left-radius:3px}.panel>.panel-heading+.panel-collapse>.list-group .list-group-item:first-child{border-top-left-radius:0;border-top-right-radius:0}.panel-heading+.list-group .list-group-item:first-child{border-top-width:0}.list-group+.panel-footer{border-top-width:0}.panel>.table,.panel>.table-responsive>.table,.panel>.panel-collapse>.table{margin-bottom:0}.panel>.table caption,.panel>.table-responsive>.table caption,.panel>.panel-collapse>.table caption{padding-right:15px;padding-left:15px}.panel>.table:first-child,.panel>.table-responsive:first-child>.table:first-child{border-top-left-radius:3px;border-top-right-radius:3px}.panel>.table:first-child>thead:first-child>tr:first-child,.panel>.table-responsive:first-child>.table:first-child>thead:first-child>tr:first-child,.panel>.table:first-child>tbody:first-child>tr:first-child,.panel>.table-responsive:first-child>.table:first-child>tbody:first-child>tr:first-child{border-top-left-radius:3px;border-top-right-radius:3px}.panel>.table:first-child>thead:first-child>tr:first-child td:first-child,.panel>.table-responsive:first-child>.table:first-child>thead:first-child>tr:first-child td:first-child,.panel>.table:first-child>tbody:first-child>tr:first-child td:first-child,.panel>.table-responsive:first-child>.table:first-child>tbody:first-child>tr:first-child td:first-child,.panel>.table:first-child>thead:first-child>tr:first-child th:first-child,.panel>.table-responsive:first-child>.table:first-child>thead:first-child>tr:first-child th:first-child,.panel>.table:first-child>tbody:first-child>tr:first-child th:first-child,.panel>.table-responsive:first-child>.table:first-child>tbody:first-child>tr:first-child th:first-child{border-top-left-radius:3px}.panel>.table:first-child>thead:first-child>tr:first-child td:last-child,.panel>.table-responsive:first-child>.table:first-child>thead:first-child>tr:first-child td:last-child,.panel>.table:first-child>tbody:first-child>tr:first-child td:last-child,.panel>.table-responsive:first-child>.table:first-child>tbody:first-child>tr:first-child td:last-child,.panel>.table:first-child>thead:first-child>tr:first-child th:last-child,.panel>.table-responsive:first-child>.table:first-child>thead:first-child>tr:first-child th:last-child,.panel>.table:first-child>tbody:first-child>tr:first-child th:last-child,.panel>.table-responsive:first-child>.table:first-child>tbody:first-child>tr:first-child th:last-child{border-top-right-radius:3px}.panel>.table:last-child,.panel>.table-responsive:last-child>.table:last-child{border-bottom-right-radius:3px;border-bottom-left-radius:3px}.panel>.table:last-child>tbody:last-child>tr:last-child,.panel>.table-responsive:last-child>.table:last-child>tbody:last-child>tr:last-child,.panel>.table:last-child>tfoot:last-child>tr:last-child,.panel>.table-responsive:last-child>.table:last-child>tfoot:last-child>tr:last-child{border-bottom-right-radius:3px;border-bottom-left-radius:3px}.panel>.table:last-child>tbody:last-child>tr:last-child td:first-child,.panel>.table-responsive:last-child>.table:last-child>tbody:last-child>tr:last-child td:first-child,.panel>.table:last-child>tfoot:last-child>tr:last-child td:first-child,.panel>.table-responsive:last-child>.table:last-child>tfoot:last-child>tr:last-child td:first-child,.panel>.table:last-child>tbody:last-child>tr:last-child th:first-child,.panel>.table-responsive:last-child>.table:last-child>tbody:last-child>tr:last-child th:first-child,.panel>.table:last-child>tfoot:last-child>tr:last-child th:first-child,.panel>.table-responsive:last-child>.table:last-child>tfoot:last-child>tr:last-child th:first-child{border-bottom-left-radius:3px}.panel>.table:last-child>tbody:last-child>tr:last-child td:last-child,.panel>.table-responsive:last-child>.table:last-child>tbody:last-child>tr:last-child td:last-child,.panel>.table:last-child>tfoot:last-child>tr:last-child td:last-child,.panel>.table-responsive:last-child>.table:last-child>tfoot:last-child>tr:last-child td:last-child,.panel>.table:last-child>tbody:last-child>tr:last-child th:last-child,.panel>.table-responsive:last-child>.table:last-child>tbody:last-child>tr:last-child th:last-child,.panel>.table:last-child>tfoot:last-child>tr:last-child th:last-child,.panel>.table-responsive:last-child>.table:last-child>tfoot:last-child>tr:last-child th:last-child{border-bottom-right-radius:3px}.panel>.panel-body+.table,.panel>.panel-body+.table-responsive,.panel>.table+.panel-body,.panel>.table-responsive+.panel-body{border-top:1px solid #ddd}.panel>.table>tbody:first-child>tr:first-child th,.panel>.table>tbody:first-child>tr:first-child td{border-top:0}.panel>.table-bordered,.panel>.table-responsive>.table-bordered{border:0}.panel>.table-bordered>thead>tr>th:first-child,.panel>.table-responsive>.table-bordered>thead>tr>th:first-child,.panel>.table-bordered>tbody>tr>th:first-child,.panel>.table-responsive>.table-bordered>tbody>tr>th:first-child,.panel>.table-bordered>tfoot>tr>th:first-child,.panel>.table-responsive>.table-bordered>tfoot>tr>th:first-child,.panel>.table-bordered>thead>tr>td:first-child,.panel>.table-responsive>.table-bordered>thead>tr>td:first-child,.panel>.table-bordered>tbody>tr>td:first-child,.panel>.table-responsive>.table-bordered>tbody>tr>td:first-child,.panel>.table-bordered>tfoot>tr>td:first-child,.panel>.table-responsive>.table-bordered>tfoot>tr>td:first-child{border-left:0}.panel>.table-bordered>thead>tr>th:last-child,.panel>.table-responsive>.table-bordered>thead>tr>th:last-child,.panel>.table-bordered>tbody>tr>th:last-child,.panel>.table-responsive>.table-bordered>tbody>tr>th:last-child,.panel>.table-bordered>tfoot>tr>th:last-child,.panel>.table-responsive>.table-bordered>tfoot>tr>th:last-child,.panel>.table-bordered>thead>tr>td:last-child,.panel>.table-responsive>.table-bordered>thead>tr>td:last-child,.panel>.table-bordered>tbody>tr>td:last-child,.panel>.table-responsive>.table-bordered>tbody>tr>td:last-child,.panel>.table-bordered>tfoot>tr>td:last-child,.panel>.table-responsive>.table-bordered>tfoot>tr>td:last-child{border-right:0}.panel>.table-bordered>thead>tr:first-child>td,.panel>.table-responsive>.table-bordered>thead>tr:first-child>td,.panel>.table-bordered>tbody>tr:first-child>td,.panel>.table-responsive>.table-bordered>tbody>tr:first-child>td,.panel>.table-bordered>thead>tr:first-child>th,.panel>.table-responsive>.table-bordered>thead>tr:first-child>th,.panel>.table-bordered>tbody>tr:first-child>th,.panel>.table-responsive>.table-bordered>tbody>tr:first-child>th{border-bottom:0}.panel>.table-bordered>tbody>tr:last-child>td,.panel>.table-responsive>.table-bordered>tbody>tr:last-child>td,.panel>.table-bordered>tfoot>tr:last-child>td,.panel>.table-responsive>.table-bordered>tfoot>tr:last-child>td,.panel>.table-bordered>tbody>tr:last-child>th,.panel>.table-responsive>.table-bordered>tbody>tr:last-child>th,.panel>.table-bordered>tfoot>tr:last-child>th,.panel>.table-responsive>.table-bordered>tfoot>tr:last-child>th{border-bottom:0}.panel>.table-responsive{margin-bottom:0;border:0}.panel-group{margin-bottom:20px}.panel-group .panel{margin-bottom:0;border-radius:4px}.panel-group .panel+.panel{margin-top:5px}.panel-group .panel-heading{border-bottom:0}.panel-group .panel-heading+.panel-collapse>.panel-body,.panel-group .panel-heading+.panel-collapse>.list-group{border-top:1px solid #ddd}.panel-group .panel-footer{border-top:0}.panel-group .panel-footer+.panel-collapse .panel-body{border-bottom:1px solid #ddd}.panel-default{border-color:#ddd}.panel-default>.panel-heading{color:#333;background-color:#f5f5f5;border-color:#ddd}.panel-default>.panel-heading+.panel-collapse>.panel-body{border-top-color:#ddd}.panel-default>.panel-heading .badge{color:#f5f5f5;background-color:#333}.panel-default>.panel-footer+.panel-collapse>.panel-body{border-bottom-color:#ddd}.panel-primary{border-color:#337ab7}.panel-primary>.panel-heading{color:#fff;background-color:#337ab7;border-color:#337ab7}.panel-primary>.panel-heading+.panel-collapse>.panel-body{border-top-color:#337ab7}.panel-primary>.panel-heading .badge{color:#337ab7;background-color:#fff}.panel-primary>.panel-footer+.panel-collapse>.panel-body{border-bottom-color:#337ab7}.panel-success{border-color:#d6e9c6}.panel-success>.panel-heading{color:#3c763d;background-color:#dff0d8;border-color:#d6e9c6}.panel-success>.panel-heading+.panel-collapse>.panel-body{border-top-color:#d6e9c6}.panel-success>.panel-heading .badge{color:#dff0d8;background-color:#3c763d}.panel-success>.panel-footer+.panel-collapse>.panel-body{border-bottom-color:#d6e9c6}.panel-info{border-color:#bce8f1}.panel-info>.panel-heading{color:#31708f;background-color:#d9edf7;border-color:#bce8f1}.panel-info>.panel-heading+.panel-collapse>.panel-body{border-top-color:#bce8f1}.panel-info>.panel-heading .badge{color:#d9edf7;background-color:#31708f}.panel-info>.panel-footer+.panel-collapse>.panel-body{border-bottom-color:#bce8f1}.panel-warning{border-color:#faebcc}.panel-warning>.panel-heading{color:#8a6d3b;background-color:#fcf8e3;border-color:#faebcc}.panel-warning>.panel-heading+.panel-collapse>.panel-body{border-top-color:#faebcc}.panel-warning>.panel-heading .badge{color:#fcf8e3;background-color:#8a6d3b}.panel-warning>.panel-footer+.panel-collapse>.panel-body{border-bottom-color:#faebcc}.panel-danger{border-color:#ebccd1}.panel-danger>.panel-heading{color:#a94442;background-color:#f2dede;border-color:#ebccd1}.panel-danger>.panel-heading+.panel-collapse>.panel-body{border-top-color:#ebccd1}.panel-danger>.panel-heading .badge{color:#f2dede;background-color:#a94442}.panel-danger>.panel-footer+.panel-collapse>.panel-body{border-bottom-color:#ebccd1}.embed-responsive{position:relative;display:block;height:0;padding:0;overflow:hidden}.embed-responsive .embed-responsive-item,.embed-responsive iframe,.embed-responsive embed,.embed-responsive object,.embed-responsive video{position:absolute;top:0;bottom:0;left:0;width:100%;height:100%;border:0}.embed-responsive-16by9{padding-bottom:56.25%}.embed-responsive-4by3{padding-bottom:75%}.well{min-height:20px;padding:19px;margin-bottom:20px;background-color:#f5f5f5;border:1px solid #e3e3e3;border-radius:4px;-webkit-box-shadow:inset 0 1px 1px rgba(0,0,0,0.05);box-shadow:inset 0 1px 1px rgba(0,0,0,0.05)}.well blockquote{border-color:#ddd;border-color:rgba(0,0,0,0.15)}.well-lg{padding:24px;border-radius:6px}.well-sm{padding:9px;border-radius:3px}.close{float:right;font-size:21px;font-weight:bold;line-height:1;color:#000;text-shadow:0 1px 0 #fff;filter:alpha(opacity=20);opacity:.2}.close:hover,.close:focus{color:#000;text-decoration:none;cursor:pointer;filter:alpha(opacity=50);opacity:.5}button.close{padding:0;cursor:pointer;background:transparent;border:0;-webkit-appearance:none;appearance:none}.modal-open{overflow:hidden}.modal{position:fixed;top:0;right:0;bottom:0;left:0;z-index:1050;display:none;overflow:hidden;-webkit-overflow-scrolling:touch;outline:0}.modal.fade .modal-dialog{-webkit-transform:translate(0, -25%);-ms-transform:translate(0, -25%);-o-transform:translate(0, -25%);transform:translate(0, -25%);-webkit-transition:-webkit-transform 0.3s ease-out;-moz-transition:-moz-transform 0.3s ease-out;-o-transition:-o-transform 0.3s ease-out;transition:transform 0.3s ease-out}.modal.in .modal-dialog{-webkit-transform:translate(0, 0);-ms-transform:translate(0, 0);-o-transform:translate(0, 0);transform:translate(0, 0)}.modal-open .modal{overflow-x:hidden;overflow-y:auto}.modal-dialog{position:relative;width:auto;margin:10px}.modal-content{position:relative;background-color:#fff;background-clip:padding-box;border:1px solid #999;border:1px solid rgba(0,0,0,0.2);border-radius:6px;-webkit-box-shadow:0 3px 9px rgba(0,0,0,0.5);box-shadow:0 3px 9px rgba(0,0,0,0.5);outline:0}.modal-backdrop{position:fixed;top:0;right:0;bottom:0;left:0;z-index:1040;background-color:#000}.modal-backdrop.fade{filter:alpha(opacity=0);opacity:0}.modal-backdrop.in{filter:alpha(opacity=50);opacity:.5}.modal-header{padding:15px;border-bottom:1px solid #e5e5e5}.modal-header .close{margin-top:-2px}.modal-title{margin:0;line-height:1.42857143}.modal-body{position:relative;padding:15px}.modal-footer{padding:15px;text-align:right;border-top:1px solid #e5e5e5}.modal-footer .btn+.btn{margin-bottom:0;margin-left:5px}.modal-footer .btn-group .btn+.btn{margin-left:-1px}.modal-footer .btn-block+.btn-block{margin-left:0}.modal-scrollbar-measure{position:absolute;top:-9999px;width:50px;height:50px;overflow:scroll}@media (min-width:768px){.modal-dialog{width:600px;margin:30px auto}.modal-content{-webkit-box-shadow:0 5px 15px rgba(0,0,0,0.5);box-shadow:0 5px 15px rgba(0,0,0,0.5)}.modal-sm{width:300px}}@media (min-width:992px){.modal-lg{width:900px}}.tooltip{position:absolute;z-index:1070;display:block;font-family:"Helvetica Neue",Helvetica,Arial,sans-serif;font-style:normal;font-weight:400;line-height:1.42857143;line-break:auto;text-align:left;text-align:start;text-decoration:none;text-shadow:none;text-transform:none;letter-spacing:normal;word-break:normal;word-spacing:normal;word-wrap:normal;white-space:normal;font-size:12px;filter:alpha(opacity=0);opacity:0}.tooltip.in{filter:alpha(opacity=90);opacity:.9}.tooltip.top{padding:5px 0;margin-top:-3px}.tooltip.right{padding:0 5px;margin-left:3px}.tooltip.bottom{padding:5px 0;margin-top:3px}.tooltip.left{padding:0 5px;margin-left:-3px}.tooltip.top .tooltip-arrow{bottom:0;left:50%;margin-left:-5px;border-width:5px 5px 0;border-top-color:#000}.tooltip.top-left .tooltip-arrow{right:5px;bottom:0;margin-bottom:-5px;border-width:5px 5px 0;border-top-color:#000}.tooltip.top-right .tooltip-arrow{bottom:0;left:5px;margin-bottom:-5px;border-width:5px 5px 0;border-top-color:#000}.tooltip.right .tooltip-arrow{top:50%;left:0;margin-top:-5px;border-width:5px 5px 5px 0;border-right-color:#000}.tooltip.left .tooltip-arrow{top:50%;right:0;margin-top:-5px;border-width:5px 0 5px 5px;border-left-color:#000}.tooltip.bottom .tooltip-arrow{top:0;left:50%;margin-left:-5px;border-width:0 5px 5px;border-bottom-color:#000}.tooltip.bottom-left .tooltip-arrow{top:0;right:5px;margin-top:-5px;border-width:0 5px 5px;border-bottom-color:#000}.tooltip.bottom-right .tooltip-arrow{top:0;left:5px;margin-top:-5px;border-width:0 5px 5px;border-bottom-color:#000}.tooltip-inner{max-width:200px;padding:3px 8px;color:#fff;text-align:center;background-color:#000;border-radius:4px}.tooltip-arrow{position:absolute;width:0;height:0;border-color:transparent;border-style:solid}.popover{position:absolute;top:0;left:0;z-index:1060;display:none;max-width:276px;padding:1px;font-family:"Helvetica Neue",Helvetica,Arial,sans-serif;font-style:normal;font-weight:400;line-height:1.42857143;line-break:auto;text-align:left;text-align:start;text-decoration:none;text-shadow:none;text-transform:none;letter-spacing:normal;word-break:normal;word-spacing:normal;word-wrap:normal;white-space:normal;font-size:14px;background-color:#fff;background-clip:padding-box;border:1px solid #ccc;border:1px solid rgba(0,0,0,0.2);border-radius:6px;-webkit-box-shadow:0 5px 10px rgba(0,0,0,0.2);box-shadow:0 5px 10px rgba(0,0,0,0.2)}.popover.top{margin-top:-10px}.popover.right{margin-left:10px}.popover.bottom{margin-top:10px}.popover.left{margin-left:-10px}.popover>.arrow{border-width:11px}.popover>.arrow,.popover>.arrow:after{position:absolute;display:block;width:0;height:0;border-color:transparent;border-style:solid}.popover>.arrow:after{content:"";border-width:10px}.popover.top>.arrow{bottom:-11px;left:50%;margin-left:-11px;border-top-color:#999;border-top-color:rgba(0,0,0,0.25);border-bottom-width:0}.popover.top>.arrow:after{bottom:1px;margin-left:-10px;content:" ";border-top-color:#fff;border-bottom-width:0}.popover.right>.arrow{top:50%;left:-11px;margin-top:-11px;border-right-color:#999;border-right-color:rgba(0,0,0,0.25);border-left-width:0}.popover.right>.arrow:after{bottom:-10px;left:1px;content:" ";border-right-color:#fff;border-left-width:0}.popover.bottom>.arrow{top:-11px;left:50%;margin-left:-11px;border-top-width:0;border-bottom-color:#999;border-bottom-color:rgba(0,0,0,0.25)}.popover.bottom>.arrow:after{top:1px;margin-left:-10px;content:" ";border-top-width:0;border-bottom-color:#fff}.popover.left>.arrow{top:50%;right:-11px;margin-top:-11px;border-right-width:0;border-left-color:#999;border-left-color:rgba(0,0,0,0.25)}.popover.left>.arrow:after{right:1px;bottom:-10px;content:" ";border-right-width:0;border-left-color:#fff}.popover-title{padding:8px 14px;margin:0;font-size:14px;background-color:#f7f7f7;border-bottom:1px solid #ebebeb;border-radius:5px 5px 0 0}.popover-content{padding:9px 14px}.carousel{position:relative}.carousel-inner{position:relative;width:100%;overflow:hidden}.carousel-inner>.item{position:relative;display:none;-webkit-transition:.6s ease-in-out left;-o-transition:.6s ease-in-out left;transition:.6s ease-in-out left}.carousel-inner>.item>img,.carousel-inner>.item>a>img{line-height:1}@media all and (transform-3d),(-webkit-transform-3d){.carousel-inner>.item{-webkit-transition:-webkit-transform 0.6s ease-in-out;-moz-transition:-moz-transform 0.6s ease-in-out;-o-transition:-o-transform 0.6s ease-in-out;transition:transform 0.6s ease-in-out;-webkit-backface-visibility:hidden;-moz-backface-visibility:hidden;backface-visibility:hidden;-webkit-perspective:1000px;-moz-perspective:1000px;perspective:1000px}.carousel-inner>.item.next,.carousel-inner>.item.active.right{-webkit-transform:translate3d(100%, 0, 0);transform:translate3d(100%, 0, 0);left:0}.carousel-inner>.item.prev,.carousel-inner>.item.active.left{-webkit-transform:translate3d(-100%, 0, 0);transform:translate3d(-100%, 0, 0);left:0}.carousel-inner>.item.next.left,.carousel-inner>.item.prev.right,.carousel-inner>.item.active{-webkit-transform:translate3d(0, 0, 0);transform:translate3d(0, 0, 0);left:0}}.carousel-inner>.active,.carousel-inner>.next,.carousel-inner>.prev{display:block}.carousel-inner>.active{left:0}.carousel-inner>.next,.carousel-inner>.prev{position:absolute;top:0;width:100%}.carousel-inner>.next{left:100%}.carousel-inner>.prev{left:-100%}.carousel-inner>.next.left,.carousel-inner>.prev.right{left:0}.carousel-inner>.active.left{left:-100%}.carousel-inner>.active.right{left:100%}.carousel-control{position:absolute;top:0;bottom:0;left:0;width:15%;font-size:20px;color:#fff;text-align:center;text-shadow:0 1px 2px rgba(0,0,0,0.6);background-color:rgba(0,0,0,0);filter:alpha(opacity=50);opacity:.5}.carousel-control.left{background-image:-webkit-linear-gradient(left, rgba(0,0,0,0.5) 0%, rgba(0,0,0,0.0001) 100%);background-image:-o-linear-gradient(left, rgba(0,0,0,0.5) 0%, rgba(0,0,0,0.0001) 100%);background-image:linear-gradient(to right, rgba(0,0,0,0.5) 0%, rgba(0,0,0,0.0001) 100%);filter:progid:DXImageTransform.Microsoft.gradient(startColorstr='#80000000', endColorstr='#00000000', GradientType=1);background-repeat:repeat-x}.carousel-control.right{right:0;left:auto;background-image:-webkit-linear-gradient(left, rgba(0,0,0,0.0001) 0%, rgba(0,0,0,0.5) 100%);background-image:-o-linear-gradient(left, rgba(0,0,0,0.0001) 0%, rgba(0,0,0,0.5) 100%);background-image:linear-gradient(to right, rgba(0,0,0,0.0001) 0%, rgba(0,0,0,0.5) 100%);filter:progid:DXImageTransform.Microsoft.gradient(startColorstr='#00000000', endColorstr='#80000000', GradientType=1);background-repeat:repeat-x}.carousel-control:hover,.carousel-control:focus{color:#fff;text-decoration:none;outline:0;filter:alpha(opacity=90);opacity:.9}.carousel-control .icon-prev,.carousel-control .icon-next,.carousel-control .glyphicon-chevron-left,.carousel-control .glyphicon-chevron-right{position:absolute;top:50%;z-index:5;display:inline-block;margin-top:-10px}.carousel-control .icon-prev,.carousel-control .glyphicon-chevron-left{left:50%;margin-left:-10px}.carousel-control .icon-next,.carousel-control .glyphicon-chevron-right{right:50%;margin-right:-10px}.carousel-control .icon-prev,.carousel-control .icon-next{width:20px;height:20px;font-family:serif;line-height:1}.carousel-control .icon-prev:before{content:"\2039"}.carousel-control .icon-next:before{content:"\203a"}.carousel-indicators{position:absolute;bottom:10px;left:50%;z-index:15;width:60%;padding-left:0;margin-left:-30%;text-align:center;list-style:none}.carousel-indicators li{display:inline-block;width:10px;height:10px;margin:1px;text-indent:-999px;cursor:pointer;background-color:#000 \9;background-color:rgba(0,0,0,0);border:1px solid #fff;border-radius:10px}.carousel-indicators .active{width:12px;height:12px;margin:0;background-color:#fff}.carousel-caption{position:absolute;right:15%;bottom:20px;left:15%;z-index:10;padding-top:20px;padding-bottom:20px;color:#fff;text-align:center;text-shadow:0 1px 2px rgba(0,0,0,0.6)}.carousel-caption .btn{text-shadow:none}@media screen and (min-width:768px){.carousel-control .glyphicon-chevron-left,.carousel-control .glyphicon-chevron-right,.carousel-control .icon-prev,.carousel-control .icon-next{width:30px;height:30px;margin-top:-10px;font-size:30px}.carousel-control .glyphicon-chevron-left,.carousel-control .icon-prev{margin-left:-10px}.carousel-control .glyphicon-chevron-right,.carousel-control .icon-next{margin-right:-10px}.carousel-caption{right:20%;left:20%;padding-bottom:30px}.carousel-indicators{bottom:20px}}.clearfix:before,.clearfix:after,.dl-horizontal dd:before,.dl-horizontal dd:after,.container:before,.container:after,.container-fluid:before,.container-fluid:after,.row:before,.row:after,.form-horizontal .form-group:before,.form-horizontal .form-group:after,.btn-toolbar:before,.btn-toolbar:after,.btn-group-vertical>.btn-group:before,.btn-group-vertical>.btn-group:after,.nav:before,.nav:after,.navbar:before,.navbar:after,.navbar-header:before,.navbar-header:after,.navbar-collapse:before,.navbar-collapse:after,.pager:before,.pager:after,.panel-body:before,.panel-body:after,.modal-header:before,.modal-header:after,.modal-footer:before,.modal-footer:after{display:table;content:" "}.clearfix:after,.dl-horizontal dd:after,.container:after,.container-fluid:after,.row:after,.form-horizontal .form-group:after,.btn-toolbar:after,.btn-group-vertical>.btn-group:after,.nav:after,.navbar:after,.navbar-header:after,.navbar-collapse:after,.pager:after,.panel-body:after,.modal-header:after,.modal-footer:after{clear:both}.center-block{display:block;margin-right:auto;margin-left:auto}.pull-right{float:right !important}.pull-left{float:left !important}.hide{display:none !important}.show{display:block !important}.invisible{visibility:hidden}.text-hide{font:0/0 a;color:transparent;text-shadow:none;background-color:transparent;border:0}.hidden{display:none !important}.affix{position:fixed}@-ms-viewport{width:device-width}.visible-xs,.visible-sm,.visible-md,.visible-lg{display:none !important}.visible-xs-block,.visible-xs-inline,.visible-xs-inline-block,.visible-sm-block,.visible-sm-inline,.visible-sm-inline-block,.visible-md-block,.visible-md-inline,.visible-md-inline-block,.visible-lg-block,.visible-lg-inline,.visible-lg-inline-block{display:none !important}@media (max-width:767px){.visible-xs{display:block !important}table.visible-xs{display:table !important}tr.visible-xs{display:table-row !important}th.visible-xs,td.visible-xs{display:table-cell !important}}@media (max-width:767px){.visible-xs-block{display:block !important}}@media (max-width:767px){.visible-xs-inline{display:inline !important}}@media (max-width:767px){.visible-xs-inline-block{display:inline-block !important}}@media (min-width:768px) and (max-width:991px){.visible-sm{display:block !important}table.visible-sm{display:table !important}tr.visible-sm{display:table-row !important}th.visible-sm,td.visible-sm{display:table-cell !important}}@media (min-width:768px) and (max-width:991px){.visible-sm-block{display:block !important}}@media (min-width:768px) and (max-width:991px){.visible-sm-inline{display:inline !important}}@media (min-width:768px) and (max-width:991px){.visible-sm-inline-block{display:inline-block !important}}@media (min-width:992px) and (max-width:1199px){.visible-md{display:block !important}table.visible-md{display:table !important}tr.visible-md{display:table-row !important}th.visible-md,td.visible-md{display:table-cell !important}}@media (min-width:992px) and (max-width:1199px){.visible-md-block{display:block !important}}@media (min-width:992px) and (max-width:1199px){.visible-md-inline{display:inline !important}}@media (min-width:992px) and (max-width:1199px){.visible-md-inline-block{display:inline-block !important}}@media (min-width:1200px){.visible-lg{display:block !important}table.visible-lg{display:table !important}tr.visible-lg{display:table-row !important}th.visible-lg,td.visible-lg{display:table-cell !important}}@media (min-width:1200px){.visible-lg-block{display:block !important}}@media (min-width:1200px){.visible-lg-inline{display:inline !important}}@media (min-width:1200px){.visible-lg-inline-block{display:inline-block !important}}@media (max-width:767px){.hidden-xs{display:none !important}}@media (min-width:768px) and (max-width:991px){.hidden-sm{display:none !important}}@media (min-width:992px) and (max-width:1199px){.hidden-md{display:none !important}}@media (min-width:1200px){.hidden-lg{display:none !important}}.visible-print{display:none !important}@media print{.visible-print{display:block !important}table.visible-print{display:table !important}tr.visible-print{display:table-row !important}th.visible-print,td.visible-print{display:table-cell !important}}.visible-print-block{display:none !important}@media print{.visible-print-block{display:block !important}}.visible-print-inline{display:none !important}@media print{.visible-print-inline{display:inline !important}}.visible-print-inline-block{display:none !important}@media print{.visible-print-inline-block{display:inline-block !important}}@media print{.hidden-print{display:none !important}}/*

Original highlight.js style (c) Ivan Sagalaev <maniac@softwaremaniacs.org>

*/

.hljs {
  display: block;
  overflow-x: auto;
  padding: 0.5em;
  background: #F0F0F0;
}


/* Base color: saturation 0; */

.hljs,
.hljs-subst {
  color: #444;
}

.hljs-comment {
  color: #888888;
}

.hljs-keyword,
.hljs-attribute,
.hljs-selector-tag,
.hljs-meta-keyword,
.hljs-doctag,
.hljs-name {
  font-weight: bold;
}


/* User color: hue: 0 */

.hljs-type,
.hljs-string,
.hljs-number,
.hljs-selector-id,
.hljs-selector-class,
.hljs-quote,
.hljs-template-tag,
.hljs-deletion {
  color: #880000;
}

.hljs-title,
.hljs-section {
  color: #880000;
  font-weight: bold;
}

.hljs-regexp,
.hljs-symbol,
.hljs-variable,
.hljs-template-variable,
.hljs-link,
.hljs-selector-attr,
.hljs-selector-pseudo {
  color: #BC6060;
}


/* Language color: hue: 90; */

.hljs-literal {
  color: #78A960;
}

.hljs-built_in,
.hljs-bullet,
.hljs-code,
.hljs-addition {
  color: #397300;
}


/* Meta color: hue: 200 */

.hljs-meta {
  color: #1f7199;
}

.hljs-meta-string {
  color: #4d99bf;
}


/* Misc effects */

.hljs-emphasis {
  font-style: italic;
}

.hljs-strong {
  font-weight: bold;
}
.panel-definition{border-color:#a2a2a2}.panel-definition>.panel-heading{color:#000;background-color:#eee;border-color:#a2a2a2}.panel-definition>.panel-heading+.panel-collapse>.panel-body{border-top-color:#a2a2a2}.panel-definition>.panel-heading .badge{color:#eee;background-color:#000}.panel-definition>.panel-footer+.panel-collapse>.panel-body{border-bottom-color:#a2a2a2}.json-schema-description:before{font-weight:bold;color:#555;text-transform:uppercase;content:"Description";padding-bottom:.5em;display:block}.json-schema-description:not(:last-child){padding-bottom:1.5em}.json-schema-properties:before{font-weight:bold;color:#555;text-transform:uppercase;content:"Properties";padding-bottom:.5em;display:block}.json-schema-properties:not(:last-child){padding-bottom:1.5em}.json-schema-properties dd:not(:last-child){padding-bottom:1em}.json-schema-properties dl{margin:0}.json-schema-example:before{font-weight:bold;color:#555;text-transform:uppercase;content:"Example";padding-bottom:.5em;display:block}.json-schema-example:not(:last-child){padding-bottom:1.5em}.json-schema-array-items:before{font-weight:bold;color:#555;text-transform:uppercase;content:"Items";padding-bottom:.5em;display:block}.json-schema-array-items:not(:last-child){padding-bottom:1.5em}.json-schema-allOf-inherited:before{font-weight:bold;color:#555;text-transform:uppercase;content:"Inherited";padding-bottom:.5em;display:block}.json-schema-allOf-inherited:not(:last-child){padding-bottom:1.5em}.json-schema-allOf-inherited ul{padding-left:0;list-style:none}.json-schema-anyOf>dl{border-left:2px solid #a2a2a2;padding-left:1em}.json-schema-anyOf>dl dt:not(:first-child):before{content:"or "}.json-schema-anyOf>dl dt:first-child:before{content:"either "}.json-schema-additionalProperties:before{font-weight:bold;color:#555;text-transform:uppercase;content:"Additional properties";padding-bottom:.5em;display:block}.json-schema-additionalProperties:not(:last-child){padding-bottom:1.5em}.json-inner-schema .json-schema-properties,.json-inner-schema .json-schema-array-items,.json-inner-schema .json-schema-description,.json-inner-schema .json-schema-example{padding-left:1em;margin-top:.5em;padding-bottom:.5em;border-left:2px solid #a2a2a2}.json-property-discriminator:before{display:inline;padding:.2em .6em .3em;font-size:75%;font-weight:700;line-height:1;color:#fff;text-align:center;white-space:nowrap;vertical-align:baseline;border-radius:.25em;background-color:#777;content:"discriminator"}a.json-property-discriminator:before:hover,a.json-property-discriminator:before:focus{color:#fff;text-decoration:none;cursor:pointer}.json-property-discriminator:before:empty{display:none}.btn .json-property-discriminator:before{position:relative;top:-1px}.json-property-discriminator:before[href]:hover,.json-property-discriminator:before[href]:focus{background-color:#5e5e5e}.json-property-required:before{display:inline;padding:.2em .6em .3em;font-size:75%;font-weight:700;line-height:1;color:#fff;text-align:center;white-space:nowrap;vertical-align:baseline;border-radius:.25em;background-color:#777;content:"required"}a.json-property-required:before:hover,a.json-property-required:before:focus{color:#fff;text-decoration:none;cursor:pointer}.json-property-required:before:empty{display:none}.btn .json-property-required:before{position:relative;top:-1px}.json-property-required:before[href]:hover,.json-property-required:before[href]:focus{background-color:#5e5e5e}.json-property-read-only:before{display:inline;padding:.2em .6em .3em;font-size:75%;font-weight:700;line-height:1;color:#fff;text-align:center;white-space:nowrap;vertical-align:baseline;border-radius:.25em;background-color:#777;content:"read only"}a.json-property-read-only:before:hover,a.json-property-read-only:before:focus{color:#fff;text-decoration:none;cursor:pointer}.json-property-read-only:before:empty{display:none}.btn .json-property-read-only:before{position:relative;top:-1px}.json-property-read-only:before[href]:hover,.json-property-read-only:before[href]:focus{background-color:#5e5e5e}.json-property-pattern{font-weight:lighter;font-size:small}.json-schema--regex:before,.json-schema--regex:after{color:#808080;content:'/'}.json-property-type{font-style:italic;font-weight:100}.json-property-format{font-size:smaller}.json-property-enum{font-weight:lighter;font-size:small}.json-property-default-value{font-weight:lighter;font-size:small}.json-property-default-value:before{content:'(default: "'}.json-property-default-value:after{content:'")'}.json-property-enum-item{font-weight:lighter;font-size:small}.json-property-enum-item:before,.json-property-enum-item:after{content:"\""}.json-schema--reference{font-size:90%}.table.swagger--summary>tbody>tr>td.swagger--summary-path{vertical-align:middle}.table.swagger--summary>tbody>tr>td p{margin:0}.swagger--panel-operation-post{border-color:#78cc94}.swagger--panel-operation-post>.panel-heading{color:#333;background-color:#e7f6ec;border-color:#78cc94}.swagger--panel-operation-post>.panel-heading+.panel-collapse>.panel-body{border-top-color:#78cc94}.swagger--panel-operation-post>.panel-heading .badge{color:#e7f6ec;background-color:#333}.swagger--panel-operation-post>.panel-footer+.panel-collapse>.panel-body{border-bottom-color:#78cc94}.swagger--panel-operation-post .operation-name{font-weight:bold}.swagger--panel-operation-post .operation-summary{float:right !important}.swagger--panel-operation-get{border-color:#74a8d1}.swagger--panel-operation-get>.panel-heading{color:#333;background-color:#e7f0f7;border-color:#74a8d1}.swagger--panel-operation-get>.panel-heading+.panel-collapse>.panel-body{border-top-color:#74a8d1}.swagger--panel-operation-get>.panel-heading .badge{color:#e7f0f7;background-color:#333}.swagger--panel-operation-get>.panel-footer+.panel-collapse>.panel-body{border-bottom-color:#74a8d1}.swagger--panel-operation-get .operation-name{font-weight:bold}.swagger--panel-operation-get .operation-summary{float:right !important}.swagger--panel-operation-put{border-color:#d8ab71}.swagger--panel-operation-put>.panel-heading{color:#333;background-color:#f9f2e9;border-color:#d8ab71}.swagger--panel-operation-put>.panel-heading+.panel-collapse>.panel-body{border-top-color:#d8ab71}.swagger--panel-operation-put>.panel-heading .badge{color:#f9f2e9;background-color:#333}.swagger--panel-operation-put>.panel-footer+.panel-collapse>.panel-body{border-bottom-color:#d8ab71}.swagger--panel-operation-put .operation-name{font-weight:bold}.swagger--panel-operation-put .operation-summary{float:right !important}.swagger--panel-operation-patch{border-color:#ed7c59}.swagger--panel-operation-patch>.panel-heading{color:#333;background-color:#FCE9E3;border-color:#ed7c59}.swagger--panel-operation-patch>.panel-heading+.panel-collapse>.panel-body{border-top-color:#ed7c59}.swagger--panel-operation-patch>.panel-heading .badge{color:#FCE9E3;background-color:#333}.swagger--panel-operation-patch>.panel-footer+.panel-collapse>.panel-body{border-bottom-color:#ed7c59}.swagger--panel-operation-patch .operation-name{font-weight:bold}.swagger--panel-operation-patch .operation-summary{float:right !important}.swagger--panel-operation-options{border-color:#74a8d1}.swagger--panel-operation-options>.panel-heading{color:#333;background-color:#e7f0f7;border-color:#74a8d1}.swagger--panel-operation-options>.panel-heading+.panel-collapse>.panel-body{border-top-color:#74a8d1}.swagger--panel-operation-options>.panel-heading .badge{color:#e7f0f7;background-color:#333}.swagger--panel-operation-options>.panel-footer+.panel-collapse>.panel-body{border-bottom-color:#74a8d1}.swagger--panel-operation-options .operation-name{font-weight:bold}.swagger--panel-operation-options .operation-summary{float:right !important}.swagger--panel-operation-delete{border-color:#c77d7d}.swagger--panel-operation-delete>.panel-heading{color:#333;background-color:#f5e8e8;border-color:#c77d7d}.swagger--panel-operation-delete>.panel-heading+.panel-collapse>.panel-body{border-top-color:#c77d7d}.swagger--panel-operation-delete>.panel-heading .badge{color:#f5e8e8;background-color:#333}.swagger--panel-operation-delete>.panel-footer+.panel-collapse>.panel-body{border-bottom-color:#c77d7d}.swagger--panel-operation-delete .operation-name{font-weight:bold}.swagger--panel-operation-delete .operation-summary{float:right !important}.swagger--panel-operation-head{border-color:#f3ff34}.swagger--panel-operation-head>.panel-heading{color:#333;background-color:#fcffcd;border-color:#f3ff34}.swagger--panel-operation-head>.panel-heading+.panel-collapse>.panel-body{border-top-color:#f3ff34}.swagger--panel-operation-head>.panel-heading .badge{color:#fcffcd;background-color:#333}.swagger--panel-operation-head>.panel-footer+.panel-collapse>.panel-body{border-bottom-color:#f3ff34}.swagger--panel-operation-head .operation-name{font-weight:bold}.swagger--panel-operation-head .operation-summary{float:right !important}.sw-operation-description:before{font-weight:bold;color:#555;text-transform:uppercase;content:"Description";padding-bottom:.5em;display:block}.sw-operation-description:not(:last-child){padding-bottom:1.5em}.sw-request-params:before{font-weight:bold;color:#555;text-transform:uppercase;content:"Request parameters";padding-bottom:.5em;display:block}.sw-request-params:not(:last-child){padding-bottom:1.5em}.sw-request-body:before{font-weight:bold;color:#555;text-transform:uppercase;content:"Request body";padding-bottom:.5em;display:block}.sw-request-body:not(:last-child){padding-bottom:1.5em}.sw-responses:before{font-weight:bold;color:#555;text-transform:uppercase;content:"Responses";padding-bottom:.5em;display:block}.sw-responses:not(:last-child){padding-bottom:1.5em}.swagger--global:before{display:inline;padding:.2em .6em .3em;font-size:75%;font-weight:700;line-height:1;color:#fff;text-align:center;white-space:nowrap;vertical-align:baseline;border-radius:.25em;background-color:#777;content:'global'}a.swagger--global:before:hover,a.swagger--global:before:focus{color:#fff;text-decoration:none;cursor:pointer}.swagger--global:before:empty{display:none}.btn .swagger--global:before{position:relative;top:-1px}.swagger--global:before[href]:hover,.swagger--global:before[href]:focus{background-color:#5e5e5e}table.table th.sw-param-key{width:auto}table.table th.sw-param-key:before{content:"Key"}table.table th.sw-param-name{width:auto}table.table th.sw-param-name:before{content:"Name"}table.table th.sw-param-description{width:auto}table.table th.sw-param-description:before{content:"Description"}table.table th.sw-param-data-type{width:auto}table.table th.sw-param-data-type:before{content:"Data type"}table.table th.sw-param-type{width:auto}table.table th.sw-param-type:before{content:"Type"}table.table th.sw-request-security-schema{width:auto}table.table th.sw-request-security-schema:before{content:"Schema"}table.table th.sw-request-security-scopes{width:auto}table.table th.sw-request-security-scopes:before{content:"Scopes"}table.table th.sw-response-header-name{width:auto}table.table th.sw-response-header-name:before{content:"Header"}table.table th.sw-response-header-description{width:auto}table.table th.sw-response-header-description:before{content:"Description"}table.table th.sw-response-header-data-type{width:auto}table.table th.sw-response-header-data-type:before{content:"Data type"}.sw-response-name-value{font-weight:bold}.sw-response-description-text{padding-bottom:.5em}code.highlight{padding:0}.panel-security-definition{border-color:#a2a2a2}.panel-security-definition>.panel-heading{color:#000;background-color:#eee;border-color:#a2a2a2}.panel-security-definition>.panel-heading+.panel-collapse>.panel-body{border-top-color:#a2a2a2}.panel-security-definition>.panel-heading .badge{color:#eee;background-color:#000}.panel-security-definition>.panel-footer+.panel-collapse>.panel-body{border-bottom-color:#a2a2a2}.sw-request-security:before{font-weight:bold;color:#555;text-transform:uppercase;content:"Security";padding-bottom:.5em;display:block}.sw-request-security:not(:last-child){padding-bottom:1.5em}.sw-security-definition-basic:before{color:#555;font-size:smaller;content:"(HTTP Basic Authentication)"}span.sw-default-value-header{font-weight:bold}.sw-info{font-weight:bold}.sw-info span{font-family:monospace;font-weight:normal;font-size:1.1em}/*# sourceMappingURL=main.css.map */</style>
    <meta charset="UTF-8">
    <title>Kubeflow Pipelines API</title>
                                                         </head>
<body>
<div class="container">
    <h1>Kubeflow Pipelines API</h1>
    <p class="sw-info">
        
        Version: <span class="sw-info-version">2.0.0-alpha.1</span>
    </p>
    <p><p>This file contains REST API specification for Kubeflow Pipelines. The file is autogenerated from the swagger definition.</p>
    </p>
    
        <div id="sw-default-consumes" class="sw-default-value">
            <span class="sw-default-value-header">Default request content-types:</span>
            application/json
        </div>
        <div id="sw-default-produces" class="sw-default-value">
            <span class="sw-default-value-header">Default response content-types:</span>
            application/json
        </div>
    
    <div id="sw-schemes" class="sw-default-value">
        <span class="sw-default-value-header">Schemes:</span>
        http, https
    </div>
    
        
        <h2 id="swagger--summary-tags">Summary</h2>
            <h3 id="tag-RunService" class="swagger-summary-tag">Tag: RunService</h3>
            
            <p class="sw-tag-external-doc">
            </p>
            <table class="table table-bordered table-condensed swagger--summary">
                <thead>
                <tr>
                    <th>Operation</th>
                    <th>Description</th>
                </tr>
                </thead>
                <tbody>
                    <tr>
                        <td><a href="#operation--apis-v1beta1-runs-get">GET /apis/v1beta1/runs</a></td>
                        <td><p>Finds all runs.</p>
        </td>
                    </tr>
                    <tr>
                        <td><a href="#operation--apis-v1beta1-runs-post">POST /apis/v1beta1/runs</a></td>
                        <td><p>Creates a new run.</p>
        </td>
                    </tr>
                    <tr>
                        <td><a href="#operation--apis-v1beta1-runs--id--delete">DELETE /apis/v1beta1/runs/{id}</a></td>
                        <td><p>Deletes a run.</p>
        </td>
                    </tr>
                    <tr>
                        <td><a href="#operation--apis-v1beta1-runs--id-:archive-post">POST /apis/v1beta1/runs/{id}:archive</a></td>
                        <td><p>Archives a run.</p>
        </td>
                    </tr>
                    <tr>
                        <td><a href="#operation--apis-v1beta1-runs--id-:unarchive-post">POST /apis/v1beta1/runs/{id}:unarchive</a></td>
                        <td><p>Restores an archived run.</p>
        </td>
                    </tr>
                    <tr>
                        <td><a href="#operation--apis-v1beta1-runs--run_id--get">GET /apis/v1beta1/runs/{run_id}</a></td>
                        <td><p>Finds a specific run by ID.</p>
        </td>
                    </tr>
                    <tr>
                        <td><a href="#operation--apis-v1beta1-runs--run_id--nodes--node_id--artifacts--artifact_name-:read-get">GET /apis/v1beta1/runs/{run_id}/nodes/{node_id}/artifacts/{artifact_name}:read</a></td>
                        <td><p>Finds a run&#39;s artifact data.</p>
        </td>
                    </tr>
                    <tr>
                        <td><a href="#operation--apis-v1beta1-runs--run_id--retry-post">POST /apis/v1beta1/runs/{run_id}/retry</a></td>
                        <td><p>Re-initiates a failed or terminated run.</p>
        </td>
                    </tr>
                    <tr>
                        <td><a href="#operation--apis-v1beta1-runs--run_id--terminate-post">POST /apis/v1beta1/runs/{run_id}/terminate</a></td>
                        <td><p>Terminates an active run.</p>
        </td>
                    </tr>
                    <tr>
                        <td><a href="#operation--apis-v1beta1-runs--run_id-:reportMetrics-post">POST /apis/v1beta1/runs/{run_id}:reportMetrics</a></td>
                        <td><p>ReportRunMetrics reports metrics of a run. Each metric is reported in its
        own transaction, so this API accepts partial failures. Metric can be
        uniquely identified by (run_id, node_id, name). Duplicate reporting will be
        ignored by the API. First reporting wins.</p>
        </td>
                    </tr>
                </tbody>
            </table>
            <h3 id="tag-JobService" class="swagger-summary-tag">Tag: JobService</h3>
            
            <p class="sw-tag-external-doc">
            </p>
            <table class="table table-bordered table-condensed swagger--summary">
                <thead>
                <tr>
                    <th>Operation</th>
                    <th>Description</th>
                </tr>
                </thead>
                <tbody>
                    <tr>
                        <td><a href="#operation--apis-v1beta1-jobs-get">GET /apis/v1beta1/jobs</a></td>
                        <td><p>Finds all jobs.</p>
        </td>
                    </tr>
                    <tr>
                        <td><a href="#operation--apis-v1beta1-jobs-post">POST /apis/v1beta1/jobs</a></td>
                        <td><p>Creates a new job.</p>
        </td>
                    </tr>
                    <tr>
                        <td><a href="#operation--apis-v1beta1-jobs--id--get">GET /apis/v1beta1/jobs/{id}</a></td>
                        <td><p>Finds a specific job by ID.</p>
        </td>
                    </tr>
                    <tr>
                        <td><a href="#operation--apis-v1beta1-jobs--id--delete">DELETE /apis/v1beta1/jobs/{id}</a></td>
                        <td><p>Deletes a job.</p>
        </td>
                    </tr>
                    <tr>
                        <td><a href="#operation--apis-v1beta1-jobs--id--disable-post">POST /apis/v1beta1/jobs/{id}/disable</a></td>
                        <td><p>Stops a job and all its associated runs. The job is not deleted.</p>
        </td>
                    </tr>
                    <tr>
                        <td><a href="#operation--apis-v1beta1-jobs--id--enable-post">POST /apis/v1beta1/jobs/{id}/enable</a></td>
                        <td><p>Restarts a job that was previously stopped. All runs associated with the job will continue.</p>
        </td>
                    </tr>
                </tbody>
            </table>
            <h3 id="tag-ExperimentService" class="swagger-summary-tag">Tag: ExperimentService</h3>
            
            <p class="sw-tag-external-doc">
            </p>
            <table class="table table-bordered table-condensed swagger--summary">
                <thead>
                <tr>
                    <th>Operation</th>
                    <th>Description</th>
                </tr>
                </thead>
                <tbody>
                    <tr>
                        <td><a href="#operation--apis-v1beta1-experiments-get">GET /apis/v1beta1/experiments</a></td>
                        <td><p>Finds all experiments. Supports pagination, and sorting on certain fields.</p>
        </td>
                    </tr>
                    <tr>
                        <td><a href="#operation--apis-v1beta1-experiments-post">POST /apis/v1beta1/experiments</a></td>
                        <td><p>Creates a new experiment.</p>
        </td>
                    </tr>
                    <tr>
                        <td><a href="#operation--apis-v1beta1-experiments--id--get">GET /apis/v1beta1/experiments/{id}</a></td>
                        <td><p>Finds a specific experiment by ID.</p>
        </td>
                    </tr>
                    <tr>
                        <td><a href="#operation--apis-v1beta1-experiments--id--delete">DELETE /apis/v1beta1/experiments/{id}</a></td>
                        <td><p>Deletes an experiment without deleting the experiment&#39;s runs and jobs. To
        avoid unexpected behaviors, delete an experiment&#39;s runs and jobs before
        deleting the experiment.</p>
        </td>
                    </tr>
                    <tr>
                        <td><a href="#operation--apis-v1beta1-experiments--id-:archive-post">POST /apis/v1beta1/experiments/{id}:archive</a></td>
                        <td><p>Archives an experiment and the experiment&#39;s runs and jobs.</p>
        </td>
                    </tr>
                    <tr>
                        <td><a href="#operation--apis-v1beta1-experiments--id-:unarchive-post">POST /apis/v1beta1/experiments/{id}:unarchive</a></td>
                        <td><p>Restores an archived experiment. The experiment&#39;s archived runs and jobs
        will stay archived.</p>
        </td>
                    </tr>
                </tbody>
            </table>
            <h3 id="tag-PipelineService" class="swagger-summary-tag">Tag: PipelineService</h3>
            
            <p class="sw-tag-external-doc">
            </p>
            <table class="table table-bordered table-condensed swagger--summary">
                <thead>
                <tr>
                    <th>Operation</th>
                    <th>Description</th>
                </tr>
                </thead>
                <tbody>
                    <tr>
                        <td><a href="#operation--apis-v1beta1-namespaces--namespace--pipelines--name--get">GET /apis/v1beta1/namespaces/{namespace}/pipelines/{name}</a></td>
                        <td><p>Finds a pipeline by Name (and namespace)</p>
        </td>
                    </tr>
                    <tr>
                        <td><a href="#operation--apis-v1beta1-pipeline_versions-get">GET /apis/v1beta1/pipeline_versions</a></td>
                        <td><p>Lists all pipeline versions of a given pipeline.</p>
        </td>
                    </tr>
                    <tr>
                        <td><a href="#operation--apis-v1beta1-pipeline_versions-post">POST /apis/v1beta1/pipeline_versions</a></td>
                        <td><p>Adds a pipeline version to the specified pipeline.</p>
        </td>
                    </tr>
                    <tr>
                        <td><a href="#operation--apis-v1beta1-pipeline_versions--version_id--get">GET /apis/v1beta1/pipeline_versions/{version_id}</a></td>
                        <td><p>Gets a pipeline version by pipeline version ID.</p>
        </td>
                    </tr>
                    <tr>
                        <td><a href="#operation--apis-v1beta1-pipeline_versions--version_id--delete">DELETE /apis/v1beta1/pipeline_versions/{version_id}</a></td>
                        <td><p>Deletes a pipeline version by pipeline version ID. If the deleted pipeline
        version is the default pipeline version, the pipeline&#39;s default version
        changes to the pipeline&#39;s most recent pipeline version. If there are no
        remaining pipeline versions, the pipeline will have no default version.
        Examines the run_service_api.ipynb notebook to learn more about creating a
        run using a pipeline version (<a href="https://github.com/kubeflow/pipelines/blob/sdk/release-1.8/tools/benchmarks/run_service_api.ipynb">https://github.com/kubeflow/pipelines/blob/sdk/release-1.8/tools/benchmarks/run_service_api.ipynb</a>).</p>
        </td>
                    </tr>
                    <tr>
                        <td><a href="#operation--apis-v1beta1-pipeline_versions--version_id--templates-get">GET /apis/v1beta1/pipeline_versions/{version_id}/templates</a></td>
                        <td><p>Returns a YAML template that contains the specified pipeline version&#39;s description, parameters and metadata.</p>
        </td>
                    </tr>
                    <tr>
                        <td><a href="#operation--apis-v1beta1-pipelines-get">GET /apis/v1beta1/pipelines</a></td>
                        <td><p>Finds all pipelines.</p>
        </td>
                    </tr>
                    <tr>
                        <td><a href="#operation--apis-v1beta1-pipelines-post">POST /apis/v1beta1/pipelines</a></td>
                        <td><p>Creates a pipeline.</p>
        </td>
                    </tr>
                    <tr>
                        <td><a href="#operation--apis-v1beta1-pipelines--id--get">GET /apis/v1beta1/pipelines/{id}</a></td>
                        <td><p>Finds a specific pipeline by ID.</p>
        </td>
                    </tr>
                    <tr>
                        <td><a href="#operation--apis-v1beta1-pipelines--id--delete">DELETE /apis/v1beta1/pipelines/{id}</a></td>
                        <td><p>Deletes a pipeline and its pipeline versions.</p>
        </td>
                    </tr>
                    <tr>
                        <td><a href="#operation--apis-v1beta1-pipelines--id--templates-get">GET /apis/v1beta1/pipelines/{id}/templates</a></td>
                        <td><p>Returns a single YAML template that contains the description, parameters, and metadata associated with the pipeline provided.</p>
        </td>
                    </tr>
                    <tr>
                        <td><a href="#operation--apis-v1beta1-pipelines--pipeline_id--default_version--version_id--post">POST /apis/v1beta1/pipelines/{pipeline_id}/default_version/{version_id}</a></td>
                        <td><p>Update the default pipeline version of a specific pipeline.</p>
        </td>
                    </tr>
                </tbody>
            </table>
            <h3 id="tag-PipelineUploadService" class="swagger-summary-tag">Tag: PipelineUploadService</h3>
            
            <p class="sw-tag-external-doc">
            </p>
            <table class="table table-bordered table-condensed swagger--summary">
                <thead>
                <tr>
                    <th>Operation</th>
                    <th>Description</th>
                </tr>
                </thead>
                <tbody>
                    <tr>
                        <td><a href="#operation--apis-v1beta1-pipelines-upload-post">POST /apis/v1beta1/pipelines/upload</a></td>
                        <td></td>
                    </tr>
                    <tr>
                        <td><a href="#operation--apis-v1beta1-pipelines-upload_version-post">POST /apis/v1beta1/pipelines/upload_version</a></td>
                        <td></td>
                    </tr>
                </tbody>
            </table>
            <h3 id="tag-HealthzService" class="swagger-summary-tag">Tag: HealthzService</h3>
            
            <p class="sw-tag-external-doc">
            </p>
            <table class="table table-bordered table-condensed swagger--summary">
                <thead>
                <tr>
                    <th>Operation</th>
                    <th>Description</th>
                </tr>
                </thead>
                <tbody>
                    <tr>
                        <td><a href="#operation--apis-v1beta1-healthz-get">GET /apis/v1beta1/healthz</a></td>
                        <td><p>Get healthz data.</p>
        </td>
                    </tr>
                </tbody>
            </table>
        
    
    
        <h2>Security</h2>
    
            <div id="security-definition-Bearer" class="panel panel-security-definition panel-security-definition-apiKey">
                <div class="panel-heading">
                    <h3 class="panel-title"><span class="security-name">Bearer</span></h3>
                    Type: apiKey
                </div>
                <div class="panel-body">                
                    <section class="sw-security-properties">
                        <dl>                
                                <dt class="security-property-name">Name:</dt>
                                <dd class="security-property-type">
                                    <div class="row">
                                        <div class="col-md-12"><p>authorization</p></div>
                                    </div>
                                </dd>
                                <dt class="security-property-name">In:</dt>
                                <dd class="security-property-type">
                                    <div class="row">
                                        <div class="col-md-12"><p>header</p></div>
                                    </div>
                                </dd>
                        </dl>
                    </section>                
                </div>
            </div>        
    
    <h2>Paths</h2>
    
        
        <span id="path--apis-v1beta1-experiments"></span>
            <div id="operation--apis-v1beta1-experiments-get" class="swagger--panel-operation-get panel">
                <div class="panel-heading">
                    <div class="operation-summary">Finds all experiments. Supports pagination, and sorting on certain fields.</div>
                    <h3 class="panel-title"><span class="operation-name">GET</span> <strong>/apis/v1beta1/experiments</strong></h3>
                        Tags:
                            <a href="#tag-ExperimentService">ExperimentService</a>
                </div>
                <div class="panel-body">
                    <section class="sw-operation-description">
                        
                    </section>
            
                    
                        <section class="sw-request-params">
                            <table class="table">
                                <thead>
                                <tr>
                                    <th class="sw-param-name"></th>
                                    <th class="sw-param-description"></th>
                                    <th class="sw-param-type"></th>
                                    <th class="sw-param-data-type"></th>
                                    <th class="sw-param-annotation"></th>
                                </tr>
                                </thead>
                                <tbody>
                                        <tr>
                                            <td>
                                                page_token
                                            </td>
                                            <td><p>A page token to request the next page of results. The token is acquried
                                        from the nextPageToken field of the response from the previous
                                        ListExperiment call or can be omitted when fetching the first page.</p>
                                        </td>
                                            <td>query</td>
                                            <td>
                                        <span class="json-property-type">string</span>
                                        <span class="json-property-range" title="Value limits"></span>
                                        
                                            </td>
                                            <td>
                                            </td>
                                        </tr>
                                        <tr>
                                            <td>
                                                page_size
                                            </td>
                                            <td><p>The number of experiments to be listed per page. If there are more
                                        experiments than this number, the response message will contain a
                                        nextPageToken field you can use to fetch the next page.</p>
                                        </td>
                                            <td>query</td>
                                            <td>
                                        <span class="json-property-type">integer</span>    <span class="json-property-format">(int32)</span>
                                        <span class="json-property-range" title="Value limits"></span>
                                        
                                            </td>
                                            <td>
                                            </td>
                                        </tr>
                                        <tr>
                                            <td>
                                                sort_by
                                            </td>
                                            <td><p>Can be format of &quot;field_name&quot;, &quot;field_name asc&quot; or &quot;field_name desc&quot;
                                        Ascending by default.</p>
                                        </td>
                                            <td>query</td>
                                            <td>
                                        <span class="json-property-type">string</span>
                                        <span class="json-property-range" title="Value limits"></span>
                                        
                                            </td>
                                            <td>
                                            </td>
                                        </tr>
                                        <tr>
                                            <td>
                                                filter
                                            </td>
                                            <td><p>A url-encoded, JSON-serialized Filter protocol buffer (see
                                        <a href="https://github.com/kubeflow/pipelines/blob/master/backend/api/filter.proto">filter.proto</a>).</p>
                                        </td>
                                            <td>query</td>
                                            <td>
                                        <span class="json-property-type">string</span>
                                        <span class="json-property-range" title="Value limits"></span>
                                        
                                            </td>
                                            <td>
                                            </td>
                                        </tr>
                                        <tr>
                                            <td>
                                                resource_reference_key.type
                                            </td>
                                            <td><p>The type of the resource that referred to.</p>
                                        </td>
                                            <td>query</td>
                                            <td>
                                        <span class="json-property-type">string</span>    <span class="json-property-enum" title="Possible values">, x &isin; {
                                                        <span class="json-property-enum-item">UNKNOWN_RESOURCE_TYPE</span>
                                                        (default)
                                                    ,
                                                        <span class="json-property-enum-item">EXPERIMENT</span>
                                                    ,
                                                        <span class="json-property-enum-item">JOB</span>
                                                    ,
                                                        <span class="json-property-enum-item">PIPELINE</span>
                                                    ,
                                                        <span class="json-property-enum-item">PIPELINE_VERSION</span>
                                                    ,
                                                        <span class="json-property-enum-item">NAMESPACE</span>
                                                    
                                                }
                                                </span>
                                        <span class="json-property-range" title="Value limits"></span>
                                        
                                            </td>
                                            <td>
                                            </td>
                                        </tr>
                                        <tr>
                                            <td>
                                                resource_reference_key.id
                                            </td>
                                            <td><p>The ID of the resource that referred to.</p>
                                        </td>
                                            <td>query</td>
                                            <td>
                                        <span class="json-property-type">string</span>
                                        <span class="json-property-range" title="Value limits"></span>
                                        
                                            </td>
                                            <td>
                                            </td>
                                        </tr>
                                </tbody>
                            </table>
                        </section>
                    
                        <section class="sw-responses">
                                <p><a href="#sw-default-produces">Uses default content-types: </a>
                                    <span class="label label-default">application/json</span> 
                                </p>
                            
                            <dl>
                                    <dt class="sw-response-200">
                                        200 OK
                                    
                                    </dt>
                                    <dd class="sw-response-200">
                                            <div class="row">
                                                <div class="col-md-12">
                                                    <p>A successful response.</p>
                                            
                                                </div>
                                            </div>
                                            <div class="row">
                                                
                                                <div class="col-md-6 sw-response-model">
                                                <div  class="panel panel-definition">
                                                    <div class="panel-body">
                                                                <a class="json-schema-ref" href="#/definitions/apiListExperimentsResponse">apiListExperimentsResponse</a>
                                                    </div>
                                                </div></div>
                                            
                                            </div>                </dd>
                                    <dt class="sw-response-default">
                                        default 
                                    
                                    </dt>
                                    <dd class="sw-response-default">
                                            <div class="row">
                                                <div class="col-md-12">
                                                    
                                                </div>
                                            </div>
                                            <div class="row">
                                                
                                                <div class="col-md-6 sw-response-model">
                                                <div  class="panel panel-definition">
                                                    <div class="panel-body">
                                                                <a class="json-schema-ref" href="#/definitions/apiStatus">apiStatus</a>
                                                    </div>
                                                </div></div>
                                            
                                            </div>                </dd>
                            </dl>
                        </section>
                </div>
            </div>
            <div id="operation--apis-v1beta1-experiments-post" class="swagger--panel-operation-post panel">
                <div class="panel-heading">
                    <div class="operation-summary">Creates a new experiment.</div>
                    <h3 class="panel-title"><span class="operation-name">POST</span> <strong>/apis/v1beta1/experiments</strong></h3>
                        Tags:
                            <a href="#tag-ExperimentService">ExperimentService</a>
                </div>
                <div class="panel-body">
                    <section class="sw-operation-description">
                        
                    </section>
            
                        
                            <section class="sw-request-body">
                                
                                    <p><a href="#sw-default-consumes">Uses default content-types: </a>
                                    <span class="label label-default">application/json</span> 
                                    </p>
                                                <div class="row">
                                            <div class="col-md-6">
                                                <p><p>The experiment to be created.</p>
                        </p>
                                            </div>
                                            <div class="col-md-6 sw-request-model">
                            <div  class="panel panel-definition">
                                <div class="panel-body">
                                            <a class="json-schema-ref" href="#/definitions/apiExperiment">apiExperiment</a>
                                </div>
                            </div></div>
                                        </div>
                            </section>        
                    
                        <section class="sw-responses">
                                <p><a href="#sw-default-produces">Uses default content-types: </a>
                                    <span class="label label-default">application/json</span> 
                                </p>
                            
                            <dl>
                                    <dt class="sw-response-200">
                                        200 OK
                                    
                                    </dt>
                                    <dd class="sw-response-200">
                                            <div class="row">
                                                <div class="col-md-12">
                                                    <p>A successful response.</p>
                                            
                                                </div>
                                            </div>
                                            <div class="row">
                                                
                                                <div class="col-md-6 sw-response-model">
                                                <div  class="panel panel-definition">
                                                    <div class="panel-body">
                                                                <a class="json-schema-ref" href="#/definitions/apiExperiment">apiExperiment</a>
                                                    </div>
                                                </div></div>
                                            
                                            </div>                </dd>
                                    <dt class="sw-response-default">
                                        default 
                                    
                                    </dt>
                                    <dd class="sw-response-default">
                                            <div class="row">
                                                <div class="col-md-12">
                                                    
                                                </div>
                                            </div>
                                            <div class="row">
                                                
                                                <div class="col-md-6 sw-response-model">
                                                <div  class="panel panel-definition">
                                                    <div class="panel-body">
                                                                <a class="json-schema-ref" href="#/definitions/apiStatus">apiStatus</a>
                                                    </div>
                                                </div></div>
                                            
                                            </div>                </dd>
                            </dl>
                        </section>
                </div>
            </div>
        
        <span id="path--apis-v1beta1-experiments--id-"></span>
            <div id="operation--apis-v1beta1-experiments--id--delete" class="swagger--panel-operation-delete panel">
                <div class="panel-heading">
                    <div class="operation-summary">Deletes an experiment without deleting the experiment&apos;s runs and jobs. To
            avoid unexpected behaviors, delete an experiment&apos;s runs and jobs before
            deleting the experiment.</div>
                    <h3 class="panel-title"><span class="operation-name">DELETE</span> <strong>/apis/v1beta1/experiments/{id}</strong></h3>
                        Tags:
                            <a href="#tag-ExperimentService">ExperimentService</a>
                </div>
                <div class="panel-body">
                    <section class="sw-operation-description">
                        
                    </section>
            
                    
                        <section class="sw-request-params">
                            <table class="table">
                                <thead>
                                <tr>
                                    <th class="sw-param-name"></th>
                                    <th class="sw-param-description"></th>
                                    <th class="sw-param-type"></th>
                                    <th class="sw-param-data-type"></th>
                                    <th class="sw-param-annotation"></th>
                                </tr>
                                </thead>
                                <tbody>
                                        <tr>
                                            <td>
                                                id
                                            </td>
                                            <td><p>The ID of the experiment to be deleted.</p>
                                        </td>
                                            <td>path</td>
                                            <td>
                                        <span class="json-property-type">string</span>
                                        <span class="json-property-range" title="Value limits"></span>
                                        
                                            </td>
                                            <td>
                                                    <span class="json-property-required"></span>
                                            </td>
                                        </tr>
                                </tbody>
                            </table>
                        </section>
                    
                        <section class="sw-responses">
                                <p><a href="#sw-default-produces">Uses default content-types: </a>
                                    <span class="label label-default">application/json</span> 
                                </p>
                            
                            <dl>
                                    <dt class="sw-response-200">
                                        200 OK
                                    
                                    </dt>
                                    <dd class="sw-response-200">
                                            <div class="row">
                                                <div class="col-md-12">
                                                    <p>A successful response.</p>
                                            
                                                </div>
                                            </div>
                                            <div class="row">
                                                
                                                <div class="col-md-6 sw-response-model">
                                                <div  class="panel panel-definition">
                                                    <div class="panel-body">
                                                            
                                                                <section class="json-schema-properties">
                                                                    <dl>
                                                                    </dl>
                                                                </section>
                                                    </div>
                                                </div></div>
                                            
                                            </div>                </dd>
                                    <dt class="sw-response-default">
                                        default 
                                    
                                    </dt>
                                    <dd class="sw-response-default">
                                            <div class="row">
                                                <div class="col-md-12">
                                                    
                                                </div>
                                            </div>
                                            <div class="row">
                                                
                                                <div class="col-md-6 sw-response-model">
                                                <div  class="panel panel-definition">
                                                    <div class="panel-body">
                                                                <a class="json-schema-ref" href="#/definitions/apiStatus">apiStatus</a>
                                                    </div>
                                                </div></div>
                                            
                                            </div>                </dd>
                            </dl>
                        </section>
                </div>
            </div>
            <div id="operation--apis-v1beta1-experiments--id--get" class="swagger--panel-operation-get panel">
                <div class="panel-heading">
                    <div class="operation-summary">Finds a specific experiment by ID.</div>
                    <h3 class="panel-title"><span class="operation-name">GET</span> <strong>/apis/v1beta1/experiments/{id}</strong></h3>
                        Tags:
                            <a href="#tag-ExperimentService">ExperimentService</a>
                </div>
                <div class="panel-body">
                    <section class="sw-operation-description">
                        
                    </section>
            
                    
                        <section class="sw-request-params">
                            <table class="table">
                                <thead>
                                <tr>
                                    <th class="sw-param-name"></th>
                                    <th class="sw-param-description"></th>
                                    <th class="sw-param-type"></th>
                                    <th class="sw-param-data-type"></th>
                                    <th class="sw-param-annotation"></th>
                                </tr>
                                </thead>
                                <tbody>
                                        <tr>
                                            <td>
                                                id
                                            </td>
                                            <td><p>The ID of the experiment to be retrieved.</p>
                                        </td>
                                            <td>path</td>
                                            <td>
                                        <span class="json-property-type">string</span>
                                        <span class="json-property-range" title="Value limits"></span>
                                        
                                            </td>
                                            <td>
                                                    <span class="json-property-required"></span>
                                            </td>
                                        </tr>
                                </tbody>
                            </table>
                        </section>
                    
                        <section class="sw-responses">
                                <p><a href="#sw-default-produces">Uses default content-types: </a>
                                    <span class="label label-default">application/json</span> 
                                </p>
                            
                            <dl>
                                    <dt class="sw-response-200">
                                        200 OK
                                    
                                    </dt>
                                    <dd class="sw-response-200">
                                            <div class="row">
                                                <div class="col-md-12">
                                                    <p>A successful response.</p>
                                            
                                                </div>
                                            </div>
                                            <div class="row">
                                                
                                                <div class="col-md-6 sw-response-model">
                                                <div  class="panel panel-definition">
                                                    <div class="panel-body">
                                                                <a class="json-schema-ref" href="#/definitions/apiExperiment">apiExperiment</a>
                                                    </div>
                                                </div></div>
                                            
                                            </div>                </dd>
                                    <dt class="sw-response-default">
                                        default 
                                    
                                    </dt>
                                    <dd class="sw-response-default">
                                            <div class="row">
                                                <div class="col-md-12">
                                                    
                                                </div>
                                            </div>
                                            <div class="row">
                                                
                                                <div class="col-md-6 sw-response-model">
                                                <div  class="panel panel-definition">
                                                    <div class="panel-body">
                                                                <a class="json-schema-ref" href="#/definitions/apiStatus">apiStatus</a>
                                                    </div>
                                                </div></div>
                                            
                                            </div>                </dd>
                            </dl>
                        </section>
                </div>
            </div>
        
        <span id="path--apis-v1beta1-experiments--id-:archive"></span>
            <div id="operation--apis-v1beta1-experiments--id-:archive-post" class="swagger--panel-operation-post panel">
                <div class="panel-heading">
                    <div class="operation-summary">Archives an experiment and the experiment&apos;s runs and jobs.</div>
                    <h3 class="panel-title"><span class="operation-name">POST</span> <strong>/apis/v1beta1/experiments/{id}:archive</strong></h3>
                        Tags:
                            <a href="#tag-ExperimentService">ExperimentService</a>
                </div>
                <div class="panel-body">
                    <section class="sw-operation-description">
                        
                    </section>
            
                    
                        <section class="sw-request-params">
                            <table class="table">
                                <thead>
                                <tr>
                                    <th class="sw-param-name"></th>
                                    <th class="sw-param-description"></th>
                                    <th class="sw-param-type"></th>
                                    <th class="sw-param-data-type"></th>
                                    <th class="sw-param-annotation"></th>
                                </tr>
                                </thead>
                                <tbody>
                                        <tr>
                                            <td>
                                                id
                                            </td>
                                            <td><p>The ID of the experiment to be archived.</p>
                                        </td>
                                            <td>path</td>
                                            <td>
                                        <span class="json-property-type">string</span>
                                        <span class="json-property-range" title="Value limits"></span>
                                        
                                            </td>
                                            <td>
                                                    <span class="json-property-required"></span>
                                            </td>
                                        </tr>
                                </tbody>
                            </table>
                        </section>
                    
                        <section class="sw-responses">
                                <p><a href="#sw-default-produces">Uses default content-types: </a>
                                    <span class="label label-default">application/json</span> 
                                </p>
                            
                            <dl>
                                    <dt class="sw-response-200">
                                        200 OK
                                    
                                    </dt>
                                    <dd class="sw-response-200">
                                            <div class="row">
                                                <div class="col-md-12">
                                                    <p>A successful response.</p>
                                            
                                                </div>
                                            </div>
                                            <div class="row">
                                                
                                                <div class="col-md-6 sw-response-model">
                                                <div  class="panel panel-definition">
                                                    <div class="panel-body">
                                                            
                                                                <section class="json-schema-properties">
                                                                    <dl>
                                                                    </dl>
                                                                </section>
                                                    </div>
                                                </div></div>
                                            
                                            </div>                </dd>
                                    <dt class="sw-response-default">
                                        default 
                                    
                                    </dt>
                                    <dd class="sw-response-default">
                                            <div class="row">
                                                <div class="col-md-12">
                                                    
                                                </div>
                                            </div>
                                            <div class="row">
                                                
                                                <div class="col-md-6 sw-response-model">
                                                <div  class="panel panel-definition">
                                                    <div class="panel-body">
                                                                <a class="json-schema-ref" href="#/definitions/apiStatus">apiStatus</a>
                                                    </div>
                                                </div></div>
                                            
                                            </div>                </dd>
                            </dl>
                        </section>
                </div>
            </div>
        
        <span id="path--apis-v1beta1-experiments--id-:unarchive"></span>
            <div id="operation--apis-v1beta1-experiments--id-:unarchive-post" class="swagger--panel-operation-post panel">
                <div class="panel-heading">
                    <div class="operation-summary">Restores an archived experiment. The experiment&apos;s archived runs and jobs
            will stay archived.</div>
                    <h3 class="panel-title"><span class="operation-name">POST</span> <strong>/apis/v1beta1/experiments/{id}:unarchive</strong></h3>
                        Tags:
                            <a href="#tag-ExperimentService">ExperimentService</a>
                </div>
                <div class="panel-body">
                    <section class="sw-operation-description">
                        
                    </section>
            
                    
                        <section class="sw-request-params">
                            <table class="table">
                                <thead>
                                <tr>
                                    <th class="sw-param-name"></th>
                                    <th class="sw-param-description"></th>
                                    <th class="sw-param-type"></th>
                                    <th class="sw-param-data-type"></th>
                                    <th class="sw-param-annotation"></th>
                                </tr>
                                </thead>
                                <tbody>
                                        <tr>
                                            <td>
                                                id
                                            </td>
                                            <td><p>The ID of the experiment to be restored.</p>
                                        </td>
                                            <td>path</td>
                                            <td>
                                        <span class="json-property-type">string</span>
                                        <span class="json-property-range" title="Value limits"></span>
                                        
                                            </td>
                                            <td>
                                                    <span class="json-property-required"></span>
                                            </td>
                                        </tr>
                                </tbody>
                            </table>
                        </section>
                    
                        <section class="sw-responses">
                                <p><a href="#sw-default-produces">Uses default content-types: </a>
                                    <span class="label label-default">application/json</span> 
                                </p>
                            
                            <dl>
                                    <dt class="sw-response-200">
                                        200 OK
                                    
                                    </dt>
                                    <dd class="sw-response-200">
                                            <div class="row">
                                                <div class="col-md-12">
                                                    <p>A successful response.</p>
                                            
                                                </div>
                                            </div>
                                            <div class="row">
                                                
                                                <div class="col-md-6 sw-response-model">
                                                <div  class="panel panel-definition">
                                                    <div class="panel-body">
                                                            
                                                                <section class="json-schema-properties">
                                                                    <dl>
                                                                    </dl>
                                                                </section>
                                                    </div>
                                                </div></div>
                                            
                                            </div>                </dd>
                                    <dt class="sw-response-default">
                                        default 
                                    
                                    </dt>
                                    <dd class="sw-response-default">
                                            <div class="row">
                                                <div class="col-md-12">
                                                    
                                                </div>
                                            </div>
                                            <div class="row">
                                                
                                                <div class="col-md-6 sw-response-model">
                                                <div  class="panel panel-definition">
                                                    <div class="panel-body">
                                                                <a class="json-schema-ref" href="#/definitions/apiStatus">apiStatus</a>
                                                    </div>
                                                </div></div>
                                            
                                            </div>                </dd>
                            </dl>
                        </section>
                </div>
            </div>
        
        <span id="path--apis-v1beta1-healthz"></span>
            <div id="operation--apis-v1beta1-healthz-get" class="swagger--panel-operation-get panel">
                <div class="panel-heading">
                    <div class="operation-summary">Get healthz data.</div>
                    <h3 class="panel-title"><span class="operation-name">GET</span> <strong>/apis/v1beta1/healthz</strong></h3>
                        Tags:
                            <a href="#tag-HealthzService">HealthzService</a>
                </div>
                <div class="panel-body">
                    <section class="sw-operation-description">
                        
                    </section>
            
                    
                    
                        <section class="sw-responses">
                                <p><a href="#sw-default-produces">Uses default content-types: </a>
                                    <span class="label label-default">application/json</span> 
                                </p>
                            
                            <dl>
                                    <dt class="sw-response-200">
                                        200 OK
                                    
                                    </dt>
                                    <dd class="sw-response-200">
                                            <div class="row">
                                                <div class="col-md-12">
                                                    <p>A successful response.</p>
                                            
                                                </div>
                                            </div>
                                            <div class="row">
                                                
                                                <div class="col-md-6 sw-response-model">
                                                <div  class="panel panel-definition">
                                                    <div class="panel-body">
                                                                <a class="json-schema-ref" href="#/definitions/apiGetHealthzResponse">apiGetHealthzResponse</a>
                                                    </div>
                                                </div></div>
                                            
                                            </div>                </dd>
                                    <dt class="sw-response-default">
                                        default 
                                    
                                    </dt>
                                    <dd class="sw-response-default">
                                            <div class="row">
                                                <div class="col-md-12">
                                                    
                                                </div>
                                            </div>
                                            <div class="row">
                                                
                                                <div class="col-md-6 sw-response-model">
                                                <div  class="panel panel-definition">
                                                    <div class="panel-body">
                                                                <a class="json-schema-ref" href="#/definitions/apiStatus">apiStatus</a>
                                                    </div>
                                                </div></div>
                                            
                                            </div>                </dd>
                            </dl>
                        </section>
                </div>
            </div>
        
        <span id="path--apis-v1beta1-jobs"></span>
            <div id="operation--apis-v1beta1-jobs-get" class="swagger--panel-operation-get panel">
                <div class="panel-heading">
                    <div class="operation-summary">Finds all jobs.</div>
                    <h3 class="panel-title"><span class="operation-name">GET</span> <strong>/apis/v1beta1/jobs</strong></h3>
                        Tags:
                            <a href="#tag-JobService">JobService</a>
                </div>
                <div class="panel-body">
                    <section class="sw-operation-description">
                        
                    </section>
            
                    
                        <section class="sw-request-params">
                            <table class="table">
                                <thead>
                                <tr>
                                    <th class="sw-param-name"></th>
                                    <th class="sw-param-description"></th>
                                    <th class="sw-param-type"></th>
                                    <th class="sw-param-data-type"></th>
                                    <th class="sw-param-annotation"></th>
                                </tr>
                                </thead>
                                <tbody>
                                        <tr>
                                            <td>
                                                page_token
                                            </td>
                                            <td><p>A page token to request the next page of results. The token is acquried
                                        from the nextPageToken field of the response from the previous
                                        ListJobs call or can be omitted when fetching the first page.</p>
                                        </td>
                                            <td>query</td>
                                            <td>
                                        <span class="json-property-type">string</span>
                                        <span class="json-property-range" title="Value limits"></span>
                                        
                                            </td>
                                            <td>
                                            </td>
                                        </tr>
                                        <tr>
                                            <td>
                                                page_size
                                            </td>
                                            <td><p>The number of jobs to be listed per page. If there are more jobs than this
                                        number, the response message will contain a nextPageToken field you can use
                                        to fetch the next page.</p>
                                        </td>
                                            <td>query</td>
                                            <td>
                                        <span class="json-property-type">integer</span>    <span class="json-property-format">(int32)</span>
                                        <span class="json-property-range" title="Value limits"></span>
                                        
                                            </td>
                                            <td>
                                            </td>
                                        </tr>
                                        <tr>
                                            <td>
                                                sort_by
                                            </td>
                                            <td><p>Can be format of &quot;field_name&quot;, &quot;field_name asc&quot; or &quot;field_name desc&quot;.
                                        Ascending by default.</p>
                                        </td>
                                            <td>query</td>
                                            <td>
                                        <span class="json-property-type">string</span>
                                        <span class="json-property-range" title="Value limits"></span>
                                        
                                            </td>
                                            <td>
                                            </td>
                                        </tr>
                                        <tr>
                                            <td>
                                                resource_reference_key.type
                                            </td>
                                            <td><p>The type of the resource that referred to.</p>
                                        </td>
                                            <td>query</td>
                                            <td>
                                        <span class="json-property-type">string</span>    <span class="json-property-enum" title="Possible values">, x &isin; {
                                                        <span class="json-property-enum-item">UNKNOWN_RESOURCE_TYPE</span>
                                                        (default)
                                                    ,
                                                        <span class="json-property-enum-item">EXPERIMENT</span>
                                                    ,
                                                        <span class="json-property-enum-item">JOB</span>
                                                    ,
                                                        <span class="json-property-enum-item">PIPELINE</span>
                                                    ,
                                                        <span class="json-property-enum-item">PIPELINE_VERSION</span>
                                                    ,
                                                        <span class="json-property-enum-item">NAMESPACE</span>
                                                    
                                                }
                                                </span>
                                        <span class="json-property-range" title="Value limits"></span>
                                        
                                            </td>
                                            <td>
                                            </td>
                                        </tr>
                                        <tr>
                                            <td>
                                                resource_reference_key.id
                                            </td>
                                            <td><p>The ID of the resource that referred to.</p>
                                        </td>
                                            <td>query</td>
                                            <td>
                                        <span class="json-property-type">string</span>
                                        <span class="json-property-range" title="Value limits"></span>
                                        
                                            </td>
                                            <td>
                                            </td>
                                        </tr>
                                        <tr>
                                            <td>
                                                filter
                                            </td>
                                            <td><p>A url-encoded, JSON-serialized Filter protocol buffer (see
                                        <a href="https://github.com/kubeflow/pipelines/blob/master/backend/api/filter.proto">filter.proto</a>).</p>
                                        </td>
                                            <td>query</td>
                                            <td>
                                        <span class="json-property-type">string</span>
                                        <span class="json-property-range" title="Value limits"></span>
                                        
                                            </td>
                                            <td>
                                            </td>
                                        </tr>
                                </tbody>
                            </table>
                        </section>
                    
                        <section class="sw-responses">
                                <p><a href="#sw-default-produces">Uses default content-types: </a>
                                    <span class="label label-default">application/json</span> 
                                </p>
                            
                            <dl>
                                    <dt class="sw-response-200">
                                        200 OK
                                    
                                    </dt>
                                    <dd class="sw-response-200">
                                            <div class="row">
                                                <div class="col-md-12">
                                                    <p>A successful response.</p>
                                            
                                                </div>
                                            </div>
                                            <div class="row">
                                                
                                                <div class="col-md-6 sw-response-model">
                                                <div  class="panel panel-definition">
                                                    <div class="panel-body">
                                                                <a class="json-schema-ref" href="#/definitions/apiListJobsResponse">apiListJobsResponse</a>
                                                    </div>
                                                </div></div>
                                            
                                            </div>                </dd>
                                    <dt class="sw-response-default">
                                        default 
                                    
                                    </dt>
                                    <dd class="sw-response-default">
                                            <div class="row">
                                                <div class="col-md-12">
                                                    
                                                </div>
                                            </div>
                                            <div class="row">
                                                
                                                <div class="col-md-6 sw-response-model">
                                                <div  class="panel panel-definition">
                                                    <div class="panel-body">
                                                                <a class="json-schema-ref" href="#/definitions/apiStatus">apiStatus</a>
                                                    </div>
                                                </div></div>
                                            
                                            </div>                </dd>
                            </dl>
                        </section>
                </div>
            </div>
            <div id="operation--apis-v1beta1-jobs-post" class="swagger--panel-operation-post panel">
                <div class="panel-heading">
                    <div class="operation-summary">Creates a new job.</div>
                    <h3 class="panel-title"><span class="operation-name">POST</span> <strong>/apis/v1beta1/jobs</strong></h3>
                        Tags:
                            <a href="#tag-JobService">JobService</a>
                </div>
                <div class="panel-body">
                    <section class="sw-operation-description">
                        
                    </section>
            
                        
                            <section class="sw-request-body">
                                
                                    <p><a href="#sw-default-consumes">Uses default content-types: </a>
                                    <span class="label label-default">application/json</span> 
                                    </p>
                                                <div class="row">
                                            <div class="col-md-6">
                                                <p><p>The job to be created</p>
                        </p>
                                            </div>
                                            <div class="col-md-6 sw-request-model">
                            <div  class="panel panel-definition">
                                <div class="panel-body">
                                            <a class="json-schema-ref" href="#/definitions/apiJob">apiJob</a>
                                </div>
                            </div></div>
                                        </div>
                            </section>        
                    
                        <section class="sw-responses">
                                <p><a href="#sw-default-produces">Uses default content-types: </a>
                                    <span class="label label-default">application/json</span> 
                                </p>
                            
                            <dl>
                                    <dt class="sw-response-200">
                                        200 OK
                                    
                                    </dt>
                                    <dd class="sw-response-200">
                                            <div class="row">
                                                <div class="col-md-12">
                                                    <p>A successful response.</p>
                                            
                                                </div>
                                            </div>
                                            <div class="row">
                                                
                                                <div class="col-md-6 sw-response-model">
                                                <div  class="panel panel-definition">
                                                    <div class="panel-body">
                                                                <a class="json-schema-ref" href="#/definitions/apiJob">apiJob</a>
                                                    </div>
                                                </div></div>
                                            
                                            </div>                </dd>
                                    <dt class="sw-response-default">
                                        default 
                                    
                                    </dt>
                                    <dd class="sw-response-default">
                                            <div class="row">
                                                <div class="col-md-12">
                                                    
                                                </div>
                                            </div>
                                            <div class="row">
                                                
                                                <div class="col-md-6 sw-response-model">
                                                <div  class="panel panel-definition">
                                                    <div class="panel-body">
                                                                <a class="json-schema-ref" href="#/definitions/apiStatus">apiStatus</a>
                                                    </div>
                                                </div></div>
                                            
                                            </div>                </dd>
                            </dl>
                        </section>
                </div>
            </div>
        
        <span id="path--apis-v1beta1-jobs--id-"></span>
            <div id="operation--apis-v1beta1-jobs--id--delete" class="swagger--panel-operation-delete panel">
                <div class="panel-heading">
                    <div class="operation-summary">Deletes a job.</div>
                    <h3 class="panel-title"><span class="operation-name">DELETE</span> <strong>/apis/v1beta1/jobs/{id}</strong></h3>
                        Tags:
                            <a href="#tag-JobService">JobService</a>
                </div>
                <div class="panel-body">
                    <section class="sw-operation-description">
                        
                    </section>
            
                    
                        <section class="sw-request-params">
                            <table class="table">
                                <thead>
                                <tr>
                                    <th class="sw-param-name"></th>
                                    <th class="sw-param-description"></th>
                                    <th class="sw-param-type"></th>
                                    <th class="sw-param-data-type"></th>
                                    <th class="sw-param-annotation"></th>
                                </tr>
                                </thead>
                                <tbody>
                                        <tr>
                                            <td>
                                                id
                                            </td>
                                            <td><p>The ID of the job to be deleted</p>
                                        </td>
                                            <td>path</td>
                                            <td>
                                        <span class="json-property-type">string</span>
                                        <span class="json-property-range" title="Value limits"></span>
                                        
                                            </td>
                                            <td>
                                                    <span class="json-property-required"></span>
                                            </td>
                                        </tr>
                                </tbody>
                            </table>
                        </section>
                    
                        <section class="sw-responses">
                                <p><a href="#sw-default-produces">Uses default content-types: </a>
                                    <span class="label label-default">application/json</span> 
                                </p>
                            
                            <dl>
                                    <dt class="sw-response-200">
                                        200 OK
                                    
                                    </dt>
                                    <dd class="sw-response-200">
                                            <div class="row">
                                                <div class="col-md-12">
                                                    <p>A successful response.</p>
                                            
                                                </div>
                                            </div>
                                            <div class="row">
                                                
                                                <div class="col-md-6 sw-response-model">
                                                <div  class="panel panel-definition">
                                                    <div class="panel-body">
                                                            
                                                                <section class="json-schema-properties">
                                                                    <dl>
                                                                    </dl>
                                                                </section>
                                                    </div>
                                                </div></div>
                                            
                                            </div>                </dd>
                                    <dt class="sw-response-default">
                                        default 
                                    
                                    </dt>
                                    <dd class="sw-response-default">
                                            <div class="row">
                                                <div class="col-md-12">
                                                    
                                                </div>
                                            </div>
                                            <div class="row">
                                                
                                                <div class="col-md-6 sw-response-model">
                                                <div  class="panel panel-definition">
                                                    <div class="panel-body">
                                                                <a class="json-schema-ref" href="#/definitions/apiStatus">apiStatus</a>
                                                    </div>
                                                </div></div>
                                            
                                            </div>                </dd>
                            </dl>
                        </section>
                </div>
            </div>
            <div id="operation--apis-v1beta1-jobs--id--get" class="swagger--panel-operation-get panel">
                <div class="panel-heading">
                    <div class="operation-summary">Finds a specific job by ID.</div>
                    <h3 class="panel-title"><span class="operation-name">GET</span> <strong>/apis/v1beta1/jobs/{id}</strong></h3>
                        Tags:
                            <a href="#tag-JobService">JobService</a>
                </div>
                <div class="panel-body">
                    <section class="sw-operation-description">
                        
                    </section>
            
                    
                        <section class="sw-request-params">
                            <table class="table">
                                <thead>
                                <tr>
                                    <th class="sw-param-name"></th>
                                    <th class="sw-param-description"></th>
                                    <th class="sw-param-type"></th>
                                    <th class="sw-param-data-type"></th>
                                    <th class="sw-param-annotation"></th>
                                </tr>
                                </thead>
                                <tbody>
                                        <tr>
                                            <td>
                                                id
                                            </td>
                                            <td><p>The ID of the job to be retrieved</p>
                                        </td>
                                            <td>path</td>
                                            <td>
                                        <span class="json-property-type">string</span>
                                        <span class="json-property-range" title="Value limits"></span>
                                        
                                            </td>
                                            <td>
                                                    <span class="json-property-required"></span>
                                            </td>
                                        </tr>
                                </tbody>
                            </table>
                        </section>
                    
                        <section class="sw-responses">
                                <p><a href="#sw-default-produces">Uses default content-types: </a>
                                    <span class="label label-default">application/json</span> 
                                </p>
                            
                            <dl>
                                    <dt class="sw-response-200">
                                        200 OK
                                    
                                    </dt>
                                    <dd class="sw-response-200">
                                            <div class="row">
                                                <div class="col-md-12">
                                                    <p>A successful response.</p>
                                            
                                                </div>
                                            </div>
                                            <div class="row">
                                                
                                                <div class="col-md-6 sw-response-model">
                                                <div  class="panel panel-definition">
                                                    <div class="panel-body">
                                                                <a class="json-schema-ref" href="#/definitions/apiJob">apiJob</a>
                                                    </div>
                                                </div></div>
                                            
                                            </div>                </dd>
                                    <dt class="sw-response-default">
                                        default 
                                    
                                    </dt>
                                    <dd class="sw-response-default">
                                            <div class="row">
                                                <div class="col-md-12">
                                                    
                                                </div>
                                            </div>
                                            <div class="row">
                                                
                                                <div class="col-md-6 sw-response-model">
                                                <div  class="panel panel-definition">
                                                    <div class="panel-body">
                                                                <a class="json-schema-ref" href="#/definitions/apiStatus">apiStatus</a>
                                                    </div>
                                                </div></div>
                                            
                                            </div>                </dd>
                            </dl>
                        </section>
                </div>
            </div>
        
        <span id="path--apis-v1beta1-jobs--id--disable"></span>
            <div id="operation--apis-v1beta1-jobs--id--disable-post" class="swagger--panel-operation-post panel">
                <div class="panel-heading">
                    <div class="operation-summary">Stops a job and all its associated runs. The job is not deleted.</div>
                    <h3 class="panel-title"><span class="operation-name">POST</span> <strong>/apis/v1beta1/jobs/{id}/disable</strong></h3>
                        Tags:
                            <a href="#tag-JobService">JobService</a>
                </div>
                <div class="panel-body">
                    <section class="sw-operation-description">
                        
                    </section>
            
                    
                        <section class="sw-request-params">
                            <table class="table">
                                <thead>
                                <tr>
                                    <th class="sw-param-name"></th>
                                    <th class="sw-param-description"></th>
                                    <th class="sw-param-type"></th>
                                    <th class="sw-param-data-type"></th>
                                    <th class="sw-param-annotation"></th>
                                </tr>
                                </thead>
                                <tbody>
                                        <tr>
                                            <td>
                                                id
                                            </td>
                                            <td><p>The ID of the job to be disabled</p>
                                        </td>
                                            <td>path</td>
                                            <td>
                                        <span class="json-property-type">string</span>
                                        <span class="json-property-range" title="Value limits"></span>
                                        
                                            </td>
                                            <td>
                                                    <span class="json-property-required"></span>
                                            </td>
                                        </tr>
                                </tbody>
                            </table>
                        </section>
                    
                        <section class="sw-responses">
                                <p><a href="#sw-default-produces">Uses default content-types: </a>
                                    <span class="label label-default">application/json</span> 
                                </p>
                            
                            <dl>
                                    <dt class="sw-response-200">
                                        200 OK
                                    
                                    </dt>
                                    <dd class="sw-response-200">
                                            <div class="row">
                                                <div class="col-md-12">
                                                    <p>A successful response.</p>
                                            
                                                </div>
                                            </div>
                                            <div class="row">
                                                
                                                <div class="col-md-6 sw-response-model">
                                                <div  class="panel panel-definition">
                                                    <div class="panel-body">
                                                            
                                                                <section class="json-schema-properties">
                                                                    <dl>
                                                                    </dl>
                                                                </section>
                                                    </div>
                                                </div></div>
                                            
                                            </div>                </dd>
                                    <dt class="sw-response-default">
                                        default 
                                    
                                    </dt>
                                    <dd class="sw-response-default">
                                            <div class="row">
                                                <div class="col-md-12">
                                                    
                                                </div>
                                            </div>
                                            <div class="row">
                                                
                                                <div class="col-md-6 sw-response-model">
                                                <div  class="panel panel-definition">
                                                    <div class="panel-body">
                                                                <a class="json-schema-ref" href="#/definitions/apiStatus">apiStatus</a>
                                                    </div>
                                                </div></div>
                                            
                                            </div>                </dd>
                            </dl>
                        </section>
                </div>
            </div>
        
        <span id="path--apis-v1beta1-jobs--id--enable"></span>
            <div id="operation--apis-v1beta1-jobs--id--enable-post" class="swagger--panel-operation-post panel">
                <div class="panel-heading">
                    <div class="operation-summary">Restarts a job that was previously stopped. All runs associated with the job will continue.</div>
                    <h3 class="panel-title"><span class="operation-name">POST</span> <strong>/apis/v1beta1/jobs/{id}/enable</strong></h3>
                        Tags:
                            <a href="#tag-JobService">JobService</a>
                </div>
                <div class="panel-body">
                    <section class="sw-operation-description">
                        
                    </section>
            
                    
                        <section class="sw-request-params">
                            <table class="table">
                                <thead>
                                <tr>
                                    <th class="sw-param-name"></th>
                                    <th class="sw-param-description"></th>
                                    <th class="sw-param-type"></th>
                                    <th class="sw-param-data-type"></th>
                                    <th class="sw-param-annotation"></th>
                                </tr>
                                </thead>
                                <tbody>
                                        <tr>
                                            <td>
                                                id
                                            </td>
                                            <td><p>The ID of the job to be enabled</p>
                                        </td>
                                            <td>path</td>
                                            <td>
                                        <span class="json-property-type">string</span>
                                        <span class="json-property-range" title="Value limits"></span>
                                        
                                            </td>
                                            <td>
                                                    <span class="json-property-required"></span>
                                            </td>
                                        </tr>
                                </tbody>
                            </table>
                        </section>
                    
                        <section class="sw-responses">
                                <p><a href="#sw-default-produces">Uses default content-types: </a>
                                    <span class="label label-default">application/json</span> 
                                </p>
                            
                            <dl>
                                    <dt class="sw-response-200">
                                        200 OK
                                    
                                    </dt>
                                    <dd class="sw-response-200">
                                            <div class="row">
                                                <div class="col-md-12">
                                                    <p>A successful response.</p>
                                            
                                                </div>
                                            </div>
                                            <div class="row">
                                                
                                                <div class="col-md-6 sw-response-model">
                                                <div  class="panel panel-definition">
                                                    <div class="panel-body">
                                                            
                                                                <section class="json-schema-properties">
                                                                    <dl>
                                                                    </dl>
                                                                </section>
                                                    </div>
                                                </div></div>
                                            
                                            </div>                </dd>
                                    <dt class="sw-response-default">
                                        default 
                                    
                                    </dt>
                                    <dd class="sw-response-default">
                                            <div class="row">
                                                <div class="col-md-12">
                                                    
                                                </div>
                                            </div>
                                            <div class="row">
                                                
                                                <div class="col-md-6 sw-response-model">
                                                <div  class="panel panel-definition">
                                                    <div class="panel-body">
                                                                <a class="json-schema-ref" href="#/definitions/apiStatus">apiStatus</a>
                                                    </div>
                                                </div></div>
                                            
                                            </div>                </dd>
                            </dl>
                        </section>
                </div>
            </div>
        
        <span id="path--apis-v1beta1-namespaces--namespace--pipelines--name-"></span>
            <div id="operation--apis-v1beta1-namespaces--namespace--pipelines--name--get" class="swagger--panel-operation-get panel">
                <div class="panel-heading">
                    <div class="operation-summary">Finds a pipeline by Name (and namespace)</div>
                    <h3 class="panel-title"><span class="operation-name">GET</span> <strong>/apis/v1beta1/namespaces/{namespace}/pipelines/{name}</strong></h3>
                        Tags:
                            <a href="#tag-PipelineService">PipelineService</a>
                </div>
                <div class="panel-body">
                    <section class="sw-operation-description">
                        
                    </section>
            
                    
                        <section class="sw-request-params">
                            <table class="table">
                                <thead>
                                <tr>
                                    <th class="sw-param-name"></th>
                                    <th class="sw-param-description"></th>
                                    <th class="sw-param-type"></th>
                                    <th class="sw-param-data-type"></th>
                                    <th class="sw-param-annotation"></th>
                                </tr>
                                </thead>
                                <tbody>
                                        <tr>
                                            <td>
                                                namespace
                                            </td>
                                            <td><p>The Namespace the pipeline belongs to.
                                        In the case of shared pipelines and KFPipeline standalone installation,
                                        the pipeline name is the only needed field for unique resource lookup (namespace is not required).
                                        In those case, please provide hyphen (dash character, &quot;-&quot;).</p>
                                        </td>
                                            <td>path</td>
                                            <td>
                                        <span class="json-property-type">string</span>
                                        <span class="json-property-range" title="Value limits"></span>
                                        
                                            </td>
                                            <td>
                                                    <span class="json-property-required"></span>
                                            </td>
                                        </tr>
                                        <tr>
                                            <td>
                                                name
                                            </td>
                                            <td><p>The Name of the pipeline to be retrieved.</p>
                                        </td>
                                            <td>path</td>
                                            <td>
                                        <span class="json-property-type">string</span>
                                        <span class="json-property-range" title="Value limits"></span>
                                        
                                            </td>
                                            <td>
                                                    <span class="json-property-required"></span>
                                            </td>
                                        </tr>
                                </tbody>
                            </table>
                        </section>
                    
                        <section class="sw-responses">
                                <p><a href="#sw-default-produces">Uses default content-types: </a>
                                    <span class="label label-default">application/json</span> 
                                </p>
                            
                            <dl>
                                    <dt class="sw-response-200">
                                        200 OK
                                    
                                    </dt>
                                    <dd class="sw-response-200">
                                            <div class="row">
                                                <div class="col-md-12">
                                                    <p>A successful response.</p>
                                            
                                                </div>
                                            </div>
                                            <div class="row">
                                                
                                                <div class="col-md-6 sw-response-model">
                                                <div  class="panel panel-definition">
                                                    <div class="panel-body">
                                                                <a class="json-schema-ref" href="#/definitions/apiPipeline">apiPipeline</a>
                                                    </div>
                                                </div></div>
                                            
                                            </div>                </dd>
                                    <dt class="sw-response-default">
                                        default 
                                    
                                    </dt>
                                    <dd class="sw-response-default">
                                            <div class="row">
                                                <div class="col-md-12">
                                                    
                                                </div>
                                            </div>
                                            <div class="row">
                                                
                                                <div class="col-md-6 sw-response-model">
                                                <div  class="panel panel-definition">
                                                    <div class="panel-body">
                                                                <a class="json-schema-ref" href="#/definitions/apiStatus">apiStatus</a>
                                                    </div>
                                                </div></div>
                                            
                                            </div>                </dd>
                            </dl>
                        </section>
                </div>
            </div>
        
        <span id="path--apis-v1beta1-pipeline_versions"></span>
            <div id="operation--apis-v1beta1-pipeline_versions-get" class="swagger--panel-operation-get panel">
                <div class="panel-heading">
                    <div class="operation-summary">Lists all pipeline versions of a given pipeline.</div>
                    <h3 class="panel-title"><span class="operation-name">GET</span> <strong>/apis/v1beta1/pipeline_versions</strong></h3>
                        Tags:
                            <a href="#tag-PipelineService">PipelineService</a>
                </div>
                <div class="panel-body">
                    <section class="sw-operation-description">
                        
                    </section>
            
                    
                        <section class="sw-request-params">
                            <table class="table">
                                <thead>
                                <tr>
                                    <th class="sw-param-name"></th>
                                    <th class="sw-param-description"></th>
                                    <th class="sw-param-type"></th>
                                    <th class="sw-param-data-type"></th>
                                    <th class="sw-param-annotation"></th>
                                </tr>
                                </thead>
                                <tbody>
                                        <tr>
                                            <td>
                                                resource_key.type
                                            </td>
                                            <td><p>The type of the resource that referred to.</p>
                                        </td>
                                            <td>query</td>
                                            <td>
                                        <span class="json-property-type">string</span>    <span class="json-property-enum" title="Possible values">, x &isin; {
                                                        <span class="json-property-enum-item">UNKNOWN_RESOURCE_TYPE</span>
                                                        (default)
                                                    ,
                                                        <span class="json-property-enum-item">EXPERIMENT</span>
                                                    ,
                                                        <span class="json-property-enum-item">JOB</span>
                                                    ,
                                                        <span class="json-property-enum-item">PIPELINE</span>
                                                    ,
                                                        <span class="json-property-enum-item">PIPELINE_VERSION</span>
                                                    ,
                                                        <span class="json-property-enum-item">NAMESPACE</span>
                                                    
                                                }
                                                </span>
                                        <span class="json-property-range" title="Value limits"></span>
                                        
                                            </td>
                                            <td>
                                            </td>
                                        </tr>
                                        <tr>
                                            <td>
                                                resource_key.id
                                            </td>
                                            <td><p>The ID of the resource that referred to.</p>
                                        </td>
                                            <td>query</td>
                                            <td>
                                        <span class="json-property-type">string</span>
                                        <span class="json-property-range" title="Value limits"></span>
                                        
                                            </td>
                                            <td>
                                            </td>
                                        </tr>
                                        <tr>
                                            <td>
                                                page_size
                                            </td>
                                            <td><p>The number of pipeline versions to be listed per page. If there are more
                                        pipeline versions than this number, the response message will contain a
                                        nextPageToken field you can use to fetch the next page.</p>
                                        </td>
                                            <td>query</td>
                                            <td>
                                        <span class="json-property-type">integer</span>    <span class="json-property-format">(int32)</span>
                                        <span class="json-property-range" title="Value limits"></span>
                                        
                                            </td>
                                            <td>
                                            </td>
                                        </tr>
                                        <tr>
                                            <td>
                                                page_token
                                            </td>
                                            <td><p>A page token to request the next page of results. The token is acquried
                                        from the nextPageToken field of the response from the previous
                                        ListPipelineVersions call or can be omitted when fetching the first page.</p>
                                        </td>
                                            <td>query</td>
                                            <td>
                                        <span class="json-property-type">string</span>
                                        <span class="json-property-range" title="Value limits"></span>
                                        
                                            </td>
                                            <td>
                                            </td>
                                        </tr>
                                        <tr>
                                            <td>
                                                sort_by
                                            </td>
                                            <td><p>Can be format of &quot;field_name&quot;, &quot;field_name asc&quot; or &quot;field_name desc&quot;
                                        Ascending by default.</p>
                                        </td>
                                            <td>query</td>
                                            <td>
                                        <span class="json-property-type">string</span>
                                        <span class="json-property-range" title="Value limits"></span>
                                        
                                            </td>
                                            <td>
                                            </td>
                                        </tr>
                                        <tr>
                                            <td>
                                                filter
                                            </td>
                                            <td><p>A base-64 encoded, JSON-serialized Filter protocol buffer (see
                                        filter.proto).</p>
                                        </td>
                                            <td>query</td>
                                            <td>
                                        <span class="json-property-type">string</span>
                                        <span class="json-property-range" title="Value limits"></span>
                                        
                                            </td>
                                            <td>
                                            </td>
                                        </tr>
                                </tbody>
                            </table>
                        </section>
                    
                        <section class="sw-responses">
                                <p><a href="#sw-default-produces">Uses default content-types: </a>
                                    <span class="label label-default">application/json</span> 
                                </p>
                            
                            <dl>
                                    <dt class="sw-response-200">
                                        200 OK
                                    
                                    </dt>
                                    <dd class="sw-response-200">
                                            <div class="row">
                                                <div class="col-md-12">
                                                    <p>A successful response.</p>
                                            
                                                </div>
                                            </div>
                                            <div class="row">
                                                
                                                <div class="col-md-6 sw-response-model">
                                                <div  class="panel panel-definition">
                                                    <div class="panel-body">
                                                                <a class="json-schema-ref" href="#/definitions/apiListPipelineVersionsResponse">apiListPipelineVersionsResponse</a>
                                                    </div>
                                                </div></div>
                                            
                                            </div>                </dd>
                                    <dt class="sw-response-default">
                                        default 
                                    
                                    </dt>
                                    <dd class="sw-response-default">
                                            <div class="row">
                                                <div class="col-md-12">
                                                    
                                                </div>
                                            </div>
                                            <div class="row">
                                                
                                                <div class="col-md-6 sw-response-model">
                                                <div  class="panel panel-definition">
                                                    <div class="panel-body">
                                                                <a class="json-schema-ref" href="#/definitions/apiStatus">apiStatus</a>
                                                    </div>
                                                </div></div>
                                            
                                            </div>                </dd>
                            </dl>
                        </section>
                </div>
            </div>
            <div id="operation--apis-v1beta1-pipeline_versions-post" class="swagger--panel-operation-post panel">
                <div class="panel-heading">
                    <div class="operation-summary">Adds a pipeline version to the specified pipeline.</div>
                    <h3 class="panel-title"><span class="operation-name">POST</span> <strong>/apis/v1beta1/pipeline_versions</strong></h3>
                        Tags:
                            <a href="#tag-PipelineService">PipelineService</a>
                </div>
                <div class="panel-body">
                    <section class="sw-operation-description">
                        
                    </section>
            
                        
                            <section class="sw-request-body">
                                
                                    <p><a href="#sw-default-consumes">Uses default content-types: </a>
                                    <span class="label label-default">application/json</span> 
                                    </p>
                                                <div class="row">
                                            <div class="col-md-6">
                                                <p><p>ResourceReference inside PipelineVersion specifies the pipeline that this
                        version belongs to.</p>
                        </p>
                                            </div>
                                            <div class="col-md-6 sw-request-model">
                            <div  class="panel panel-definition">
                                <div class="panel-body">
                                            <a class="json-schema-ref" href="#/definitions/apiPipelineVersion">apiPipelineVersion</a>
                                </div>
                            </div></div>
                                        </div>
                            </section>        
                    
                        <section class="sw-responses">
                                <p><a href="#sw-default-produces">Uses default content-types: </a>
                                    <span class="label label-default">application/json</span> 
                                </p>
                            
                            <dl>
                                    <dt class="sw-response-200">
                                        200 OK
                                    
                                    </dt>
                                    <dd class="sw-response-200">
                                            <div class="row">
                                                <div class="col-md-12">
                                                    <p>A successful response.</p>
                                            
                                                </div>
                                            </div>
                                            <div class="row">
                                                
                                                <div class="col-md-6 sw-response-model">
                                                <div  class="panel panel-definition">
                                                    <div class="panel-body">
                                                                <a class="json-schema-ref" href="#/definitions/apiPipelineVersion">apiPipelineVersion</a>
                                                    </div>
                                                </div></div>
                                            
                                            </div>                </dd>
                                    <dt class="sw-response-default">
                                        default 
                                    
                                    </dt>
                                    <dd class="sw-response-default">
                                            <div class="row">
                                                <div class="col-md-12">
                                                    
                                                </div>
                                            </div>
                                            <div class="row">
                                                
                                                <div class="col-md-6 sw-response-model">
                                                <div  class="panel panel-definition">
                                                    <div class="panel-body">
                                                                <a class="json-schema-ref" href="#/definitions/apiStatus">apiStatus</a>
                                                    </div>
                                                </div></div>
                                            
                                            </div>                </dd>
                            </dl>
                        </section>
                </div>
            </div>
        
        <span id="path--apis-v1beta1-pipeline_versions--version_id-"></span>
            <div id="operation--apis-v1beta1-pipeline_versions--version_id--delete" class="swagger--panel-operation-delete panel">
                <div class="panel-heading">
                    <div class="operation-summary">Deletes a pipeline version by pipeline version ID. If the deleted pipeline
            version is the default pipeline version, the pipeline&apos;s default version
            changes to the pipeline&apos;s most recent pipeline version. If there are no
            remaining pipeline versions, the pipeline will have no default version.
            Examines the run_service_api.ipynb notebook to learn more about creating a
            run using a pipeline version (<a href="https://github.com/kubeflow/pipelines/blob/sdk/release-1.8/tools/benchmarks/run_service_api.ipynb">https://github.com/kubeflow/pipelines/blob/sdk/release-1.8/tools/benchmarks/run_service_api.ipynb</a>).</div>
                    <h3 class="panel-title"><span class="operation-name">DELETE</span> <strong>/apis/v1beta1/pipeline_versions/{version_id}</strong></h3>
                        Tags:
                            <a href="#tag-PipelineService">PipelineService</a>
                </div>
                <div class="panel-body">
                    <section class="sw-operation-description">
                        
                    </section>
            
                    
                        <section class="sw-request-params">
                            <table class="table">
                                <thead>
                                <tr>
                                    <th class="sw-param-name"></th>
                                    <th class="sw-param-description"></th>
                                    <th class="sw-param-type"></th>
                                    <th class="sw-param-data-type"></th>
                                    <th class="sw-param-annotation"></th>
                                </tr>
                                </thead>
                                <tbody>
                                        <tr>
                                            <td>
                                                version_id
                                            </td>
                                            <td><p>The ID of the pipeline version to be deleted.</p>
                                        </td>
                                            <td>path</td>
                                            <td>
                                        <span class="json-property-type">string</span>
                                        <span class="json-property-range" title="Value limits"></span>
                                        
                                            </td>
                                            <td>
                                                    <span class="json-property-required"></span>
                                            </td>
                                        </tr>
                                </tbody>
                            </table>
                        </section>
                    
                        <section class="sw-responses">
                                <p><a href="#sw-default-produces">Uses default content-types: </a>
                                    <span class="label label-default">application/json</span> 
                                </p>
                            
                            <dl>
                                    <dt class="sw-response-200">
                                        200 OK
                                    
                                    </dt>
                                    <dd class="sw-response-200">
                                            <div class="row">
                                                <div class="col-md-12">
                                                    <p>A successful response.</p>
                                            
                                                </div>
                                            </div>
                                            <div class="row">
                                                
                                                <div class="col-md-6 sw-response-model">
                                                <div  class="panel panel-definition">
                                                    <div class="panel-body">
                                                            
                                                                <section class="json-schema-properties">
                                                                    <dl>
                                                                    </dl>
                                                                </section>
                                                    </div>
                                                </div></div>
                                            
                                            </div>                </dd>
                                    <dt class="sw-response-default">
                                        default 
                                    
                                    </dt>
                                    <dd class="sw-response-default">
                                            <div class="row">
                                                <div class="col-md-12">
                                                    
                                                </div>
                                            </div>
                                            <div class="row">
                                                
                                                <div class="col-md-6 sw-response-model">
                                                <div  class="panel panel-definition">
                                                    <div class="panel-body">
                                                                <a class="json-schema-ref" href="#/definitions/apiStatus">apiStatus</a>
                                                    </div>
                                                </div></div>
                                            
                                            </div>                </dd>
                            </dl>
                        </section>
                </div>
            </div>
            <div id="operation--apis-v1beta1-pipeline_versions--version_id--get" class="swagger--panel-operation-get panel">
                <div class="panel-heading">
                    <div class="operation-summary">Gets a pipeline version by pipeline version ID.</div>
                    <h3 class="panel-title"><span class="operation-name">GET</span> <strong>/apis/v1beta1/pipeline_versions/{version_id}</strong></h3>
                        Tags:
                            <a href="#tag-PipelineService">PipelineService</a>
                </div>
                <div class="panel-body">
                    <section class="sw-operation-description">
                        
                    </section>
            
                    
                        <section class="sw-request-params">
                            <table class="table">
                                <thead>
                                <tr>
                                    <th class="sw-param-name"></th>
                                    <th class="sw-param-description"></th>
                                    <th class="sw-param-type"></th>
                                    <th class="sw-param-data-type"></th>
                                    <th class="sw-param-annotation"></th>
                                </tr>
                                </thead>
                                <tbody>
                                        <tr>
                                            <td>
                                                version_id
                                            </td>
                                            <td><p>The ID of the pipeline version to be retrieved.</p>
                                        </td>
                                            <td>path</td>
                                            <td>
                                        <span class="json-property-type">string</span>
                                        <span class="json-property-range" title="Value limits"></span>
                                        
                                            </td>
                                            <td>
                                                    <span class="json-property-required"></span>
                                            </td>
                                        </tr>
                                </tbody>
                            </table>
                        </section>
                    
                        <section class="sw-responses">
                                <p><a href="#sw-default-produces">Uses default content-types: </a>
                                    <span class="label label-default">application/json</span> 
                                </p>
                            
                            <dl>
                                    <dt class="sw-response-200">
                                        200 OK
                                    
                                    </dt>
                                    <dd class="sw-response-200">
                                            <div class="row">
                                                <div class="col-md-12">
                                                    <p>A successful response.</p>
                                            
                                                </div>
                                            </div>
                                            <div class="row">
                                                
                                                <div class="col-md-6 sw-response-model">
                                                <div  class="panel panel-definition">
                                                    <div class="panel-body">
                                                                <a class="json-schema-ref" href="#/definitions/apiPipelineVersion">apiPipelineVersion</a>
                                                    </div>
                                                </div></div>
                                            
                                            </div>                </dd>
                                    <dt class="sw-response-default">
                                        default 
                                    
                                    </dt>
                                    <dd class="sw-response-default">
                                            <div class="row">
                                                <div class="col-md-12">
                                                    
                                                </div>
                                            </div>
                                            <div class="row">
                                                
                                                <div class="col-md-6 sw-response-model">
                                                <div  class="panel panel-definition">
                                                    <div class="panel-body">
                                                                <a class="json-schema-ref" href="#/definitions/apiStatus">apiStatus</a>
                                                    </div>
                                                </div></div>
                                            
                                            </div>                </dd>
                            </dl>
                        </section>
                </div>
            </div>
        
        <span id="path--apis-v1beta1-pipeline_versions--version_id--templates"></span>
            <div id="operation--apis-v1beta1-pipeline_versions--version_id--templates-get" class="swagger--panel-operation-get panel">
                <div class="panel-heading">
                    <div class="operation-summary">Returns a YAML template that contains the specified pipeline version&apos;s description, parameters and metadata.</div>
                    <h3 class="panel-title"><span class="operation-name">GET</span> <strong>/apis/v1beta1/pipeline_versions/{version_id}/templates</strong></h3>
                        Tags:
                            <a href="#tag-PipelineService">PipelineService</a>
                </div>
                <div class="panel-body">
                    <section class="sw-operation-description">
                        
                    </section>
            
                    
                        <section class="sw-request-params">
                            <table class="table">
                                <thead>
                                <tr>
                                    <th class="sw-param-name"></th>
                                    <th class="sw-param-description"></th>
                                    <th class="sw-param-type"></th>
                                    <th class="sw-param-data-type"></th>
                                    <th class="sw-param-annotation"></th>
                                </tr>
                                </thead>
                                <tbody>
                                        <tr>
                                            <td>
                                                version_id
                                            </td>
                                            <td><p>The ID of the pipeline version whose template is to be retrieved.</p>
                                        </td>
                                            <td>path</td>
                                            <td>
                                        <span class="json-property-type">string</span>
                                        <span class="json-property-range" title="Value limits"></span>
                                        
                                            </td>
                                            <td>
                                                    <span class="json-property-required"></span>
                                            </td>
                                        </tr>
                                </tbody>
                            </table>
                        </section>
                    
                        <section class="sw-responses">
                                <p><a href="#sw-default-produces">Uses default content-types: </a>
                                    <span class="label label-default">application/json</span> 
                                </p>
                            
                            <dl>
                                    <dt class="sw-response-200">
                                        200 OK
                                    
                                    </dt>
                                    <dd class="sw-response-200">
                                            <div class="row">
                                                <div class="col-md-12">
                                                    <p>A successful response.</p>
                                            
                                                </div>
                                            </div>
                                            <div class="row">
                                                
                                                <div class="col-md-6 sw-response-model">
                                                <div  class="panel panel-definition">
                                                    <div class="panel-body">
                                                                <a class="json-schema-ref" href="#/definitions/apiGetTemplateResponse">apiGetTemplateResponse</a>
                                                    </div>
                                                </div></div>
                                            
                                            </div>                </dd>
                                    <dt class="sw-response-default">
                                        default 
                                    
                                    </dt>
                                    <dd class="sw-response-default">
                                            <div class="row">
                                                <div class="col-md-12">
                                                    
                                                </div>
                                            </div>
                                            <div class="row">
                                                
                                                <div class="col-md-6 sw-response-model">
                                                <div  class="panel panel-definition">
                                                    <div class="panel-body">
                                                                <a class="json-schema-ref" href="#/definitions/apiStatus">apiStatus</a>
                                                    </div>
                                                </div></div>
                                            
                                            </div>                </dd>
                            </dl>
                        </section>
                </div>
            </div>
        
        <span id="path--apis-v1beta1-pipelines"></span>
            <div id="operation--apis-v1beta1-pipelines-get" class="swagger--panel-operation-get panel">
                <div class="panel-heading">
                    <div class="operation-summary">Finds all pipelines.</div>
                    <h3 class="panel-title"><span class="operation-name">GET</span> <strong>/apis/v1beta1/pipelines</strong></h3>
                        Tags:
                            <a href="#tag-PipelineService">PipelineService</a>
                </div>
                <div class="panel-body">
                    <section class="sw-operation-description">
                        
                    </section>
            
                    
                        <section class="sw-request-params">
                            <table class="table">
                                <thead>
                                <tr>
                                    <th class="sw-param-name"></th>
                                    <th class="sw-param-description"></th>
                                    <th class="sw-param-type"></th>
                                    <th class="sw-param-data-type"></th>
                                    <th class="sw-param-annotation"></th>
                                </tr>
                                </thead>
                                <tbody>
                                        <tr>
                                            <td>
                                                page_token
                                            </td>
                                            <td><p>A page token to request the next page of results. The token is acquried
                                        from the nextPageToken field of the response from the previous
                                        ListPipelines call.</p>
                                        </td>
                                            <td>query</td>
                                            <td>
                                        <span class="json-property-type">string</span>
                                        <span class="json-property-range" title="Value limits"></span>
                                        
                                            </td>
                                            <td>
                                            </td>
                                        </tr>
                                        <tr>
                                            <td>
                                                page_size
                                            </td>
                                            <td><p>The number of pipelines to be listed per page. If there are more pipelines
                                        than this number, the response message will contain a valid value in the
                                        nextPageToken field.</p>
                                        </td>
                                            <td>query</td>
                                            <td>
                                        <span class="json-property-type">integer</span>    <span class="json-property-format">(int32)</span>
                                        <span class="json-property-range" title="Value limits"></span>
                                        
                                            </td>
                                            <td>
                                            </td>
                                        </tr>
                                        <tr>
                                            <td>
                                                sort_by
                                            </td>
                                            <td><p>Can be format of &quot;field_name&quot;, &quot;field_name asc&quot; or &quot;field_name desc&quot;
                                        Ascending by default.</p>
                                        </td>
                                            <td>query</td>
                                            <td>
                                        <span class="json-property-type">string</span>
                                        <span class="json-property-range" title="Value limits"></span>
                                        
                                            </td>
                                            <td>
                                            </td>
                                        </tr>
                                        <tr>
                                            <td>
                                                filter
                                            </td>
                                            <td><p>A url-encoded, JSON-serialized Filter protocol buffer (see
                                        <a href="https://github.com/kubeflow/pipelines/blob/master/backend/api/filter.proto">filter.proto</a>).</p>
                                        </td>
                                            <td>query</td>
                                            <td>
                                        <span class="json-property-type">string</span>
                                        <span class="json-property-range" title="Value limits"></span>
                                        
                                            </td>
                                            <td>
                                            </td>
                                        </tr>
                                        <tr>
                                            <td>
                                                resource_reference_key.type
                                            </td>
                                            <td><p>The type of the resource that referred to.</p>
                                        </td>
                                            <td>query</td>
                                            <td>
                                        <span class="json-property-type">string</span>    <span class="json-property-enum" title="Possible values">, x &isin; {
                                                        <span class="json-property-enum-item">UNKNOWN_RESOURCE_TYPE</span>
                                                        (default)
                                                    ,
                                                        <span class="json-property-enum-item">EXPERIMENT</span>
                                                    ,
                                                        <span class="json-property-enum-item">JOB</span>
                                                    ,
                                                        <span class="json-property-enum-item">PIPELINE</span>
                                                    ,
                                                        <span class="json-property-enum-item">PIPELINE_VERSION</span>
                                                    ,
                                                        <span class="json-property-enum-item">NAMESPACE</span>
                                                    
                                                }
                                                </span>
                                        <span class="json-property-range" title="Value limits"></span>
                                        
                                            </td>
                                            <td>
                                            </td>
                                        </tr>
                                        <tr>
                                            <td>
                                                resource_reference_key.id
                                            </td>
                                            <td><p>The ID of the resource that referred to.</p>
                                        </td>
                                            <td>query</td>
                                            <td>
                                        <span class="json-property-type">string</span>
                                        <span class="json-property-range" title="Value limits"></span>
                                        
                                            </td>
                                            <td>
                                            </td>
                                        </tr>
                                </tbody>
                            </table>
                        </section>
                    
                        <section class="sw-responses">
                                <p><a href="#sw-default-produces">Uses default content-types: </a>
                                    <span class="label label-default">application/json</span> 
                                </p>
                            
                            <dl>
                                    <dt class="sw-response-200">
                                        200 OK
                                    
                                    </dt>
                                    <dd class="sw-response-200">
                                            <div class="row">
                                                <div class="col-md-12">
                                                    <p>A successful response.</p>
                                            
                                                </div>
                                            </div>
                                            <div class="row">
                                                
                                                <div class="col-md-6 sw-response-model">
                                                <div  class="panel panel-definition">
                                                    <div class="panel-body">
                                                                <a class="json-schema-ref" href="#/definitions/apiListPipelinesResponse">apiListPipelinesResponse</a>
                                                    </div>
                                                </div></div>
                                            
                                            </div>                </dd>
                                    <dt class="sw-response-default">
                                        default 
                                    
                                    </dt>
                                    <dd class="sw-response-default">
                                            <div class="row">
                                                <div class="col-md-12">
                                                    
                                                </div>
                                            </div>
                                            <div class="row">
                                                
                                                <div class="col-md-6 sw-response-model">
                                                <div  class="panel panel-definition">
                                                    <div class="panel-body">
                                                                <a class="json-schema-ref" href="#/definitions/apiStatus">apiStatus</a>
                                                    </div>
                                                </div></div>
                                            
                                            </div>                </dd>
                            </dl>
                        </section>
                </div>
            </div>
            <div id="operation--apis-v1beta1-pipelines-post" class="swagger--panel-operation-post panel">
                <div class="panel-heading">
                    <div class="operation-summary">Creates a pipeline.</div>
                    <h3 class="panel-title"><span class="operation-name">POST</span> <strong>/apis/v1beta1/pipelines</strong></h3>
                        Tags:
                            <a href="#tag-PipelineService">PipelineService</a>
                </div>
                <div class="panel-body">
                    <section class="sw-operation-description">
                        
                    </section>
            
                        
                            <section class="sw-request-body">
                                
                                    <p><a href="#sw-default-consumes">Uses default content-types: </a>
                                    <span class="label label-default">application/json</span> 
                                    </p>
                                                <div class="row">
                                            <div class="col-md-6">
                                                <p></p>
                                            </div>
                                            <div class="col-md-6 sw-request-model">
                            <div  class="panel panel-definition">
                                <div class="panel-body">
                                            <a class="json-schema-ref" href="#/definitions/apiPipeline">apiPipeline</a>
                                </div>
                            </div></div>
                                        </div>
                            </section>        
                    
                        <section class="sw-responses">
                                <p><a href="#sw-default-produces">Uses default content-types: </a>
                                    <span class="label label-default">application/json</span> 
                                </p>
                            
                            <dl>
                                    <dt class="sw-response-200">
                                        200 OK
                                    
                                    </dt>
                                    <dd class="sw-response-200">
                                            <div class="row">
                                                <div class="col-md-12">
                                                    <p>A successful response.</p>
                                            
                                                </div>
                                            </div>
                                            <div class="row">
                                                
                                                <div class="col-md-6 sw-response-model">
                                                <div  class="panel panel-definition">
                                                    <div class="panel-body">
                                                                <a class="json-schema-ref" href="#/definitions/apiPipeline">apiPipeline</a>
                                                    </div>
                                                </div></div>
                                            
                                            </div>                </dd>
                                    <dt class="sw-response-default">
                                        default 
                                    
                                    </dt>
                                    <dd class="sw-response-default">
                                            <div class="row">
                                                <div class="col-md-12">
                                                    
                                                </div>
                                            </div>
                                            <div class="row">
                                                
                                                <div class="col-md-6 sw-response-model">
                                                <div  class="panel panel-definition">
                                                    <div class="panel-body">
                                                                <a class="json-schema-ref" href="#/definitions/apiStatus">apiStatus</a>
                                                    </div>
                                                </div></div>
                                            
                                            </div>                </dd>
                            </dl>
                        </section>
                </div>
            </div>
        
        <span id="path--apis-v1beta1-pipelines-upload"></span>
            <div id="operation--apis-v1beta1-pipelines-upload-post" class="swagger--panel-operation-post panel">
                <div class="panel-heading">
                    <div class="operation-summary"></div>
                    <h3 class="panel-title"><span class="operation-name">POST</span> <strong>/apis/v1beta1/pipelines/upload</strong></h3>
                        Tags:
                            <a href="#tag-PipelineUploadService">PipelineUploadService</a>
                </div>
                <div class="panel-body">
                    <section class="sw-operation-description">
                        
                    </section>
            
                        
                            <section class="sw-request-body">
                                
                                    <p><span class="label label-default">multipart/form-data</span> 
                        </p>
                            </section>        
                        <section class="sw-request-params">
                            <table class="table">
                                <thead>
                                <tr>
                                    <th class="sw-param-name"></th>
                                    <th class="sw-param-description"></th>
                                    <th class="sw-param-type"></th>
                                    <th class="sw-param-data-type"></th>
                                    <th class="sw-param-annotation"></th>
                                </tr>
                                </thead>
                                <tbody>
                                        <tr>
                                            <td>
                                                uploadfile
                                            </td>
                                            <td><p>The pipeline to upload. Maximum size of 32MB is supported.</p>
                                        </td>
                                            <td>formData</td>
                                            <td>
                                        <span class="json-property-type">file</span>
                                        <span class="json-property-range" title="Value limits"></span>
                                        
                                            </td>
                                            <td>
                                                    <span class="json-property-required"></span>
                                            </td>
                                        </tr>
                                        <tr>
                                            <td>
                                                name
                                            </td>
                                            <td></td>
                                            <td>query</td>
                                            <td>
                                        <span class="json-property-type">string</span>
                                        <span class="json-property-range" title="Value limits"></span>
                                        
                                            </td>
                                            <td>
                                            </td>
                                        </tr>
                                        <tr>
                                            <td>
                                                description
                                            </td>
                                            <td></td>
                                            <td>query</td>
                                            <td>
                                        <span class="json-property-type">string</span>
                                        <span class="json-property-range" title="Value limits"></span>
                                        
                                            </td>
                                            <td>
                                            </td>
                                        </tr>
                                </tbody>
                            </table>
                        </section>
                    
                        <section class="sw-responses">
                                <p><span class="label label-default">application/json</span> 
                    </p>
                    
                            <dl>
                                    <dt class="sw-response-200">
                                        200 OK
                                    
                                    </dt>
                                    <dd class="sw-response-200">
                                            <div class="row">
                                                <div class="col-md-12">
                                                    
                                                </div>
                                            </div>
                                            <div class="row">
                                                
                                                <div class="col-md-6 sw-response-model">
                                                <div  class="panel panel-definition">
                                                    <div class="panel-body">
                                                                <a class="json-schema-ref" href="#/definitions/apiPipeline">apiPipeline</a>
                                                    </div>
                                                </div></div>
                                            
                                            </div>                </dd>
                                    <dt class="sw-response-default">
                                        default 
                                    
                                    </dt>
                                    <dd class="sw-response-default">
                                            <div class="row">
                                                <div class="col-md-12">
                                                    
                                                </div>
                                            </div>
                                            <div class="row">
                                                
                                                <div class="col-md-6 sw-response-model">
                                                <div  class="panel panel-definition">
                                                    <div class="panel-body">
                                                                <a class="json-schema-ref" href="#/definitions/apiStatus">apiStatus</a>
                                                    </div>
                                                </div></div>
                                            
                                            </div>                </dd>
                            </dl>
                        </section>
                </div>
            </div>
        
        <span id="path--apis-v1beta1-pipelines-upload_version"></span>
            <div id="operation--apis-v1beta1-pipelines-upload_version-post" class="swagger--panel-operation-post panel">
                <div class="panel-heading">
                    <div class="operation-summary"></div>
                    <h3 class="panel-title"><span class="operation-name">POST</span> <strong>/apis/v1beta1/pipelines/upload_version</strong></h3>
                        Tags:
                            <a href="#tag-PipelineUploadService">PipelineUploadService</a>
                </div>
                <div class="panel-body">
                    <section class="sw-operation-description">
                        
                    </section>
            
                        
                            <section class="sw-request-body">
                                
                                    <p><span class="label label-default">multipart/form-data</span> 
                        </p>
                            </section>        
                        <section class="sw-request-params">
                            <table class="table">
                                <thead>
                                <tr>
                                    <th class="sw-param-name"></th>
                                    <th class="sw-param-description"></th>
                                    <th class="sw-param-type"></th>
                                    <th class="sw-param-data-type"></th>
                                    <th class="sw-param-annotation"></th>
                                </tr>
                                </thead>
                                <tbody>
                                        <tr>
                                            <td>
                                                uploadfile
                                            </td>
                                            <td><p>The pipeline to upload. Maximum size of 32MB is supported.</p>
                                        </td>
                                            <td>formData</td>
                                            <td>
                                        <span class="json-property-type">file</span>
                                        <span class="json-property-range" title="Value limits"></span>
                                        
                                            </td>
                                            <td>
                                                    <span class="json-property-required"></span>
                                            </td>
                                        </tr>
                                        <tr>
                                            <td>
                                                name
                                            </td>
                                            <td></td>
                                            <td>query</td>
                                            <td>
                                        <span class="json-property-type">string</span>
                                        <span class="json-property-range" title="Value limits"></span>
                                        
                                            </td>
                                            <td>
                                            </td>
                                        </tr>
                                        <tr>
                                            <td>
                                                pipelineid
                                            </td>
                                            <td></td>
                                            <td>query</td>
                                            <td>
                                        <span class="json-property-type">string</span>
                                        <span class="json-property-range" title="Value limits"></span>
                                        
                                            </td>
                                            <td>
                                            </td>
                                        </tr>
                                        <tr>
                                            <td>
                                                description
                                            </td>
                                            <td></td>
                                            <td>query</td>
                                            <td>
                                        <span class="json-property-type">string</span>
                                        <span class="json-property-range" title="Value limits"></span>
                                        
                                            </td>
                                            <td>
                                            </td>
                                        </tr>
                                </tbody>
                            </table>
                        </section>
                    
                        <section class="sw-responses">
                                <p><span class="label label-default">application/json</span> 
                    </p>
                    
                            <dl>
                                    <dt class="sw-response-200">
                                        200 OK
                                    
                                    </dt>
                                    <dd class="sw-response-200">
                                            <div class="row">
                                                <div class="col-md-12">
                                                    
                                                </div>
                                            </div>
                                            <div class="row">
                                                
                                                <div class="col-md-6 sw-response-model">
                                                <div  class="panel panel-definition">
                                                    <div class="panel-body">
                                                                <a class="json-schema-ref" href="#/definitions/apiPipelineVersion">apiPipelineVersion</a>
                                                    </div>
                                                </div></div>
                                            
                                            </div>                </dd>
                                    <dt class="sw-response-default">
                                        default 
                                    
                                    </dt>
                                    <dd class="sw-response-default">
                                            <div class="row">
                                                <div class="col-md-12">
                                                    
                                                </div>
                                            </div>
                                            <div class="row">
                                                
                                                <div class="col-md-6 sw-response-model">
                                                <div  class="panel panel-definition">
                                                    <div class="panel-body">
                                                                <a class="json-schema-ref" href="#/definitions/apiStatus">apiStatus</a>
                                                    </div>
                                                </div></div>
                                            
                                            </div>                </dd>
                            </dl>
                        </section>
                </div>
            </div>
        
        <span id="path--apis-v1beta1-pipelines--id-"></span>
            <div id="operation--apis-v1beta1-pipelines--id--delete" class="swagger--panel-operation-delete panel">
                <div class="panel-heading">
                    <div class="operation-summary">Deletes a pipeline and its pipeline versions.</div>
                    <h3 class="panel-title"><span class="operation-name">DELETE</span> <strong>/apis/v1beta1/pipelines/{id}</strong></h3>
                        Tags:
                            <a href="#tag-PipelineService">PipelineService</a>
                </div>
                <div class="panel-body">
                    <section class="sw-operation-description">
                        
                    </section>
            
                    
                        <section class="sw-request-params">
                            <table class="table">
                                <thead>
                                <tr>
                                    <th class="sw-param-name"></th>
                                    <th class="sw-param-description"></th>
                                    <th class="sw-param-type"></th>
                                    <th class="sw-param-data-type"></th>
                                    <th class="sw-param-annotation"></th>
                                </tr>
                                </thead>
                                <tbody>
                                        <tr>
                                            <td>
                                                id
                                            </td>
                                            <td><p>The ID of the pipeline to be deleted.</p>
                                        </td>
                                            <td>path</td>
                                            <td>
                                        <span class="json-property-type">string</span>
                                        <span class="json-property-range" title="Value limits"></span>
                                        
                                            </td>
                                            <td>
                                                    <span class="json-property-required"></span>
                                            </td>
                                        </tr>
                                </tbody>
                            </table>
                        </section>
                    
                        <section class="sw-responses">
                                <p><a href="#sw-default-produces">Uses default content-types: </a>
                                    <span class="label label-default">application/json</span> 
                                </p>
                            
                            <dl>
                                    <dt class="sw-response-200">
                                        200 OK
                                    
                                    </dt>
                                    <dd class="sw-response-200">
                                            <div class="row">
                                                <div class="col-md-12">
                                                    <p>A successful response.</p>
                                            
                                                </div>
                                            </div>
                                            <div class="row">
                                                
                                                <div class="col-md-6 sw-response-model">
                                                <div  class="panel panel-definition">
                                                    <div class="panel-body">
                                                            
                                                                <section class="json-schema-properties">
                                                                    <dl>
                                                                    </dl>
                                                                </section>
                                                    </div>
                                                </div></div>
                                            
                                            </div>                </dd>
                                    <dt class="sw-response-default">
                                        default 
                                    
                                    </dt>
                                    <dd class="sw-response-default">
                                            <div class="row">
                                                <div class="col-md-12">
                                                    
                                                </div>
                                            </div>
                                            <div class="row">
                                                
                                                <div class="col-md-6 sw-response-model">
                                                <div  class="panel panel-definition">
                                                    <div class="panel-body">
                                                                <a class="json-schema-ref" href="#/definitions/apiStatus">apiStatus</a>
                                                    </div>
                                                </div></div>
                                            
                                            </div>                </dd>
                            </dl>
                        </section>
                </div>
            </div>
            <div id="operation--apis-v1beta1-pipelines--id--get" class="swagger--panel-operation-get panel">
                <div class="panel-heading">
                    <div class="operation-summary">Finds a specific pipeline by ID.</div>
                    <h3 class="panel-title"><span class="operation-name">GET</span> <strong>/apis/v1beta1/pipelines/{id}</strong></h3>
                        Tags:
                            <a href="#tag-PipelineService">PipelineService</a>
                </div>
                <div class="panel-body">
                    <section class="sw-operation-description">
                        
                    </section>
            
                    
                        <section class="sw-request-params">
                            <table class="table">
                                <thead>
                                <tr>
                                    <th class="sw-param-name"></th>
                                    <th class="sw-param-description"></th>
                                    <th class="sw-param-type"></th>
                                    <th class="sw-param-data-type"></th>
                                    <th class="sw-param-annotation"></th>
                                </tr>
                                </thead>
                                <tbody>
                                        <tr>
                                            <td>
                                                id
                                            </td>
                                            <td><p>The ID of the pipeline to be retrieved.</p>
                                        </td>
                                            <td>path</td>
                                            <td>
                                        <span class="json-property-type">string</span>
                                        <span class="json-property-range" title="Value limits"></span>
                                        
                                            </td>
                                            <td>
                                                    <span class="json-property-required"></span>
                                            </td>
                                        </tr>
                                </tbody>
                            </table>
                        </section>
                    
                        <section class="sw-responses">
                                <p><a href="#sw-default-produces">Uses default content-types: </a>
                                    <span class="label label-default">application/json</span> 
                                </p>
                            
                            <dl>
                                    <dt class="sw-response-200">
                                        200 OK
                                    
                                    </dt>
                                    <dd class="sw-response-200">
                                            <div class="row">
                                                <div class="col-md-12">
                                                    <p>A successful response.</p>
                                            
                                                </div>
                                            </div>
                                            <div class="row">
                                                
                                                <div class="col-md-6 sw-response-model">
                                                <div  class="panel panel-definition">
                                                    <div class="panel-body">
                                                                <a class="json-schema-ref" href="#/definitions/apiPipeline">apiPipeline</a>
                                                    </div>
                                                </div></div>
                                            
                                            </div>                </dd>
                                    <dt class="sw-response-default">
                                        default 
                                    
                                    </dt>
                                    <dd class="sw-response-default">
                                            <div class="row">
                                                <div class="col-md-12">
                                                    
                                                </div>
                                            </div>
                                            <div class="row">
                                                
                                                <div class="col-md-6 sw-response-model">
                                                <div  class="panel panel-definition">
                                                    <div class="panel-body">
                                                                <a class="json-schema-ref" href="#/definitions/apiStatus">apiStatus</a>
                                                    </div>
                                                </div></div>
                                            
                                            </div>                </dd>
                            </dl>
                        </section>
                </div>
            </div>
        
        <span id="path--apis-v1beta1-pipelines--id--templates"></span>
            <div id="operation--apis-v1beta1-pipelines--id--templates-get" class="swagger--panel-operation-get panel">
                <div class="panel-heading">
                    <div class="operation-summary">Returns a single YAML template that contains the description, parameters, and metadata associated with the pipeline provided.</div>
                    <h3 class="panel-title"><span class="operation-name">GET</span> <strong>/apis/v1beta1/pipelines/{id}/templates</strong></h3>
                        Tags:
                            <a href="#tag-PipelineService">PipelineService</a>
                </div>
                <div class="panel-body">
                    <section class="sw-operation-description">
                        
                    </section>
            
                    
                        <section class="sw-request-params">
                            <table class="table">
                                <thead>
                                <tr>
                                    <th class="sw-param-name"></th>
                                    <th class="sw-param-description"></th>
                                    <th class="sw-param-type"></th>
                                    <th class="sw-param-data-type"></th>
                                    <th class="sw-param-annotation"></th>
                                </tr>
                                </thead>
                                <tbody>
                                        <tr>
                                            <td>
                                                id
                                            </td>
                                            <td><p>The ID of the pipeline whose template is to be retrieved.</p>
                                        </td>
                                            <td>path</td>
                                            <td>
                                        <span class="json-property-type">string</span>
                                        <span class="json-property-range" title="Value limits"></span>
                                        
                                            </td>
                                            <td>
                                                    <span class="json-property-required"></span>
                                            </td>
                                        </tr>
                                </tbody>
                            </table>
                        </section>
                    
                        <section class="sw-responses">
                                <p><a href="#sw-default-produces">Uses default content-types: </a>
                                    <span class="label label-default">application/json</span> 
                                </p>
                            
                            <dl>
                                    <dt class="sw-response-200">
                                        200 OK
                                    
                                    </dt>
                                    <dd class="sw-response-200">
                                            <div class="row">
                                                <div class="col-md-12">
                                                    <p>A successful response.</p>
                                            
                                                </div>
                                            </div>
                                            <div class="row">
                                                
                                                <div class="col-md-6 sw-response-model">
                                                <div  class="panel panel-definition">
                                                    <div class="panel-body">
                                                                <a class="json-schema-ref" href="#/definitions/apiGetTemplateResponse">apiGetTemplateResponse</a>
                                                    </div>
                                                </div></div>
                                            
                                            </div>                </dd>
                                    <dt class="sw-response-default">
                                        default 
                                    
                                    </dt>
                                    <dd class="sw-response-default">
                                            <div class="row">
                                                <div class="col-md-12">
                                                    
                                                </div>
                                            </div>
                                            <div class="row">
                                                
                                                <div class="col-md-6 sw-response-model">
                                                <div  class="panel panel-definition">
                                                    <div class="panel-body">
                                                                <a class="json-schema-ref" href="#/definitions/apiStatus">apiStatus</a>
                                                    </div>
                                                </div></div>
                                            
                                            </div>                </dd>
                            </dl>
                        </section>
                </div>
            </div>
        
        <span id="path--apis-v1beta1-pipelines--pipeline_id--default_version--version_id-"></span>
            <div id="operation--apis-v1beta1-pipelines--pipeline_id--default_version--version_id--post" class="swagger--panel-operation-post panel">
                <div class="panel-heading">
                    <div class="operation-summary">Update the default pipeline version of a specific pipeline.</div>
                    <h3 class="panel-title"><span class="operation-name">POST</span> <strong>/apis/v1beta1/pipelines/{pipeline_id}/default_version/{version_id}</strong></h3>
                        Tags:
                            <a href="#tag-PipelineService">PipelineService</a>
                </div>
                <div class="panel-body">
                    <section class="sw-operation-description">
                        
                    </section>
            
                    
                        <section class="sw-request-params">
                            <table class="table">
                                <thead>
                                <tr>
                                    <th class="sw-param-name"></th>
                                    <th class="sw-param-description"></th>
                                    <th class="sw-param-type"></th>
                                    <th class="sw-param-data-type"></th>
                                    <th class="sw-param-annotation"></th>
                                </tr>
                                </thead>
                                <tbody>
                                        <tr>
                                            <td>
                                                pipeline_id
                                            </td>
                                            <td><p>The ID of the pipeline to be updated.</p>
                                        </td>
                                            <td>path</td>
                                            <td>
                                        <span class="json-property-type">string</span>
                                        <span class="json-property-range" title="Value limits"></span>
                                        
                                            </td>
                                            <td>
                                                    <span class="json-property-required"></span>
                                            </td>
                                        </tr>
                                        <tr>
                                            <td>
                                                version_id
                                            </td>
                                            <td><p>The ID of the default version.</p>
                                        </td>
                                            <td>path</td>
                                            <td>
                                        <span class="json-property-type">string</span>
                                        <span class="json-property-range" title="Value limits"></span>
                                        
                                            </td>
                                            <td>
                                                    <span class="json-property-required"></span>
                                            </td>
                                        </tr>
                                </tbody>
                            </table>
                        </section>
                    
                        <section class="sw-responses">
                                <p><a href="#sw-default-produces">Uses default content-types: </a>
                                    <span class="label label-default">application/json</span> 
                                </p>
                            
                            <dl>
                                    <dt class="sw-response-200">
                                        200 OK
                                    
                                    </dt>
                                    <dd class="sw-response-200">
                                            <div class="row">
                                                <div class="col-md-12">
                                                    <p>A successful response.</p>
                                            
                                                </div>
                                            </div>
                                            <div class="row">
                                                
                                                <div class="col-md-6 sw-response-model">
                                                <div  class="panel panel-definition">
                                                    <div class="panel-body">
                                                            
                                                                <section class="json-schema-properties">
                                                                    <dl>
                                                                    </dl>
                                                                </section>
                                                    </div>
                                                </div></div>
                                            
                                            </div>                </dd>
                                    <dt class="sw-response-default">
                                        default 
                                    
                                    </dt>
                                    <dd class="sw-response-default">
                                            <div class="row">
                                                <div class="col-md-12">
                                                    
                                                </div>
                                            </div>
                                            <div class="row">
                                                
                                                <div class="col-md-6 sw-response-model">
                                                <div  class="panel panel-definition">
                                                    <div class="panel-body">
                                                                <a class="json-schema-ref" href="#/definitions/apiStatus">apiStatus</a>
                                                    </div>
                                                </div></div>
                                            
                                            </div>                </dd>
                            </dl>
                        </section>
                </div>
            </div>
        
        <span id="path--apis-v1beta1-runs"></span>
            <div id="operation--apis-v1beta1-runs-get" class="swagger--panel-operation-get panel">
                <div class="panel-heading">
                    <div class="operation-summary">Finds all runs.</div>
                    <h3 class="panel-title"><span class="operation-name">GET</span> <strong>/apis/v1beta1/runs</strong></h3>
                        Tags:
                            <a href="#tag-RunService">RunService</a>
                </div>
                <div class="panel-body">
                    <section class="sw-operation-description">
                        
                    </section>
            
                    
                        <section class="sw-request-params">
                            <table class="table">
                                <thead>
                                <tr>
                                    <th class="sw-param-name"></th>
                                    <th class="sw-param-description"></th>
                                    <th class="sw-param-type"></th>
                                    <th class="sw-param-data-type"></th>
                                    <th class="sw-param-annotation"></th>
                                </tr>
                                </thead>
                                <tbody>
                                        <tr>
                                            <td>
                                                page_token
                                            </td>
                                            <td><p>A page token to request the next page of results. The token is acquried
                                        from the nextPageToken field of the response from the previous
                                        ListRuns call or can be omitted when fetching the first page.</p>
                                        </td>
                                            <td>query</td>
                                            <td>
                                        <span class="json-property-type">string</span>
                                        <span class="json-property-range" title="Value limits"></span>
                                        
                                            </td>
                                            <td>
                                            </td>
                                        </tr>
                                        <tr>
                                            <td>
                                                page_size
                                            </td>
                                            <td><p>The number of runs to be listed per page. If there are more runs than this
                                        number, the response message will contain a nextPageToken field you can use
                                        to fetch the next page.</p>
                                        </td>
                                            <td>query</td>
                                            <td>
                                        <span class="json-property-type">integer</span>    <span class="json-property-format">(int32)</span>
                                        <span class="json-property-range" title="Value limits"></span>
                                        
                                            </td>
                                            <td>
                                            </td>
                                        </tr>
                                        <tr>
                                            <td>
                                                sort_by
                                            </td>
                                            <td><p>Can be format of &quot;field_name&quot;, &quot;field_name asc&quot; or &quot;field_name desc&quot;
                                        (Example, &quot;name asc&quot; or &quot;id desc&quot;). Ascending by default.</p>
                                        </td>
                                            <td>query</td>
                                            <td>
                                        <span class="json-property-type">string</span>
                                        <span class="json-property-range" title="Value limits"></span>
                                        
                                            </td>
                                            <td>
                                            </td>
                                        </tr>
                                        <tr>
                                            <td>
                                                resource_reference_key.type
                                            </td>
                                            <td><p>The type of the resource that referred to.</p>
                                        </td>
                                            <td>query</td>
                                            <td>
                                        <span class="json-property-type">string</span>    <span class="json-property-enum" title="Possible values">, x &isin; {
                                                        <span class="json-property-enum-item">UNKNOWN_RESOURCE_TYPE</span>
                                                        (default)
                                                    ,
                                                        <span class="json-property-enum-item">EXPERIMENT</span>
                                                    ,
                                                        <span class="json-property-enum-item">JOB</span>
                                                    ,
                                                        <span class="json-property-enum-item">PIPELINE</span>
                                                    ,
                                                        <span class="json-property-enum-item">PIPELINE_VERSION</span>
                                                    ,
                                                        <span class="json-property-enum-item">NAMESPACE</span>
                                                    
                                                }
                                                </span>
                                        <span class="json-property-range" title="Value limits"></span>
                                        
                                            </td>
                                            <td>
                                            </td>
                                        </tr>
                                        <tr>
                                            <td>
                                                resource_reference_key.id
                                            </td>
                                            <td><p>The ID of the resource that referred to.</p>
                                        </td>
                                            <td>query</td>
                                            <td>
                                        <span class="json-property-type">string</span>
                                        <span class="json-property-range" title="Value limits"></span>
                                        
                                            </td>
                                            <td>
                                            </td>
                                        </tr>
                                        <tr>
                                            <td>
                                                filter
                                            </td>
                                            <td><p>A url-encoded, JSON-serialized Filter protocol buffer (see
                                        <a href="https://github.com/kubeflow/pipelines/blob/master/backend/api/filter.proto">filter.proto</a>).</p>
                                        </td>
                                            <td>query</td>
                                            <td>
                                        <span class="json-property-type">string</span>
                                        <span class="json-property-range" title="Value limits"></span>
                                        
                                            </td>
                                            <td>
                                            </td>
                                        </tr>
                                </tbody>
                            </table>
                        </section>
                    
                        <section class="sw-responses">
                                <p><a href="#sw-default-produces">Uses default content-types: </a>
                                    <span class="label label-default">application/json</span> 
                                </p>
                            
                            <dl>
                                    <dt class="sw-response-200">
                                        200 OK
                                    
                                    </dt>
                                    <dd class="sw-response-200">
                                            <div class="row">
                                                <div class="col-md-12">
                                                    <p>A successful response.</p>
                                            
                                                </div>
                                            </div>
                                            <div class="row">
                                                
                                                <div class="col-md-6 sw-response-model">
                                                <div  class="panel panel-definition">
                                                    <div class="panel-body">
                                                                <a class="json-schema-ref" href="#/definitions/apiListRunsResponse">apiListRunsResponse</a>
                                                    </div>
                                                </div></div>
                                            
                                            </div>                </dd>
                                    <dt class="sw-response-default">
                                        default 
                                    
                                    </dt>
                                    <dd class="sw-response-default">
                                            <div class="row">
                                                <div class="col-md-12">
                                                    
                                                </div>
                                            </div>
                                            <div class="row">
                                                
                                                <div class="col-md-6 sw-response-model">
                                                <div  class="panel panel-definition">
                                                    <div class="panel-body">
                                                                <a class="json-schema-ref" href="#/definitions/apiStatus">apiStatus</a>
                                                    </div>
                                                </div></div>
                                            
                                            </div>                </dd>
                            </dl>
                        </section>
                </div>
            </div>
            <div id="operation--apis-v1beta1-runs-post" class="swagger--panel-operation-post panel">
                <div class="panel-heading">
                    <div class="operation-summary">Creates a new run.</div>
                    <h3 class="panel-title"><span class="operation-name">POST</span> <strong>/apis/v1beta1/runs</strong></h3>
                        Tags:
                            <a href="#tag-RunService">RunService</a>
                </div>
                <div class="panel-body">
                    <section class="sw-operation-description">
                        
                    </section>
            
                        
                            <section class="sw-request-body">
                                
                                    <p><a href="#sw-default-consumes">Uses default content-types: </a>
                                    <span class="label label-default">application/json</span> 
                                    </p>
                                                <div class="row">
                                            <div class="col-md-6">
                                                <p></p>
                                            </div>
                                            <div class="col-md-6 sw-request-model">
                            <div  class="panel panel-definition">
                                <div class="panel-body">
                                            <a class="json-schema-ref" href="#/definitions/apiRun">apiRun</a>
                                </div>
                            </div></div>
                                        </div>
                            </section>        
                    
                        <section class="sw-responses">
                                <p><a href="#sw-default-produces">Uses default content-types: </a>
                                    <span class="label label-default">application/json</span> 
                                </p>
                            
                            <dl>
                                    <dt class="sw-response-200">
                                        200 OK
                                    
                                    </dt>
                                    <dd class="sw-response-200">
                                            <div class="row">
                                                <div class="col-md-12">
                                                    <p>A successful response.</p>
                                            
                                                </div>
                                            </div>
                                            <div class="row">
                                                
                                                <div class="col-md-6 sw-response-model">
                                                <div  class="panel panel-definition">
                                                    <div class="panel-body">
                                                                <a class="json-schema-ref" href="#/definitions/apiRunDetail">apiRunDetail</a>
                                                    </div>
                                                </div></div>
                                            
                                            </div>                </dd>
                                    <dt class="sw-response-default">
                                        default 
                                    
                                    </dt>
                                    <dd class="sw-response-default">
                                            <div class="row">
                                                <div class="col-md-12">
                                                    
                                                </div>
                                            </div>
                                            <div class="row">
                                                
                                                <div class="col-md-6 sw-response-model">
                                                <div  class="panel panel-definition">
                                                    <div class="panel-body">
                                                                <a class="json-schema-ref" href="#/definitions/apiStatus">apiStatus</a>
                                                    </div>
                                                </div></div>
                                            
                                            </div>                </dd>
                            </dl>
                        </section>
                </div>
            </div>
        
        <span id="path--apis-v1beta1-runs--id-"></span>
            <div id="operation--apis-v1beta1-runs--id--delete" class="swagger--panel-operation-delete panel">
                <div class="panel-heading">
                    <div class="operation-summary">Deletes a run.</div>
                    <h3 class="panel-title"><span class="operation-name">DELETE</span> <strong>/apis/v1beta1/runs/{id}</strong></h3>
                        Tags:
                            <a href="#tag-RunService">RunService</a>
                </div>
                <div class="panel-body">
                    <section class="sw-operation-description">
                        
                    </section>
            
                    
                        <section class="sw-request-params">
                            <table class="table">
                                <thead>
                                <tr>
                                    <th class="sw-param-name"></th>
                                    <th class="sw-param-description"></th>
                                    <th class="sw-param-type"></th>
                                    <th class="sw-param-data-type"></th>
                                    <th class="sw-param-annotation"></th>
                                </tr>
                                </thead>
                                <tbody>
                                        <tr>
                                            <td>
                                                id
                                            </td>
                                            <td><p>The ID of the run to be deleted.</p>
                                        </td>
                                            <td>path</td>
                                            <td>
                                        <span class="json-property-type">string</span>
                                        <span class="json-property-range" title="Value limits"></span>
                                        
                                            </td>
                                            <td>
                                                    <span class="json-property-required"></span>
                                            </td>
                                        </tr>
                                </tbody>
                            </table>
                        </section>
                    
                        <section class="sw-responses">
                                <p><a href="#sw-default-produces">Uses default content-types: </a>
                                    <span class="label label-default">application/json</span> 
                                </p>
                            
                            <dl>
                                    <dt class="sw-response-200">
                                        200 OK
                                    
                                    </dt>
                                    <dd class="sw-response-200">
                                            <div class="row">
                                                <div class="col-md-12">
                                                    <p>A successful response.</p>
                                            
                                                </div>
                                            </div>
                                            <div class="row">
                                                
                                                <div class="col-md-6 sw-response-model">
                                                <div  class="panel panel-definition">
                                                    <div class="panel-body">
                                                            
                                                                <section class="json-schema-properties">
                                                                    <dl>
                                                                    </dl>
                                                                </section>
                                                    </div>
                                                </div></div>
                                            
                                            </div>                </dd>
                                    <dt class="sw-response-default">
                                        default 
                                    
                                    </dt>
                                    <dd class="sw-response-default">
                                            <div class="row">
                                                <div class="col-md-12">
                                                    
                                                </div>
                                            </div>
                                            <div class="row">
                                                
                                                <div class="col-md-6 sw-response-model">
                                                <div  class="panel panel-definition">
                                                    <div class="panel-body">
                                                                <a class="json-schema-ref" href="#/definitions/apiStatus">apiStatus</a>
                                                    </div>
                                                </div></div>
                                            
                                            </div>                </dd>
                            </dl>
                        </section>
                </div>
            </div>
        
        <span id="path--apis-v1beta1-runs--id-:archive"></span>
            <div id="operation--apis-v1beta1-runs--id-:archive-post" class="swagger--panel-operation-post panel">
                <div class="panel-heading">
                    <div class="operation-summary">Archives a run.</div>
                    <h3 class="panel-title"><span class="operation-name">POST</span> <strong>/apis/v1beta1/runs/{id}:archive</strong></h3>
                        Tags:
                            <a href="#tag-RunService">RunService</a>
                </div>
                <div class="panel-body">
                    <section class="sw-operation-description">
                        
                    </section>
            
                    
                        <section class="sw-request-params">
                            <table class="table">
                                <thead>
                                <tr>
                                    <th class="sw-param-name"></th>
                                    <th class="sw-param-description"></th>
                                    <th class="sw-param-type"></th>
                                    <th class="sw-param-data-type"></th>
                                    <th class="sw-param-annotation"></th>
                                </tr>
                                </thead>
                                <tbody>
                                        <tr>
                                            <td>
                                                id
                                            </td>
                                            <td><p>The ID of the run to be archived.</p>
                                        </td>
                                            <td>path</td>
                                            <td>
                                        <span class="json-property-type">string</span>
                                        <span class="json-property-range" title="Value limits"></span>
                                        
                                            </td>
                                            <td>
                                                    <span class="json-property-required"></span>
                                            </td>
                                        </tr>
                                </tbody>
                            </table>
                        </section>
                    
                        <section class="sw-responses">
                                <p><a href="#sw-default-produces">Uses default content-types: </a>
                                    <span class="label label-default">application/json</span> 
                                </p>
                            
                            <dl>
                                    <dt class="sw-response-200">
                                        200 OK
                                    
                                    </dt>
                                    <dd class="sw-response-200">
                                            <div class="row">
                                                <div class="col-md-12">
                                                    <p>A successful response.</p>
                                            
                                                </div>
                                            </div>
                                            <div class="row">
                                                
                                                <div class="col-md-6 sw-response-model">
                                                <div  class="panel panel-definition">
                                                    <div class="panel-body">
                                                            
                                                                <section class="json-schema-properties">
                                                                    <dl>
                                                                    </dl>
                                                                </section>
                                                    </div>
                                                </div></div>
                                            
                                            </div>                </dd>
                                    <dt class="sw-response-default">
                                        default 
                                    
                                    </dt>
                                    <dd class="sw-response-default">
                                            <div class="row">
                                                <div class="col-md-12">
                                                    
                                                </div>
                                            </div>
                                            <div class="row">
                                                
                                                <div class="col-md-6 sw-response-model">
                                                <div  class="panel panel-definition">
                                                    <div class="panel-body">
                                                                <a class="json-schema-ref" href="#/definitions/apiStatus">apiStatus</a>
                                                    </div>
                                                </div></div>
                                            
                                            </div>                </dd>
                            </dl>
                        </section>
                </div>
            </div>
        
        <span id="path--apis-v1beta1-runs--id-:unarchive"></span>
            <div id="operation--apis-v1beta1-runs--id-:unarchive-post" class="swagger--panel-operation-post panel">
                <div class="panel-heading">
                    <div class="operation-summary">Restores an archived run.</div>
                    <h3 class="panel-title"><span class="operation-name">POST</span> <strong>/apis/v1beta1/runs/{id}:unarchive</strong></h3>
                        Tags:
                            <a href="#tag-RunService">RunService</a>
                </div>
                <div class="panel-body">
                    <section class="sw-operation-description">
                        
                    </section>
            
                    
                        <section class="sw-request-params">
                            <table class="table">
                                <thead>
                                <tr>
                                    <th class="sw-param-name"></th>
                                    <th class="sw-param-description"></th>
                                    <th class="sw-param-type"></th>
                                    <th class="sw-param-data-type"></th>
                                    <th class="sw-param-annotation"></th>
                                </tr>
                                </thead>
                                <tbody>
                                        <tr>
                                            <td>
                                                id
                                            </td>
                                            <td><p>The ID of the run to be restored.</p>
                                        </td>
                                            <td>path</td>
                                            <td>
                                        <span class="json-property-type">string</span>
                                        <span class="json-property-range" title="Value limits"></span>
                                        
                                            </td>
                                            <td>
                                                    <span class="json-property-required"></span>
                                            </td>
                                        </tr>
                                </tbody>
                            </table>
                        </section>
                    
                        <section class="sw-responses">
                                <p><a href="#sw-default-produces">Uses default content-types: </a>
                                    <span class="label label-default">application/json</span> 
                                </p>
                            
                            <dl>
                                    <dt class="sw-response-200">
                                        200 OK
                                    
                                    </dt>
                                    <dd class="sw-response-200">
                                            <div class="row">
                                                <div class="col-md-12">
                                                    <p>A successful response.</p>
                                            
                                                </div>
                                            </div>
                                            <div class="row">
                                                
                                                <div class="col-md-6 sw-response-model">
                                                <div  class="panel panel-definition">
                                                    <div class="panel-body">
                                                            
                                                                <section class="json-schema-properties">
                                                                    <dl>
                                                                    </dl>
                                                                </section>
                                                    </div>
                                                </div></div>
                                            
                                            </div>                </dd>
                                    <dt class="sw-response-default">
                                        default 
                                    
                                    </dt>
                                    <dd class="sw-response-default">
                                            <div class="row">
                                                <div class="col-md-12">
                                                    
                                                </div>
                                            </div>
                                            <div class="row">
                                                
                                                <div class="col-md-6 sw-response-model">
                                                <div  class="panel panel-definition">
                                                    <div class="panel-body">
                                                                <a class="json-schema-ref" href="#/definitions/apiStatus">apiStatus</a>
                                                    </div>
                                                </div></div>
                                            
                                            </div>                </dd>
                            </dl>
                        </section>
                </div>
            </div>
        
        <span id="path--apis-v1beta1-runs--run_id-"></span>
            <div id="operation--apis-v1beta1-runs--run_id--get" class="swagger--panel-operation-get panel">
                <div class="panel-heading">
                    <div class="operation-summary">Finds a specific run by ID.</div>
                    <h3 class="panel-title"><span class="operation-name">GET</span> <strong>/apis/v1beta1/runs/{run_id}</strong></h3>
                        Tags:
                            <a href="#tag-RunService">RunService</a>
                </div>
                <div class="panel-body">
                    <section class="sw-operation-description">
                        
                    </section>
            
                    
                        <section class="sw-request-params">
                            <table class="table">
                                <thead>
                                <tr>
                                    <th class="sw-param-name"></th>
                                    <th class="sw-param-description"></th>
                                    <th class="sw-param-type"></th>
                                    <th class="sw-param-data-type"></th>
                                    <th class="sw-param-annotation"></th>
                                </tr>
                                </thead>
                                <tbody>
                                        <tr>
                                            <td>
                                                run_id
                                            </td>
                                            <td><p>The ID of the run to be retrieved.</p>
                                        </td>
                                            <td>path</td>
                                            <td>
                                        <span class="json-property-type">string</span>
                                        <span class="json-property-range" title="Value limits"></span>
                                        
                                            </td>
                                            <td>
                                                    <span class="json-property-required"></span>
                                            </td>
                                        </tr>
                                </tbody>
                            </table>
                        </section>
                    
                        <section class="sw-responses">
                                <p><a href="#sw-default-produces">Uses default content-types: </a>
                                    <span class="label label-default">application/json</span> 
                                </p>
                            
                            <dl>
                                    <dt class="sw-response-200">
                                        200 OK
                                    
                                    </dt>
                                    <dd class="sw-response-200">
                                            <div class="row">
                                                <div class="col-md-12">
                                                    <p>A successful response.</p>
                                            
                                                </div>
                                            </div>
                                            <div class="row">
                                                
                                                <div class="col-md-6 sw-response-model">
                                                <div  class="panel panel-definition">
                                                    <div class="panel-body">
                                                                <a class="json-schema-ref" href="#/definitions/apiRunDetail">apiRunDetail</a>
                                                    </div>
                                                </div></div>
                                            
                                            </div>                </dd>
                                    <dt class="sw-response-default">
                                        default 
                                    
                                    </dt>
                                    <dd class="sw-response-default">
                                            <div class="row">
                                                <div class="col-md-12">
                                                    
                                                </div>
                                            </div>
                                            <div class="row">
                                                
                                                <div class="col-md-6 sw-response-model">
                                                <div  class="panel panel-definition">
                                                    <div class="panel-body">
                                                                <a class="json-schema-ref" href="#/definitions/apiStatus">apiStatus</a>
                                                    </div>
                                                </div></div>
                                            
                                            </div>                </dd>
                            </dl>
                        </section>
                </div>
            </div>
        
        <span id="path--apis-v1beta1-runs--run_id--nodes--node_id--artifacts--artifact_name-:read"></span>
            <div id="operation--apis-v1beta1-runs--run_id--nodes--node_id--artifacts--artifact_name-:read-get" class="swagger--panel-operation-get panel">
                <div class="panel-heading">
                    <div class="operation-summary">Finds a run&apos;s artifact data.</div>
                    <h3 class="panel-title"><span class="operation-name">GET</span> <strong>/apis/v1beta1/runs/{run_id}/nodes/{node_id}/artifacts/{artifact_name}:read</strong></h3>
                        Tags:
                            <a href="#tag-RunService">RunService</a>
                </div>
                <div class="panel-body">
                    <section class="sw-operation-description">
                        
                    </section>
            
                    
                        <section class="sw-request-params">
                            <table class="table">
                                <thead>
                                <tr>
                                    <th class="sw-param-name"></th>
                                    <th class="sw-param-description"></th>
                                    <th class="sw-param-type"></th>
                                    <th class="sw-param-data-type"></th>
                                    <th class="sw-param-annotation"></th>
                                </tr>
                                </thead>
                                <tbody>
                                        <tr>
                                            <td>
                                                run_id
                                            </td>
                                            <td><p>The ID of the run.</p>
                                        </td>
                                            <td>path</td>
                                            <td>
                                        <span class="json-property-type">string</span>
                                        <span class="json-property-range" title="Value limits"></span>
                                        
                                            </td>
                                            <td>
                                                    <span class="json-property-required"></span>
                                            </td>
                                        </tr>
                                        <tr>
                                            <td>
                                                node_id
                                            </td>
                                            <td><p>The ID of the running node.</p>
                                        </td>
                                            <td>path</td>
                                            <td>
                                        <span class="json-property-type">string</span>
                                        <span class="json-property-range" title="Value limits"></span>
                                        
                                            </td>
                                            <td>
                                                    <span class="json-property-required"></span>
                                            </td>
                                        </tr>
                                        <tr>
                                            <td>
                                                artifact_name
                                            </td>
                                            <td><p>The name of the artifact.</p>
                                        </td>
                                            <td>path</td>
                                            <td>
                                        <span class="json-property-type">string</span>
                                        <span class="json-property-range" title="Value limits"></span>
                                        
                                            </td>
                                            <td>
                                                    <span class="json-property-required"></span>
                                            </td>
                                        </tr>
                                </tbody>
                            </table>
                        </section>
                    
                        <section class="sw-responses">
                                <p><a href="#sw-default-produces">Uses default content-types: </a>
                                    <span class="label label-default">application/json</span> 
                                </p>
                            
                            <dl>
                                    <dt class="sw-response-200">
                                        200 OK
                                    
                                    </dt>
                                    <dd class="sw-response-200">
                                            <div class="row">
                                                <div class="col-md-12">
                                                    <p>A successful response.</p>
                                            
                                                </div>
                                            </div>
                                            <div class="row">
                                                
                                                <div class="col-md-6 sw-response-model">
                                                <div  class="panel panel-definition">
                                                    <div class="panel-body">
                                                                <a class="json-schema-ref" href="#/definitions/apiReadArtifactResponse">apiReadArtifactResponse</a>
                                                    </div>
                                                </div></div>
                                            
                                            </div>                </dd>
                                    <dt class="sw-response-default">
                                        default 
                                    
                                    </dt>
                                    <dd class="sw-response-default">
                                            <div class="row">
                                                <div class="col-md-12">
                                                    
                                                </div>
                                            </div>
                                            <div class="row">
                                                
                                                <div class="col-md-6 sw-response-model">
                                                <div  class="panel panel-definition">
                                                    <div class="panel-body">
                                                                <a class="json-schema-ref" href="#/definitions/apiStatus">apiStatus</a>
                                                    </div>
                                                </div></div>
                                            
                                            </div>                </dd>
                            </dl>
                        </section>
                </div>
            </div>
        
        <span id="path--apis-v1beta1-runs--run_id--retry"></span>
            <div id="operation--apis-v1beta1-runs--run_id--retry-post" class="swagger--panel-operation-post panel">
                <div class="panel-heading">
                    <div class="operation-summary">Re-initiates a failed or terminated run.</div>
                    <h3 class="panel-title"><span class="operation-name">POST</span> <strong>/apis/v1beta1/runs/{run_id}/retry</strong></h3>
                        Tags:
                            <a href="#tag-RunService">RunService</a>
                </div>
                <div class="panel-body">
                    <section class="sw-operation-description">
                        
                    </section>
            
                    
                        <section class="sw-request-params">
                            <table class="table">
                                <thead>
                                <tr>
                                    <th class="sw-param-name"></th>
                                    <th class="sw-param-description"></th>
                                    <th class="sw-param-type"></th>
                                    <th class="sw-param-data-type"></th>
                                    <th class="sw-param-annotation"></th>
                                </tr>
                                </thead>
                                <tbody>
                                        <tr>
                                            <td>
                                                run_id
                                            </td>
                                            <td><p>The ID of the run to be retried.</p>
                                        </td>
                                            <td>path</td>
                                            <td>
                                        <span class="json-property-type">string</span>
                                        <span class="json-property-range" title="Value limits"></span>
                                        
                                            </td>
                                            <td>
                                                    <span class="json-property-required"></span>
                                            </td>
                                        </tr>
                                </tbody>
                            </table>
                        </section>
                    
                        <section class="sw-responses">
                                <p><a href="#sw-default-produces">Uses default content-types: </a>
                                    <span class="label label-default">application/json</span> 
                                </p>
                            
                            <dl>
                                    <dt class="sw-response-200">
                                        200 OK
                                    
                                    </dt>
                                    <dd class="sw-response-200">
                                            <div class="row">
                                                <div class="col-md-12">
                                                    <p>A successful response.</p>
                                            
                                                </div>
                                            </div>
                                            <div class="row">
                                                
                                                <div class="col-md-6 sw-response-model">
                                                <div  class="panel panel-definition">
                                                    <div class="panel-body">
                                                            
                                                                <section class="json-schema-properties">
                                                                    <dl>
                                                                    </dl>
                                                                </section>
                                                    </div>
                                                </div></div>
                                            
                                            </div>                </dd>
                                    <dt class="sw-response-default">
                                        default 
                                    
                                    </dt>
                                    <dd class="sw-response-default">
                                            <div class="row">
                                                <div class="col-md-12">
                                                    
                                                </div>
                                            </div>
                                            <div class="row">
                                                
                                                <div class="col-md-6 sw-response-model">
                                                <div  class="panel panel-definition">
                                                    <div class="panel-body">
                                                                <a class="json-schema-ref" href="#/definitions/apiStatus">apiStatus</a>
                                                    </div>
                                                </div></div>
                                            
                                            </div>                </dd>
                            </dl>
                        </section>
                </div>
            </div>
        
        <span id="path--apis-v1beta1-runs--run_id--terminate"></span>
            <div id="operation--apis-v1beta1-runs--run_id--terminate-post" class="swagger--panel-operation-post panel">
                <div class="panel-heading">
                    <div class="operation-summary">Terminates an active run.</div>
                    <h3 class="panel-title"><span class="operation-name">POST</span> <strong>/apis/v1beta1/runs/{run_id}/terminate</strong></h3>
                        Tags:
                            <a href="#tag-RunService">RunService</a>
                </div>
                <div class="panel-body">
                    <section class="sw-operation-description">
                        
                    </section>
            
                    
                        <section class="sw-request-params">
                            <table class="table">
                                <thead>
                                <tr>
                                    <th class="sw-param-name"></th>
                                    <th class="sw-param-description"></th>
                                    <th class="sw-param-type"></th>
                                    <th class="sw-param-data-type"></th>
                                    <th class="sw-param-annotation"></th>
                                </tr>
                                </thead>
                                <tbody>
                                        <tr>
                                            <td>
                                                run_id
                                            </td>
                                            <td><p>The ID of the run to be terminated.</p>
                                        </td>
                                            <td>path</td>
                                            <td>
                                        <span class="json-property-type">string</span>
                                        <span class="json-property-range" title="Value limits"></span>
                                        
                                            </td>
                                            <td>
                                                    <span class="json-property-required"></span>
                                            </td>
                                        </tr>
                                </tbody>
                            </table>
                        </section>
                    
                        <section class="sw-responses">
                                <p><a href="#sw-default-produces">Uses default content-types: </a>
                                    <span class="label label-default">application/json</span> 
                                </p>
                            
                            <dl>
                                    <dt class="sw-response-200">
                                        200 OK
                                    
                                    </dt>
                                    <dd class="sw-response-200">
                                            <div class="row">
                                                <div class="col-md-12">
                                                    <p>A successful response.</p>
                                            
                                                </div>
                                            </div>
                                            <div class="row">
                                                
                                                <div class="col-md-6 sw-response-model">
                                                <div  class="panel panel-definition">
                                                    <div class="panel-body">
                                                            
                                                                <section class="json-schema-properties">
                                                                    <dl>
                                                                    </dl>
                                                                </section>
                                                    </div>
                                                </div></div>
                                            
                                            </div>                </dd>
                                    <dt class="sw-response-default">
                                        default 
                                    
                                    </dt>
                                    <dd class="sw-response-default">
                                            <div class="row">
                                                <div class="col-md-12">
                                                    
                                                </div>
                                            </div>
                                            <div class="row">
                                                
                                                <div class="col-md-6 sw-response-model">
                                                <div  class="panel panel-definition">
                                                    <div class="panel-body">
                                                                <a class="json-schema-ref" href="#/definitions/apiStatus">apiStatus</a>
                                                    </div>
                                                </div></div>
                                            
                                            </div>                </dd>
                            </dl>
                        </section>
                </div>
            </div>
        
        <span id="path--apis-v1beta1-runs--run_id-:reportMetrics"></span>
            <div id="operation--apis-v1beta1-runs--run_id-:reportMetrics-post" class="swagger--panel-operation-post panel">
                <div class="panel-heading">
                    <div class="operation-summary">ReportRunMetrics reports metrics of a run. Each metric is reported in its
            own transaction, so this API accepts partial failures. Metric can be
            uniquely identified by (run_id, node_id, name). Duplicate reporting will be
            ignored by the API. First reporting wins.</div>
                    <h3 class="panel-title"><span class="operation-name">POST</span> <strong>/apis/v1beta1/runs/{run_id}:reportMetrics</strong></h3>
                        Tags:
                            <a href="#tag-RunService">RunService</a>
                </div>
                <div class="panel-body">
                    <section class="sw-operation-description">
                        
                    </section>
            
                        
                            <section class="sw-request-body">
                                
                                    <p><a href="#sw-default-consumes">Uses default content-types: </a>
                                    <span class="label label-default">application/json</span> 
                                    </p>
                                                <div class="row">
                                            <div class="col-md-6">
                                                <p></p>
                                            </div>
                                            <div class="col-md-6 sw-request-model">
                            <div  class="panel panel-definition">
                                <div class="panel-body">
                                            <a class="json-schema-ref" href="#/definitions/apiReportRunMetricsRequest">apiReportRunMetricsRequest</a>
                                </div>
                            </div></div>
                                        </div>
                            </section>        
                        <section class="sw-request-params">
                            <table class="table">
                                <thead>
                                <tr>
                                    <th class="sw-param-name"></th>
                                    <th class="sw-param-description"></th>
                                    <th class="sw-param-type"></th>
                                    <th class="sw-param-data-type"></th>
                                    <th class="sw-param-annotation"></th>
                                </tr>
                                </thead>
                                <tbody>
                                        <tr>
                                            <td>
                                                run_id
                                            </td>
                                            <td><p>Required. The parent run ID of the metric.</p>
                                        </td>
                                            <td>path</td>
                                            <td>
                                        <span class="json-property-type">string</span>
                                        <span class="json-property-range" title="Value limits"></span>
                                        
                                            </td>
                                            <td>
                                                    <span class="json-property-required"></span>
                                            </td>
                                        </tr>
                                </tbody>
                            </table>
                        </section>
                    
                        <section class="sw-responses">
                                <p><a href="#sw-default-produces">Uses default content-types: </a>
                                    <span class="label label-default">application/json</span> 
                                </p>
                            
                            <dl>
                                    <dt class="sw-response-200">
                                        200 OK
                                    
                                    </dt>
                                    <dd class="sw-response-200">
                                            <div class="row">
                                                <div class="col-md-12">
                                                    <p>A successful response.</p>
                                            
                                                </div>
                                            </div>
                                            <div class="row">
                                                
                                                <div class="col-md-6 sw-response-model">
                                                <div  class="panel panel-definition">
                                                    <div class="panel-body">
                                                                <a class="json-schema-ref" href="#/definitions/apiReportRunMetricsResponse">apiReportRunMetricsResponse</a>
                                                    </div>
                                                </div></div>
                                            
                                            </div>                </dd>
                                    <dt class="sw-response-default">
                                        default 
                                    
                                    </dt>
                                    <dd class="sw-response-default">
                                            <div class="row">
                                                <div class="col-md-12">
                                                    
                                                </div>
                                            </div>
                                            <div class="row">
                                                
                                                <div class="col-md-6 sw-response-model">
                                                <div  class="panel panel-definition">
                                                    <div class="panel-body">
                                                                <a class="json-schema-ref" href="#/definitions/apiStatus">apiStatus</a>
                                                    </div>
                                                </div></div>
                                            
                                            </div>                </dd>
                            </dl>
                        </section>
                </div>
            </div>
    
     
    
                       
        <h2>Schema definitions</h2>
    
            
                <div id="definition-apiCronSchedule" class="panel panel-definition">
                        <div class="panel-heading">
                                <h3 class="panel-title"><a name="/definitions/apiCronSchedule"></a>apiCronSchedule:
                                    <span class="json-property-type">
                <span class="json-property-type">object</span>
                <span class="json-property-range" title="Value limits"></span>
                
                </span>
                                </h3>
                        </div>
                    <div class="panel-body">
                            
                                    <section class="json-schema-properties">
                                        <dl>
                                                <dt data-property-name="start_time">
                                                    <span class="json-property-name">start_time:</span>
                                                    
                                                    <span class="json-property-type">string</span>    <span class="json-property-format">(date-time)</span>
                                                    <span class="json-property-range" title="Value limits"></span>
                                                    
                                                </dt>
                                                <dd>
                                                    
                                                    <div class="json-inner-schema">
                                                        
                                                    </div>
                                                </dd>
                                                <dt data-property-name="end_time">
                                                    <span class="json-property-name">end_time:</span>
                                                    
                                                    <span class="json-property-type">string</span>    <span class="json-property-format">(date-time)</span>
                                                    <span class="json-property-range" title="Value limits"></span>
                                                    
                                                </dt>
                                                <dd>
                                                    
                                                    <div class="json-inner-schema">
                                                        
                                                    </div>
                                                </dd>
                                                <dt data-property-name="cron">
                                                    <span class="json-property-name">cron:</span>
                                                    
                                                    <span class="json-property-type">string</span>
                                                    <span class="json-property-range" title="Value limits"></span>
                                                    
                                                </dt>
                                                <dd>
                                                    
                                                    <div class="json-inner-schema">
                                                        
                                                    </div>
                                                </dd>
                                        </dl>
                                    </section>
                    </div>
                </div>        
                <div id="definition-apiExperiment" class="panel panel-definition">
                        <div class="panel-heading">
                                <h3 class="panel-title"><a name="/definitions/apiExperiment"></a>apiExperiment:
                                    <span class="json-property-type">
                <span class="json-property-type">object</span>
                <span class="json-property-range" title="Value limits"></span>
                
                </span>
                                </h3>
                        </div>
                    <div class="panel-body">
                            
                                    <section class="json-schema-properties">
                                        <dl>
                                                <dt data-property-name="id">
                                                    <span class="json-property-name">id:</span>
                                                    
                                                    <span class="json-property-type">string</span>
                                                    <span class="json-property-range" title="Value limits"></span>
                                                    
                                                </dt>
                                                <dd>
                                                    <p>Output. Unique experiment ID. Generated by API server.</p>
                                    
                                                    <div class="json-inner-schema">
                                                        
                                                    </div>
                                                </dd>
                                                <dt data-property-name="name">
                                                    <span class="json-property-name">name:</span>
                                                    
                                                    <span class="json-property-type">string</span>
                                                    <span class="json-property-range" title="Value limits"></span>
                                                    
                                                </dt>
                                                <dd>
                                                    <p>Required input field. Unique experiment name provided by user.</p>
                                    
                                                    <div class="json-inner-schema">
                                                        
                                                    </div>
                                                </dd>
                                                <dt data-property-name="description">
                                                    <span class="json-property-name">description:</span>
                                                    
                                                    <span class="json-property-type">string</span>
                                                    <span class="json-property-range" title="Value limits"></span>
                                                    
                                                </dt>
                                                <dd>
                                                    
                                                    <div class="json-inner-schema">
                                                        
                                                    </div>
                                                </dd>
                                                <dt data-property-name="created_at">
                                                    <span class="json-property-name">created_at:</span>
                                                    
                                                    <span class="json-property-type">string</span>    <span class="json-property-format">(date-time)</span>
                                                    <span class="json-property-range" title="Value limits"></span>
                                                    
                                                </dt>
                                                <dd>
                                                    <p>Output. The time that the experiment created.</p>
                                    
                                                    <div class="json-inner-schema">
                                                        
                                                    </div>
                                                </dd>
                                                <dt data-property-name="resource_references">
                                                    <span class="json-property-name">resource_references:</span>
                                                    
                                                    <span class="json-property-type">object[]</span>
                                                    <span class="json-property-range" title="Value limits"></span>
                                                    
                                                </dt>
                                                <dd>
                                                    <p>Optional input field. Specify which resource this run belongs to.
                                    For Experiment, the only valid resource reference is a single Namespace.</p>
                                    
                                                    <div class="json-inner-schema">
                                                        
                                                                        <section class="json-schema-array-items">
                                                                            
                                                                            <span class="json-property-type">    <a class="json-schema-ref" href="#/definitions/apiResourceReference">apiResourceReference</a>
                                                                            </span>
                                                                            <span class="json-property-range" title="Value limits"></span>
                                                                            
                                                                            <div class="json-inner-schema">
                                                                                
                                                                            </div>
                                                                        </section>                </div>
                                                </dd>
                                                <dt data-property-name="storage_state">
                                                    <span class="json-property-name">storage_state:</span>
                                                    
                                                    <span class="json-property-type">    <a class="json-schema-ref" href="#/definitions/apiExperimentStorageState">apiExperimentStorageState</a>
                                                    </span>
                                                    <span class="json-property-range" title="Value limits"></span>
                                                    
                                                </dt>
                                                <dd>
                                                    <p>Output. Specifies whether this experiment is in archived or available state.</p>
                                    
                                                    <div class="json-inner-schema">
                                                        
                                                    </div>
                                                </dd>
                                        </dl>
                                    </section>
                    </div>
                </div>        
                <div id="definition-apiExperimentStorageState" class="panel panel-definition">
                        <div class="panel-heading">
                                <h3 class="panel-title"><a name="/definitions/apiExperimentStorageState"></a>apiExperimentStorageState:
                                    <span class="json-property-type">
                <span class="json-property-type">string</span>    <span class="json-property-enum" title="Possible values">, x &isin; {
                                <span class="json-property-enum-item">STORAGESTATE_UNSPECIFIED</span>
                                (default)
                            ,
                                <span class="json-property-enum-item">STORAGESTATE_AVAILABLE</span>
                            ,
                                <span class="json-property-enum-item">STORAGESTATE_ARCHIVED</span>
                            
                        }
                        </span>
                <span class="json-property-range" title="Value limits"></span>
                
                </span>
                                </h3>
                        </div>
                    <div class="panel-body">
                            
                    </div>
                </div>        
                <div id="definition-apiGetHealthzResponse" class="panel panel-definition">
                        <div class="panel-heading">
                                <h3 class="panel-title"><a name="/definitions/apiGetHealthzResponse"></a>apiGetHealthzResponse:
                                    <span class="json-property-type">
                <span class="json-property-type">object</span>
                <span class="json-property-range" title="Value limits"></span>
                
                </span>
                                </h3>
                        </div>
                    <div class="panel-body">
                            
                                    <section class="json-schema-properties">
                                        <dl>
                                                <dt data-property-name="multi_user">
                                                    <span class="json-property-name">multi_user:</span>
                                                    
                                                    <span class="json-property-type">boolean</span>    <span class="json-property-format">(boolean)</span>
                                                    <span class="json-property-range" title="Value limits"></span>
                                                    
                                                </dt>
                                                <dd>
                                                    
                                                    <div class="json-inner-schema">
                                                        
                                                    </div>
                                                </dd>
                                        </dl>
                                    </section>
                    </div>
                </div>        
                <div id="definition-apiGetTemplateResponse" class="panel panel-definition">
                        <div class="panel-heading">
                                <h3 class="panel-title"><a name="/definitions/apiGetTemplateResponse"></a>apiGetTemplateResponse:
                                    <span class="json-property-type">
                <span class="json-property-type">object</span>
                <span class="json-property-range" title="Value limits"></span>
                
                </span>
                                </h3>
                        </div>
                    <div class="panel-body">
                            
                                    <section class="json-schema-properties">
                                        <dl>
                                                <dt data-property-name="template">
                                                    <span class="json-property-name">template:</span>
                                                    
                                                    <span class="json-property-type">string</span>
                                                    <span class="json-property-range" title="Value limits"></span>
                                                    
                                                </dt>
                                                <dd>
                                                    <p>The template of the pipeline specified in a GetTemplate request, or of a
                                    pipeline version specified in a GetPipelinesVersionTemplate request.</p>
                                    
                                                    <div class="json-inner-schema">
                                                        
                                                    </div>
                                                </dd>
                                        </dl>
                                    </section>
                    </div>
                </div>        
                <div id="definition-apiJob" class="panel panel-definition">
                        <div class="panel-heading">
                                <h3 class="panel-title"><a name="/definitions/apiJob"></a>apiJob:
                                    <span class="json-property-type">
                <span class="json-property-type">object</span>
                <span class="json-property-range" title="Value limits"></span>
                
                </span>
                                </h3>
                        </div>
                    <div class="panel-body">
                            
                                    <section class="json-schema-properties">
                                        <dl>
                                                <dt data-property-name="id">
                                                    <span class="json-property-name">id:</span>
                                                    
                                                    <span class="json-property-type">string</span>
                                                    <span class="json-property-range" title="Value limits"></span>
                                                    
                                                </dt>
                                                <dd>
                                                    <p>Output. Unique run ID. Generated by API server.</p>
                                    
                                                    <div class="json-inner-schema">
                                                        
                                                    </div>
                                                </dd>
                                                <dt data-property-name="name">
                                                    <span class="json-property-name">name:</span>
                                                    
                                                    <span class="json-property-type">string</span>
                                                    <span class="json-property-range" title="Value limits"></span>
                                                    
                                                </dt>
                                                <dd>
                                                    <p>Required input field. Job name provided by user. Not unique.</p>
                                    
                                                    <div class="json-inner-schema">
                                                        
                                                    </div>
                                                </dd>
                                                <dt data-property-name="description">
                                                    <span class="json-property-name">description:</span>
                                                    
                                                    <span class="json-property-type">string</span>
                                                    <span class="json-property-range" title="Value limits"></span>
                                                    
                                                </dt>
                                                <dd>
                                                    
                                                    <div class="json-inner-schema">
                                                        
                                                    </div>
                                                </dd>
                                                <dt data-property-name="pipeline_spec">
                                                    <span class="json-property-name">pipeline_spec:</span>
                                                    
                                                    <span class="json-property-type">    <a class="json-schema-ref" href="#/definitions/apiPipelineSpec">apiPipelineSpec</a>
                                                    </span>
                                                    <span class="json-property-range" title="Value limits"></span>
                                                    
                                                </dt>
                                                <dd>
                                                    <p>Required input field.
                                    Describing what the pipeline manifest and parameters to use
                                    for the scheduled job.</p>
                                    
                                                    <div class="json-inner-schema">
                                                        
                                                    </div>
                                                </dd>
                                                <dt data-property-name="resource_references">
                                                    <span class="json-property-name">resource_references:</span>
                                                    
                                                    <span class="json-property-type">object[]</span>
                                                    <span class="json-property-range" title="Value limits"></span>
                                                    
                                                </dt>
                                                <dd>
                                                    <p>Optional input field. Specify which resource this job belongs to.</p>
                                    
                                                    <div class="json-inner-schema">
                                                        
                                                                        <section class="json-schema-array-items">
                                                                            
                                                                            <span class="json-property-type">    <a class="json-schema-ref" href="#/definitions/apiResourceReference">apiResourceReference</a>
                                                                            </span>
                                                                            <span class="json-property-range" title="Value limits"></span>
                                                                            
                                                                            <div class="json-inner-schema">
                                                                                
                                                                            </div>
                                                                        </section>                </div>
                                                </dd>
                                                <dt data-property-name="service_account">
                                                    <span class="json-property-name">service_account:</span>
                                                    
                                                    <span class="json-property-type">string</span>
                                                    <span class="json-property-range" title="Value limits"></span>
                                                    
                                                </dt>
                                                <dd>
                                                    <p>Optional input field. Specify which Kubernetes service account this job uses.</p>
                                    
                                                    <div class="json-inner-schema">
                                                        
                                                    </div>
                                                </dd>
                                                <dt data-property-name="max_concurrency">
                                                    <span class="json-property-name">max_concurrency:</span>
                                                    
                                                    <span class="json-property-type">string</span>    <span class="json-property-format">(int64)</span>
                                                    <span class="json-property-range" title="Value limits"></span>
                                                    
                                                </dt>
                                                <dd>
                                                    
                                                    <div class="json-inner-schema">
                                                        
                                                    </div>
                                                </dd>
                                                <dt data-property-name="trigger">
                                                    <span class="json-property-name">trigger:</span>
                                                    
                                                    <span class="json-property-type">    <a class="json-schema-ref" href="#/definitions/apiTrigger">apiTrigger</a>
                                                    </span>
                                                    <span class="json-property-range" title="Value limits"></span>
                                                    
                                                </dt>
                                                <dd>
                                                    <p>Required input field.
                                    Specify how a run is triggered. Support cron mode or periodic mode.</p>
                                    
                                                    <div class="json-inner-schema">
                                                        
                                                    </div>
                                                </dd>
                                                <dt data-property-name="mode">
                                                    <span class="json-property-name">mode:</span>
                                                    
                                                    <span class="json-property-type">    <a class="json-schema-ref" href="#/definitions/JobMode">JobMode</a>
                                                    </span>
                                                    <span class="json-property-range" title="Value limits"></span>
                                                    
                                                </dt>
                                                <dd>
                                                    
                                                    <div class="json-inner-schema">
                                                        
                                                    </div>
                                                </dd>
                                                <dt data-property-name="created_at">
                                                    <span class="json-property-name">created_at:</span>
                                                    
                                                    <span class="json-property-type">string</span>    <span class="json-property-format">(date-time)</span>
                                                    <span class="json-property-range" title="Value limits"></span>
                                                    
                                                </dt>
                                                <dd>
                                                    <p>Output. The time this job is created.</p>
                                    
                                                    <div class="json-inner-schema">
                                                        
                                                    </div>
                                                </dd>
                                                <dt data-property-name="updated_at">
                                                    <span class="json-property-name">updated_at:</span>
                                                    
                                                    <span class="json-property-type">string</span>    <span class="json-property-format">(date-time)</span>
                                                    <span class="json-property-range" title="Value limits"></span>
                                                    
                                                </dt>
                                                <dd>
                                                    <p>Output. The last time this job is updated.</p>
                                    
                                                    <div class="json-inner-schema">
                                                        
                                                    </div>
                                                </dd>
                                                <dt data-property-name="status">
                                                    <span class="json-property-name">status:</span>
                                                    
                                                    <span class="json-property-type">string</span>
                                                    <span class="json-property-range" title="Value limits"></span>
                                                    
                                                </dt>
                                                <dd>
                                                    
                                                    <div class="json-inner-schema">
                                                        
                                                    </div>
                                                </dd>
                                                <dt data-property-name="error">
                                                    <span class="json-property-name">error:</span>
                                                    
                                                    <span class="json-property-type">string</span>
                                                    <span class="json-property-range" title="Value limits"></span>
                                                    
                                                </dt>
                                                <dd>
                                                    <p>In case any error happens retrieving a job field, only job ID
                                    and the error message is returned. Client has the flexibility of choosing
                                    how to handle error. This is especially useful during listing call.</p>
                                    
                                                    <div class="json-inner-schema">
                                                        
                                                    </div>
                                                </dd>
                                                <dt data-property-name="enabled">
                                                    <span class="json-property-name">enabled:</span>
                                                    
                                                    <span class="json-property-type">boolean</span>    <span class="json-property-format">(boolean)</span>
                                                    <span class="json-property-range" title="Value limits"></span>
                                                    
                                                </dt>
                                                <dd>
                                                    <p>Input. Whether the job is enabled or not.</p>
                                    
                                                    <div class="json-inner-schema">
                                                        
                                                    </div>
                                                </dd>
                                                <dt data-property-name="no_catchup">
                                                    <span class="json-property-name">no_catchup:</span>
                                                    
                                                    <span class="json-property-type">boolean</span>    <span class="json-property-format">(boolean)</span>
                                                    <span class="json-property-range" title="Value limits"></span>
                                                    
                                                </dt>
                                                <dd>
                                                    <p>Optional input field. Whether the job should catch up if behind schedule.
                                    If true, the job will only schedule the latest interval if behind schedule.
                                    If false, the job will catch up on each past interval.</p>
                                    
                                                    <div class="json-inner-schema">
                                                        
                                                    </div>
                                                </dd>
                                        </dl>
                                    </section>
                    </div>
                </div>        
                <div id="definition-apiListExperimentsResponse" class="panel panel-definition">
                        <div class="panel-heading">
                                <h3 class="panel-title"><a name="/definitions/apiListExperimentsResponse"></a>apiListExperimentsResponse:
                                    <span class="json-property-type">
                <span class="json-property-type">object</span>
                <span class="json-property-range" title="Value limits"></span>
                
                </span>
                                </h3>
                        </div>
                    <div class="panel-body">
                            
                                    <section class="json-schema-properties">
                                        <dl>
                                                <dt data-property-name="experiments">
                                                    <span class="json-property-name">experiments:</span>
                                                    
                                                    <span class="json-property-type">object[]</span>
                                                    <span class="json-property-range" title="Value limits"></span>
                                                    
                                                </dt>
                                                <dd>
                                                    <p>A list of experiments returned.</p>
                                    
                                                    <div class="json-inner-schema">
                                                        
                                                                        <section class="json-schema-array-items">
                                                                            
                                                                            <span class="json-property-type">    <a class="json-schema-ref" href="#/definitions/apiExperiment">apiExperiment</a>
                                                                            </span>
                                                                            <span class="json-property-range" title="Value limits"></span>
                                                                            
                                                                            <div class="json-inner-schema">
                                                                                
                                                                            </div>
                                                                        </section>                </div>
                                                </dd>
                                                <dt data-property-name="total_size">
                                                    <span class="json-property-name">total_size:</span>
                                                    
                                                    <span class="json-property-type">integer</span>    <span class="json-property-format">(int32)</span>
                                                    <span class="json-property-range" title="Value limits"></span>
                                                    
                                                </dt>
                                                <dd>
                                                    <p>The total number of experiments for the given query.</p>
                                    
                                                    <div class="json-inner-schema">
                                                        
                                                    </div>
                                                </dd>
                                                <dt data-property-name="next_page_token">
                                                    <span class="json-property-name">next_page_token:</span>
                                                    
                                                    <span class="json-property-type">string</span>
                                                    <span class="json-property-range" title="Value limits"></span>
                                                    
                                                </dt>
                                                <dd>
                                                    <p>The token to list the next page of experiments.</p>
                                    
                                                    <div class="json-inner-schema">
                                                        
                                                    </div>
                                                </dd>
                                        </dl>
                                    </section>
                    </div>
                </div>        
                <div id="definition-apiListJobsResponse" class="panel panel-definition">
                        <div class="panel-heading">
                                <h3 class="panel-title"><a name="/definitions/apiListJobsResponse"></a>apiListJobsResponse:
                                    <span class="json-property-type">
                <span class="json-property-type">object</span>
                <span class="json-property-range" title="Value limits"></span>
                
                </span>
                                </h3>
                        </div>
                    <div class="panel-body">
                            
                                    <section class="json-schema-properties">
                                        <dl>
                                                <dt data-property-name="jobs">
                                                    <span class="json-property-name">jobs:</span>
                                                    
                                                    <span class="json-property-type">object[]</span>
                                                    <span class="json-property-range" title="Value limits"></span>
                                                    
                                                </dt>
                                                <dd>
                                                    <p>A list of jobs returned.</p>
                                    
                                                    <div class="json-inner-schema">
                                                        
                                                                        <section class="json-schema-array-items">
                                                                            
                                                                            <span class="json-property-type">    <a class="json-schema-ref" href="#/definitions/apiJob">apiJob</a>
                                                                            </span>
                                                                            <span class="json-property-range" title="Value limits"></span>
                                                                            
                                                                            <div class="json-inner-schema">
                                                                                
                                                                            </div>
                                                                        </section>                </div>
                                                </dd>
                                                <dt data-property-name="total_size">
                                                    <span class="json-property-name">total_size:</span>
                                                    
                                                    <span class="json-property-type">integer</span>    <span class="json-property-format">(int32)</span>
                                                    <span class="json-property-range" title="Value limits"></span>
                                                    
                                                </dt>
                                                <dd>
                                                    <p>The total number of jobs for the given query.</p>
                                    
                                                    <div class="json-inner-schema">
                                                        
                                                    </div>
                                                </dd>
                                                <dt data-property-name="next_page_token">
                                                    <span class="json-property-name">next_page_token:</span>
                                                    
                                                    <span class="json-property-type">string</span>
                                                    <span class="json-property-range" title="Value limits"></span>
                                                    
                                                </dt>
                                                <dd>
                                                    <p>The token to list the next page of jobs.</p>
                                    
                                                    <div class="json-inner-schema">
                                                        
                                                    </div>
                                                </dd>
                                        </dl>
                                    </section>
                    </div>
                </div>        
                <div id="definition-apiListPipelinesResponse" class="panel panel-definition">
                        <div class="panel-heading">
                                <h3 class="panel-title"><a name="/definitions/apiListPipelinesResponse"></a>apiListPipelinesResponse:
                                    <span class="json-property-type">
                <span class="json-property-type">object</span>
                <span class="json-property-range" title="Value limits"></span>
                
                </span>
                                </h3>
                        </div>
                    <div class="panel-body">
                            
                                    <section class="json-schema-properties">
                                        <dl>
                                                <dt data-property-name="pipelines">
                                                    <span class="json-property-name">pipelines:</span>
                                                    
                                                    <span class="json-property-type">object[]</span>
                                                    <span class="json-property-range" title="Value limits"></span>
                                                    
                                                </dt>
                                                <dd>
                                                    
                                                    <div class="json-inner-schema">
                                                        
                                                                        <section class="json-schema-array-items">
                                                                            
                                                                            <span class="json-property-type">    <a class="json-schema-ref" href="#/definitions/apiPipeline">apiPipeline</a>
                                                                            </span>
                                                                            <span class="json-property-range" title="Value limits"></span>
                                                                            
                                                                            <div class="json-inner-schema">
                                                                                
                                                                            </div>
                                                                        </section>                </div>
                                                </dd>
                                                <dt data-property-name="total_size">
                                                    <span class="json-property-name">total_size:</span>
                                                    
                                                    <span class="json-property-type">integer</span>    <span class="json-property-format">(int32)</span>
                                                    <span class="json-property-range" title="Value limits"></span>
                                                    
                                                </dt>
                                                <dd>
                                                    <p>The total number of pipelines for the given query.</p>
                                    
                                                    <div class="json-inner-schema">
                                                        
                                                    </div>
                                                </dd>
                                                <dt data-property-name="next_page_token">
                                                    <span class="json-property-name">next_page_token:</span>
                                                    
                                                    <span class="json-property-type">string</span>
                                                    <span class="json-property-range" title="Value limits"></span>
                                                    
                                                </dt>
                                                <dd>
                                                    <p>The token to list the next page of pipelines.</p>
                                    
                                                    <div class="json-inner-schema">
                                                        
                                                    </div>
                                                </dd>
                                        </dl>
                                    </section>
                    </div>
                </div>        
                <div id="definition-apiListPipelineVersionsResponse" class="panel panel-definition">
                        <div class="panel-heading">
                                <h3 class="panel-title"><a name="/definitions/apiListPipelineVersionsResponse"></a>apiListPipelineVersionsResponse:
                                    <span class="json-property-type">
                <span class="json-property-type">object</span>
                <span class="json-property-range" title="Value limits"></span>
                
                </span>
                                </h3>
                        </div>
                    <div class="panel-body">
                            
                                    <section class="json-schema-properties">
                                        <dl>
                                                <dt data-property-name="versions">
                                                    <span class="json-property-name">versions:</span>
                                                    
                                                    <span class="json-property-type">object[]</span>
                                                    <span class="json-property-range" title="Value limits"></span>
                                                    
                                                </dt>
                                                <dd>
                                                    
                                                    <div class="json-inner-schema">
                                                        
                                                                        <section class="json-schema-array-items">
                                                                            
                                                                            <span class="json-property-type">    <a class="json-schema-ref" href="#/definitions/apiPipelineVersion">apiPipelineVersion</a>
                                                                            </span>
                                                                            <span class="json-property-range" title="Value limits"></span>
                                                                            
                                                                            <div class="json-inner-schema">
                                                                                
                                                                            </div>
                                                                        </section>                </div>
                                                </dd>
                                                <dt data-property-name="next_page_token">
                                                    <span class="json-property-name">next_page_token:</span>
                                                    
                                                    <span class="json-property-type">string</span>
                                                    <span class="json-property-range" title="Value limits"></span>
                                                    
                                                </dt>
                                                <dd>
                                                    <p>The token to list the next page of pipeline versions.</p>
                                    
                                                    <div class="json-inner-schema">
                                                        
                                                    </div>
                                                </dd>
                                                <dt data-property-name="total_size">
                                                    <span class="json-property-name">total_size:</span>
                                                    
                                                    <span class="json-property-type">integer</span>    <span class="json-property-format">(int32)</span>
                                                    <span class="json-property-range" title="Value limits"></span>
                                                    
                                                </dt>
                                                <dd>
                                                    <p>The total number of pipeline versions for the given query.</p>
                                    
                                                    <div class="json-inner-schema">
                                                        
                                                    </div>
                                                </dd>
                                        </dl>
                                    </section>
                    </div>
                </div>        
                <div id="definition-apiListRunsResponse" class="panel panel-definition">
                        <div class="panel-heading">
                                <h3 class="panel-title"><a name="/definitions/apiListRunsResponse"></a>apiListRunsResponse:
                                    <span class="json-property-type">
                <span class="json-property-type">object</span>
                <span class="json-property-range" title="Value limits"></span>
                
                </span>
                                </h3>
                        </div>
                    <div class="panel-body">
                            
                                    <section class="json-schema-properties">
                                        <dl>
                                                <dt data-property-name="runs">
                                                    <span class="json-property-name">runs:</span>
                                                    
                                                    <span class="json-property-type">object[]</span>
                                                    <span class="json-property-range" title="Value limits"></span>
                                                    
                                                </dt>
                                                <dd>
                                                    
                                                    <div class="json-inner-schema">
                                                        
                                                                        <section class="json-schema-array-items">
                                                                            
                                                                            <span class="json-property-type">    <a class="json-schema-ref" href="#/definitions/apiRun">apiRun</a>
                                                                            </span>
                                                                            <span class="json-property-range" title="Value limits"></span>
                                                                            
                                                                            <div class="json-inner-schema">
                                                                                
                                                                            </div>
                                                                        </section>                </div>
                                                </dd>
                                                <dt data-property-name="total_size">
                                                    <span class="json-property-name">total_size:</span>
                                                    
                                                    <span class="json-property-type">integer</span>    <span class="json-property-format">(int32)</span>
                                                    <span class="json-property-range" title="Value limits"></span>
                                                    
                                                </dt>
                                                <dd>
                                                    <p>The total number of runs for the given query.</p>
                                    
                                                    <div class="json-inner-schema">
                                                        
                                                    </div>
                                                </dd>
                                                <dt data-property-name="next_page_token">
                                                    <span class="json-property-name">next_page_token:</span>
                                                    
                                                    <span class="json-property-type">string</span>
                                                    <span class="json-property-range" title="Value limits"></span>
                                                    
                                                </dt>
                                                <dd>
                                                    <p>The token to list the next page of runs.</p>
                                    
                                                    <div class="json-inner-schema">
                                                        
                                                    </div>
                                                </dd>
                                        </dl>
                                    </section>
                    </div>
                </div>        
                <div id="definition-apiParameter" class="panel panel-definition">
                        <div class="panel-heading">
                                <h3 class="panel-title"><a name="/definitions/apiParameter"></a>apiParameter:
                                    <span class="json-property-type">
                <span class="json-property-type">object</span>
                <span class="json-property-range" title="Value limits"></span>
                
                </span>
                                </h3>
                        </div>
                    <div class="panel-body">
                            
                                    <section class="json-schema-properties">
                                        <dl>
                                                <dt data-property-name="name">
                                                    <span class="json-property-name">name:</span>
                                                    
                                                    <span class="json-property-type">string</span>
                                                    <span class="json-property-range" title="Value limits"></span>
                                                    
                                                </dt>
                                                <dd>
                                                    
                                                    <div class="json-inner-schema">
                                                        
                                                    </div>
                                                </dd>
                                                <dt data-property-name="value">
                                                    <span class="json-property-name">value:</span>
                                                    
                                                    <span class="json-property-type">string</span>
                                                    <span class="json-property-range" title="Value limits"></span>
                                                    
                                                </dt>
                                                <dd>
                                                    
                                                    <div class="json-inner-schema">
                                                        
                                                    </div>
                                                </dd>
                                        </dl>
                                    </section>
                    </div>
                </div>        
                <div id="definition-apiPeriodicSchedule" class="panel panel-definition">
                        <div class="panel-heading">
                                <h3 class="panel-title"><a name="/definitions/apiPeriodicSchedule"></a>apiPeriodicSchedule:
                                    <span class="json-property-type">
                <span class="json-property-type">object</span>
                <span class="json-property-range" title="Value limits"></span>
                
                </span>
                                </h3>
                        </div>
                    <div class="panel-body">
                            
                                    <section class="json-schema-properties">
                                        <dl>
                                                <dt data-property-name="start_time">
                                                    <span class="json-property-name">start_time:</span>
                                                    
                                                    <span class="json-property-type">string</span>    <span class="json-property-format">(date-time)</span>
                                                    <span class="json-property-range" title="Value limits"></span>
                                                    
                                                </dt>
                                                <dd>
                                                    
                                                    <div class="json-inner-schema">
                                                        
                                                    </div>
                                                </dd>
                                                <dt data-property-name="end_time">
                                                    <span class="json-property-name">end_time:</span>
                                                    
                                                    <span class="json-property-type">string</span>    <span class="json-property-format">(date-time)</span>
                                                    <span class="json-property-range" title="Value limits"></span>
                                                    
                                                </dt>
                                                <dd>
                                                    
                                                    <div class="json-inner-schema">
                                                        
                                                    </div>
                                                </dd>
                                                <dt data-property-name="interval_second">
                                                    <span class="json-property-name">interval_second:</span>
                                                    
                                                    <span class="json-property-type">string</span>    <span class="json-property-format">(int64)</span>
                                                    <span class="json-property-range" title="Value limits"></span>
                                                    
                                                </dt>
                                                <dd>
                                                    
                                                    <div class="json-inner-schema">
                                                        
                                                    </div>
                                                </dd>
                                        </dl>
                                    </section>
                    </div>
                </div>        
                <div id="definition-apiPipeline" class="panel panel-definition">
                        <div class="panel-heading">
                                <h3 class="panel-title"><a name="/definitions/apiPipeline"></a>apiPipeline:
                                    <span class="json-property-type">
                <span class="json-property-type">object</span>
                <span class="json-property-range" title="Value limits"></span>
                
                </span>
                                </h3>
                        </div>
                    <div class="panel-body">
                            
                                    <section class="json-schema-properties">
                                        <dl>
                                                <dt data-property-name="id">
                                                    <span class="json-property-name">id:</span>
                                                    
                                                    <span class="json-property-type">string</span>
                                                    <span class="json-property-range" title="Value limits"></span>
                                                    
                                                </dt>
                                                <dd>
                                                    <p>Output. Unique pipeline ID. Generated by API server.</p>
                                    
                                                    <div class="json-inner-schema">
                                                        
                                                    </div>
                                                </dd>
                                                <dt data-property-name="created_at">
                                                    <span class="json-property-name">created_at:</span>
                                                    
                                                    <span class="json-property-type">string</span>    <span class="json-property-format">(date-time)</span>
                                                    <span class="json-property-range" title="Value limits"></span>
                                                    
                                                </dt>
                                                <dd>
                                                    <p>Output. The time this pipeline is created.</p>
                                    
                                                    <div class="json-inner-schema">
                                                        
                                                    </div>
                                                </dd>
                                                <dt data-property-name="name">
                                                    <span class="json-property-name">name:</span>
                                                    
                                                    <span class="json-property-type">string</span>
                                                    <span class="json-property-range" title="Value limits"></span>
                                                    
                                                </dt>
                                                <dd>
                                                    <p>Optional input field. Pipeline name provided by user. If not specified,
                                    file name is used as pipeline name.</p>
                                    
                                                    <div class="json-inner-schema">
                                                        
                                                    </div>
                                                </dd>
                                                <dt data-property-name="description">
                                                    <span class="json-property-name">description:</span>
                                                    
                                                    <span class="json-property-type">string</span>
                                                    <span class="json-property-range" title="Value limits"></span>
                                                    
                                                </dt>
                                                <dd>
                                                    <p>Optional input field. Describing the purpose of the job.</p>
                                    
                                                    <div class="json-inner-schema">
                                                        
                                                    </div>
                                                </dd>
                                                <dt data-property-name="parameters">
                                                    <span class="json-property-name">parameters:</span>
                                                    
                                                    <span class="json-property-type">object[]</span>
                                                    <span class="json-property-range" title="Value limits"></span>
                                                    
                                                </dt>
                                                <dd>
                                                    <p>Output. The input parameters for this pipeline.
                                    TODO(jingzhang36): replace this parameters field with the parameters field
                                    inside PipelineVersion when all usage of the former has been changed to use
                                    the latter.</p>
                                    
                                                    <div class="json-inner-schema">
                                                        
                                                                        <section class="json-schema-array-items">
                                                                            
                                                                            <span class="json-property-type">    <a class="json-schema-ref" href="#/definitions/apiParameter">apiParameter</a>
                                                                            </span>
                                                                            <span class="json-property-range" title="Value limits"></span>
                                                                            
                                                                            <div class="json-inner-schema">
                                                                                
                                                                            </div>
                                                                        </section>                </div>
                                                </dd>
                                                <dt data-property-name="url">
                                                    <span class="json-property-name">url:</span>
                                                    
                                                    <span class="json-property-type">    <a class="json-schema-ref" href="#/definitions/apiUrl">apiUrl</a>
                                                    </span>
                                                    <span class="json-property-range" title="Value limits"></span>
                                                    
                                                </dt>
                                                <dd>
                                                    <p>The URL to the source of the pipeline. This is required when creating the
                                    pipeine through CreatePipeline API.
                                    TODO(jingzhang36): replace this url field with the code_source_urls field
                                    inside PipelineVersion when all usage of the former has been changed to use
                                    the latter.</p>
                                    
                                                    <div class="json-inner-schema">
                                                        
                                                    </div>
                                                </dd>
                                                <dt data-property-name="error">
                                                    <span class="json-property-name">error:</span>
                                                    
                                                    <span class="json-property-type">string</span>
                                                    <span class="json-property-range" title="Value limits"></span>
                                                    
                                                </dt>
                                                <dd>
                                                    <p>In case any error happens retrieving a pipeline field, only pipeline ID
                                    and the error message is returned. Client has the flexibility of choosing
                                    how to handle error. This is especially useful during listing call.</p>
                                    
                                                    <div class="json-inner-schema">
                                                        
                                                    </div>
                                                </dd>
                                                <dt data-property-name="default_version">
                                                    <span class="json-property-name">default_version:</span>
                                                    
                                                    <span class="json-property-type">    <a class="json-schema-ref" href="#/definitions/apiPipelineVersion">apiPipelineVersion</a>
                                                    </span>
                                                    <span class="json-property-range" title="Value limits"></span>
                                                    
                                                        <span class="json-property-read-only"></span>
                                                </dt>
                                                <dd>
                                                    
                                                    <div class="json-inner-schema">
                                                        
                                                    </div>
                                                </dd>
                                                <dt data-property-name="resource_references">
                                                    <span class="json-property-name">resource_references:</span>
                                                    
                                                    <span class="json-property-type">object[]</span>
                                                    <span class="json-property-range" title="Value limits"></span>
                                                    
                                                </dt>
                                                <dd>
                                                    <p>Input field. Specify which resource this pipeline belongs to.
                                    For Pipeline, the only valid resource reference is a single Namespace.</p>
                                    
                                                    <div class="json-inner-schema">
                                                        
                                                                        <section class="json-schema-array-items">
                                                                            
                                                                            <span class="json-property-type">    <a class="json-schema-ref" href="#/definitions/apiResourceReference">apiResourceReference</a>
                                                                            </span>
                                                                            <span class="json-property-range" title="Value limits"></span>
                                                                            
                                                                            <div class="json-inner-schema">
                                                                                
                                                                            </div>
                                                                        </section>                </div>
                                                </dd>
                                        </dl>
                                    </section>
                    </div>
                </div>        
                <div id="definition-apiPipelineRuntime" class="panel panel-definition">
                        <div class="panel-heading">
                                <h3 class="panel-title"><a name="/definitions/apiPipelineRuntime"></a>apiPipelineRuntime:
                                    <span class="json-property-type">
                <span class="json-property-type">object</span>
                <span class="json-property-range" title="Value limits"></span>
                
                </span>
                                </h3>
                        </div>
                    <div class="panel-body">
                            
                                    <section class="json-schema-properties">
                                        <dl>
                                                <dt data-property-name="pipeline_manifest">
                                                    <span class="json-property-name">pipeline_manifest:</span>
                                                    
                                                    <span class="json-property-type">string</span>
                                                    <span class="json-property-range" title="Value limits"></span>
                                                    
                                                </dt>
                                                <dd>
                                                    <p>Output. The runtime JSON manifest of the pipeline, including the status
                                    of pipeline steps and fields need for UI visualization etc.</p>
                                    
                                                    <div class="json-inner-schema">
                                                        
                                                    </div>
                                                </dd>
                                                <dt data-property-name="workflow_manifest">
                                                    <span class="json-property-name">workflow_manifest:</span>
                                                    
                                                    <span class="json-property-type">string</span>
                                                    <span class="json-property-range" title="Value limits"></span>
                                                    
                                                </dt>
                                                <dd>
                                                    <p>Output. The runtime JSON manifest of the argo workflow.
                                    This is deprecated after pipeline_runtime_manifest is in use.</p>
                                    
                                                    <div class="json-inner-schema">
                                                        
                                                    </div>
                                                </dd>
                                        </dl>
                                    </section>
                    </div>
                </div>        
                <div id="definition-apiPipelineSpec" class="panel panel-definition">
                        <div class="panel-heading">
                                <h3 class="panel-title"><a name="/definitions/apiPipelineSpec"></a>apiPipelineSpec:
                                    <span class="json-property-type">
                <span class="json-property-type">object</span>
                <span class="json-property-range" title="Value limits"></span>
                
                </span>
                                </h3>
                        </div>
                    <div class="panel-body">
                            
                                    <section class="json-schema-properties">
                                        <dl>
                                                <dt data-property-name="pipeline_id">
                                                    <span class="json-property-name">pipeline_id:</span>
                                                    
                                                    <span class="json-property-type">string</span>
                                                    <span class="json-property-range" title="Value limits"></span>
                                                    
                                                </dt>
                                                <dd>
                                                    <p>Optional input field. The ID of the pipeline user uploaded before.</p>
                                    
                                                    <div class="json-inner-schema">
                                                        
                                                    </div>
                                                </dd>
                                                <dt data-property-name="pipeline_name">
                                                    <span class="json-property-name">pipeline_name:</span>
                                                    
                                                    <span class="json-property-type">string</span>
                                                    <span class="json-property-range" title="Value limits"></span>
                                                    
                                                </dt>
                                                <dd>
                                                    <p>Optional output field. The name of the pipeline.
                                    Not empty if the pipeline id is not empty.</p>
                                    
                                                    <div class="json-inner-schema">
                                                        
                                                    </div>
                                                </dd>
                                                <dt data-property-name="workflow_manifest">
                                                    <span class="json-property-name">workflow_manifest:</span>
                                                    
                                                    <span class="json-property-type">string</span>
                                                    <span class="json-property-range" title="Value limits"></span>
                                                    
                                                </dt>
                                                <dd>
                                                    <p>Optional input field. The marshalled raw argo JSON workflow.
                                    This will be deprecated when pipeline_manifest is in use.</p>
                                    
                                                    <div class="json-inner-schema">
                                                        
                                                    </div>
                                                </dd>
                                                <dt data-property-name="pipeline_manifest">
                                                    <span class="json-property-name">pipeline_manifest:</span>
                                                    
                                                    <span class="json-property-type">string</span>
                                                    <span class="json-property-range" title="Value limits"></span>
                                                    
                                                </dt>
                                                <dd>
                                                    <p>Optional input field. The raw pipeline JSON spec.</p>
                                    
                                                    <div class="json-inner-schema">
                                                        
                                                    </div>
                                                </dd>
                                                <dt data-property-name="parameters">
                                                    <span class="json-property-name">parameters:</span>
                                                    
                                                    <span class="json-property-type">object[]</span>
                                                    <span class="json-property-range" title="Value limits"></span>
                                                    
                                                </dt>
                                                <dd>
                                                    
                                                    <div class="json-inner-schema">
                                                        
                                                                        <section class="json-schema-array-items">
                                                                            
                                                                            <span class="json-property-type">    <a class="json-schema-ref" href="#/definitions/apiParameter">apiParameter</a>
                                                                            </span>
                                                                            <span class="json-property-range" title="Value limits"></span>
                                                                            
                                                                            <div class="json-inner-schema">
                                                                                
                                                                            </div>
                                                                        </section>                </div>
                                                </dd>
                                                <dt data-property-name="runtime_config">
                                                    <span class="json-property-name">runtime_config:</span>
                                                    
                                                    <span class="json-property-type">    <a class="json-schema-ref" href="#/definitions/PipelineSpecRuntimeConfig">PipelineSpecRuntimeConfig</a>
                                                    </span>
                                                    <span class="json-property-range" title="Value limits"></span>
                                                    
                                                </dt>
                                                <dd>
                                                    
                                                    <div class="json-inner-schema">
                                                        
                                                    </div>
                                                </dd>
                                        </dl>
                                    </section>
                    </div>
                </div>        
                <div id="definition-apiPipelineVersion" class="panel panel-definition">
                        <div class="panel-heading">
                                <h3 class="panel-title"><a name="/definitions/apiPipelineVersion"></a>apiPipelineVersion:
                                    <span class="json-property-type">
                <span class="json-property-type">object</span>
                <span class="json-property-range" title="Value limits"></span>
                
                </span>
                                </h3>
                        </div>
                    <div class="panel-body">
                            
                                    <section class="json-schema-properties">
                                        <dl>
                                                <dt data-property-name="id">
                                                    <span class="json-property-name">id:</span>
                                                    
                                                    <span class="json-property-type">string</span>
                                                    <span class="json-property-range" title="Value limits"></span>
                                                    
                                                </dt>
                                                <dd>
                                                    <p>Output. Unique version ID. Generated by API server.</p>
                                    
                                                    <div class="json-inner-schema">
                                                        
                                                    </div>
                                                </dd>
                                                <dt data-property-name="name">
                                                    <span class="json-property-name">name:</span>
                                                    
                                                    <span class="json-property-type">string</span>
                                                    <span class="json-property-range" title="Value limits"></span>
                                                    
                                                </dt>
                                                <dd>
                                                    <p>Optional input field. Version name provided by user.</p>
                                    
                                                    <div class="json-inner-schema">
                                                        
                                                    </div>
                                                </dd>
                                                <dt data-property-name="created_at">
                                                    <span class="json-property-name">created_at:</span>
                                                    
                                                    <span class="json-property-type">string</span>    <span class="json-property-format">(date-time)</span>
                                                    <span class="json-property-range" title="Value limits"></span>
                                                    
                                                </dt>
                                                <dd>
                                                    <p>Output. The time this pipeline version is created.</p>
                                    
                                                    <div class="json-inner-schema">
                                                        
                                                    </div>
                                                </dd>
                                                <dt data-property-name="parameters">
                                                    <span class="json-property-name">parameters:</span>
                                                    
                                                    <span class="json-property-type">object[]</span>
                                                    <span class="json-property-range" title="Value limits"></span>
                                                    
                                                </dt>
                                                <dd>
                                                    <p>Output. The input parameters for this pipeline.</p>
                                    
                                                    <div class="json-inner-schema">
                                                        
                                                                        <section class="json-schema-array-items">
                                                                            
                                                                            <span class="json-property-type">    <a class="json-schema-ref" href="#/definitions/apiParameter">apiParameter</a>
                                                                            </span>
                                                                            <span class="json-property-range" title="Value limits"></span>
                                                                            
                                                                            <div class="json-inner-schema">
                                                                                
                                                                            </div>
                                                                        </section>                </div>
                                                </dd>
                                                <dt data-property-name="code_source_url">
                                                    <span class="json-property-name">code_source_url:</span>
                                                    
                                                    <span class="json-property-type">string</span>
                                                    <span class="json-property-range" title="Value limits"></span>
                                                    
                                                </dt>
                                                <dd>
                                                    <p>Input. Optional. Pipeline version code source.</p>
                                    
                                                    <div class="json-inner-schema">
                                                        
                                                    </div>
                                                </dd>
                                                <dt data-property-name="package_url">
                                                    <span class="json-property-name">package_url:</span>
                                                    
                                                    <span class="json-property-type">    <a class="json-schema-ref" href="#/definitions/apiUrl">apiUrl</a>
                                                    </span>
                                                    <span class="json-property-range" title="Value limits"></span>
                                                    
                                                </dt>
                                                <dd>
                                                    <p>Input. Required. Pipeline version package url.
                                    Whe calling CreatePipelineVersion API method, need to provide one package
                                    file location.</p>
                                    
                                                    <div class="json-inner-schema">
                                                        
                                                    </div>
                                                </dd>
                                                <dt data-property-name="resource_references">
                                                    <span class="json-property-name">resource_references:</span>
                                                    
                                                    <span class="json-property-type">object[]</span>
                                                    <span class="json-property-range" title="Value limits"></span>
                                                    
                                                </dt>
                                                <dd>
                                                    <p>Input. Required. E.g., specify which pipeline this pipeline version belongs
                                    to.</p>
                                    
                                                    <div class="json-inner-schema">
                                                        
                                                                        <section class="json-schema-array-items">
                                                                            
                                                                            <span class="json-property-type">    <a class="json-schema-ref" href="#/definitions/apiResourceReference">apiResourceReference</a>
                                                                            </span>
                                                                            <span class="json-property-range" title="Value limits"></span>
                                                                            
                                                                            <div class="json-inner-schema">
                                                                                
                                                                            </div>
                                                                        </section>                </div>
                                                </dd>
                                                <dt data-property-name="description">
                                                    <span class="json-property-name">description:</span>
                                                    
                                                    <span class="json-property-type">string</span>
                                                    <span class="json-property-range" title="Value limits"></span>
                                                    
                                                </dt>
                                                <dd>
                                                    <p>Input. Optional. Description for the pipeline version.</p>
                                    
                                                    <div class="json-inner-schema">
                                                        
                                                    </div>
                                                </dd>
                                        </dl>
                                    </section>
                    </div>
                </div>        
                <div id="definition-apiReadArtifactResponse" class="panel panel-definition">
                        <div class="panel-heading">
                                <h3 class="panel-title"><a name="/definitions/apiReadArtifactResponse"></a>apiReadArtifactResponse:
                                    <span class="json-property-type">
                <span class="json-property-type">object</span>
                <span class="json-property-range" title="Value limits"></span>
                
                </span>
                                </h3>
                        </div>
                    <div class="panel-body">
                            
                                    <section class="json-schema-properties">
                                        <dl>
                                                <dt data-property-name="data">
                                                    <span class="json-property-name">data:</span>
                                                    
                                                    <span class="json-property-type">string</span>    <span class="json-property-format">(byte)</span>
                                                    <span class="json-property-range" title="Value limits"></span>
                                                    
                                                </dt>
                                                <dd>
                                                    <p>The bytes of the artifact content.</p>
                                    
                                                    <div class="json-inner-schema">
                                                        
                                                    </div>
                                                </dd>
                                        </dl>
                                    </section>
                    </div>
                </div>        
                <div id="definition-apiRelationship" class="panel panel-definition">
                        <div class="panel-heading">
                                <h3 class="panel-title"><a name="/definitions/apiRelationship"></a>apiRelationship:
                                    <span class="json-property-type">
                <span class="json-property-type">string</span>    <span class="json-property-enum" title="Possible values">, x &isin; {
                                <span class="json-property-enum-item">UNKNOWN_RELATIONSHIP</span>
                                (default)
                            ,
                                <span class="json-property-enum-item">OWNER</span>
                            ,
                                <span class="json-property-enum-item">CREATOR</span>
                            
                        }
                        </span>
                <span class="json-property-range" title="Value limits"></span>
                
                </span>
                                </h3>
                        </div>
                    <div class="panel-body">
                            
                    </div>
                </div>        
                <div id="definition-apiReportRunMetricsRequest" class="panel panel-definition">
                        <div class="panel-heading">
                                <h3 class="panel-title"><a name="/definitions/apiReportRunMetricsRequest"></a>apiReportRunMetricsRequest:
                                    <span class="json-property-type">
                <span class="json-property-type">object</span>
                <span class="json-property-range" title="Value limits"></span>
                
                </span>
                                </h3>
                        </div>
                    <div class="panel-body">
                            
                                    <section class="json-schema-properties">
                                        <dl>
                                                <dt data-property-name="run_id">
                                                    <span class="json-property-name">run_id:</span>
                                                    
                                                    <span class="json-property-type">string</span>
                                                    <span class="json-property-range" title="Value limits"></span>
                                                    
                                                </dt>
                                                <dd>
                                                    <p>Required. The parent run ID of the metric.</p>
                                    
                                                    <div class="json-inner-schema">
                                                        
                                                    </div>
                                                </dd>
                                                <dt data-property-name="metrics">
                                                    <span class="json-property-name">metrics:</span>
                                                    
                                                    <span class="json-property-type">object[]</span>
                                                    <span class="json-property-range" title="Value limits"></span>
                                                    
                                                </dt>
                                                <dd>
                                                    <p>List of metrics to report.</p>
                                    
                                                    <div class="json-inner-schema">
                                                        
                                                                        <section class="json-schema-array-items">
                                                                            
                                                                            <span class="json-property-type">    <a class="json-schema-ref" href="#/definitions/apiRunMetric">apiRunMetric</a>
                                                                            </span>
                                                                            <span class="json-property-range" title="Value limits"></span>
                                                                            
                                                                            <div class="json-inner-schema">
                                                                                
                                                                            </div>
                                                                        </section>                </div>
                                                </dd>
                                        </dl>
                                    </section>
                    </div>
                </div>        
                <div id="definition-apiReportRunMetricsResponse" class="panel panel-definition">
                        <div class="panel-heading">
                                <h3 class="panel-title"><a name="/definitions/apiReportRunMetricsResponse"></a>apiReportRunMetricsResponse:
                                    <span class="json-property-type">
                <span class="json-property-type">object</span>
                <span class="json-property-range" title="Value limits"></span>
                
                </span>
                                </h3>
                        </div>
                    <div class="panel-body">
                            
                                    <section class="json-schema-properties">
                                        <dl>
                                                <dt data-property-name="results">
                                                    <span class="json-property-name">results:</span>
                                                    
                                                    <span class="json-property-type">object[]</span>
                                                    <span class="json-property-range" title="Value limits"></span>
                                                    
                                                </dt>
                                                <dd>
                                                    
                                                    <div class="json-inner-schema">
                                                        
                                                                        <section class="json-schema-array-items">
                                                                            
                                                                            <span class="json-property-type">    <a class="json-schema-ref" href="#/definitions/ReportRunMetricsResponseReportRunMetricResult">ReportRunMetricsResponseReportRunMetricResult</a>
                                                                            </span>
                                                                            <span class="json-property-range" title="Value limits"></span>
                                                                            
                                                                            <div class="json-inner-schema">
                                                                                
                                                                            </div>
                                                                        </section>                </div>
                                                </dd>
                                        </dl>
                                    </section>
                    </div>
                </div>        
                <div id="definition-apiResourceKey" class="panel panel-definition">
                        <div class="panel-heading">
                                <h3 class="panel-title"><a name="/definitions/apiResourceKey"></a>apiResourceKey:
                                    <span class="json-property-type">
                <span class="json-property-type">object</span>
                <span class="json-property-range" title="Value limits"></span>
                
                </span>
                                </h3>
                        </div>
                    <div class="panel-body">
                            
                                    <section class="json-schema-properties">
                                        <dl>
                                                <dt data-property-name="type">
                                                    <span class="json-property-name">type:</span>
                                                    
                                                    <span class="json-property-type">    <a class="json-schema-ref" href="#/definitions/apiResourceType">apiResourceType</a>
                                                    </span>
                                                    <span class="json-property-range" title="Value limits"></span>
                                                    
                                                </dt>
                                                <dd>
                                                    <p>The type of the resource that referred to.</p>
                                    
                                                    <div class="json-inner-schema">
                                                        
                                                    </div>
                                                </dd>
                                                <dt data-property-name="id">
                                                    <span class="json-property-name">id:</span>
                                                    
                                                    <span class="json-property-type">string</span>
                                                    <span class="json-property-range" title="Value limits"></span>
                                                    
                                                </dt>
                                                <dd>
                                                    <p>The ID of the resource that referred to.</p>
                                    
                                                    <div class="json-inner-schema">
                                                        
                                                    </div>
                                                </dd>
                                        </dl>
                                    </section>
                    </div>
                </div>        
                <div id="definition-apiResourceReference" class="panel panel-definition">
                        <div class="panel-heading">
                                <h3 class="panel-title"><a name="/definitions/apiResourceReference"></a>apiResourceReference:
                                    <span class="json-property-type">
                <span class="json-property-type">object</span>
                <span class="json-property-range" title="Value limits"></span>
                
                </span>
                                </h3>
                        </div>
                    <div class="panel-body">
                            
                                    <section class="json-schema-properties">
                                        <dl>
                                                <dt data-property-name="key">
                                                    <span class="json-property-name">key:</span>
                                                    
                                                    <span class="json-property-type">    <a class="json-schema-ref" href="#/definitions/apiResourceKey">apiResourceKey</a>
                                                    </span>
                                                    <span class="json-property-range" title="Value limits"></span>
                                                    
                                                </dt>
                                                <dd>
                                                    
                                                    <div class="json-inner-schema">
                                                        
                                                    </div>
                                                </dd>
                                                <dt data-property-name="name">
                                                    <span class="json-property-name">name:</span>
                                                    
                                                    <span class="json-property-type">string</span>
                                                    <span class="json-property-range" title="Value limits"></span>
                                                    
                                                </dt>
                                                <dd>
                                                    <p>The name of the resource that referred to.</p>
                                    
                                                    <div class="json-inner-schema">
                                                        
                                                    </div>
                                                </dd>
                                                <dt data-property-name="relationship">
                                                    <span class="json-property-name">relationship:</span>
                                                    
                                                    <span class="json-property-type">    <a class="json-schema-ref" href="#/definitions/apiRelationship">apiRelationship</a>
                                                    </span>
                                                    <span class="json-property-range" title="Value limits"></span>
                                                    
                                                </dt>
                                                <dd>
                                                    <p>Required field. The relationship from referred resource to the object.</p>
                                    
                                                    <div class="json-inner-schema">
                                                        
                                                    </div>
                                                </dd>
                                        </dl>
                                    </section>
                    </div>
                </div>        
                <div id="definition-apiResourceType" class="panel panel-definition">
                        <div class="panel-heading">
                                <h3 class="panel-title"><a name="/definitions/apiResourceType"></a>apiResourceType:
                                    <span class="json-property-type">
                <span class="json-property-type">string</span>    <span class="json-property-enum" title="Possible values">, x &isin; {
                                <span class="json-property-enum-item">UNKNOWN_RESOURCE_TYPE</span>
                                (default)
                            ,
                                <span class="json-property-enum-item">EXPERIMENT</span>
                            ,
                                <span class="json-property-enum-item">JOB</span>
                            ,
                                <span class="json-property-enum-item">PIPELINE</span>
                            ,
                                <span class="json-property-enum-item">PIPELINE_VERSION</span>
                            ,
                                <span class="json-property-enum-item">NAMESPACE</span>
                            
                        }
                        </span>
                <span class="json-property-range" title="Value limits"></span>
                
                </span>
                                </h3>
                        </div>
                    <div class="panel-body">
                            
                    </div>
                </div>        
                <div id="definition-apiRun" class="panel panel-definition">
                        <div class="panel-heading">
                                <h3 class="panel-title"><a name="/definitions/apiRun"></a>apiRun:
                                    <span class="json-property-type">
                <span class="json-property-type">object</span>
                <span class="json-property-range" title="Value limits"></span>
                
                </span>
                                </h3>
                        </div>
                    <div class="panel-body">
                            
                                    <section class="json-schema-properties">
                                        <dl>
                                                <dt data-property-name="id">
                                                    <span class="json-property-name">id:</span>
                                                    
                                                    <span class="json-property-type">string</span>
                                                    <span class="json-property-range" title="Value limits"></span>
                                                    
                                                </dt>
                                                <dd>
                                                    <p>Output. Unique run ID. Generated by API server.</p>
                                    
                                                    <div class="json-inner-schema">
                                                        
                                                    </div>
                                                </dd>
                                                <dt data-property-name="name">
                                                    <span class="json-property-name">name:</span>
                                                    
                                                    <span class="json-property-type">string</span>
                                                    <span class="json-property-range" title="Value limits"></span>
                                                    
                                                </dt>
                                                <dd>
                                                    <p>Required input field. Name provided by user,
                                    or auto generated if run is created by scheduled job. Not unique.</p>
                                    
                                                    <div class="json-inner-schema">
                                                        
                                                    </div>
                                                </dd>
                                                <dt data-property-name="storage_state">
                                                    <span class="json-property-name">storage_state:</span>
                                                    
                                                    <span class="json-property-type">    <a class="json-schema-ref" href="#/definitions/apiRunStorageState">apiRunStorageState</a>
                                                    </span>
                                                    <span class="json-property-range" title="Value limits"></span>
                                                    
                                                </dt>
                                                <dd>
                                                    <p>Output. Specify whether this run is in archived or available mode.</p>
                                    
                                                    <div class="json-inner-schema">
                                                        
                                                    </div>
                                                </dd>
                                                <dt data-property-name="description">
                                                    <span class="json-property-name">description:</span>
                                                    
                                                    <span class="json-property-type">string</span>
                                                    <span class="json-property-range" title="Value limits"></span>
                                                    
                                                </dt>
                                                <dd>
                                                    
                                                    <div class="json-inner-schema">
                                                        
                                                    </div>
                                                </dd>
                                                <dt data-property-name="pipeline_spec">
                                                    <span class="json-property-name">pipeline_spec:</span>
                                                    
                                                    <span class="json-property-type">    <a class="json-schema-ref" href="#/definitions/apiPipelineSpec">apiPipelineSpec</a>
                                                    </span>
                                                    <span class="json-property-range" title="Value limits"></span>
                                                    
                                                </dt>
                                                <dd>
                                                    <p>Required input field.
                                    Describing what the pipeline manifest and parameters to use for the run.</p>
                                    
                                                    <div class="json-inner-schema">
                                                        
                                                    </div>
                                                </dd>
                                                <dt data-property-name="resource_references">
                                                    <span class="json-property-name">resource_references:</span>
                                                    
                                                    <span class="json-property-type">object[]</span>
                                                    <span class="json-property-range" title="Value limits"></span>
                                                    
                                                </dt>
                                                <dd>
                                                    <p>Optional input field. Specify which resource this run belongs to.
                                    When creating a run from a particular pipeline version, the pipeline
                                    version can be specified here.</p>
                                    
                                                    <div class="json-inner-schema">
                                                        
                                                                        <section class="json-schema-array-items">
                                                                            
                                                                            <span class="json-property-type">    <a class="json-schema-ref" href="#/definitions/apiResourceReference">apiResourceReference</a>
                                                                            </span>
                                                                            <span class="json-property-range" title="Value limits"></span>
                                                                            
                                                                            <div class="json-inner-schema">
                                                                                
                                                                            </div>
                                                                        </section>                </div>
                                                </dd>
                                                <dt data-property-name="service_account">
                                                    <span class="json-property-name">service_account:</span>
                                                    
                                                    <span class="json-property-type">string</span>
                                                    <span class="json-property-range" title="Value limits"></span>
                                                    
                                                </dt>
                                                <dd>
                                                    <p>Optional input field. Specify which Kubernetes service account this run uses.</p>
                                    
                                                    <div class="json-inner-schema">
                                                        
                                                    </div>
                                                </dd>
                                                <dt data-property-name="created_at">
                                                    <span class="json-property-name">created_at:</span>
                                                    
                                                    <span class="json-property-type">string</span>    <span class="json-property-format">(date-time)</span>
                                                    <span class="json-property-range" title="Value limits"></span>
                                                    
                                                </dt>
                                                <dd>
                                                    <p>Output. The time that the run created.</p>
                                    
                                                    <div class="json-inner-schema">
                                                        
                                                    </div>
                                                </dd>
                                                <dt data-property-name="scheduled_at">
                                                    <span class="json-property-name">scheduled_at:</span>
                                                    
                                                    <span class="json-property-type">string</span>    <span class="json-property-format">(date-time)</span>
                                                    <span class="json-property-range" title="Value limits"></span>
                                                    
                                                </dt>
                                                <dd>
                                                    <p>Output. When this run is scheduled to run. This could be different from
                                    created_at. For example, if a run is from a backfilling job that was
                                    supposed to run 2 month ago, the scheduled_at is 2 month ago,
                                    v.s. created_at is the current time.</p>
                                    
                                                    <div class="json-inner-schema">
                                                        
                                                    </div>
                                                </dd>
                                                <dt data-property-name="finished_at">
                                                    <span class="json-property-name">finished_at:</span>
                                                    
                                                    <span class="json-property-type">string</span>    <span class="json-property-format">(date-time)</span>
                                                    <span class="json-property-range" title="Value limits"></span>
                                                    
                                                </dt>
                                                <dd>
                                                    <p>Output. The time this run is finished.</p>
                                    
                                                    <div class="json-inner-schema">
                                                        
                                                    </div>
                                                </dd>
                                                <dt data-property-name="status">
                                                    <span class="json-property-name">status:</span>
                                                    
                                                    <span class="json-property-type">string</span>
                                                    <span class="json-property-range" title="Value limits"></span>
                                                    
                                                </dt>
                                                <dd>
                                                    
                                                    <div class="json-inner-schema">
                                                        
                                                    </div>
                                                </dd>
                                                <dt data-property-name="error">
                                                    <span class="json-property-name">error:</span>
                                                    
                                                    <span class="json-property-type">string</span>
                                                    <span class="json-property-range" title="Value limits"></span>
                                                    
                                                </dt>
                                                <dd>
                                                    <p>In case any error happens retrieving a run field, only run ID
                                    and the error message is returned. Client has the flexibility of choosing
                                    how to handle error. This is especially useful during listing call.</p>
                                    
                                                    <div class="json-inner-schema">
                                                        
                                                    </div>
                                                </dd>
                                                <dt data-property-name="metrics">
                                                    <span class="json-property-name">metrics:</span>
                                                    
                                                    <span class="json-property-type">object[]</span>
                                                    <span class="json-property-range" title="Value limits"></span>
                                                    
                                                </dt>
                                                <dd>
                                                    <p>Output. The metrics of the run. The metrics are reported by ReportMetrics
                                    API.</p>
                                    
                                                    <div class="json-inner-schema">
                                                        
                                                                        <section class="json-schema-array-items">
                                                                            
                                                                            <span class="json-property-type">    <a class="json-schema-ref" href="#/definitions/apiRunMetric">apiRunMetric</a>
                                                                            </span>
                                                                            <span class="json-property-range" title="Value limits"></span>
                                                                            
                                                                            <div class="json-inner-schema">
                                                                                
                                                                            </div>
                                                                        </section>                </div>
                                                </dd>
                                        </dl>
                                    </section>
                    </div>
                </div>        
                <div id="definition-apiRunDetail" class="panel panel-definition">
                        <div class="panel-heading">
                                <h3 class="panel-title"><a name="/definitions/apiRunDetail"></a>apiRunDetail:
                                    <span class="json-property-type">
                <span class="json-property-type">object</span>
                <span class="json-property-range" title="Value limits"></span>
                
                </span>
                                </h3>
                        </div>
                    <div class="panel-body">
                            
                                    <section class="json-schema-properties">
                                        <dl>
                                                <dt data-property-name="run">
                                                    <span class="json-property-name">run:</span>
                                                    
                                                    <span class="json-property-type">    <a class="json-schema-ref" href="#/definitions/apiRun">apiRun</a>
                                                    </span>
                                                    <span class="json-property-range" title="Value limits"></span>
                                                    
                                                </dt>
                                                <dd>
                                                    
                                                    <div class="json-inner-schema">
                                                        
                                                    </div>
                                                </dd>
                                                <dt data-property-name="pipeline_runtime">
                                                    <span class="json-property-name">pipeline_runtime:</span>
                                                    
                                                    <span class="json-property-type">    <a class="json-schema-ref" href="#/definitions/apiPipelineRuntime">apiPipelineRuntime</a>
                                                    </span>
                                                    <span class="json-property-range" title="Value limits"></span>
                                                    
                                                </dt>
                                                <dd>
                                                    
                                                    <div class="json-inner-schema">
                                                        
                                                    </div>
                                                </dd>
                                        </dl>
                                    </section>
                    </div>
                </div>        
                <div id="definition-apiRunMetric" class="panel panel-definition">
                        <div class="panel-heading">
                                <h3 class="panel-title"><a name="/definitions/apiRunMetric"></a>apiRunMetric:
                                    <span class="json-property-type">
                <span class="json-property-type">object</span>
                <span class="json-property-range" title="Value limits"></span>
                
                </span>
                                </h3>
                        </div>
                    <div class="panel-body">
                            
                                    <section class="json-schema-properties">
                                        <dl>
                                                <dt data-property-name="name">
                                                    <span class="json-property-name">name:</span>
                                                    
                                                    <span class="json-property-type">string</span>
                                                    <span class="json-property-range" title="Value limits"></span>
                                                    
                                                </dt>
                                                <dd>
                                                    <p>Required. The user defined name of the metric. It must between 1 and 63
                                    characters long and must conform to the following regular expression:
                                    <code>[a-z]([-a-z0-9]*[a-z0-9])?</code>.</p>
                                    
                                                    <div class="json-inner-schema">
                                                        
                                                    </div>
                                                </dd>
                                                <dt data-property-name="node_id">
                                                    <span class="json-property-name">node_id:</span>
                                                    
                                                    <span class="json-property-type">string</span>
                                                    <span class="json-property-range" title="Value limits"></span>
                                                    
                                                </dt>
                                                <dd>
                                                    <p>Required. The runtime node ID which reports the metric. The node ID can be
                                    found in the RunDetail.workflow.Status. Metric with same (node_id, name)
                                    are considerd as duplicate. Only the first reporting will be recorded. Max
                                    length is 128.</p>
                                    
                                                    <div class="json-inner-schema">
                                                        
                                                    </div>
                                                </dd>
                                                <dt data-property-name="number_value">
                                                    <span class="json-property-name">number_value:</span>
                                                    
                                                    <span class="json-property-type">number</span>    <span class="json-property-format">(double)</span>
                                                    <span class="json-property-range" title="Value limits"></span>
                                                    
                                                </dt>
                                                <dd>
                                                    <p>The number value of the metric.</p>
                                    
                                                    <div class="json-inner-schema">
                                                        
                                                    </div>
                                                </dd>
                                                <dt data-property-name="format">
                                                    <span class="json-property-name">format:</span>
                                                    
                                                    <span class="json-property-type">    <a class="json-schema-ref" href="#/definitions/RunMetricFormat">RunMetricFormat</a>
                                                    </span>
                                                    <span class="json-property-range" title="Value limits"></span>
                                                    
                                                </dt>
                                                <dd>
                                                    <p>The display format of metric.</p>
                                    
                                                    <div class="json-inner-schema">
                                                        
                                                    </div>
                                                </dd>
                                        </dl>
                                    </section>
                    </div>
                </div>        
                <div id="definition-apiRunStorageState" class="panel panel-definition">
                        <div class="panel-heading">
                                <h3 class="panel-title"><a name="/definitions/apiRunStorageState"></a>apiRunStorageState:
                                    <span class="json-property-type">
                <span class="json-property-type">string</span>    <span class="json-property-enum" title="Possible values">, x &isin; {
                                <span class="json-property-enum-item">STORAGESTATE_AVAILABLE</span>
                                (default)
                            ,
                                <span class="json-property-enum-item">STORAGESTATE_ARCHIVED</span>
                            
                        }
                        </span>
                <span class="json-property-range" title="Value limits"></span>
                
                </span>
                                </h3>
                        </div>
                    <div class="panel-body">
                            
                    </div>
                </div>        
                <div id="definition-apiStatus" class="panel panel-definition">
                        <div class="panel-heading">
                                <h3 class="panel-title"><a name="/definitions/apiStatus"></a>apiStatus:
                                    <span class="json-property-type">
                <span class="json-property-type">object</span>
                <span class="json-property-range" title="Value limits"></span>
                
                </span>
                                </h3>
                        </div>
                    <div class="panel-body">
                            
                                    <section class="json-schema-properties">
                                        <dl>
                                                <dt data-property-name="error">
                                                    <span class="json-property-name">error:</span>
                                                    
                                                    <span class="json-property-type">string</span>
                                                    <span class="json-property-range" title="Value limits"></span>
                                                    
                                                </dt>
                                                <dd>
                                                    
                                                    <div class="json-inner-schema">
                                                        
                                                    </div>
                                                </dd>
                                                <dt data-property-name="code">
                                                    <span class="json-property-name">code:</span>
                                                    
                                                    <span class="json-property-type">integer</span>    <span class="json-property-format">(int32)</span>
                                                    <span class="json-property-range" title="Value limits"></span>
                                                    
                                                </dt>
                                                <dd>
                                                    
                                                    <div class="json-inner-schema">
                                                        
                                                    </div>
                                                </dd>
                                                <dt data-property-name="details">
                                                    <span class="json-property-name">details:</span>
                                                    
                                                    <span class="json-property-type">object[]</span>
                                                    <span class="json-property-range" title="Value limits"></span>
                                                    
                                                </dt>
                                                <dd>
                                                    
                                                    <div class="json-inner-schema">
                                                        
                                                                        <section class="json-schema-array-items">
                                                                            
                                                                            <span class="json-property-type">    <a class="json-schema-ref" href="#/definitions/protobufAny">protobufAny</a>
                                                                            </span>
                                                                            <span class="json-property-range" title="Value limits"></span>
                                                                            
                                                                            <div class="json-inner-schema">
                                                                                
                                                                            </div>
                                                                        </section>                </div>
                                                </dd>
                                        </dl>
                                    </section>
                    </div>
                </div>        
                <div id="definition-apiTrigger" class="panel panel-definition">
                        <div class="panel-heading">
                                <h3 class="panel-title"><a name="/definitions/apiTrigger"></a>apiTrigger:
                                    <span class="json-property-type">
                <span class="json-property-type">object</span>
                <span class="json-property-range" title="Value limits"></span>
                
                </span>
                                </h3>
                        </div>
                    <div class="panel-body">
                                <section class="json-schema-description">
                                    <p>Trigger defines what starts a pipeline run.</p>
                            
                                </section>
                            
                                    <section class="json-schema-properties">
                                        <dl>
                                                <dt data-property-name="cron_schedule">
                                                    <span class="json-property-name">cron_schedule:</span>
                                                    
                                                    <span class="json-property-type">    <a class="json-schema-ref" href="#/definitions/apiCronSchedule">apiCronSchedule</a>
                                                    </span>
                                                    <span class="json-property-range" title="Value limits"></span>
                                                    
                                                </dt>
                                                <dd>
                                                    
                                                    <div class="json-inner-schema">
                                                        
                                                    </div>
                                                </dd>
                                                <dt data-property-name="periodic_schedule">
                                                    <span class="json-property-name">periodic_schedule:</span>
                                                    
                                                    <span class="json-property-type">    <a class="json-schema-ref" href="#/definitions/apiPeriodicSchedule">apiPeriodicSchedule</a>
                                                    </span>
                                                    <span class="json-property-range" title="Value limits"></span>
                                                    
                                                </dt>
                                                <dd>
                                                    
                                                    <div class="json-inner-schema">
                                                        
                                                    </div>
                                                </dd>
                                        </dl>
                                    </section>
                    </div>
                </div>        
                <div id="definition-apiUrl" class="panel panel-definition">
                        <div class="panel-heading">
                                <h3 class="panel-title"><a name="/definitions/apiUrl"></a>apiUrl:
                                    <span class="json-property-type">
                <span class="json-property-type">object</span>
                <span class="json-property-range" title="Value limits"></span>
                
                </span>
                                </h3>
                        </div>
                    <div class="panel-body">
                            
                                    <section class="json-schema-properties">
                                        <dl>
                                                <dt data-property-name="pipeline_url">
                                                    <span class="json-property-name">pipeline_url:</span>
                                                    
                                                    <span class="json-property-type">string</span>
                                                    <span class="json-property-range" title="Value limits"></span>
                                                    
                                                </dt>
                                                <dd>
                                                    <p>URL of the pipeline definition or the pipeline version definition.</p>
                                    
                                                    <div class="json-inner-schema">
                                                        
                                                    </div>
                                                </dd>
                                        </dl>
                                    </section>
                    </div>
                </div>        
                <div id="definition-JobMode" class="panel panel-definition">
                        <div class="panel-heading">
                                <h3 class="panel-title"><a name="/definitions/JobMode"></a>JobMode:
                                    <span class="json-property-type">
                <span class="json-property-type">string</span>    <span class="json-property-enum" title="Possible values">, x &isin; {
                                <span class="json-property-enum-item">UNKNOWN_MODE</span>
                                (default)
                            ,
                                <span class="json-property-enum-item">ENABLED</span>
                            ,
                                <span class="json-property-enum-item">DISABLED</span>
                            
                        }
                        </span>
                <span class="json-property-range" title="Value limits"></span>
                
                </span>
                                </h3>
                        </div>
                    <div class="panel-body">
                                <section class="json-schema-description">
                                    <p>Required input.</p>
                            <ul>
                            <li>DISABLED: The job won&#39;t schedule any run if disabled.</li>
                            </ul>
                            
                                </section>
                            
                    </div>
                </div>        
                <div id="definition-PipelineSpecRuntimeConfig" class="panel panel-definition">
                        <div class="panel-heading">
                                <h3 class="panel-title"><a name="/definitions/PipelineSpecRuntimeConfig"></a>PipelineSpecRuntimeConfig:
                                    <span class="json-property-type">
                <span class="json-property-type">object</span>
                <span class="json-property-range" title="Value limits"></span>
                
                </span>
                                </h3>
                        </div>
                    <div class="panel-body">
                                <section class="json-schema-description">
                                    <p>The runtime config of a PipelineSpec.</p>
                            
                                </section>
                            
                                    <section class="json-schema-properties">
                                        <dl>
                                                <dt data-property-name="parameters">
                                                    <span class="json-property-name">parameters:</span>
                                                    
                                                    <span class="json-property-type">object</span>
                                                    <span class="json-property-range" title="Value limits"></span>
                                                    
                                                </dt>
                                                <dd>
                                                    <p>The runtime parameters of the PipelineSpec. The parameters will be
                                    used to replace the placeholders
                                    at runtime.</p>
                                    
                                                    <div class="json-inner-schema">
                                                        
                                                                    <section class="json-schema-additionalProperties">
                                                                        <span class="json-property-type">
                                                                    <span class="json-property-type">    <a class="json-schema-ref" href="#/definitions/protobufValue">protobufValue</a>
                                                                    </span>
                                                                    <span class="json-property-range" title="Value limits"></span>
                                                                    
                                                                    </span>
                                                                        
                                                                    </section>
                                                    </div>
                                                </dd>
                                                <dt data-property-name="pipeline_root">
                                                    <span class="json-property-name">pipeline_root:</span>
                                                    
                                                    <span class="json-property-type">string</span>
                                                    <span class="json-property-range" title="Value limits"></span>
                                                    
                                                </dt>
                                                <dd>
                                                    
                                                    <div class="json-inner-schema">
                                                        
                                                    </div>
                                                </dd>
                                        </dl>
                                    </section>
                    </div>
                </div>        
                <div id="definition-protobufAny" class="panel panel-definition">
                        <div class="panel-heading">
                                <h3 class="panel-title"><a name="/definitions/protobufAny"></a>protobufAny:
                                    <span class="json-property-type">
                <span class="json-property-type">object</span>
                <span class="json-property-range" title="Value limits"></span>
                
                </span>
                                </h3>
                        </div>
                    <div class="panel-body">
                                <section class="json-schema-description">
                                    <p><code>Any</code> contains an arbitrary serialized protocol buffer message along with a
                            URL that describes the type of the serialized message.</p>
                            <p>Protobuf library provides support to pack/unpack Any values in the form
                            of utility functions or additional generated methods of the Any type.</p>
                            <p>Example 1: Pack and unpack a message in C++.</p>
                            <pre><code>Foo foo = ...;<br>Any</span> <span class="hljs-built_in">any</span>;<br>any</span>.PackFrom(foo);<br>...<br>if</span> (<span class="hljs-built_in">any</span>.UnpackTo(&amp;foo)) {<br>  ...<br>}</code></pre><p>Example 2: Pack and unpack a message in Java.</p>
                            <pre><code>Foo foo = ...;<br>Any</span> <span class="hljs-built_in">any</span> = <span class="hljs-built_in">Any</span>.<span class="hljs-built_in">pack</span>(foo);<br>...<br>if</span> (<span class="hljs-built_in">any</span>.is(Foo.<span class="hljs-keyword">class</span>)) {<br>  foo = <span class="hljs-built_in">any</span>.<span class="hljs-built_in">unpack</span>(Foo.<span class="hljs-keyword">class</span>);<br>}</code></pre><p> Example 3: Pack and unpack a message in Python.</p>
                            <pre><code>foo = Foo(...)<br>any</span> = <span class="hljs-built_in">Any</span>()<br>any</span>.<span class="hljs-built_in">Pack</span>(foo)<br>...<br>if</span> <span class="hljs-built_in">any</span>.Is(Foo.DESCRIPTOR):<br>  <span class="hljs-built_in">any</span>.<span class="hljs-built_in">Unpack</span>(foo)<br>  ...</code></pre><p> Example 4: Pack and unpack a message in Go</p>
                            <pre><code> foo := &amp;pb.<span class="hljs-type">Foo</span><span class="hljs-meta">{...}</span><br> <span class="hljs-built_in">any</span>, err := anypb.<span class="hljs-type">New</span>(foo)<br> <span class="hljs-keyword">if</span> err != <span class="hljs-keyword">nil</span> {<br>   ...<br> }<br> ...<br> foo := &amp;pb.<span class="hljs-type">Foo</span>{}<br> <span class="hljs-keyword">if</span> err := <span class="hljs-built_in">any</span>.<span class="hljs-type">UnmarshalTo</span>(foo); err != <span class="hljs-keyword">nil</span> {<br>   ...<br> }</code></pre><p>The pack methods provided by protobuf library will by default use
                            &#39;type.googleapis.com/full.type.name&#39; as the type URL and the unpack
                            methods only use the fully qualified type name after the last &#39;/&#39;
                            in the type URL, for example &quot;foo.bar.com/x/y.z&quot; will yield type
                            name &quot;y.z&quot;.</p>
                            <h1 id="json">JSON</h1>
                            <p>The JSON representation of an <code>Any</code> value uses the regular
                            representation of the deserialized, embedded message, with an
                            additional field <code>@type</code> which contains the type URL. Example:</p>
                            <pre><code>package</span> google.profile;<br>message</span> <span class="hljs-title">Person</span> </span>{<br>  <span class="hljs-built_in">string</span> first_name = <span class="hljs-number">1</span>;<br>  <span class="hljs-built_in">string</span> last_name = <span class="hljs-number">2</span>;<br>}<br>
                            {<br>  <span class="hljs-string">"@type"</span>: <span class="hljs-string">"type.googleapis.com/google.profile.Person"</span>,<br>  <span class="hljs-string">"firstName"</span>: &lt;<span class="hljs-built_in">string</span>&gt;,<br>  <span class="hljs-string">"lastName"</span>: &lt;<span class="hljs-built_in">string</span>&gt;<br>}</code></pre><p>If the embedded message type is well-known and has a custom JSON
                            representation, that representation will be embedded adding a field
                            <code>value</code> which holds the custom JSON in addition to the <code>@type</code>
                            field. Example (for message [google.protobuf.Duration][]):</p>
                            <pre><code>{<br>  <span class="hljs-attr">"@type"</span>: <span class="hljs-string">"type.googleapis.com/google.protobuf.Duration"</span>,<br>  <span class="hljs-attr">"value"</span>: <span class="hljs-string">"1.212s"</span><br>}</code></pre>
                                </section>
                            
                                    <section class="json-schema-properties">
                                        <dl>
                                                <dt data-property-name="type_url">
                                                    <span class="json-property-name">type_url:</span>
                                                    
                                                    <span class="json-property-type">string</span>
                                                    <span class="json-property-range" title="Value limits"></span>
                                                    
                                                </dt>
                                                <dd>
                                                    <p>A URL/resource name that uniquely identifies the type of the serialized
                                    protocol buffer message. This string must contain at least
                                    one &quot;/&quot; character. The last segment of the URL&#39;s path must represent
                                    the fully qualified name of the type (as in
                                    <code>path/google.protobuf.Duration</code>). The name should be in a canonical form
                                    (e.g., leading &quot;.&quot; is not accepted).</p>
                                    <p>In practice, teams usually precompile into the binary all types that they
                                    expect it to use in the context of Any. However, for URLs which use the
                                    scheme <code>http</code>, <code>https</code>, or no scheme, one can optionally set up a type
                                    server that maps type URLs to message definitions as follows:</p>
                                    <ul>
                                    <li>If no scheme is provided, <code>https</code> is assumed.</li>
                                    <li>An HTTP GET on the URL must yield a [google.protobuf.Type][]
                                    value in binary format, or produce an error.</li>
                                    <li>Applications are allowed to cache lookup results based on the
                                    URL, or have them precompiled into a binary to avoid any
                                    lookup. Therefore, binary compatibility needs to be preserved
                                    on changes to types. (Use versioned type names to manage
                                    breaking changes.)</li>
                                    </ul>
                                    <p>Note: this functionality is not currently available in the official
                                    protobuf release, and it is not used for type URLs beginning with
                                    type.googleapis.com.</p>
                                    <p>Schemes other than <code>http</code>, <code>https</code> (or the empty scheme) might be
                                    used with implementation specific semantics.</p>
                                    
                                                    <div class="json-inner-schema">
                                                        
                                                    </div>
                                                </dd>
                                                <dt data-property-name="value">
                                                    <span class="json-property-name">value:</span>
                                                    
                                                    <span class="json-property-type">string</span>    <span class="json-property-format">(byte)</span>
                                                    <span class="json-property-range" title="Value limits"></span>
                                                    
                                                </dt>
                                                <dd>
                                                    <p>Must be a valid serialized protocol buffer of the above specified type.</p>
                                    
                                                    <div class="json-inner-schema">
                                                        
                                                    </div>
                                                </dd>
                                        </dl>
                                    </section>
                    </div>
                </div>        
                <div id="definition-protobufListValue" class="panel panel-definition">
                        <div class="panel-heading">
                                <h3 class="panel-title"><a name="/definitions/protobufListValue"></a>protobufListValue:
                                    <span class="json-property-type">
                <span class="json-property-type">object</span>
                <span class="json-property-range" title="Value limits"></span>
                
                </span>
                                </h3>
                        </div>
                    <div class="panel-body">
                                <section class="json-schema-description">
                                    <p><code>ListValue</code> is a wrapper around a repeated field of values.</p>
                            <p>The JSON representation for <code>ListValue</code> is JSON array.</p>
                            
                                </section>
                            
                                    <section class="json-schema-properties">
                                        <dl>
                                                <dt data-property-name="values">
                                                    <span class="json-property-name">values:</span>
                                                    
                                                    <span class="json-property-type">object[]</span>
                                                    <span class="json-property-range" title="Value limits"></span>
                                                    
                                                </dt>
                                                <dd>
                                                    <p>Repeated field of dynamically typed values.</p>
                                    
                                                    <div class="json-inner-schema">
                                                        
                                                                        <section class="json-schema-array-items">
                                                                            
                                                                            <span class="json-property-type">    <a class="json-schema-ref" href="#/definitions/protobufValue">protobufValue</a>
                                                                            </span>
                                                                            <span class="json-property-range" title="Value limits"></span>
                                                                            
                                                                            <div class="json-inner-schema">
                                                                                
                                                                            </div>
                                                                        </section>                </div>
                                                </dd>
                                        </dl>
                                    </section>
                    </div>
                </div>        
                <div id="definition-protobufNullValue" class="panel panel-definition">
                        <div class="panel-heading">
                                <h3 class="panel-title"><a name="/definitions/protobufNullValue"></a>protobufNullValue:
                                    <span class="json-property-type">
                <span class="json-property-type">string</span>    <span class="json-property-enum" title="Possible values">, x &isin; {
                                <span class="json-property-enum-item">NULL_VALUE</span>
                                (default)
                            
                        }
                        </span>
                <span class="json-property-range" title="Value limits"></span>
                
                </span>
                                </h3>
                        </div>
                    <div class="panel-body">
                                <section class="json-schema-description">
                                    <p><code>NullValue</code> is a singleton enumeration to represent the null value for the
                            <code>Value</code> type union.</p>
                            <p> The JSON representation for <code>NullValue</code> is JSON <code>null</code>.</p>
                            <ul>
                            <li>NULL_VALUE: Null value.</li>
                            </ul>
                            
                                </section>
                            
                    </div>
                </div>        
                <div id="definition-protobufStruct" class="panel panel-definition">
                        <div class="panel-heading">
                                <h3 class="panel-title"><a name="/definitions/protobufStruct"></a>protobufStruct:
                                    <span class="json-property-type">
                <span class="json-property-type">object</span>
                <span class="json-property-range" title="Value limits"></span>
                
                </span>
                                </h3>
                        </div>
                    <div class="panel-body">
                                <section class="json-schema-description">
                                    <p><code>Struct</code> represents a structured data value, consisting of fields
                            which map to dynamically typed values. In some languages, <code>Struct</code>
                            might be supported by a native representation. For example, in
                            scripting languages like JS a struct is represented as an
                            object. The details of that representation are described together
                            with the proto support for the language.</p>
                            <p>The JSON representation for <code>Struct</code> is JSON object.</p>
                            
                                </section>
                            
                                    <section class="json-schema-properties">
                                        <dl>
                                                <dt data-property-name="fields">
                                                    <span class="json-property-name">fields:</span>
                                                    
                                                    <span class="json-property-type">object</span>
                                                    <span class="json-property-range" title="Value limits"></span>
                                                    
                                                </dt>
                                                <dd>
                                                    <p>Unordered map of dynamically typed values.</p>
                                    
                                                    <div class="json-inner-schema">
                                                        
                                                                    <section class="json-schema-additionalProperties">
                                                                        <span class="json-property-type">
                                                                    <span class="json-property-type">    <a class="json-schema-ref" href="#/definitions/protobufValue">protobufValue</a>
                                                                    </span>
                                                                    <span class="json-property-range" title="Value limits"></span>
                                                                    
                                                                    </span>
                                                                        
                                                                    </section>
                                                    </div>
                                                </dd>
                                        </dl>
                                    </section>
                    </div>
                </div>        
                <div id="definition-protobufValue" class="panel panel-definition">
                        <div class="panel-heading">
                                <h3 class="panel-title"><a name="/definitions/protobufValue"></a>protobufValue:
                                    <span class="json-property-type">
                <span class="json-property-type">object</span>
                <span class="json-property-range" title="Value limits"></span>
                
                </span>
                                </h3>
                        </div>
                    <div class="panel-body">
                                <section class="json-schema-description">
                                    <p><code>Value</code> represents a dynamically typed value which can be either
                            null, a number, a string, a boolean, a recursive struct value, or a
                            list of values. A producer of value is expected to set one of that
                            variants, absence of any variant indicates an error.</p>
                            <p>The JSON representation for <code>Value</code> is JSON value.</p>
                            
                                </section>
                            
                                    <section class="json-schema-properties">
                                        <dl>
                                                <dt data-property-name="null_value">
                                                    <span class="json-property-name">null_value:</span>
                                                    
                                                    <span class="json-property-type">    <a class="json-schema-ref" href="#/definitions/protobufNullValue">protobufNullValue</a>
                                                    </span>
                                                    <span class="json-property-range" title="Value limits"></span>
                                                    
                                                </dt>
                                                <dd>
                                                    <p>Represents a null value.</p>
                                    
                                                    <div class="json-inner-schema">
                                                        
                                                    </div>
                                                </dd>
                                                <dt data-property-name="number_value">
                                                    <span class="json-property-name">number_value:</span>
                                                    
                                                    <span class="json-property-type">number</span>    <span class="json-property-format">(double)</span>
                                                    <span class="json-property-range" title="Value limits"></span>
                                                    
                                                </dt>
                                                <dd>
                                                    <p>Represents a double value.</p>
                                    
                                                    <div class="json-inner-schema">
                                                        
                                                    </div>
                                                </dd>
                                                <dt data-property-name="string_value">
                                                    <span class="json-property-name">string_value:</span>
                                                    
                                                    <span class="json-property-type">string</span>
                                                    <span class="json-property-range" title="Value limits"></span>
                                                    
                                                </dt>
                                                <dd>
                                                    <p>Represents a string value.</p>
                                    
                                                    <div class="json-inner-schema">
                                                        
                                                    </div>
                                                </dd>
                                                <dt data-property-name="bool_value">
                                                    <span class="json-property-name">bool_value:</span>
                                                    
                                                    <span class="json-property-type">boolean</span>    <span class="json-property-format">(boolean)</span>
                                                    <span class="json-property-range" title="Value limits"></span>
                                                    
                                                </dt>
                                                <dd>
                                                    <p>Represents a boolean value.</p>
                                    
                                                    <div class="json-inner-schema">
                                                        
                                                    </div>
                                                </dd>
                                                <dt data-property-name="struct_value">
                                                    <span class="json-property-name">struct_value:</span>
                                                    
                                                    <span class="json-property-type">    <a class="json-schema-ref" href="#/definitions/protobufStruct">protobufStruct</a>
                                                    </span>
                                                    <span class="json-property-range" title="Value limits"></span>
                                                    
                                                </dt>
                                                <dd>
                                                    <p>Represents a structured value.</p>
                                    
                                                    <div class="json-inner-schema">
                                                        
                                                    </div>
                                                </dd>
                                                <dt data-property-name="list_value">
                                                    <span class="json-property-name">list_value:</span>
                                                    
                                                    <span class="json-property-type">    <a class="json-schema-ref" href="#/definitions/protobufListValue">protobufListValue</a>
                                                    </span>
                                                    <span class="json-property-range" title="Value limits"></span>
                                                    
                                                </dt>
                                                <dd>
                                                    <p>Represents a repeated <code>Value</code>.</p>
                                    
                                                    <div class="json-inner-schema">
                                                        
                                                    </div>
                                                </dd>
                                        </dl>
                                    </section>
                    </div>
                </div>        
                <div id="definition-ReportRunMetricsResponseReportRunMetricResult" class="panel panel-definition">
                        <div class="panel-heading">
                                <h3 class="panel-title"><a name="/definitions/ReportRunMetricsResponseReportRunMetricResult"></a>ReportRunMetricsResponseReportRunMetricResult:
                                    <span class="json-property-type">
                <span class="json-property-type">object</span>
                <span class="json-property-range" title="Value limits"></span>
                
                </span>
                                </h3>
                        </div>
                    <div class="panel-body">
                            
                                    <section class="json-schema-properties">
                                        <dl>
                                                <dt data-property-name="metric_name">
                                                    <span class="json-property-name">metric_name:</span>
                                                    
                                                    <span class="json-property-type">string</span>
                                                    <span class="json-property-range" title="Value limits"></span>
                                                    
                                                </dt>
                                                <dd>
                                                    <p>Output. The name of the metric.</p>
                                    
                                                    <div class="json-inner-schema">
                                                        
                                                    </div>
                                                </dd>
                                                <dt data-property-name="metric_node_id">
                                                    <span class="json-property-name">metric_node_id:</span>
                                                    
                                                    <span class="json-property-type">string</span>
                                                    <span class="json-property-range" title="Value limits"></span>
                                                    
                                                </dt>
                                                <dd>
                                                    <p>Output. The ID of the node which reports the metric.</p>
                                    
                                                    <div class="json-inner-schema">
                                                        
                                                    </div>
                                                </dd>
                                                <dt data-property-name="status">
                                                    <span class="json-property-name">status:</span>
                                                    
                                                    <span class="json-property-type">    <a class="json-schema-ref" href="#/definitions/ReportRunMetricsResponseReportRunMetricResultStatus">ReportRunMetricsResponseReportRunMetricResultStatus</a>
                                                    </span>
                                                    <span class="json-property-range" title="Value limits"></span>
                                                    
                                                </dt>
                                                <dd>
                                                    <p>Output. The status of the metric reporting.</p>
                                    
                                                    <div class="json-inner-schema">
                                                        
                                                    </div>
                                                </dd>
                                                <dt data-property-name="message">
                                                    <span class="json-property-name">message:</span>
                                                    
                                                    <span class="json-property-type">string</span>
                                                    <span class="json-property-range" title="Value limits"></span>
                                                    
                                                </dt>
                                                <dd>
                                                    <p>Output. The detailed message of the error of the reporting.</p>
                                    
                                                    <div class="json-inner-schema">
                                                        
                                                    </div>
                                                </dd>
                                        </dl>
                                    </section>
                    </div>
                </div>        
                <div id="definition-ReportRunMetricsResponseReportRunMetricResultStatus" class="panel panel-definition">
                        <div class="panel-heading">
                                <h3 class="panel-title"><a name="/definitions/ReportRunMetricsResponseReportRunMetricResultStatus"></a>ReportRunMetricsResponseReportRunMetricResultStatus:
                                    <span class="json-property-type">
                <span class="json-property-type">string</span>    <span class="json-property-enum" title="Possible values">, x &isin; {
                                <span class="json-property-enum-item">UNSPECIFIED</span>
                                (default)
                            ,
                                <span class="json-property-enum-item">OK</span>
                            ,
                                <span class="json-property-enum-item">INVALID_ARGUMENT</span>
                            ,
                                <span class="json-property-enum-item">DUPLICATE_REPORTING</span>
                            ,
                                <span class="json-property-enum-item">INTERNAL_ERROR</span>
                            
                        }
                        </span>
                <span class="json-property-range" title="Value limits"></span>
                
                </span>
                                </h3>
                        </div>
                    <div class="panel-body">
                                <section class="json-schema-description">
                                    <ul>
                            <li>UNSPECIFIED: Default value if not present.</li>
                            <li>OK: Indicates successful reporting.</li>
                            <li>INVALID_ARGUMENT: Indicates that the payload of the metric is invalid.</li>
                            <li>DUPLICATE_REPORTING: Indicates that the metric has been reported before.</li>
                            <li>INTERNAL_ERROR: Indicates that something went wrong in the server.</li>
                            </ul>
                            
                                </section>
                            
                    </div>
                </div>        
                <div id="definition-RunMetricFormat" class="panel panel-definition">
                        <div class="panel-heading">
                                <h3 class="panel-title"><a name="/definitions/RunMetricFormat"></a>RunMetricFormat:
                                    <span class="json-property-type">
                <span class="json-property-type">string</span>    <span class="json-property-enum" title="Possible values">, x &isin; {
                                <span class="json-property-enum-item">UNSPECIFIED</span>
                                (default)
                            ,
                                <span class="json-property-enum-item">RAW</span>
                            ,
                                <span class="json-property-enum-item">PERCENTAGE</span>
                            
                        }
                        </span>
                <span class="json-property-range" title="Value limits"></span>
                
                </span>
                                </h3>
                        </div>
                    <div class="panel-body">
                                <section class="json-schema-description">
                                    <ul>
                            <li>UNSPECIFIED: Default value if not present.</li>
                            <li>RAW: Display value as its raw format.</li>
                            <li>PERCENTAGE: Display value in percentage format.</li>
                            </ul>
                            
                                </section>
                            
                    </div>
                </div>
</div>

</body>
</html>

</div>



    
	
  
    
    
	
    

<div class="td-content" style="page-break-before: always">
    
	<h1 id="pg-160d2268979e6dd7a6add5e009df9bb1">3.1.9.3 -  Pipelines SDK Reference</h1>
    <div class="lead">Reference documentation for the Kubeflow Pipelines SDK</div>
	<p>See the <a href="https://kubeflow-pipelines.readthedocs.io/en/stable/">generated reference docs for the Python
SDK</a> (hosted on
<em>Read the Docs</em>).</p>

</div>



    
	
  

    
	
  

    
	
  
    
    
	
    

<div class="td-content" style="page-break-before: always">
    
	<h1 id="pg-2e292725af6ef6d4ac4f546c6c3652a4">3.2 - v2</h1>
    <div class="lead">Kubeflow Pipelines v2 Documentation</div>
	<p><strong>Note:</strong> Kubeflow Pipelines v2 is in pre-release stage and is not yet stable. The v2 docs being are continually developed and links to v2 documentation are also not yet stable.</p>
<p>Please see <a href="/docs/components/pipelines/v1">v1 documentation</a> for documentation on the latest stable KFP release.</p>

</div>



    
      
  
  
  
  

  
  

  
    
    
	
    

<div class="td-content" style="">
    
	<h1 id="pg-491d81fa84033751ec5e23d040fe3b20">3.2.1 - Introduction</h1>
    <div class="lead">What is Kubeflow Pipelines?</div>
	<p>Kubeflow Pipelines (KFP) is a platform for building and deploying portable and
scalable machine learning (ML) workflows by using Docker containers.</p>
<p>KFP is available as a core component of Kubeflow or as a standalone installation. To quickly get started with a KFP deployment and usage example, see the <a href="/docs/components/pipelines/v2/quickstart">Quickstart</a> guide.</p>
<!-- TODO: Include these links once the topic is available -->
<!-- [Learn more about installing Kubeflow][Installation]
[Learn more about installing Kubeflow Pipelines standalone][Installation] -->
<h2 id="objectives">Objectives</h2>
<p>The primary objectives of Kubeflow Pipelines are to enable the following:</p>
<ul>
<li>End-to-end orchestration of ML workflows</li>
<li>Pipeline composability through reusable components and pipelines</li>
<li>Easy management, tracking, and visualization of pipeline definitions, pipeline runs, experiments, and ML artifacts</li>
<li>Efficient use of compute resources by eliminating redundant executions through <a href="/docs/components/pipelines/v2/author-a-pipeline/tasks/#caching">caching</a></li>
<li>Cross-platform pipeline portability through a platform-neutral <a href="/docs/components/pipelines/v2/compile-a-pipeline/#ir-yaml">IR YAML pipeline definition</a></li>
</ul>
<h2 id="what-is-a-pipeline">What is a pipeline?</h2>
<p>A <a href="/docs/components/pipelines/v2/author-a-pipeline/pipelines"><em>pipeline</em></a> is the definition of a workflow with one or more steps called <a href="/docs/components/pipelines/v2/author-a-pipeline/tasks"><em>tasks</em></a>. A task is defined by a single container execution and includes output parameters. Each task in a pipeline might also include input parameters. By specifying the output of one task as the input of another task, a pipeline author can form a computed acyclic graph (DAG) of tasks.</p>
<p>Pipelines are written in Python for an easy authoring experience, compiled to YAML for portability, and executed on Kubernetes for scalability.</p>
<h2 id="what-does-using-kfp-look-like">What does using KFP look like?</h2>
<p>At a high level, using KFP consists of the following steps:</p>
<ol>
<li><a href="/docs/components/pipelines/v2/author-a-pipeline">Author a pipeline</a> with one or more components using the <strong>Python KFP SDK</strong>&rsquo;s domain-specific language (DSL). You can <a href="/docs/components/pipelines/v2/author-a-pipeline/components">author your own components</a> or use prebuilt components provided by other authors.</li>
<li><a href="/docs/components/pipelines/v2/compile-a-pipeline">Compile the pipeline</a> into a static representation (YAML) by using the <strong>KFP SDK&rsquo;s DSL compiler</strong>.</li>
<li>Submit the pipeline to run on the <strong>KFP backend</strong>. The KFP backend orchestrates the Kubernetes Pod creation and data passes, which are required to execute your workflow.</li>
<li>View your runs, experiments, and ML artifacts on the <strong>KFP Dashboard</strong>.</li>
</ol>
<h2 id="next-steps">Next steps</h2>
<ul>
<li>Follow the
<a href="/docs/components/pipelines/v2/quickstart">pipelines quickstart guide</a> guide to
deploy Kubeflow Pipelines and run your first pipeline</li>
</ul>
<!-- TODO: Uncomment these links once the topic is created -->
<!-- * Learn more about the [different ways to install KFP][installation] -->
<ul>
<li>Learn more about <a href="/docs/components/pipelines/v2/author-a-pipeline">authoring pipelines</a></li>
</ul>

</div>



    
	
  
    
    
	
    

<div class="td-content" style="page-break-before: always">
    
	<h1 id="pg-40b7d37854add4a8b5bab284800cd2e8">3.2.2 - Installation</h1>
    <div class="lead">Options to install Kubeflow Pipelines</div>
	<p>This page will be available soon. For similar information, see <a href="/docs/components/pipelines/v1/installation/">KFP v1 installation documentation</a>.</p>

</div>



    
	
  
    
    
	
    

<div class="td-content" style="page-break-before: always">
    
	<h1 id="pg-50b1788ca8945aadd369ed873937651f">3.2.3 - Quickstart</h1>
    <div class="lead">Get started with Kubeflow Pipelines</div>
	<style type="text/css">
summary::marker {
    font-size: 1.5rem;
}
summary {
    margin-bottom: 1.5rem;
}
</style>
<!-- TODO: add UI screenshots for final pipeline -->
<p>This tutorial helps you get started with KFP.</p>
<p>Before you begin, you need the following prerequisites:</p>
<ul>
<li>
<p><strong>An existing Kubernetes cluster</strong>: If you don&rsquo;t have a Kubernetes cluster, see <a href="/docs/components/pipelines/v2/installation/">Installation</a> for instructions about how to get one.</p>
</li>
<li>
<p><strong>The <a href="https://kubernetes.io/docs/tasks/tools/">kubectl</a> command-line tool</strong>: Install and configure your <a href="https://kubernetes.io/docs/tasks/access-application-cluster/configure-access-multiple-clusters/">kubectl context</a> to connect with your cluster.</p>
</li>
<li>
<p>Run the following script to install the KFP SDK:</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-shell" data-lang="shell"><span class="line"><span class="cl">pip install kfp --pre
</span></span></code></pre></div><p><strong>Note:</strong> This command installs KFP v2, which is in pre-release stage and is not yet stable. The v2 documentation is being developed continually and some of the links to the v2 documentation might be unavailable.</p>
</li>
</ul>
<p>After you complete the prerequisites, click each step to view the instructions:</p>
<details>
  <summary><a name="kfp_qs_step1"></a><h2 style="display:inline;">Step 1: Deploy a KFP standalone instance into your cluster</h2></summary>
  <hr/>
  This step shows how to deploy a KFP standalone instance into an existing Kubernetes cluster.
<p>Run the following script after replacing <code>PIPELINE_VERSION</code> with the desired version of KFP:</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-shell" data-lang="shell"><span class="line"><span class="cl"><span class="nb">export</span> <span class="nv">PIPELINE_VERSION</span><span class="o">=</span><span class="s2">&#34;2.0.0-alpha.4&#34;</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">kubectl apply -k <span class="s2">&#34;github.com/kubeflow/pipelines/manifests/kustomize/cluster-scoped-resources?ref=</span><span class="nv">$PIPELINE_VERSION</span><span class="s2">&#34;</span>
</span></span><span class="line"><span class="cl">kubectl <span class="nb">wait</span> --for <span class="nv">condition</span><span class="o">=</span>established --timeout<span class="o">=</span>60s crd/applications.app.k8s.io
</span></span><span class="line"><span class="cl">kubectl apply -k <span class="s2">&#34;github.com/kubeflow/pipelines/manifests/kustomize/env/dev?ref=</span><span class="nv">$PIPELINE_VERSION</span><span class="s2">&#34;</span>
</span></span></code></pre></div><p>After you deploy Kubernetes, obtain your KFP endpoint by following <a href="/docs/components/pipelines/v2/installation/">these instructions</a>.</p>
  <!-- TODO: add more precise section link and descriptive link text (with more context) when available -->
</details>
<details>
  <summary><a name="kfp_qs_step2"></a><h2 style="display:inline;">Step 2: Create and run a simple pipeline using the KFP SDK</h2></summary>
  <hr/>
This step shows how to use the KFP SDK to compose a pipeline and submit it for execution by KFP.
<p>The following simple pipeline adds two integers, and then adds another integer to the result to come up with a final sum.</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-python" data-lang="python"><span class="line"><span class="cl"><span class="kn">from</span> <span class="nn">kfp</span> <span class="kn">import</span> <span class="n">dsl</span>
</span></span><span class="line"><span class="cl"><span class="kn">from</span> <span class="nn">kfp</span> <span class="kn">import</span> <span class="n">client</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="nd">@dsl</span><span class="o">.</span><span class="n">component</span>
</span></span><span class="line"><span class="cl"><span class="k">def</span> <span class="nf">addition_component</span><span class="p">(</span><span class="n">num1</span><span class="p">:</span> <span class="nb">int</span><span class="p">,</span> <span class="n">num2</span><span class="p">:</span> <span class="nb">int</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">int</span><span class="p">:</span>
</span></span><span class="line"><span class="cl">    <span class="k">return</span> <span class="n">num1</span> <span class="o">+</span> <span class="n">num2</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="nd">@dsl</span><span class="o">.</span><span class="n">pipeline</span><span class="p">(</span><span class="n">name</span><span class="o">=</span><span class="s1">&#39;addition-pipeline&#39;</span><span class="p">)</span>
</span></span><span class="line"><span class="cl"><span class="k">def</span> <span class="nf">my_pipeline</span><span class="p">(</span><span class="n">a</span><span class="p">:</span> <span class="nb">int</span><span class="p">,</span> <span class="n">b</span><span class="p">:</span> <span class="nb">int</span><span class="p">,</span> <span class="n">c</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="mi">10</span><span class="p">):</span>
</span></span><span class="line"><span class="cl">    <span class="n">add_task_1</span> <span class="o">=</span> <span class="n">addition_component</span><span class="p">(</span><span class="n">num1</span><span class="o">=</span><span class="n">a</span><span class="p">,</span> <span class="n">num2</span><span class="o">=</span><span class="n">b</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">    <span class="n">add_task_2</span> <span class="o">=</span> <span class="n">addition_component</span><span class="p">(</span><span class="n">num1</span><span class="o">=</span><span class="n">add_task_1</span><span class="o">.</span><span class="n">output</span><span class="p">,</span> <span class="n">num2</span><span class="o">=</span><span class="n">c</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="n">endpoint</span> <span class="o">=</span> <span class="s1">&#39;&lt;KFP_ENDPOINT&gt;&#39;</span>
</span></span><span class="line"><span class="cl"><span class="n">kfp_client</span> <span class="o">=</span> <span class="n">client</span><span class="o">.</span><span class="n">Client</span><span class="p">(</span><span class="n">host</span><span class="o">=</span><span class="n">endpoint</span><span class="p">)</span>
</span></span><span class="line"><span class="cl"><span class="n">run</span> <span class="o">=</span> <span class="n">kfp_client</span><span class="o">.</span><span class="n">create_run_from_pipeline_func</span><span class="p">(</span>
</span></span><span class="line"><span class="cl">    <span class="n">my_pipeline</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">    <span class="n">arguments</span><span class="o">=</span><span class="p">{</span>
</span></span><span class="line"><span class="cl">        <span class="s1">&#39;a&#39;</span><span class="p">:</span> <span class="mi">1</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">        <span class="s1">&#39;b&#39;</span><span class="p">:</span> <span class="mi">2</span>
</span></span><span class="line"><span class="cl">    <span class="p">},</span>
</span></span><span class="line"><span class="cl"><span class="p">)</span>
</span></span><span class="line"><span class="cl"><span class="n">url</span> <span class="o">=</span> <span class="sa">f</span><span class="s1">&#39;</span><span class="si">{</span><span class="n">endpoint</span><span class="si">}</span><span class="s1">/#/runs/details/</span><span class="si">{</span><span class="n">run</span><span class="o">.</span><span class="n">run_id</span><span class="si">}</span><span class="s1">&#39;</span>
</span></span><span class="line"><span class="cl"><span class="nb">print</span><span class="p">(</span><span class="n">url</span><span class="p">)</span>
</span></span></code></pre></div><p>The above code consists of the following parts:</p>
<ul>
<li>
<p>In the first part, the following lines create a <a href="/docs/components/pipelines/v2/author-a-pipeline/components/#1-lighweight-python-function-based-components">lightweight Python component</a> by using the <code>@dsl.component</code> decorator:</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-python" data-lang="python"><span class="line"><span class="cl"><span class="nd">@dsl</span><span class="o">.</span><span class="n">component</span>
</span></span><span class="line"><span class="cl"><span class="k">def</span> <span class="nf">addition_component</span><span class="p">(</span><span class="n">num1</span><span class="p">:</span> <span class="nb">int</span><span class="p">,</span> <span class="n">num2</span><span class="p">:</span> <span class="nb">int</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">int</span><span class="p">:</span>
</span></span><span class="line"><span class="cl">  <span class="k">return</span> <span class="n">num1</span> <span class="o">+</span> <span class="n">num2</span>
</span></span></code></pre></div><p>The <code>@dsl.component</code> decorator transforms a Python function into a component, which can be used within a pipeline. You are required to specify the type annotations on the parameters as well as the return value, as these inform the KFP executor how to serialize and deserialize the data passed between components. The type annotations and return value also enable the KFP compiler to type check any data that is passed between pipeline tasks.</p>
</li>
<li>
<p>In the second part, the following lines <a href="/docs/components/pipelines/v2/author-a-pipeline/pipelines">create a pipeline</a> by using the <code>@dsl.pipeline</code> decorator:</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-python" data-lang="python"><span class="line"><span class="cl"><span class="nd">@dsl</span><span class="o">.</span><span class="n">pipeline</span><span class="p">(</span><span class="n">name</span><span class="o">=</span><span class="s1">&#39;addition-pipeline&#39;</span><span class="p">)</span>
</span></span><span class="line"><span class="cl"><span class="k">def</span> <span class="nf">my_pipeline</span><span class="p">(</span><span class="n">a</span><span class="p">:</span> <span class="nb">int</span><span class="p">,</span> <span class="n">b</span><span class="p">:</span> <span class="nb">int</span><span class="p">,</span> <span class="n">c</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="mi">10</span><span class="p">):</span>
</span></span><span class="line"><span class="cl">  <span class="o">...</span>
</span></span></code></pre></div><p>Like the component decorator, the <code>@dsl.pipeline</code> decorator transforms a Python function into a pipeline that can be executed by the KFP backend. The pipeline can have arguments. These arguments also require type annotations. In this example, the argument <code>c</code> has a default value of <code>10</code>.</p>
</li>
<li>
<p>In the third part, the following lines connect the components together to form a computational directed acyclic graph (DAG) within the body of the pipeline function:</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-python" data-lang="python"><span class="line"><span class="cl"><span class="n">add_task_1</span> <span class="o">=</span> <span class="n">addition_component</span><span class="p">(</span><span class="n">num1</span><span class="o">=</span><span class="n">a</span><span class="p">,</span> <span class="n">num2</span><span class="o">=</span><span class="n">b</span><span class="p">)</span>
</span></span><span class="line"><span class="cl"><span class="n">add_task_2</span> <span class="o">=</span> <span class="n">addition_component</span><span class="p">(</span><span class="n">num1</span><span class="o">=</span><span class="n">add_task_1</span><span class="o">.</span><span class="n">output</span><span class="p">,</span> <span class="n">num2</span><span class="o">=</span><span class="n">c</span><span class="p">)</span>
</span></span></code></pre></div><p>This example instantiates two different addition tasks from the same component named <code>addition_component</code>, by passing different arguments to the component function for each task, as follows:</p>
<ul>
<li>The first task accepts pipeline parameters <code>a</code> and <code>b</code> as input arguments.</li>
<li>The second task accepts <code>add_task_1.output</code>, which is the output from <code>add_task_1</code>, as the first input argument. The pipeline parameter <code>c</code> is the second input argument.</li>
</ul>
<p>You must always pass component arguments as keyword arguments.</p>
</li>
<li>
<p>In the fourth part, the following lines instantiate a KFP client using the endpoint obtained in <a href="#kfp_qs_step1">step 1</a> and submit the pipeline to the KFP backend with the required pipeline arguments:</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-python" data-lang="python"><span class="line"><span class="cl"><span class="n">endpoint</span> <span class="o">=</span> <span class="s1">&#39;&lt;KFP_ENDPOINT&gt;&#39;</span>
</span></span><span class="line"><span class="cl"><span class="n">kfp_client</span> <span class="o">=</span> <span class="n">client</span><span class="o">.</span><span class="n">Client</span><span class="p">(</span><span class="n">host</span><span class="o">=</span><span class="n">endpoint</span><span class="p">)</span>
</span></span><span class="line"><span class="cl"><span class="n">run</span> <span class="o">=</span> <span class="n">kfp_client</span><span class="o">.</span><span class="n">create_run_from_pipeline_func</span><span class="p">(</span>
</span></span><span class="line"><span class="cl">  <span class="n">my_pipeline</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">  <span class="n">arguments</span><span class="o">=</span><span class="p">{</span>
</span></span><span class="line"><span class="cl">    <span class="s1">&#39;a&#39;</span><span class="p">:</span> <span class="mi">1</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">    <span class="s1">&#39;b&#39;</span><span class="p">:</span> <span class="mi">2</span>
</span></span><span class="line"><span class="cl">  <span class="p">},</span>
</span></span><span class="line"><span class="cl"><span class="p">)</span>
</span></span><span class="line"><span class="cl"><span class="n">url</span> <span class="o">=</span> <span class="sa">f</span><span class="s1">&#39;</span><span class="si">{</span><span class="n">endpoint</span><span class="si">}</span><span class="s1">/#/runs/details/</span><span class="si">{</span><span class="n">run</span><span class="o">.</span><span class="n">run_id</span><span class="si">}</span><span class="s1">&#39;</span>
</span></span><span class="line"><span class="cl"><span class="nb">print</span><span class="p">(</span><span class="n">url</span><span class="p">)</span>
</span></span></code></pre></div><p>In this example, replace <code>endpoint</code> with the KFP endpoint URL you obtained in the from <a href="#kfp_qs_step1">step 1</a>.</p>
<p>Alternatively, you can compile the pipeline to <a href="/docs/components/pipelines/v2/compile-a-pipeline/#ir-yaml">IR YAML</a> for use at another time:</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-python" data-lang="python"><span class="line"><span class="cl"><span class="kn">from</span> <span class="nn">kfp</span> <span class="kn">import</span> <span class="n">compiler</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="n">compiler</span><span class="o">.</span><span class="n">Compiler</span><span class="p">()</span><span class="o">.</span><span class="n">compile</span><span class="p">(</span><span class="n">pipeline_func</span><span class="o">=</span><span class="n">my_pipeline</span><span class="p">,</span> <span class="n">package_path</span><span class="o">=</span><span class="s1">&#39;pipeline.yaml&#39;</span><span class="p">)</span>
</span></span></code></pre></div></li>
</ul>
</details>
<details>
  <summary><a name="kfp_qs_step3"></a><h2 style="display:inline;">Step 3: View the pipeline in the KFP Dashboard</h2></summary>
  <hr/>
<p>This step shows how to view the pipeline run on the KFP Dashboard. To do this, go to the URL printed from <a href="#kfp_qs_step_2">step 2</a>.</p>
<p>To view the details of each task, including input and output, click the appropriate task node.</p>
<!-- TODO: add logs to this list when available in v2 -->
<p><img src="/docs/images/pipelines/addition_pipeline_ui.png" 
alt="Pipelines Dashboard"
class="mt-3 mb-3 border border-info rounded"></p>
</details>
<details>
  <summary><a name="kfp_qs_step4"></a><h2 style="display:inline;">Step 4: Build a more advanced ML pipeline</h2></summary>
  <hr/>
This step shows how to build a more advanced machine learning (ML) pipeline that demonstrates additional KFP pipeline composition features.
<p>The following ML pipeline creates a dataset, normalizes the features of the dataset as a preprocessing step, and trains a simple ML model on the data using different hyperparameters:</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-python" data-lang="python"><span class="line"><span class="cl"><span class="kn">from</span> <span class="nn">typing</span> <span class="kn">import</span> <span class="n">List</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="kn">from</span> <span class="nn">kfp</span> <span class="kn">import</span> <span class="n">client</span>
</span></span><span class="line"><span class="cl"><span class="kn">from</span> <span class="nn">kfp</span> <span class="kn">import</span> <span class="n">dsl</span>
</span></span><span class="line"><span class="cl"><span class="kn">from</span> <span class="nn">kfp.dsl</span> <span class="kn">import</span> <span class="n">Dataset</span>
</span></span><span class="line"><span class="cl"><span class="kn">from</span> <span class="nn">kfp.dsl</span> <span class="kn">import</span> <span class="n">Input</span>
</span></span><span class="line"><span class="cl"><span class="kn">from</span> <span class="nn">kfp.dsl</span> <span class="kn">import</span> <span class="n">Model</span>
</span></span><span class="line"><span class="cl"><span class="kn">from</span> <span class="nn">kfp.dsl</span> <span class="kn">import</span> <span class="n">Output</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="nd">@dsl</span><span class="o">.</span><span class="n">component</span><span class="p">(</span><span class="n">packages_to_install</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;pandas==1.3.5&#39;</span><span class="p">])</span>
</span></span><span class="line"><span class="cl"><span class="k">def</span> <span class="nf">create_dataset</span><span class="p">(</span><span class="n">iris_dataset</span><span class="p">:</span> <span class="n">Output</span><span class="p">[</span><span class="n">Dataset</span><span class="p">]):</span>
</span></span><span class="line"><span class="cl">    <span class="kn">import</span> <span class="nn">pandas</span> <span class="k">as</span> <span class="nn">pd</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">    <span class="n">csv_url</span> <span class="o">=</span> <span class="s1">&#39;https://archive.ics.uci.edu/ml/machine-learning-databases/iris/iris.data&#39;</span>
</span></span><span class="line"><span class="cl">    <span class="n">col_names</span> <span class="o">=</span> <span class="p">[</span>
</span></span><span class="line"><span class="cl">        <span class="s1">&#39;Sepal_Length&#39;</span><span class="p">,</span> <span class="s1">&#39;Sepal_Width&#39;</span><span class="p">,</span> <span class="s1">&#39;Petal_Length&#39;</span><span class="p">,</span> <span class="s1">&#39;Petal_Width&#39;</span><span class="p">,</span> <span class="s1">&#39;Labels&#39;</span>
</span></span><span class="line"><span class="cl">    <span class="p">]</span>
</span></span><span class="line"><span class="cl">    <span class="n">df</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">read_csv</span><span class="p">(</span><span class="n">csv_url</span><span class="p">,</span> <span class="n">names</span><span class="o">=</span><span class="n">col_names</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">    <span class="k">with</span> <span class="nb">open</span><span class="p">(</span><span class="n">iris_dataset</span><span class="o">.</span><span class="n">path</span><span class="p">,</span> <span class="s1">&#39;w&#39;</span><span class="p">)</span> <span class="k">as</span> <span class="n">f</span><span class="p">:</span>
</span></span><span class="line"><span class="cl">        <span class="n">df</span><span class="o">.</span><span class="n">to_csv</span><span class="p">(</span><span class="n">f</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="nd">@dsl</span><span class="o">.</span><span class="n">component</span><span class="p">(</span><span class="n">packages_to_install</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;pandas==1.3.5&#39;</span><span class="p">,</span> <span class="s1">&#39;scikit-learn==1.0.2&#39;</span><span class="p">])</span>
</span></span><span class="line"><span class="cl"><span class="k">def</span> <span class="nf">normalize_dataset</span><span class="p">(</span>
</span></span><span class="line"><span class="cl">    <span class="n">input_iris_dataset</span><span class="p">:</span> <span class="n">Input</span><span class="p">[</span><span class="n">Dataset</span><span class="p">],</span>
</span></span><span class="line"><span class="cl">    <span class="n">normalized_iris_dataset</span><span class="p">:</span> <span class="n">Output</span><span class="p">[</span><span class="n">Dataset</span><span class="p">],</span>
</span></span><span class="line"><span class="cl">    <span class="n">standard_scaler</span><span class="p">:</span> <span class="nb">bool</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">    <span class="n">min_max_scaler</span><span class="p">:</span> <span class="nb">bool</span><span class="p">,</span>
</span></span><span class="line"><span class="cl"><span class="p">):</span>
</span></span><span class="line"><span class="cl">    <span class="k">if</span> <span class="n">standard_scaler</span> <span class="ow">is</span> <span class="n">min_max_scaler</span><span class="p">:</span>
</span></span><span class="line"><span class="cl">        <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span>
</span></span><span class="line"><span class="cl">            <span class="s1">&#39;Exactly one of standard_scaler or min_max_scaler must be True.&#39;</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">    <span class="kn">import</span> <span class="nn">pandas</span> <span class="k">as</span> <span class="nn">pd</span>
</span></span><span class="line"><span class="cl">    <span class="kn">from</span> <span class="nn">sklearn.preprocessing</span> <span class="kn">import</span> <span class="n">MinMaxScaler</span>
</span></span><span class="line"><span class="cl">    <span class="kn">from</span> <span class="nn">sklearn.preprocessing</span> <span class="kn">import</span> <span class="n">StandardScaler</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">    <span class="k">with</span> <span class="nb">open</span><span class="p">(</span><span class="n">input_iris_dataset</span><span class="o">.</span><span class="n">path</span><span class="p">)</span> <span class="k">as</span> <span class="n">f</span><span class="p">:</span>
</span></span><span class="line"><span class="cl">        <span class="n">df</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">read_csv</span><span class="p">(</span><span class="n">f</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">    <span class="n">labels</span> <span class="o">=</span> <span class="n">df</span><span class="o">.</span><span class="n">pop</span><span class="p">(</span><span class="s1">&#39;Labels&#39;</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">    <span class="k">if</span> <span class="n">standard_scaler</span><span class="p">:</span>
</span></span><span class="line"><span class="cl">        <span class="n">scaler</span> <span class="o">=</span> <span class="n">StandardScaler</span><span class="p">()</span>
</span></span><span class="line"><span class="cl">    <span class="k">if</span> <span class="n">min_max_scaler</span><span class="p">:</span>
</span></span><span class="line"><span class="cl">        <span class="n">scaler</span> <span class="o">=</span> <span class="n">MinMaxScaler</span><span class="p">()</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">    <span class="n">df</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span><span class="n">scaler</span><span class="o">.</span><span class="n">fit_transform</span><span class="p">(</span><span class="n">df</span><span class="p">))</span>
</span></span><span class="line"><span class="cl">    <span class="n">df</span><span class="p">[</span><span class="s1">&#39;Labels&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">labels</span>
</span></span><span class="line"><span class="cl">    <span class="k">with</span> <span class="nb">open</span><span class="p">(</span><span class="n">normalized_iris_dataset</span><span class="o">.</span><span class="n">path</span><span class="p">,</span> <span class="s1">&#39;w&#39;</span><span class="p">)</span> <span class="k">as</span> <span class="n">f</span><span class="p">:</span>
</span></span><span class="line"><span class="cl">        <span class="n">df</span><span class="o">.</span><span class="n">to_csv</span><span class="p">(</span><span class="n">f</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="nd">@dsl</span><span class="o">.</span><span class="n">component</span><span class="p">(</span><span class="n">packages_to_install</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;pandas==1.3.5&#39;</span><span class="p">,</span> <span class="s1">&#39;scikit-learn==1.0.2&#39;</span><span class="p">])</span>
</span></span><span class="line"><span class="cl"><span class="k">def</span> <span class="nf">train_model</span><span class="p">(</span>
</span></span><span class="line"><span class="cl">    <span class="n">normalized_iris_dataset</span><span class="p">:</span> <span class="n">Input</span><span class="p">[</span><span class="n">Dataset</span><span class="p">],</span>
</span></span><span class="line"><span class="cl">    <span class="n">model</span><span class="p">:</span> <span class="n">Output</span><span class="p">[</span><span class="n">Model</span><span class="p">],</span>
</span></span><span class="line"><span class="cl">    <span class="n">n_neighbors</span><span class="p">:</span> <span class="nb">int</span><span class="p">,</span>
</span></span><span class="line"><span class="cl"><span class="p">):</span>
</span></span><span class="line"><span class="cl">    <span class="kn">import</span> <span class="nn">pickle</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">    <span class="kn">import</span> <span class="nn">pandas</span> <span class="k">as</span> <span class="nn">pd</span>
</span></span><span class="line"><span class="cl">    <span class="kn">from</span> <span class="nn">sklearn.model_selection</span> <span class="kn">import</span> <span class="n">train_test_split</span>
</span></span><span class="line"><span class="cl">    <span class="kn">from</span> <span class="nn">sklearn.neighbors</span> <span class="kn">import</span> <span class="n">KNeighborsClassifier</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">    <span class="k">with</span> <span class="nb">open</span><span class="p">(</span><span class="n">normalized_iris_dataset</span><span class="o">.</span><span class="n">path</span><span class="p">)</span> <span class="k">as</span> <span class="n">f</span><span class="p">:</span>
</span></span><span class="line"><span class="cl">        <span class="n">df</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">read_csv</span><span class="p">(</span><span class="n">f</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">    <span class="n">y</span> <span class="o">=</span> <span class="n">df</span><span class="o">.</span><span class="n">pop</span><span class="p">(</span><span class="s1">&#39;Labels&#39;</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">    <span class="n">X</span> <span class="o">=</span> <span class="n">df</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">    <span class="n">X_train</span><span class="p">,</span> <span class="n">X_test</span><span class="p">,</span> <span class="n">y_train</span><span class="p">,</span> <span class="n">y_test</span> <span class="o">=</span> <span class="n">train_test_split</span><span class="p">(</span><span class="n">X</span><span class="p">,</span> <span class="n">y</span><span class="p">,</span> <span class="n">random_state</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">    <span class="n">clf</span> <span class="o">=</span> <span class="n">KNeighborsClassifier</span><span class="p">(</span><span class="n">n_neighbors</span><span class="o">=</span><span class="n">n_neighbors</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">    <span class="n">clf</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span><span class="n">X_train</span><span class="p">,</span> <span class="n">y_train</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">    <span class="k">with</span> <span class="nb">open</span><span class="p">(</span><span class="n">model</span><span class="o">.</span><span class="n">path</span><span class="p">,</span> <span class="s1">&#39;wb&#39;</span><span class="p">)</span> <span class="k">as</span> <span class="n">f</span><span class="p">:</span>
</span></span><span class="line"><span class="cl">        <span class="n">pickle</span><span class="o">.</span><span class="n">dump</span><span class="p">(</span><span class="n">clf</span><span class="p">,</span> <span class="n">f</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="nd">@dsl</span><span class="o">.</span><span class="n">pipeline</span><span class="p">(</span><span class="n">name</span><span class="o">=</span><span class="s1">&#39;iris-training-pipeline&#39;</span><span class="p">)</span>
</span></span><span class="line"><span class="cl"><span class="k">def</span> <span class="nf">my_pipeline</span><span class="p">(</span>
</span></span><span class="line"><span class="cl">    <span class="n">standard_scaler</span><span class="p">:</span> <span class="nb">bool</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">    <span class="n">min_max_scaler</span><span class="p">:</span> <span class="nb">bool</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">    <span class="n">neighbors</span><span class="p">:</span> <span class="n">List</span><span class="p">[</span><span class="nb">int</span><span class="p">],</span>
</span></span><span class="line"><span class="cl"><span class="p">):</span>
</span></span><span class="line"><span class="cl">    <span class="n">create_dataset_task</span> <span class="o">=</span> <span class="n">create_dataset</span><span class="p">()</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">    <span class="n">normalize_dataset_task</span> <span class="o">=</span> <span class="n">normalize_dataset</span><span class="p">(</span>
</span></span><span class="line"><span class="cl">        <span class="n">input_iris_dataset</span><span class="o">=</span><span class="n">create_dataset_task</span><span class="o">.</span><span class="n">outputs</span><span class="p">[</span><span class="s1">&#39;iris_dataset&#39;</span><span class="p">],</span>
</span></span><span class="line"><span class="cl">        <span class="n">standard_scaler</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">        <span class="n">min_max_scaler</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">    <span class="k">with</span> <span class="n">dsl</span><span class="o">.</span><span class="n">ParallelFor</span><span class="p">(</span><span class="n">neighbors</span><span class="p">)</span> <span class="k">as</span> <span class="n">n_neighbors</span><span class="p">:</span>
</span></span><span class="line"><span class="cl">        <span class="n">train_model</span><span class="p">(</span>
</span></span><span class="line"><span class="cl">            <span class="n">normalized_iris_dataset</span><span class="o">=</span><span class="n">normalize_dataset_task</span>
</span></span><span class="line"><span class="cl">            <span class="o">.</span><span class="n">outputs</span><span class="p">[</span><span class="s1">&#39;normalized_iris_dataset&#39;</span><span class="p">],</span>
</span></span><span class="line"><span class="cl">            <span class="n">n_neighbors</span><span class="o">=</span><span class="n">n_neighbors</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="n">endpoint</span> <span class="o">=</span> <span class="s1">&#39;&lt;KFP_UI_URL&gt;&#39;</span>
</span></span><span class="line"><span class="cl"><span class="n">kfp_client</span> <span class="o">=</span> <span class="n">client</span><span class="o">.</span><span class="n">Client</span><span class="p">(</span><span class="n">host</span><span class="o">=</span><span class="n">endpoint</span><span class="p">)</span>
</span></span><span class="line"><span class="cl"><span class="n">run</span> <span class="o">=</span> <span class="n">kfp_client</span><span class="o">.</span><span class="n">create_run_from_pipeline_func</span><span class="p">(</span>
</span></span><span class="line"><span class="cl">    <span class="n">my_pipeline</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">    <span class="n">arguments</span><span class="o">=</span><span class="p">{</span>
</span></span><span class="line"><span class="cl">        <span class="s1">&#39;min_max_scaler&#39;</span><span class="p">:</span> <span class="kc">True</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">        <span class="s1">&#39;standard_scaler&#39;</span><span class="p">:</span> <span class="kc">False</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">        <span class="s1">&#39;neighbors&#39;</span><span class="p">:</span> <span class="p">[</span><span class="mi">3</span><span class="p">,</span> <span class="mi">6</span><span class="p">,</span> <span class="mi">9</span><span class="p">]</span>
</span></span><span class="line"><span class="cl">    <span class="p">},</span>
</span></span><span class="line"><span class="cl"><span class="p">)</span>
</span></span><span class="line"><span class="cl"><span class="n">url</span> <span class="o">=</span> <span class="sa">f</span><span class="s1">&#39;</span><span class="si">{</span><span class="n">endpoint</span><span class="si">}</span><span class="s1">/#/runs/details/</span><span class="si">{</span><span class="n">run</span><span class="o">.</span><span class="n">run_id</span><span class="si">}</span><span class="s1">&#39;</span>
</span></span><span class="line"><span class="cl"><span class="nb">print</span><span class="p">(</span><span class="n">url</span><span class="p">)</span>
</span></span></code></pre></div><p>This example introduces the following new features in the pipeline:</p>
<ul>
<li>
<p>Some Python <strong>packages to install</strong> are added at component runtime, using the <code>packages_to_install</code> argument on the <code>@dsl.component</code> decorator, as follows:</p>
<p><code>@dsl.component(packages_to_install=['pandas==1.3.5'])</code></p>
<p>To use a library after installing it, you must include its import statements within the scope of the component function, so that the library is imported at component runtime.</p>
</li>
<li>
<p><strong>Input and output artifacts</strong> of types <code>Dataset</code> and <code>Model</code> are introduced in the component signature to describe the input and output artifacts of the components. This is done using the type annotation generics <code>Input[]</code> and <code>Output[]</code> for input and output artifacts respectively.</p>
<p>Within the scope of a component, artifacts can be read (for inputs) and written (for outputs) via the <code>.path</code> attribute. The KFP backend ensures that <em>input</em> artifact files are copied <em>to</em> the executing pod local file system from the remote storage at runtime, so that the component function can read input artifacts from the local file system. By comparison, <em>output</em> artifact files are copied <em>from</em> the local file system of the pod to remote storage, when the component finishes running. This way, the output artifacts persist outside the pod. In both cases, the component author needs to interact with the local file system only to create persistent artifacts.</p>
<p>The arguments for the parameters annotated with <code>Output[]</code> are not passed to components by the pipeline author. The KFP backend passes this artifact during component runtime, so that component authors don&rsquo;t need to be concerned about the path to which the output artifacts are written. After an output artifact is written, the backend executing the component recognizes the KFP artifact types (<code>Dataset</code> or <code>Model</code>), and organizes them on the Dashboard.</p>
<p>An output artifact can be passed as an input to a downstream component using <code>.outputs</code> attribute of the source task and the output artifact parameter name, as follows:</p>
<p><code>create_dataset_task.outputs['iris_dataset']</code></p>
</li>
<li>
<p>One of the <strong>DSL control flow features</strong>, <code>dsl.ParallelFor</code>, is used. It is a context manager that lets pipeline authors create tasks. These tasks execute in parallel in a loop. Using <code>dsl.ParallelFor</code> to iterate over the <code>neighbors</code> pipeline argument lets you execute the  <code>train_model</code> component with different arguments and test multiple hyperparameters in one pipeline run. Other control flow features include <code>dsl.Condition</code> and <code>dsl.ExitHandler</code>.</p>
</li>
</ul>
</details>
<p>Congratulations! You now have a KFP deployment, an end-to-end ML pipeline, and an introduction to the UI. That&rsquo;s just the beginning of KFP pipeline and Dashboard features.</p>
<!TODO: Add some more content to direct the user to what comes next. -->
<h2 id="next-steps">Next steps</h2>
<ul>
<li>See <a href="/docs/components/pipelines/v2/installation/">Installation</a> for additional ways to deploy KFP</li>
<li>See <a href="/docs/components/pipelines/v2/author-a-pipeline/">Author a Pipeline</a> to learn more about feautres available when authoring pipelines</li>
</ul>

</div>



    
	
  
    
    
	
    

<div class="td-content" style="page-break-before: always">
    
	<h1 id="pg-71d14ac04c3b2a201568806e101af25a">3.2.4 - Author a Pipeline</h1>
    <div class="lead">Concepts and objects for authoring pipelines</div>
	
</div>



    
      
  
  
  
  

  
  

  
    
    
	
    

<div class="td-content" style="">
    
	<h1 id="pg-8399b7eb477a6311c212af1521456bad">3.2.4.1 - Components</h1>
    <div class="lead">Author KFP components</div>
	<h2 id="summary">Summary</h2>
<p>A <em>component</em> is the basic unit of execution logic in KFP. A component is a named template for how to run a container using an image, a command, and arguments. Components may also have inputs and outputs, making a component a computational template, analogous to a function.</p>
<p>Component inputs are dynamic data used in either the container commands or arguments.</p>
<p>Component outputs may be machine learning artifacts or other JSON-serializable data.</p>
<h2 id="author-a-component">Author a component</h2>
<p>At the lowest level of execution, all components define their execution logic via a container image, command, and arguments. An importer component is a special case and the only exception to this.</p>
<p>The KFP SDK exposes three ways of authoring components with these three properties.</p>
<h3 id="1-lighweight-python-function-based-components">1. Lighweight Python function-based components</h3>
<p>The most simple way to author a component is via a lightweight Python function-based component (also known as a lightweight component).</p>
<p>Lightweight components provides a fully Pythonic approach to creating a component that executes a single Python function within a container at runtime.</p>
<p>To create a lightweight component, you must:</p>
<ol>
<li>
<p>Define a standalone function.</p>
<p>A standalone Python function is a function that does not reference any symbols defined outside of its scope. This means the function must define all objects it uses within the scope of the function and must include all import statements within the function body.</p>
</li>
<li>
<p>Include type annotations for the function parameters and return values.</p>
<p>Type annotations indicate what the component inputs and outputs are and tells the KFP lightweight component executor how to serialize and deserialize the data as it is passed within a pipeline. This also (optionally) allows the KFP DSL compiler to type check your pipeline.</p>
<p>Valid parameter annotations include <code>str</code>, <code>int</code>, <code>float</code>, <code>bool</code>, <code>dict</code>, <code>list</code>, <code>OutputPath</code>, <code>InputPath</code>, <code>Input[&lt;Artifact&gt;]</code>, and <code>Output[&lt;Artifact&gt;]</code>.</p>
<p>Valid return annotations include <code>str</code>, <code>int</code>, <code>float</code>, <code>bool</code>, <code>dict</code>, and <code>list</code>. You may also specify multiple return values by using these annotations within a <code>typing.NamedTuple</code>.</p>
<p>For detailed discussion on type annotations and runtime behavior, see <a href="/docs/components/pipelines/v2/author-a-pipeline/component-io">Data Passing</a>.</p>
</li>
<li>
<p>Decorate your function with the <code>@kfp.dsl.component</code> decorator.
This decorator transforms a Python function into a component that can be used within a pipeline.</p>
<p>For a comprehensive list of <code>@kfp.dsl.component</code> decorator arguments, see the DSL <a href="https://kubeflow-pipelines.readthedocs.io/en/master/source/dsl.html">reference documentation</a>.</p>
</li>
</ol>
<p>The following is an example of a lightweight component that trains a model on an existing input <code>Dataset</code> artifact for <code>num_epochs</code> epochs, then saves the output <code>Model</code> artifact.</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-python" data-lang="python"><span class="line"><span class="cl"><span class="kn">from</span> <span class="nn">kfp</span> <span class="kn">import</span> <span class="n">dsl</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="nd">@dsl</span><span class="o">.</span><span class="n">component</span><span class="p">(</span>
</span></span><span class="line"><span class="cl">    <span class="n">base_image</span><span class="o">=</span><span class="s1">&#39;python:3.7&#39;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">    <span class="n">packages_to_install</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;tensorflow==2.9.1&#39;</span><span class="p">]</span>
</span></span><span class="line"><span class="cl"><span class="p">)</span>
</span></span><span class="line"><span class="cl"><span class="k">def</span> <span class="nf">train_model</span><span class="p">(</span>
</span></span><span class="line"><span class="cl">    <span class="n">dataset</span><span class="p">:</span> <span class="n">Input</span><span class="p">[</span><span class="n">Dataset</span><span class="p">],</span>
</span></span><span class="line"><span class="cl">    <span class="n">model</span><span class="p">:</span> <span class="n">Output</span><span class="p">[</span><span class="n">Model</span><span class="p">],</span>
</span></span><span class="line"><span class="cl">    <span class="n">num_epochs</span><span class="p">:</span> <span class="nb">int</span><span class="p">,</span>
</span></span><span class="line"><span class="cl"><span class="p">):</span>
</span></span><span class="line"><span class="cl">    <span class="kn">from</span> <span class="nn">tensorflow</span> <span class="kn">import</span> <span class="n">keras</span>
</span></span><span class="line"><span class="cl">    
</span></span><span class="line"><span class="cl">    <span class="c1"># load and process the Dataset artifact</span>
</span></span><span class="line"><span class="cl">    <span class="k">with</span> <span class="nb">open</span><span class="p">(</span><span class="n">dataset</span><span class="o">.</span><span class="n">path</span><span class="p">)</span> <span class="k">as</span> <span class="n">f</span><span class="p">:</span>
</span></span><span class="line"><span class="cl">        <span class="n">x</span><span class="p">,</span> <span class="n">y</span> <span class="o">=</span> <span class="o">...</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">    <span class="n">my_model</span> <span class="o">=</span> <span class="n">keras</span><span class="o">.</span><span class="n">Sequential</span><span class="p">(</span>
</span></span><span class="line"><span class="cl">        <span class="p">[</span>
</span></span><span class="line"><span class="cl">            <span class="n">layers</span><span class="o">.</span><span class="n">Dense</span><span class="p">(</span><span class="mi">4</span><span class="p">,</span> <span class="n">activation</span><span class="o">=</span><span class="s1">&#39;relu&#39;</span><span class="p">,</span> <span class="n">name</span><span class="o">=</span><span class="s1">&#39;layer1&#39;</span><span class="p">),</span>
</span></span><span class="line"><span class="cl">            <span class="n">layers</span><span class="o">.</span><span class="n">Dense</span><span class="p">(</span><span class="mi">3</span><span class="p">,</span> <span class="n">activation</span><span class="o">=</span><span class="s1">&#39;relu&#39;</span><span class="p">,</span> <span class="n">name</span><span class="o">=</span><span class="s1">&#39;layer2&#39;</span><span class="p">),</span>
</span></span><span class="line"><span class="cl">            <span class="n">layers</span><span class="o">.</span><span class="n">Dense</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span> <span class="n">activation</span><span class="o">=</span><span class="s1">&#39;relu&#39;</span><span class="p">,</span> <span class="n">name</span><span class="o">=</span><span class="s1">&#39;layer2&#39;</span><span class="p">),</span>
</span></span><span class="line"><span class="cl">            <span class="n">layers</span><span class="o">.</span><span class="n">Dense</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="n">name</span><span class="o">=</span><span class="s1">&#39;layer3&#39;</span><span class="p">),</span>
</span></span><span class="line"><span class="cl">        <span class="p">]</span>
</span></span><span class="line"><span class="cl">    <span class="p">)</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">    <span class="n">my_model</span><span class="o">.</span><span class="n">compile</span><span class="p">(</span><span class="o">...</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">    <span class="c1"># train for num_epochs</span>
</span></span><span class="line"><span class="cl">    <span class="n">my_model</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">,</span> <span class="n">epochs</span><span class="o">=</span><span class="n">num_epochs</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">    
</span></span><span class="line"><span class="cl">    <span class="c1"># save the Model artifact</span>
</span></span><span class="line"><span class="cl">    <span class="n">my_model</span><span class="o">.</span><span class="n">save</span><span class="p">(</span><span class="n">model</span><span class="o">.</span><span class="n">path</span><span class="p">)</span>
</span></span></code></pre></div><p>Notice the <code>base_image</code> argument to the <code>@kfp.dsl.component</code> decorator. Despite not having the word &ldquo;container&rdquo; in its name, lightweight components are still executed as a container at runtime. The <code>@kfp.dsl.component</code> decorator mereley provides a convient Pythonic interface to defining this container image, command, and arguments. <a href="https://hub.docker.com/_/python"><code>python:3.7</code></a> is the default image, but can be changed to any image accessible to the executing backend, as long as the image has a Python interpreter available as <code>python3</code>. Packages in <code>packages_to_install</code> will be pip installed at container runtime.</p>
<p><strong>When to use?</strong> Lightweight components should be used if your component implementation can be written as a standalone Python function and does not require an abundance of source code. This is the preferred authoring approach for quick demos and when authoring components in a noteebok.</p>
<p>For more involved components and for production usage, prefer containerized components and custom container components for their increased flexibility.</p>
<p>Note: This authoring approach replaces <code>kfp.components.create_component_from_func</code> in KFP v1.</p>
<h3 id="2-containerized-python-components">2. Containerized Python components</h3>
<p>Containerized Python components extend lightweight components by allowing users to package and build their Python function-based components into containers.</p>
<p>Unlike lightweight components, containerized Python components allow authors to use additional source code outside of the component&rsquo;s Python function definition, including source code across multiple files. This is the preferred approach for authoring Python components that require more source code than can cleanly be included in the body of a standalone function or in cases where you wish to reuse the same source code in multiple components.</p>
<p>To create a containerized component, you must:</p>
<ol>
<li>
<p>Define a component using the <code>@kfp.dsl.component</code> decorator.</p>
<p>A containerized Python component definition is very similar to a lightweight component definition, but with a few key differences:</p>
<p>a) The <code>@kfp.dsl.component</code> decorator is given a <code>target_image</code>. This is the name of containerized component image that will be created from the <code>base_image</code> in Step 2 below.</p>
<p>b) The <code>tensorflow</code> import is included outside of the <code>train_model</code> function. This is possible because the entire module will be executed at component runtime, not only the Python function as in a lightweight component.</p>
<p>c) The component uses functions defined in <code>my_helper_module</code> imported via a <a href="https://docs.python.org/3/reference/import.html#package-relative-imports">relative import</a>. This is possible because <code>my_helper_module.py</code> will be included in the container image created in Step 2 below. This is unlike a lighweight component, which only uses the source code included in the Python function definition. This helper code could have also been defined within the same module outside of the <code>train_model</code> function.</p>
<p>The following containerized component adapts the lightweight component in the previous section to a containerized component. Notice that most of the logic is extracted into helper functions in <code>my_helper_module</code>, permitting a cleaner, modular component function:</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-python" data-lang="python"><span class="line"><span class="cl"><span class="c1"># my_component.py</span>
</span></span><span class="line"><span class="cl"><span class="kn">from</span> <span class="nn">kfp</span> <span class="kn">import</span> <span class="n">dsl</span>
</span></span><span class="line"><span class="cl"><span class="kn">from</span> <span class="nn">tensorflow</span> <span class="kn">import</span> <span class="n">keras</span>
</span></span><span class="line"><span class="cl"><span class="kn">from</span> <span class="nn">.my_helper_module</span> <span class="kn">import</span> <span class="n">compile_and_train</span><span class="p">,</span> <span class="n">get_model</span><span class="p">,</span> <span class="n">split_dataset</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="nd">@dsl</span><span class="o">.</span><span class="n">component</span><span class="p">(</span>
</span></span><span class="line"><span class="cl">    <span class="n">base_image</span><span class="o">=</span><span class="s1">&#39;python:3.7&#39;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">    <span class="n">target_image</span><span class="o">=</span><span class="s1">&#39;gcr.io/my-project/my-component:v1&#39;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">    <span class="n">packages_to_install</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;tensorflow&#39;</span><span class="p">],</span>
</span></span><span class="line"><span class="cl"><span class="p">)</span>
</span></span><span class="line"><span class="cl"><span class="k">def</span> <span class="nf">train_model</span><span class="p">(</span>
</span></span><span class="line"><span class="cl">    <span class="n">dataset</span><span class="p">:</span> <span class="n">Input</span><span class="p">[</span><span class="n">Dataset</span><span class="p">],</span>
</span></span><span class="line"><span class="cl">    <span class="n">model</span><span class="p">:</span> <span class="n">Output</span><span class="p">[</span><span class="n">Model</span><span class="p">],</span>
</span></span><span class="line"><span class="cl">    <span class="n">num_epochs</span><span class="p">:</span> <span class="nb">int</span><span class="p">,</span>
</span></span><span class="line"><span class="cl"><span class="p">):</span>
</span></span><span class="line"><span class="cl">    <span class="c1"># load and process the Dataset artifact</span>
</span></span><span class="line"><span class="cl">    <span class="k">with</span> <span class="nb">open</span><span class="p">(</span><span class="n">dataset</span><span class="o">.</span><span class="n">path</span><span class="p">)</span> <span class="k">as</span> <span class="n">f</span><span class="p">:</span>
</span></span><span class="line"><span class="cl">        <span class="n">x</span><span class="p">,</span> <span class="n">y</span> <span class="o">=</span> <span class="n">split_dataset</span><span class="p">(</span><span class="n">f</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">    <span class="n">untrained_model</span> <span class="o">=</span> <span class="n">get_model</span><span class="p">()</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">    <span class="c1"># train for num_epochs</span>
</span></span><span class="line"><span class="cl">    <span class="n">trained_model</span> <span class="o">=</span> <span class="n">compile_and_train</span><span class="p">(</span><span class="n">untrained_model</span><span class="p">,</span> <span class="n">epochs</span><span class="o">=</span><span class="n">num_epochs</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">    <span class="c1"># save the Model artifact</span>
</span></span><span class="line"><span class="cl">    <span class="n">trained_model</span><span class="o">.</span><span class="n">save</span><span class="p">(</span><span class="n">model</span><span class="o">.</span><span class="n">path</span><span class="p">)</span>
</span></span></code></pre></div><p>The <code>my_component.py</code> module, the <code>my_helper_module.py</code> module, and any other source code files you wish to include in the container image should be grouped together in a directory. When you build the component in Step 2 below, this directory will by <a href="https://docs.docker.com/engine/reference/builder/#copy">COPY</a>&rsquo;d into the image:</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-fallback" data-lang="fallback"><span class="line"><span class="cl">src/
</span></span><span class="line"><span class="cl"> my_component.py
</span></span><span class="line"><span class="cl"> my_helper_module.py
</span></span><span class="line"><span class="cl"> another_module.py
</span></span></code></pre></div></li>
<li>
<p>Build the component.</p>
<p>Once you&rsquo;ve written a component and associated source code files and put them in a standalone directory, you can use the KFP CLI to build your component. This command to do this takes the form:</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-shell" data-lang="shell"><span class="line"><span class="cl">kfp component build <span class="o">[</span>OPTIONS<span class="o">]</span> COMPONENTS_DIRECTORY <span class="o">[</span>ARGS<span class="o">]</span>...
</span></span></code></pre></div><p>When you run this command, KFP will build an image with all the source code found in <code>COMPONENTS_DIRECTORY</code>. KFP will find your component definition in <code>src/</code> and execute the component function you defined at component runtime. Include the <code>--push-image</code> flag to push your image to a remote registry from which the executing backend can pull your image at runtime. For example:</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-shell" data-lang="shell"><span class="line"><span class="cl">kfp component build src/ --push-image
</span></span></code></pre></div><p>For detailed information about all arguments/flags, see <a href="https://kubeflow-pipelines.readthedocs.io/en/master/source/cli.html#kfp-component-build">CLI reference documentation</a>.</p>
</li>
</ol>
<p><strong>When to use?</strong> Containerized Python components should be used any time your component is implemented as Python code, but cannot be written as a standalone Python function or you wish to organize source code outside of the component Python function definition.</p>
<h3 id="3-custom-container-components">3. Custom container components</h3>
<p>Custom container components allow you to specify a container to execute as your component. The <code>dsl.ContainerSpec</code> object allows you to specify a container via an image, command, and args.</p>
<p>To define a custom container component, you must:</p>
<ol>
<li>
<p>Write your components code as a Python function that returns a <code>dsl.ContainerSpec</code> object to specify the container image and the commands to be run in the container and wrap the function into a <code>@container_component</code> decorator. The function should do nothing other than returning a <code>dsl.ContainerSpec</code> object, with the following parameters:</p>
<ul>
<li><code>image</code>: The image that the container will run. You can use <code>command</code> and <code>args</code> to control the entrypoint.</li>
<li><code>command</code> (optional): The command to be executed.</li>
<li><code>args</code> (optional): The arguments of the command. Its recommended to place the input of the components in the args section instead of the command section.</li>
</ul>
<p>The decorator will then compose a component using the <code>ContainerSpec</code>, which can be used the same as a Python component. (Learn more about <a href="https://kubeflow-pipelines.readthedocs.io/en/master/source/dsl.html">ContainerSpec</a> in documentation.)</p>
</li>
<li>
<p>Specify your function&rsquo;s inputs and outputs in the function&rsquo;s signature <a href="/docs/components/pipelines/v2/author-a-pipeline/component-io">Learn more about passing data between components</a>. Specifically for custom container components, your function&rsquo;s inputs and outputs must meet the following requirements:</p>
<ul>
<li>All your function&rsquo;s arguments must have data type annotations.</li>
<li>Different from a Python component, your return type annotation for the function
must either be <code>dsl.ContainerSpec</code> or omitted.</li>
<li>If the function accepts or returns large amounts of data or complex
data types, you must annotate that argument as an <em>artifact</em>. Note that in the function you defined, you can only access artifacts via its <code>.url</code>, <code>.path</code>, or <code>.metadata</code> attribute. Accessing any other attribute or the artifact variable by itself is not allowed.</li>
</ul>
</li>
</ol>
<p>Below is an example that authors a pipelines from two custom container components. Just as using with a Python component, you can access the outputs of a <code>container_component</code> for downstream tasks as demonstrated in the pipeline:</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-python" data-lang="python"><span class="line"><span class="cl"><span class="kn">from</span> <span class="nn">kfp.dsl</span> <span class="kn">import</span> <span class="p">(</span>
</span></span><span class="line"><span class="cl">  <span class="n">container_component</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">  <span class="n">ContainerSpec</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">  <span class="n">Dataset</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">  <span class="n">Input</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">  <span class="n">pipeline</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">  <span class="n">Output</span><span class="p">,</span>
</span></span><span class="line"><span class="cl"><span class="p">)</span> 
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="nd">@container_component</span>
</span></span><span class="line"><span class="cl"><span class="k">def</span> <span class="nf">create_dataset</span><span class="p">(</span><span class="n">text</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span> <span class="n">output_gcs</span><span class="p">:</span> <span class="n">Output</span><span class="p">[</span><span class="n">Dataset</span><span class="p">]):</span>
</span></span><span class="line"><span class="cl">    <span class="k">return</span> <span class="n">ContainerSpec</span><span class="p">(</span>
</span></span><span class="line"><span class="cl">        <span class="n">image</span><span class="o">=</span><span class="s1">&#39;alpine&#39;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">        <span class="n">command</span><span class="o">=</span><span class="p">[</span>
</span></span><span class="line"><span class="cl">            <span class="s1">&#39;sh&#39;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">            <span class="s1">&#39;-c&#39;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">            <span class="s1">&#39;mkdir --parents $(dirname &#34;$1&#34;) &amp;&amp; echo &#34;$0&#34; &gt; &#34;$1&#34;&#39;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">        <span class="p">],</span>
</span></span><span class="line"><span class="cl">        <span class="n">args</span><span class="o">=</span><span class="p">[</span><span class="n">text</span><span class="p">,</span> <span class="n">output_gcs</span><span class="o">.</span><span class="n">path</span><span class="p">])</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="nd">@container_component</span>
</span></span><span class="line"><span class="cl"><span class="k">def</span> <span class="nf">print_dataset</span><span class="p">(</span><span class="n">input_gcs</span><span class="p">:</span> <span class="n">Input</span><span class="p">[</span><span class="n">Dataset</span><span class="p">]):</span>
</span></span><span class="line"><span class="cl">    <span class="k">return</span> <span class="n">ContainerSpec</span><span class="p">(</span><span class="n">image</span><span class="o">=</span><span class="s1">&#39;alpine&#39;</span><span class="p">,</span> <span class="n">command</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;cat&#39;</span><span class="p">],</span> <span class="n">args</span><span class="o">=</span><span class="p">[</span><span class="n">input_gcs</span><span class="o">.</span><span class="n">path</span><span class="p">])</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="nd">@pipeline</span>
</span></span><span class="line"><span class="cl"><span class="k">def</span> <span class="nf">two_step_pipeline_containerized</span><span class="p">(</span><span class="n">text</span><span class="p">:</span> <span class="nb">str</span><span class="p">):</span>
</span></span><span class="line"><span class="cl">    <span class="n">create_dataset_task</span> <span class="o">=</span> <span class="n">create_dataset</span><span class="p">(</span><span class="n">text</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">    <span class="n">print_dataset_task</span> <span class="o">=</span> <span class="n">print_dataset</span><span class="p">(</span><span class="n">input_gcs</span><span class="o">=</span><span class="n">create_dataset_task</span><span class="o">.</span><span class="n">outputs</span><span class="p">[</span><span class="s1">&#39;output_gcs&#39;</span><span class="p">])</span>
</span></span></code></pre></div><p>In the above example, the <code>create_dataset</code> component takes in a text and output it to a path as an artifact. Then, the <code>print_dataset</code> component retrieves the artifact output by the <code>create_dataset</code> component and prints it out.</p>
<h2 id="special-case-importer-components">Special case: Importer components</h2>
<p>Unlike the previous three authoring approaches, an importer component not a general authoring style but a pre-baked component for a specific use case: loading a machine learning artifact from remote storage to machine learning metadata (MLMD).</p>
<p><strong>Before you continue:</strong> Understand how KFP <a href="/docs/components/pipelines/v2/author-a-pipeline/component-io">Artifacts</a> work.</p>
<p>Typically, the input artifact to a task is an output from an upstream task. In this case, the artifact can be easily accessed from the upstream task using <code>my_task.outputs['artifact_name']</code>. The artifact is also registered in MLMD when it is created by the upstream task.</p>
<p>If you wish to use an existing artifact that is not generated by a task in the current pipeline <em>or</em> wish to use as an artifact an external file that was not generated by a pipeline at all, you can use an importer component to load an artifact from its URI.</p>
<p>You do not need to write an importer component; it can be imported from the <code>dsl</code> module and used directly:</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-python" data-lang="python"><span class="line"><span class="cl"><span class="kn">from</span> <span class="nn">kfp</span> <span class="kn">import</span> <span class="n">dsl</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="nd">@dsl</span><span class="o">.</span><span class="n">pipeline</span><span class="p">()</span>
</span></span><span class="line"><span class="cl"><span class="k">def</span> <span class="nf">my_pipeline</span><span class="p">():</span>
</span></span><span class="line"><span class="cl">    <span class="n">task</span> <span class="o">=</span> <span class="n">get_date_string</span><span class="p">()</span>
</span></span><span class="line"><span class="cl">    <span class="n">importer_task</span> <span class="o">=</span> <span class="n">dsl</span><span class="o">.</span><span class="n">importer</span><span class="p">(</span>
</span></span><span class="line"><span class="cl">        <span class="n">artifact_uri</span><span class="o">=</span><span class="s1">&#39;gs://ml-pipeline-playground/shakespeare1.txt&#39;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">        <span class="n">artifact_class</span><span class="o">=</span><span class="n">dsl</span><span class="o">.</span><span class="n">Dataset</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">        <span class="n">reimport</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">        <span class="n">metadata</span><span class="o">=</span><span class="p">{</span><span class="s1">&#39;date&#39;</span><span class="p">:</span> <span class="n">task</span><span class="o">.</span><span class="n">output</span><span class="p">})</span>
</span></span><span class="line"><span class="cl">    <span class="n">other_component</span><span class="p">(</span><span class="n">dataset</span><span class="o">=</span><span class="n">importer_task</span><span class="o">.</span><span class="n">output</span><span class="p">)</span>
</span></span></code></pre></div><p>In addition to the <code>artifact_uri</code>, you must provide an <code>artifact_class</code>, indicating the type of the artifact.</p>
<p>The <code>importer</code> component permits setting artifact metadata via the <code>metadata</code> argument. Metadata can be constructed with outputs from upstream tasks, as is done for the <code>'date'</code> value in the example pipeline.</p>
<p>You may also specify a boolean <code>reimport</code> argument. If <code>reimport</code> is <code>False</code>, KFP will use an existing MLMD artifact if it already exists from an earlier importer execution. If <code>reimport</code> is <code>True</code>, KFP will reimport the artifact as a new artifact, irrespective of whether it was previously imported.</p>
<h2 id="compile-save-a-component">Compile (save) a component</h2>
<p>Once you&rsquo;ve written a component, you may wish to write the component definition to YAML for future use or submission for execution. This can be done via the KFP SDK DSL compiler:</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-python" data-lang="python"><span class="line"><span class="cl"><span class="kn">from</span> <span class="nn">kfp</span> <span class="kn">import</span> <span class="n">compiler</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="n">compiler</span><span class="o">.</span><span class="n">Compiler</span><span class="p">()</span><span class="o">.</span><span class="n">compile</span><span class="p">(</span><span class="n">pipeline_func</span><span class="o">=</span><span class="n">addition_component</span><span class="p">,</span> <span class="n">package_path</span><span class="o">=</span><span class="s1">&#39;addition_component.yaml&#39;</span><span class="p">)</span>
</span></span></code></pre></div><h2 id="load-a-component">Load a component</h2>
<p>You can load saved components via the <code>kfp.components</code> module. This is helpful for integrating existing components stored as YAML into a larger pipeline definition:</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-python" data-lang="python"><span class="line"><span class="cl"><span class="kn">from</span> <span class="nn">kfp</span> <span class="kn">import</span> <span class="n">components</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="n">addition_component</span> <span class="o">=</span> <span class="n">components</span><span class="o">.</span><span class="n">load_component_from_file</span><span class="p">(</span><span class="s1">&#39;addition_component.yaml&#39;</span><span class="p">)</span>
</span></span></code></pre></div><p>Once loaded, you can use the component in a pipeline just as you would a component defined in Python:</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-python" data-lang="python"><span class="line"><span class="cl"><span class="nd">@dsl</span><span class="o">.</span><span class="n">pipeline</span><span class="p">()</span>
</span></span><span class="line"><span class="cl"><span class="k">def</span> <span class="nf">my_pipeline</span><span class="p">():</span>
</span></span><span class="line"><span class="cl">    <span class="n">addition_task</span> <span class="o">=</span> <span class="n">addition_component</span><span class="p">(</span><span class="n">num1</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">num2</span><span class="o">=</span><span class="mi">2</span><span class="p">)</span>
</span></span></code></pre></div><p>The <code>components</code> module also includes <code>.load_component_from_text</code> and <code>.load_component_from_url</code> for loading YAML from different sources.</p>

</div>



    
	
  
    
    
	
    

<div class="td-content" style="page-break-before: always">
    
	<h1 id="pg-6434584f19aa221c1b86bb04ddc1aebe">3.2.4.2 - Tasks</h1>
    <div class="lead">Understand and use KFP tasks</div>
	<h2 id="summary">Summary</h2>
<p>A <em>task</em> is an execution of a <a href="/docs/components/pipelines/v2/author-a-pipeline/components">component</a> with a set of inputs. It can be thought of as an instantiation of a component template. A pipeline is composed of individual tasks that may or may not pass data betwen one another.</p>
<p>One component can be used to instantiate multiple tasks within a single pipeline. Tasks can also be created and executed dynamically using pipeline control flow features such as loops, conditions, and exit handlers.</p>
<p>Because tasks represent a runtime execution of a component, you may set additional runtime configuration on a task, such as environment variables, hardware resource requirements, and various other task-level configurations.</p>
<h2 id="task-dependencies">Task dependencies</h2>
<h3 id="independent-tasks">Independent tasks</h3>
<p>Tasks may or may not depend on one another. Two tasks are independent of one another if no outputs of one are inputs to the other and neither task calls <code>.after()</code> on the other. When two tasks are independent, they execute concurrently at pipeline runtime. In the following example, <code>my_task1</code> and <code>my_task2</code> have no dependency and will execute at the same time.</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-python" data-lang="python"><span class="line"><span class="cl"><span class="kn">from</span> <span class="nn">kfp</span> <span class="kn">import</span> <span class="n">dsl</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="nd">@dsl</span><span class="o">.</span><span class="n">pipeline</span><span class="p">()</span>
</span></span><span class="line"><span class="cl"><span class="k">def</span> <span class="nf">my_pipeline</span><span class="p">():</span>
</span></span><span class="line"><span class="cl">    <span class="n">my_task1</span> <span class="o">=</span> <span class="n">concat_comp</span><span class="p">(</span><span class="n">prefix</span><span class="o">=</span><span class="s1">&#39;hello, &#39;</span><span class="p">,</span> <span class="n">text</span><span class="o">=</span><span class="s1">&#39;world&#39;</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">    <span class="n">my_task2</span> <span class="o">=</span> <span class="n">concat_comp</span><span class="p">(</span><span class="n">prefix</span><span class="o">=</span><span class="s1">&#39;hi, &#39;</span><span class="p">,</span> <span class="n">text</span><span class="o">=</span><span class="s1">&#39;universe&#39;</span><span class="p">)</span>
</span></span></code></pre></div><h3 id="implicitly-dependent-tasks">Implicitly dependent tasks</h3>
<p>When the output of one task is the input to another, an implicit dependency is created between the two tasks. When this is the case, the upstream task will execute first so that its output can be passed to the downstream task. In the following example, the argument to the <code>prefix</code> parameter on <code>my_tasks2</code> is the output from <code>my_task1</code>. This means <code>my_task2</code> implicitly depends and will execute after <code>my_task1</code>.</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-python" data-lang="python"><span class="line"><span class="cl"><span class="kn">from</span> <span class="nn">kfp</span> <span class="kn">import</span> <span class="n">dsl</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="nd">@dsl</span><span class="o">.</span><span class="n">pipeline</span><span class="p">()</span>
</span></span><span class="line"><span class="cl"><span class="k">def</span> <span class="nf">my_pipeline</span><span class="p">():</span>
</span></span><span class="line"><span class="cl">    <span class="n">my_task1</span> <span class="o">=</span> <span class="n">concat_comp</span><span class="p">(</span><span class="n">prefix</span><span class="o">=</span><span class="s1">&#39;hello, &#39;</span><span class="p">,</span> <span class="n">text</span><span class="o">=</span><span class="s1">&#39;world&#39;</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">    <span class="n">my_task2</span> <span class="o">=</span> <span class="n">concat_comp</span><span class="p">(</span><span class="n">prefix</span><span class="o">=</span><span class="n">my_task1</span><span class="o">.</span><span class="n">output</span><span class="p">,</span> <span class="n">text</span><span class="o">=</span><span class="s1">&#39;!&#39;</span><span class="p">)</span>
</span></span></code></pre></div><p>For more information on passing inputs and outputs between components, see <a href="/docs/components/pipelines/v2/author-a-pipeline/component-io-passing-data-between-tasks/#passing-data-between-tasks">Component I/O: Passing data between tasks</a>.</p>
<h3 id="explicitly-dependent-tasks">Explicitly dependent tasks</h3>
<p>Sometimes you want to order execution of two tasks but not pass data between the tasks. When this is the case, you can call the intended second task&rsquo;s <code>.after()</code> on the intended first task create an explicit dependency. In the following example, <code>my_task2</code> explicitly depends on <code>my_task1</code>, so <code>my_task1</code> will execute before <code>my_task2</code>:</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-python" data-lang="python"><span class="line"><span class="cl"><span class="kn">from</span> <span class="nn">kfp</span> <span class="kn">import</span> <span class="n">dsl</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="nd">@dsl</span><span class="o">.</span><span class="n">pipeline</span><span class="p">()</span>
</span></span><span class="line"><span class="cl"><span class="k">def</span> <span class="nf">my_pipeline</span><span class="p">():</span>
</span></span><span class="line"><span class="cl">    <span class="n">my_task1</span> <span class="o">=</span> <span class="n">concat_comp</span><span class="p">(</span><span class="n">prefix</span><span class="o">=</span><span class="s1">&#39;hello, &#39;</span><span class="p">,</span> <span class="n">text</span><span class="o">=</span><span class="s1">&#39;world&#39;</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">    <span class="n">my_task2</span> <span class="o">=</span> <span class="n">concat_comp</span><span class="p">(</span><span class="n">prefix</span><span class="o">=</span><span class="s1">&#39;hi, &#39;</span><span class="p">,</span> <span class="n">text</span><span class="o">=</span><span class="s1">&#39;universe&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">after</span><span class="p">(</span><span class="n">my_task1</span><span class="p">)</span>
</span></span></code></pre></div><h2 id="task-level-configurations">Task-level configurations</h2>
<p>The KFP SDK exposes several platform-agnostic task-level configurations for use during authoring. Platform-agnostic configurations are those that are expected to exhibit similar execution behavior on all KFP-conformant backends, such as the open source KFP backend or the Vertex Pipelines backend. The remainder of this section refers only to platform-agnostic task-level configurations.</p>
<p>All task-level configurations are set using a method on the task. Take the following environment variable example:</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-python" data-lang="python"><span class="line"><span class="cl"><span class="kn">from</span> <span class="nn">kfp</span> <span class="kn">import</span> <span class="n">dsl</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="nd">@dsl</span><span class="o">.</span><span class="n">component</span>
</span></span><span class="line"><span class="cl"><span class="k">def</span> <span class="nf">print_env_var</span><span class="p">():</span>
</span></span><span class="line"><span class="cl">    <span class="kn">import</span> <span class="nn">os</span>
</span></span><span class="line"><span class="cl">    <span class="nb">print</span><span class="p">(</span><span class="n">os</span><span class="o">.</span><span class="n">environ</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;MY_ENV_VAR&#39;</span><span class="p">))</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="nd">@dsl</span><span class="o">.</span><span class="n">pipeline</span><span class="p">()</span>
</span></span><span class="line"><span class="cl"><span class="k">def</span> <span class="nf">my_pipeline</span><span class="p">():</span>
</span></span><span class="line"><span class="cl">    <span class="n">task</span> <span class="o">=</span> <span class="n">print_env_var</span><span class="p">()</span>
</span></span><span class="line"><span class="cl">    <span class="n">task</span><span class="o">.</span><span class="n">set_env_variable</span><span class="p">(</span><span class="s1">&#39;MY_ENV_VAR&#39;</span><span class="p">,</span> <span class="s1">&#39;hello&#39;</span><span class="p">)</span>
</span></span></code></pre></div><p>When executed, the <code>print_env_var</code> component should print <code>'hello'</code>.</p>
<p>Task-level configuration methods can also be chained:</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-python" data-lang="python"><span class="line"><span class="cl"><span class="n">print_env_var</span><span class="p">()</span><span class="o">.</span><span class="n">set_env_variable</span><span class="p">(</span><span class="s1">&#39;MY_ENV_VAR&#39;</span><span class="p">,</span> <span class="s1">&#39;hello&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">set_env_variable</span><span class="p">(</span><span class="s1">&#39;OTHER_VAR&#39;</span><span class="p">,</span> <span class="s1">&#39;world&#39;</span><span class="p">)</span>
</span></span></code></pre></div><p>The KFP SDK provides the following task methods for setting task-level configurations:</p>
<ul>
<li><code>.add_node_selector_constraint</code></li>
<li><code>.set_caching_options</code></li>
<li><code>.set_cpu_limit</code></li>
<li><code>.set_display_name</code></li>
<li><code>.set_env_variable</code></li>
<li><code>.set_gpu_limit</code></li>
<li><code>.set_memory_limit</code></li>
<li><code>.set_retry</code></li>
</ul>
<p>For detailed information on how to use the above methods, see the <a href="https://kubeflow-pipelines.readthedocs.io/en/master/source/dsl.html"><code>kfp.dsl.PipelineTask</code> reference documentation</a>.</p>
<h3 id="caching">Caching</h3>
<p>KFP provides task-level output caching to reduce redundant computation by skipping the execution of tasks that were completed in a previous pipeline run. Caching is enabled by default, but can be disabled by calling <code>.set_caching_options(False)</code> on a task.</p>
<p>The cache key is determined by the task&rsquo;s component specification (image, command, arguments, input/output interface) and the task&rsquo;s provided inputs (the name and URI of artifacts and the name and value of parameters). Cache hit status is not determined until task runtime since input values may be unknown until pipeline runtime.</p>
<p>When a task&rsquo;s cache hits and its execution is skipped, it will be displayed on the KFP UI:</p>
<!-- TODO: add photo of cache on UI -->

</div>



    
	
  
    
    
	
    

<div class="td-content" style="page-break-before: always">
    
	<h1 id="pg-6afd16685922f350ab1b27a4d4e79d0c">3.2.4.3 - Pipelines</h1>
    <div class="lead">Create a pipeline</div>
	<p>A <em>pipeline</em> is a description of a multi-task workflow, including how tasks relate to each other to form an computational graph. Pipelines may have inputs which can be passed to tasks within the pipeline.</p>
<h2 id="author-a-pipeline">Author a pipeline</h2>
<p>Unlike components which have three authoring approaches, pipelines have one authoring approach: they are defined using Python pipeline functions decorated with <code>@dsl.pipeline</code>. For example:</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-python" data-lang="python"><span class="line"><span class="cl"><span class="kn">from</span> <span class="nn">kfp</span> <span class="kn">import</span> <span class="n">dsl</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="nd">@dsl</span><span class="o">.</span><span class="n">pipeline</span>
</span></span><span class="line"><span class="cl"><span class="k">def</span> <span class="nf">my_pipeline</span><span class="p">(</span><span class="n">text</span><span class="p">:</span> <span class="nb">str</span><span class="p">):</span>
</span></span><span class="line"><span class="cl">    <span class="n">my_task</span> <span class="o">=</span> <span class="n">my_component</span><span class="p">(</span><span class="n">arg1</span><span class="o">=</span><span class="n">text</span><span class="p">)</span>
</span></span></code></pre></div><p>The <code>@dsl.pipeline</code> decorator takes three optional arguments.</p>
<ul>
<li><code>name</code> is the name of your pipeline. If not provided, the name defaults to a sanitized version of the pipeline function name.</li>
<li><code>description</code> is a description of the pipeline.</li>
<li><code>pipeline_root</code> is the remote storage root path from which your pipeline will write and read artifacts (e.g., <code>gs://my/path</code>).</li>
</ul>
<p>A pipeline function is a function that may have inputs, instantiates components as tasks and uses them to form a computational graph, and only uses the KFP domain-specific language objects and syntax within the function scope. Let&rsquo;s walk through each of these parts one-by-one.</p>
<p>First, like a component, a pipeline function may have inputs and outputs. This allows your pipeline to serve as a computational template that can be executed with different input parameters to create a specified set of outputs. See <a href="/docs/components/pipelines/v2/author-a-pipeline/component-io/#pipeline-io">Component I/O: Pipeline I/O</a> for how to use type annotations in a pipeline.</p>
<p>Second, a pipeline function instantiates components as tasks and uses them to form a computational graph. For information on how to instatiate components as tasks and pass data between them, see <a href="/docs/components/pipelines/v2/author-a-pipeline/component-io#passing-data-between-tasks">Component I/O: Passing data between tasks</a>. For information on task dependencies, see <a href="/docs/components/pipelines/v2/author-a-pipeline/tasks">Tasks</a>.</p>
<p>Third, a pipeline function only uses domain-specific language (DSL) objects and syntax within the function scope. Because the body of a Python pipeline function must ultimately be compiled to IR YAML, pipeline functions only support a very narrow set of Python language features, as specified by the KFP DSL. In addition to instantiation and data passing between tasks, the only three other features permitted are <code>dsl.Condition</code>, <code>dsl.ParallelFor</code> and <code>dsl.ExitHandler</code>. Use of these three features is covered in the next section. Use of classes, list comprehensions, lambda functions, and other arbitrary Python language features are not permitted within the scope of a Python pipeline function.</p>
<h2 id="dsl-control-flow-features">DSL control flow features</h2>
<p>A critical difference between components and pipelines is how control flow is authored and executed. Within a Python component, control flow is authored using arbitrary Python language features and the raw Python code is executed at component runtime. Within the scope of a pipeline, control flow acts on tasks, is authored using DSL features, and is executed by the KFP backend through the creation of Kubernetes Pods to execute those tasks.  <code>dsl.Condition</code>, <code>dsl.ParallelFor</code> and <code>dsl.ExitHandler</code> can be used to orchestrate the completion of tasks within a pipeline function body. Each is implemented as a Python context manager.</p>
<h3 id="dslcondition">dsl.Condition</h3>
<p>The <a href="https://kubeflow-pipelines.readthedocs.io/en/master/source/dsl.html"><code>dsl.Condition</code></a> context manager allows conditional execution of tasks within its scope based on the output of an upstream task. The context manager takes two arguments: a required <code>condition</code> and an optional <code>name</code>. The <code>condition</code> is a comparative expression where at least one of the two operands is an output from an upstream task.</p>
<p>In the following pipeline, <code>conditional_task</code> only executes if <code>coin_flip_task</code> has the output <code>'heads'</code>.</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-python" data-lang="python"><span class="line"><span class="cl"><span class="kn">from</span> <span class="nn">kfp</span> <span class="kn">import</span> <span class="n">dsl</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="nd">@dsl</span><span class="o">.</span><span class="n">pipeline</span>
</span></span><span class="line"><span class="cl"><span class="k">def</span> <span class="nf">my_pipeline</span><span class="p">():</span>
</span></span><span class="line"><span class="cl">    <span class="n">coin_flip_task</span> <span class="o">=</span> <span class="n">flip_coin</span><span class="p">()</span>
</span></span><span class="line"><span class="cl">    <span class="k">with</span> <span class="n">dsl</span><span class="o">.</span><span class="n">Condition</span><span class="p">(</span><span class="n">coin_flip_task</span><span class="o">.</span><span class="n">output</span> <span class="o">==</span> <span class="s1">&#39;heads&#39;</span><span class="p">):</span>
</span></span><span class="line"><span class="cl">        <span class="n">conditional_task</span> <span class="o">=</span> <span class="n">my_comp</span><span class="p">()</span>
</span></span></code></pre></div><h3 id="dslparallelfor">dsl.ParallelFor</h3>
<p>The <a href="https://kubeflow-pipelines.readthedocs.io/en/master/source/dsl.html"><code>dsl.ParallelFor</code></a> context manager allows parallelized execution of tasks over a static set of items. The context manager takes two arguments: a required <code>items</code>, an optional <code>parallelism</code>, and an optional <code>name</code>. <code>items</code> is the static set of items to loop over, while <code>parallelism</code> is the maximum number of concurrent iterations permitted while executing the <code>dsl.ParallelFor</code> group. <code>parallelism=0</code> indicates unconstrained parallelism.</p>
<p>In the following pipeline, <code>train_model</code> will train a model for 1, 5, 10, and 25 epochs, with no more than two training tasks running at one time:</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-python" data-lang="python"><span class="line"><span class="cl"><span class="kn">from</span> <span class="nn">kfp</span> <span class="kn">import</span> <span class="n">dsl</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="nd">@dsl</span><span class="o">.</span><span class="n">pipeline</span>
</span></span><span class="line"><span class="cl"><span class="k">def</span> <span class="nf">my_pipeline</span><span class="p">():</span>
</span></span><span class="line"><span class="cl">    <span class="k">with</span> <span class="n">dsl</span><span class="o">.</span><span class="n">ParallelFor</span><span class="p">(</span>
</span></span><span class="line"><span class="cl">        <span class="n">items</span><span class="o">=</span><span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">5</span><span class="p">,</span> <span class="mi">10</span><span class="p">,</span> <span class="mi">25</span><span class="p">],</span>
</span></span><span class="line"><span class="cl">        <span class="n">parallelism</span><span class="o">=</span><span class="mi">2</span>
</span></span><span class="line"><span class="cl">    <span class="p">)</span> <span class="k">as</span> <span class="n">epochs</span><span class="p">:</span>
</span></span><span class="line"><span class="cl">        <span class="n">train_model</span><span class="p">(</span><span class="n">epochs</span><span class="o">=</span><span class="n">epochs</span><span class="p">)</span>
</span></span></code></pre></div><h3 id="dslexithandler">dsl.ExitHandler</h3>
<p>The <a href="https://kubeflow-pipelines.readthedocs.io/en/master/source/dsl.html"><code>dsl.ExitHandler</code></a> context manager allows pipeline authors to specify an &ldquo;exit handler&rdquo; task which will run after the tasks within its scope finish execution or one of them fails. This is analogous to using <code>try:</code> followed by <code>finally:</code> in normal Python. The context manager takes two arguments: a required <code>exit_task</code> and an optional <code>name</code>. The <code>exit_task</code> is the &ldquo;exit handler&rdquo; task and must be instantiated before the <code>dsl.ExitHandler</code> context manager is entered.</p>
<p>In the following pipeline, <code>clean_up_task</code> will execute after either both <code>create_dataset</code> and <code>train_and_save_models</code> finish or one of them fails:</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-python" data-lang="python"><span class="line"><span class="cl"><span class="kn">from</span> <span class="nn">kfp</span> <span class="kn">import</span> <span class="n">dsl</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="nd">@dsl</span><span class="o">.</span><span class="n">pipeline</span>
</span></span><span class="line"><span class="cl"><span class="k">def</span> <span class="nf">my_pipeline</span><span class="p">():</span>
</span></span><span class="line"><span class="cl">    <span class="n">clean_up_task</span> <span class="o">=</span> <span class="n">clean_up_resources</span><span class="p">()</span>
</span></span><span class="line"><span class="cl">    <span class="k">with</span> <span class="n">dsl</span><span class="o">.</span><span class="n">ExitHandler</span><span class="p">(</span><span class="n">exit_task</span><span class="o">=</span><span class="n">clean_up_task</span><span class="p">):</span>
</span></span><span class="line"><span class="cl">        <span class="n">dataset_task</span> <span class="o">=</span> <span class="n">create_datasets</span><span class="p">()</span>
</span></span><span class="line"><span class="cl">        <span class="n">train_task</span> <span class="o">=</span> <span class="n">train_and_save_models</span><span class="p">(</span><span class="n">dataset</span><span class="o">=</span><span class="n">dataset_task</span><span class="o">.</span><span class="n">output</span><span class="p">)</span>
</span></span></code></pre></div><p>The task you use as an exit task may use a special backend-provided input that provides access to pipeline and task status metadata, including pipeline failure or success status. You can use this special input by annotating your exit task with the <code>dsl.PipelineTaskFinalStatus</code> annotation. You should not provide any input to this annotation when you instantiate your exit task.</p>
<p>The following pipeline uses <code>PipelineTaskFinalStatus</code> to obtain information about the pipeline and task failure, even after <code>fail_op</code> fails:</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-python" data-lang="python"><span class="line"><span class="cl"><span class="kn">from</span> <span class="nn">kfp</span> <span class="kn">import</span> <span class="n">dsl</span>
</span></span><span class="line"><span class="cl"><span class="kn">from</span> <span class="nn">kfp.dsl</span> <span class="kn">import</span> <span class="n">PipelineTaskFinalStatus</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="nd">@dsl</span><span class="o">.</span><span class="n">component</span>
</span></span><span class="line"><span class="cl"><span class="k">def</span> <span class="nf">exit_op</span><span class="p">(</span><span class="n">user_input</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span> <span class="n">status</span><span class="p">:</span> <span class="n">PipelineTaskFinalStatus</span><span class="p">):</span>
</span></span><span class="line"><span class="cl">    <span class="s2">&#34;&#34;&#34;Prints pipeline run status.&#34;&#34;&#34;</span>
</span></span><span class="line"><span class="cl">    <span class="nb">print</span><span class="p">(</span><span class="n">user_input</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">    <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;Pipeline status: &#39;</span><span class="p">,</span> <span class="n">status</span><span class="o">.</span><span class="n">state</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">    <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;Job resource name: &#39;</span><span class="p">,</span> <span class="n">status</span><span class="o">.</span><span class="n">pipeline_job_resource_name</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">    <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;Pipeline task name: &#39;</span><span class="p">,</span> <span class="n">status</span><span class="o">.</span><span class="n">pipeline_task_name</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">    <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;Error code: &#39;</span><span class="p">,</span> <span class="n">status</span><span class="o">.</span><span class="n">error_code</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">    <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;Error message: &#39;</span><span class="p">,</span> <span class="n">status</span><span class="o">.</span><span class="n">error_message</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="nd">@dsl</span><span class="o">.</span><span class="n">component</span>
</span></span><span class="line"><span class="cl"><span class="k">def</span> <span class="nf">fail_op</span><span class="p">():</span>
</span></span><span class="line"><span class="cl">    <span class="kn">import</span> <span class="nn">sys</span>
</span></span><span class="line"><span class="cl">    <span class="n">sys</span><span class="o">.</span><span class="n">exit</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="nd">@dsl</span><span class="o">.</span><span class="n">pipeline</span>
</span></span><span class="line"><span class="cl"><span class="k">def</span> <span class="nf">my_pipeline</span><span class="p">():</span>
</span></span><span class="line"><span class="cl">    <span class="n">print_op</span><span class="p">()</span>
</span></span><span class="line"><span class="cl">    <span class="n">print_status_task</span> <span class="o">=</span> <span class="n">exit_op</span><span class="p">(</span><span class="n">user_input</span><span class="o">=</span><span class="s1">&#39;Task execution status:&#39;</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">    <span class="k">with</span> <span class="n">dsl</span><span class="o">.</span><span class="n">ExitHandler</span><span class="p">(</span><span class="n">exit_task</span><span class="o">=</span><span class="n">print_status_task</span><span class="p">):</span>
</span></span><span class="line"><span class="cl">        <span class="n">fail_op</span><span class="p">()</span>
</span></span></code></pre></div><!-- TODO: make this reference more precise throughout -->

</div>



    
	
  
    
    
	
    

<div class="td-content" style="page-break-before: always">
    
	<h1 id="pg-4cdabdf4d68974491ee69accb5f7080d">3.2.4.4 - Component I/O</h1>
    <div class="lead">Use parameter/artifact inputs and outputs</div>
	<p>Components may accept inputs and create outputs. Inputs and outputs can be one of two types: parameters or artifacts. The following matrix describes possible component inputs and outputs:</p>
<table>
<thead>
<tr>
<th></th>
<th>Parameter</th>
<th>Artifact</th>
</tr>
</thead>
<tbody>
<tr>
<td>Input</td>
<td>Input Parameter</td>
<td>Input Artifact</td>
</tr>
<tr>
<td>Output</td>
<td>Output Parameter</td>
<td>Output Artifact</td>
</tr>
</tbody>
</table>
<p>Throughout the remainder of this section, we will use the following example dataset creation pipeline to understand the behavior and usage of input and output parameters and artifacts:</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-python" data-lang="python"><span class="line"><span class="cl"><span class="kn">from</span> <span class="nn">kfp</span> <span class="kn">import</span> <span class="n">dsl</span>
</span></span><span class="line"><span class="cl"><span class="kn">from</span> <span class="nn">kfp.dsl</span> <span class="kn">import</span> <span class="n">Input</span><span class="p">,</span> <span class="n">Output</span><span class="p">,</span> <span class="n">Dataset</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="nd">@dsl</span><span class="o">.</span><span class="n">container_component</span>
</span></span><span class="line"><span class="cl"><span class="k">def</span> <span class="nf">create_dataset</span><span class="p">(</span>
</span></span><span class="line"><span class="cl">    <span class="n">initial_text</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">    <span class="n">output_dataset</span><span class="p">:</span> <span class="n">Output</span><span class="p">[</span><span class="n">Dataset</span><span class="p">],</span>
</span></span><span class="line"><span class="cl"><span class="p">):</span>
</span></span><span class="line"><span class="cl">    <span class="s2">&#34;&#34;&#34;Create a dataset containing the string `initial_text`.&#34;&#34;&#34;</span> 
</span></span><span class="line"><span class="cl">    <span class="k">return</span> <span class="n">dsl</span><span class="o">.</span><span class="n">ContainerSpec</span><span class="p">(</span>
</span></span><span class="line"><span class="cl">        <span class="n">image</span><span class="o">=</span><span class="s1">&#39;alpine&#39;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">        <span class="n">command</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;sh&#39;</span><span class="p">,</span> <span class="s1">&#39;-c&#39;</span><span class="p">,</span> <span class="s1">&#39;mkdir --parents $(dirname &#34;$1&#34;) &amp;&amp; echo &#34;$0&#34; &gt; &#34;$1&#34;&#39;</span><span class="p">,],</span>
</span></span><span class="line"><span class="cl">        <span class="n">args</span><span class="o">=</span><span class="p">[</span><span class="n">initial_text</span><span class="p">,</span> <span class="n">output_dataset</span><span class="o">.</span><span class="n">path</span><span class="p">])</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="nd">@dsl</span><span class="o">.</span><span class="n">component</span>
</span></span><span class="line"><span class="cl"><span class="k">def</span> <span class="nf">augment_dataset</span><span class="p">(</span>
</span></span><span class="line"><span class="cl">    <span class="n">existing_dataset</span><span class="p">:</span> <span class="n">Input</span><span class="p">[</span><span class="n">Dataset</span><span class="p">],</span>
</span></span><span class="line"><span class="cl">    <span class="n">resulting_dataset</span><span class="p">:</span> <span class="n">Output</span><span class="p">[</span><span class="n">Dataset</span><span class="p">],</span>
</span></span><span class="line"><span class="cl">    <span class="n">text</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">    <span class="n">num</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="mi">10</span><span class="p">,</span>
</span></span><span class="line"><span class="cl"><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">int</span><span class="p">:</span>
</span></span><span class="line"><span class="cl">    <span class="s2">&#34;&#34;&#34;Append `text` `num` times to an existing dataset, then write it as a new dataset.&#34;&#34;&#34;</span>
</span></span><span class="line"><span class="cl">    <span class="n">additional_data</span> <span class="o">=</span> <span class="s1">&#39; &#39;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">text</span> <span class="k">for</span> <span class="n">_</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">num</span><span class="p">))</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">    <span class="k">with</span> <span class="nb">open</span><span class="p">(</span><span class="n">existing_dataset</span><span class="o">.</span><span class="n">path</span><span class="p">,</span> <span class="s1">&#39;r&#39;</span><span class="p">)</span> <span class="k">as</span> <span class="n">f</span><span class="p">:</span>
</span></span><span class="line"><span class="cl">        <span class="n">existing_dataset_text</span> <span class="o">=</span> <span class="n">f</span><span class="o">.</span><span class="n">read</span><span class="p">()</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">    <span class="n">resulting_dataset_text</span> <span class="o">=</span> <span class="n">existing_dataset_text</span> <span class="o">+</span> <span class="s1">&#39; &#39;</span> <span class="o">+</span> <span class="n">additional_data</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">    <span class="k">with</span> <span class="nb">open</span><span class="p">(</span><span class="n">resulting_dataset</span><span class="o">.</span><span class="n">path</span><span class="p">,</span> <span class="s1">&#39;w&#39;</span><span class="p">)</span> <span class="k">as</span> <span class="n">f</span><span class="p">:</span>
</span></span><span class="line"><span class="cl">        <span class="n">f</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="n">resulting_dataset_text</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">    <span class="k">return</span> <span class="nb">len</span><span class="p">(</span><span class="n">resulting_dataset_text</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="nd">@dsl</span><span class="o">.</span><span class="n">pipeline</span><span class="p">()</span>
</span></span><span class="line"><span class="cl"><span class="k">def</span> <span class="nf">my_pipeline</span><span class="p">(</span><span class="n">initial_text</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="s1">&#39;initial dataset text&#39;</span><span class="p">):</span>
</span></span><span class="line"><span class="cl">    <span class="n">create_task</span> <span class="o">=</span> <span class="n">create_dataset</span><span class="p">(</span><span class="n">initial_text</span><span class="o">=</span><span class="n">initial_text</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">    <span class="n">augment_dataset</span><span class="p">(</span>
</span></span><span class="line"><span class="cl">        <span class="n">existing_dataset</span><span class="o">=</span><span class="n">create_task</span><span class="o">.</span><span class="n">outputs</span><span class="p">[</span><span class="s1">&#39;output_dataset&#39;</span><span class="p">],</span>
</span></span><span class="line"><span class="cl">        <span class="n">text</span><span class="o">=</span><span class="s1">&#39;additional text&#39;</span><span class="p">)</span>
</span></span></code></pre></div><p>This pipeline uses a <a href="/docs/components/pipelines/v2/author-a-pipeline/components/#3-custom-container-components">custom container component</a> <code>create_dataset</code> to construct an initial <code>Dataset</code> artifact containing <code>initial_text</code>. Then, the downstream <a href="/docs/components/pipelines/v2/author-a-pipeline/components/#1-lighweight-python-function-based-components">lightweight Python component</a> <code>augment_dataset</code> appends <code>text</code> repeated <code>num</code> times to the dataset and saves it as a new dataset.</p>
<h2 id="inputs">Inputs</h2>
<p>Component inputs are specified by the component function&rsquo;s signature. This applies for all authoring approaches: <a href="/docs/components/pipelines/v2/author-a-pipeline/components/#1-lighweight-python-function-based-components">lightweight Python components</a>, <a href="/docs/components/pipelines/v2/author-a-pipeline/components/#2-containerized-python-components">containerized Python components</a>, and <a href="/docs/components/pipelines/v2/author-a-pipeline/components/#3-custom-container-components">custom container components</a>.</p>
<p>Ultimately, each authoring style creates a component definitied by an <code>image</code>, <code>command</code>, and <code>args</code>. When you use an input, it is represented as a placeholder in the <code>command</code> or <code>args</code> and is interpolated at component runtime.</p>
<p>There is one additional type of input, the struct <code>PipelineTaskFinalStatus</code>, which allows access to the metadata of one task from within another via a system-provided value at runtime. This input is a special case, as it is neither a typical parameter nor an artifact and it is only usable in <code>dsl.ExitHandler</code> exit tasks. Use of this input is covered in <a href="/docs/components/pipelines/v2/author-a-pipeline/pipelines">Authoring: Pipelines</a>.</p>
<h3 id="input-parameters">Input parameters</h3>
<p>Input parameters are declared when you use a <code>str</code>, <code>int</code>, <code>float</code>, <code>bool</code>, <code>dict</code> or <code>list</code> type annotation. The data passed to parameters typed with <code>dict</code> or <code>list</code> may only container JSON-serializable Python primitives. <code>Union</code> types are not permitted.</p>
<p>In the example <code>create_dataset</code> component, <code>initial_text</code> is an input parameter. In <code>augment_dataset</code>, <code>text</code> and <code>num</code> are input parameters.</p>
<p>Input parameters may have default values. For example, <code>augment_dataset</code>&rsquo;s <code>num</code> parameter has a default value of <code>10</code>.</p>
<p>Within a component function body, use input parameters just as you would in a normal Python function.</p>
<h3 id="input-artifacts">Input artifacts</h3>
<p>Input artifacts are defined when you use an <code>Input[&lt;ArtifactClass&gt;]</code> annotation. For more information about artifacts, see <a href="/docs/components/pipelines/v2/author-a-pipeline/component-io/">Component I/O</a>.</p>
<p>At component runtime, input artifacts are copied to the local filesystem by the executing backend. This abstracts away the need for the component author to know where artifacts are stored in remote storage and allows component authors to only interact with the local filesystem when implementing a component that uses an artifact. All artifacts implement a <code>.path</code> method, which can be used to access the local path where the artifact file has been copied.</p>
<p>Let&rsquo;s see how this works in practice. In our example pipeline, <code>augment_dataset</code> specifies the input <code>existing_dataset: Input[Dataset]</code>. In the pipeline definition, we pass the output dataset from <code>create_dataset</code> to this parameter. When the <code>augument_dataset</code> component runs, the executing backend copies the <code>output_dataset</code> artifact file to the container filesystem and passes in an instance of <code>Dataset</code> as an argument to <code>existing_dataset</code>. The <code>Dataset</code> instance has a <code>.path</code> handle to its location in the container filesystem, allowing the component to read it:</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-python" data-lang="python"><span class="line"><span class="cl"><span class="k">with</span> <span class="nb">open</span><span class="p">(</span><span class="n">existing_dataset</span><span class="o">.</span><span class="n">path</span><span class="p">,</span> <span class="s1">&#39;r&#39;</span><span class="p">)</span> <span class="k">as</span> <span class="n">f</span><span class="p">:</span>
</span></span><span class="line"><span class="cl">    <span class="n">existing_dataset_text</span> <span class="o">=</span> <span class="n">f</span><span class="o">.</span><span class="n">read</span><span class="p">()</span>
</span></span></code></pre></div><h2 id="outputs">Outputs</h2>
<p>Like inputs, component outputs are also specified by the component function&rsquo;s signature. Depending on the component authoring approach and the type of output (parameter or artifact), outputs may be specified by the function return type annotation (e.g., <code>-&gt; int</code>), the type annotation generic <code>Output[]</code>, or the type annotation class <code>OutputPath</code>. Uses for each are explained in the sections to follow.</p>
<p>For all output types and authoring styles, outputs from a component are persisted to a remote file store, such as <a href="https://min.io/">Minio</a>, <a href="https://cloud.google.com/storage">Google Cloud Storage</a>, or <a href="https://aws.amazon.com/s3/">AWS S3</a>, that way they outlast the ephemeral container that creates them and can be picked up for use by a downstream task.</p>
<h3 id="output-parameters">Output parameters</h3>
<p>Output parameters are declared in different ways depending on the authoring approach.</p>
<h4 id="python-components">Python components</h4>
<p>For lightweight Python components and containerized Python components, output parameters are declared by the Python component function return type annotation (e.g., <code>-&gt; int</code>). Like parameter inputs, return type annotations may be <code>str</code>, <code>int</code>, <code>float</code>, <code>bool</code>, <code>dict</code> or <code>list</code>.</p>
<p>In our example, <code>augment_dataset</code> has a one integer output.</p>
<p>You may also specify multiple output parameters by using these annotations within a <code>typing.NamedTuple</code> as follows:</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-python" data-lang="python"><span class="line"><span class="cl"><span class="kn">from</span> <span class="nn">typing</span> <span class="kn">import</span> <span class="n">NamedTuple</span>
</span></span><span class="line"><span class="cl"><span class="kn">from</span> <span class="nn">kfp</span> <span class="kn">import</span> <span class="n">dsl</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="nd">@dsl</span><span class="o">.</span><span class="n">component</span>
</span></span><span class="line"><span class="cl"><span class="k">def</span> <span class="nf">my_component</span><span class="p">()</span> <span class="o">-&gt;</span> <span class="n">NamedTuple</span><span class="p">(</span><span class="s1">&#39;Outputs&#39;</span><span class="p">,</span> <span class="p">[(</span><span class="s1">&#39;name&#39;</span><span class="p">,</span> <span class="nb">str</span><span class="p">),</span> <span class="p">(</span><span class="s1">&#39;id&#39;</span><span class="p">,</span> <span class="nb">int</span><span class="p">)]):</span>
</span></span><span class="line"><span class="cl">    <span class="kn">from</span> <span class="nn">typing</span> <span class="kn">import</span> <span class="n">NamedTuple</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">    <span class="n">output</span> <span class="o">=</span> <span class="n">NamedTuple</span><span class="p">(</span><span class="s1">&#39;Outputs&#39;</span><span class="p">,</span> <span class="p">[(</span><span class="s1">&#39;name&#39;</span><span class="p">,</span> <span class="nb">str</span><span class="p">),</span> <span class="p">(</span><span class="s1">&#39;id&#39;</span><span class="p">,</span> <span class="nb">int</span><span class="p">)])</span>
</span></span><span class="line"><span class="cl">    <span class="k">return</span> <span class="n">output</span><span class="p">(</span><span class="s1">&#39;my_dataset&#39;</span><span class="p">,</span> <span class="mi">123</span><span class="p">)</span>
</span></span></code></pre></div><h4 id="custom-container-components">Custom container components</h4>
<p>For <a href="/docs/components/pipelines/v2/author-a-pipeline/components/#3-custom-container-components">custom container components</a>, output parameters are declared via an <code>OutputPath</code> annotation, which is a class that takes a type as its only argument (e.g., <code>OutputPath(int)</code>). At runtime, the backend will pass a filepath string to parameters with this annotation. This string indicating where in the container filesystem the component should write this parameter output. The backend will copy the file specified by this path to remote storage after component execution.</p>
<p>While the lightweight component executor handles writing the output parameters to the correct local filepath, custom container component authors must implement this in the container logic.</p>
<p>For example, the following very simple <code>create_text_output_parameter</code> component creates the output parameter string <code>&quot;some text&quot;</code> by using an <code>OutputPath(str)</code> annotation and writing the parameter to the path in the variable <code>output_string_path</code>:</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-python" data-lang="python"><span class="line"><span class="cl"><span class="kn">from</span> <span class="nn">kfp</span> <span class="kn">import</span> <span class="n">dsl</span>
</span></span><span class="line"><span class="cl"><span class="kn">from</span> <span class="nn">kfp.dsl</span> <span class="kn">import</span> <span class="n">OutputPath</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="nd">@dsl</span><span class="o">.</span><span class="n">container_component</span>
</span></span><span class="line"><span class="cl"><span class="k">def</span> <span class="nf">create_text_output_parameter</span><span class="p">(</span><span class="n">output_string_path</span><span class="p">:</span> <span class="n">OutputPath</span><span class="p">(</span><span class="nb">str</span><span class="p">)):</span>
</span></span><span class="line"><span class="cl">    <span class="k">return</span> <span class="n">dsl</span><span class="o">.</span><span class="n">ContainerSpec</span><span class="p">(</span>
</span></span><span class="line"><span class="cl">        <span class="n">image</span><span class="o">=</span><span class="s1">&#39;alpine&#39;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">        <span class="n">command</span><span class="o">=</span><span class="p">[</span>
</span></span><span class="line"><span class="cl">            <span class="s1">&#39;sh&#39;</span><span class="p">,</span> <span class="s1">&#39;-c&#39;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">            <span class="s1">&#39;mkdir --parents $(dirname &#34;$0&#34;) &amp;&amp; echo &#34;some text&#34; &gt; &#34;$0&#34;&#39;</span>
</span></span><span class="line"><span class="cl">        <span class="p">],</span>
</span></span><span class="line"><span class="cl">        <span class="n">args</span><span class="o">=</span><span class="p">[</span><span class="n">output_string</span><span class="p">])</span>
</span></span></code></pre></div><h3 id="output-artifacts">Output artifacts</h3>
<p>Output artifacts are declared when you use an <code>Output[&lt;ArtifactClass&gt;]</code> annotation. For more information about artifacts, see [Artifacts][artifacts].</p>
<p>Output artifacts are treated inversely to input artifacts at component runtime: instead of being <em>copied to the container</em> from remote storage, they are <em>copied to remote storage</em> from the <code>.path</code> location in the container&rsquo;s filesystem after the component executes. This abstracts away the need for the component author to know where artifacts are stored in remote storage and allows component authors to only interact with the local filesystem when implementing a component that creates an artifact. As with using an artifact input, component authors should write artifacts to <code>.path</code>:</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-python" data-lang="python"><span class="line"><span class="cl"><span class="k">with</span> <span class="nb">open</span><span class="p">(</span><span class="n">resulting_dataset</span><span class="o">.</span><span class="n">path</span><span class="p">,</span> <span class="s1">&#39;w&#39;</span><span class="p">)</span> <span class="k">as</span> <span class="n">f</span><span class="p">:</span>
</span></span><span class="line"><span class="cl">    <span class="n">f</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="n">resulting_dataset_text</span><span class="p">)</span>
</span></span></code></pre></div><h2 id="pipeline-io">Pipeline I/O</h2>
<p>A pipeline may be used like a component by instantiating it as a task within another pipeline.</p>
<h3 id="inputs-1">Inputs</h3>
<p>All pipeline inputs must include type annotations. Valid input parameter annotations include <code>str</code>, <code>int</code>, <code>float</code>, <code>bool</code>, <code>dict</code>, <code>list</code>. Input parameters may also have defaults. The only valid input artifact annotation is <code>Input[&lt;Artifact&gt;]</code> (where <code>&lt;Artifact&gt;</code> is any KFP-compatible artifact class). Input artifacts may not have defaults.</p>
<p>The following simple pipeline has a <code>str</code> parameter <code>text</code> and an <code>int</code> parameter <code>number</code>. <code>number</code> has a default value of <code>10</code>.</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-python" data-lang="python"><span class="line"><span class="cl"><span class="kn">from</span> <span class="nn">kfp</span> <span class="kn">import</span> <span class="n">dsl</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="nd">@dsl</span><span class="o">.</span><span class="n">pipeline</span>
</span></span><span class="line"><span class="cl"><span class="k">def</span> <span class="nf">my_pipeline</span><span class="p">(</span><span class="n">text</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span> <span class="n">number</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="mi">10</span><span class="p">):</span>
</span></span><span class="line"><span class="cl">    <span class="o">...</span>
</span></span></code></pre></div><p>Ultimately, all inputs must be passed to an inner &ldquo;primitive&rdquo; component in order to perform computation on the input. See <a href="#from-a-pipeline-input">Passing data between tasks: From a pipeline input</a> for information about how to pass data from a pipeline input to a component within the pipeline.</p>
<h3 id="outputs-1">Outputs</h3>
<p>Pipelines may also have output parameters. All outputs are specified by a normal Python function return type annotation indicated by the <code>-&gt;</code> token (e.g., <code>-&gt; int</code>). Valid parameter type annotations include <code>str</code>, <code>int</code>, <code>float</code>, <code>bool</code>, <code>dict</code>, and <code>list</code>. Valid artifact type return annotations include <code>&lt;Artifact&gt;</code> (where <code>&lt;Artifact&gt;</code> is a KFP-compatible artifact class). You may specify multiple outputs using a <code>typing.NamedTuple</code> return annotation (see <a href="#python-components">Python Components</a>) for more information on how to use named tuple return types.</p>
<p>Ultimately, all outputs must be created by an inner &ldquo;primitive&rdquo; component. Pipelines may return this output as its output.</p>
<p>For example, the following <code>double</code> pipeline returns the single <code>int</code> output of the <code>multiply</code> component:</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-python" data-lang="python"><span class="line"><span class="cl"><span class="kn">from</span> <span class="nn">kfp</span> <span class="kn">import</span> <span class="n">dsl</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="nd">@dsl</span><span class="o">.</span><span class="n">component</span>
</span></span><span class="line"><span class="cl"><span class="k">def</span> <span class="nf">multiply</span><span class="p">(</span><span class="n">a</span><span class="p">:</span> <span class="nb">int</span><span class="p">,</span> <span class="n">b</span><span class="p">:</span> <span class="nb">int</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">int</span><span class="p">:</span>
</span></span><span class="line"><span class="cl">    <span class="k">return</span> <span class="n">a</span> <span class="o">*</span> <span class="n">b</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="nd">@dsl</span><span class="o">.</span><span class="n">pipeline</span>
</span></span><span class="line"><span class="cl"><span class="k">def</span> <span class="nf">double</span><span class="p">(</span><span class="n">number</span><span class="p">:</span> <span class="nb">int</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">int</span><span class="p">:</span>
</span></span><span class="line"><span class="cl">    <span class="k">return</span> <span class="n">multiply</span><span class="p">(</span><span class="n">num1</span><span class="o">=</span><span class="n">a</span><span class="p">,</span> <span class="n">num2</span><span class="o">=</span><span class="mi">2</span><span class="p">)</span><span class="o">.</span><span class="n">output</span>
</span></span></code></pre></div><p>In the following different example, the <code>training_workflow</code> pipeline returns a <code>Model</code> from the inner <code>train_model</code> component:</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-python" data-lang="python"><span class="line"><span class="cl"><span class="kn">from</span> <span class="nn">kfp</span> <span class="kn">import</span> <span class="n">dsl</span>
</span></span><span class="line"><span class="cl"><span class="kn">from</span> <span class="nn">kfp.dsl</span> <span class="kn">import</span> <span class="n">Dataset</span><span class="p">,</span> <span class="n">Input</span><span class="p">,</span> <span class="n">Model</span><span class="p">,</span> <span class="n">Output</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="nd">@dsl</span><span class="o">.</span><span class="n">component</span>
</span></span><span class="line"><span class="cl"><span class="k">def</span> <span class="nf">train_model</span><span class="p">(</span><span class="n">dataset</span><span class="p">:</span> <span class="n">Input</span><span class="p">[</span><span class="n">Dataset</span><span class="p">],</span> <span class="n">model</span><span class="p">:</span> <span class="n">Output</span><span class="p">[</span><span class="n">Model</span><span class="p">]):</span>
</span></span><span class="line"><span class="cl">    <span class="c1"># do training</span>
</span></span><span class="line"><span class="cl">    <span class="n">trained_model</span> <span class="o">=</span> <span class="o">...</span>
</span></span><span class="line"><span class="cl">    <span class="n">trained_model</span><span class="o">.</span><span class="n">save</span><span class="p">(</span><span class="n">model</span><span class="o">.</span><span class="n">path</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="nd">@dsl</span><span class="o">.</span><span class="n">pipeline</span>
</span></span><span class="line"><span class="cl"><span class="k">def</span> <span class="nf">training_workflow</span><span class="p">()</span> <span class="o">-&gt;</span> <span class="n">Model</span><span class="p">:</span>
</span></span><span class="line"><span class="cl">    <span class="n">get_dataset_op</span> <span class="o">=</span> <span class="n">get_dataset</span><span class="p">()</span>
</span></span><span class="line"><span class="cl">    <span class="n">train_model_op</span> <span class="o">=</span> <span class="n">train_model</span><span class="p">(</span><span class="n">dataset</span><span class="o">=</span><span class="n">get_dataset_op</span><span class="o">.</span><span class="n">outputs</span><span class="p">[</span><span class="s1">&#39;dataset&#39;</span><span class="p">])</span>
</span></span><span class="line"><span class="cl">    <span class="k">return</span> <span class="n">train_model_op</span><span class="o">.</span><span class="n">outputs</span><span class="p">[</span><span class="s1">&#39;model&#39;</span><span class="p">]</span>
</span></span></code></pre></div><h2 id="passing-data-between-tasks">Passing data between tasks</h2>
<p>To instantiate a component as a task, you must pass to it any required inputs. Required inputs include all input parameters without default values and all input artifacts.</p>
<p>Output parameters (e.g., <code>OutputPath</code>) and output artifacts (e.g., <code>Output[&lt;ArtifactClass&gt;]</code>) should not be passed explicitly by the pipeline author; they will be passed at component runtime by the executing backend. This allows component internals to know where output parameters and artifacts should be written in the container filesystem in order to be copied to remote storage by the backend.</p>
<p>Task inputs may come from one of three different places: a static variable, a pipeline parameter, or an upstream task output. Let&rsquo;s walk through each, using the following <code>identity</code> component to help illustrate each approach:</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-python" data-lang="python"><span class="line"><span class="cl"><span class="nd">@dsl</span><span class="o">.</span><span class="n">component</span>
</span></span><span class="line"><span class="cl"><span class="k">def</span> <span class="nf">identity</span><span class="p">(</span><span class="n">x</span><span class="p">:</span> <span class="nb">int</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">int</span><span class="p">:</span>
</span></span><span class="line"><span class="cl">    <span class="k">return</span> <span class="n">x</span>
</span></span></code></pre></div><h3 id="from-a-static-variable">From a static variable</h3>
<p>To provide static data as an input to a component, simply pass it as you would when using a normal function:</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-python" data-lang="python"><span class="line"><span class="cl"><span class="nd">@dsl</span><span class="o">.</span><span class="n">pipeline</span><span class="p">()</span>
</span></span><span class="line"><span class="cl"><span class="k">def</span> <span class="nf">my_pipeline</span><span class="p">():</span>
</span></span><span class="line"><span class="cl">    <span class="n">task</span> <span class="o">=</span> <span class="n">identity</span><span class="p">(</span><span class="n">x</span><span class="o">=</span><span class="mi">10</span><span class="p">)</span>
</span></span></code></pre></div><p>Note: Input artifacts cannot be passed as static variables; they must always be passed from an upstream task or an <a href="/docs/components/pipelines/v2/author-a-pipeline/components/#special-case-importer-components"><code>importer</code> component</a>.</p>
<h3 id="from-a-pipeline-input">From a pipeline input</h3>
<p>To pass data from a pipeline input to an inner task, simply pass the variable name as you normally would when calling one function within another:</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-python" data-lang="python"><span class="line"><span class="cl"><span class="nd">@dsl</span><span class="o">.</span><span class="n">pipeline</span><span class="p">()</span>
</span></span><span class="line"><span class="cl"><span class="k">def</span> <span class="nf">my_pipeline</span><span class="p">(</span><span class="n">pipeline_var_x</span><span class="p">:</span> <span class="nb">int</span><span class="p">):</span>
</span></span><span class="line"><span class="cl">    <span class="n">task</span> <span class="o">=</span> <span class="n">identity</span><span class="p">(</span><span class="n">x</span><span class="o">=</span><span class="n">pipeline_var_x</span><span class="p">)</span>
</span></span></code></pre></div><h3 id="from-a-task-output">From a task output</h3>
<p>Tasks provide references to their outputs in order to support passing data between tasks in a pipeline.</p>
<p>In nearly all cases, outputs are accessed via <code>.outputs['&lt;parameter&gt;']</code>, where <code>'&lt;parameter&gt;'</code> is the parameter name or named tuple field name from the task that produced the output which you wish to access. The <code>.outputs['&lt;parameter&gt;']</code> access pattern is used to access <code>Output[]</code> artifacts, <code>OutputPath</code> output parameters, and <code>NamedTuple</code> output parameters.</p>
<p>The only exception to this access pattern is when you wish to access a single return value from a lightweight Python component, which can be accessed through the task&rsquo;s <code>.output</code> attribute.</p>
<p>The following two subsections demonstrate this for parameters then artifacts.</p>
<h4 id="passing-parameters-from-task-to-task">Passing parameters from task to task</h4>
<p>Let&rsquo;s introduce two more components for sake of demonstrating passing parameters between components:</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-python" data-lang="python"><span class="line"><span class="cl"><span class="kn">from</span> <span class="nn">typing</span> <span class="kn">import</span> <span class="n">NamedTuple</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="nd">@dsl</span><span class="o">.</span><span class="n">component</span>
</span></span><span class="line"><span class="cl"><span class="k">def</span> <span class="nf">named_tuple</span><span class="p">(</span><span class="n">an_id</span><span class="p">:</span> <span class="nb">int</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">NamedTuple</span><span class="p">(</span><span class="s1">&#39;Outputs&#39;</span><span class="p">,</span> <span class="p">[(</span><span class="s1">&#39;name&#39;</span><span class="p">,</span> <span class="nb">str</span><span class="p">),</span> <span class="p">(</span><span class="s1">&#39;id&#39;</span><span class="p">,</span> <span class="nb">int</span><span class="p">)]):</span>
</span></span><span class="line"><span class="cl">    <span class="s2">&#34;&#34;&#34;Lightweight Python component with a NamedTuple output.&#34;&#34;&#34;</span>
</span></span><span class="line"><span class="cl">    <span class="kn">from</span> <span class="nn">typing</span> <span class="kn">import</span> <span class="n">NamedTuple</span>
</span></span><span class="line"><span class="cl">    <span class="n">outputs</span> <span class="o">=</span> <span class="n">NamedTuple</span><span class="p">(</span><span class="s1">&#39;Outputs&#39;</span><span class="p">,</span> <span class="p">[(</span><span class="s1">&#39;name&#39;</span><span class="p">,</span> <span class="nb">str</span><span class="p">),</span> <span class="p">(</span><span class="s1">&#39;id&#39;</span><span class="p">,</span> <span class="nb">int</span><span class="p">)])</span>
</span></span><span class="line"><span class="cl">    <span class="k">return</span> <span class="n">outputs</span><span class="p">(</span><span class="s1">&#39;my_dataset&#39;</span><span class="p">,</span> <span class="n">an_id</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="nd">@dsl</span><span class="o">.</span><span class="n">container_component</span>
</span></span><span class="line"><span class="cl"><span class="k">def</span> <span class="nf">identity_container</span><span class="p">(</span><span class="n">integer</span><span class="p">:</span> <span class="nb">int</span><span class="p">,</span> <span class="n">output_int</span><span class="p">:</span> <span class="n">OutputPath</span><span class="p">(</span><span class="nb">int</span><span class="p">)):</span>
</span></span><span class="line"><span class="cl">    <span class="s2">&#34;&#34;&#34;Custom container component that creates an integer output parameter.&#34;&#34;&#34;</span>
</span></span><span class="line"><span class="cl">    <span class="k">return</span> <span class="n">dsl</span><span class="o">.</span><span class="n">ContainerSpec</span><span class="p">(</span>
</span></span><span class="line"><span class="cl">        <span class="n">image</span><span class="o">=</span><span class="s1">&#39;alpine&#39;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">        <span class="n">command</span><span class="o">=</span><span class="p">[</span>
</span></span><span class="line"><span class="cl">            <span class="s1">&#39;sh&#39;</span><span class="p">,</span> <span class="s1">&#39;-c&#39;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">            <span class="s1">&#39;mkdir --parents $(dirname &#34;$0&#34;) &amp;&amp; echo &#34;$1&#34; &gt; &#34;$0&#34;&#39;</span>
</span></span><span class="line"><span class="cl">        <span class="p">],</span>
</span></span><span class="line"><span class="cl">        <span class="n">args</span><span class="o">=</span><span class="p">[</span><span class="n">output_int</span><span class="p">,</span> <span class="n">integer</span><span class="p">])</span>
</span></span></code></pre></div><p>Using the new <code>named_tuple</code> and <code>identity_container</code> components with our original <code>identity</code> component, the following pipeline shows the full range of task-to-task data passing styles:</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-python" data-lang="python"><span class="line"><span class="cl"><span class="nd">@dsl</span><span class="o">.</span><span class="n">pipeline</span><span class="p">()</span>
</span></span><span class="line"><span class="cl"><span class="k">def</span> <span class="nf">my_pipeline</span><span class="p">(</span><span class="n">pipeline_parameter_id</span><span class="p">:</span> <span class="nb">int</span><span class="p">):</span>
</span></span><span class="line"><span class="cl">    <span class="n">named_tuple_task</span> <span class="o">=</span> <span class="n">named_tuple</span><span class="p">(</span><span class="n">an_id</span><span class="o">=</span><span class="n">pipeline_parameter_id</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">    
</span></span><span class="line"><span class="cl">    <span class="c1"># access a named tuple parameter output via .outputs[&#39;&lt;parameter&gt;&#39;]</span>
</span></span><span class="line"><span class="cl">    <span class="n">identity_container_task</span> <span class="o">=</span> <span class="n">identity_container</span><span class="p">(</span><span class="n">integer</span><span class="o">=</span><span class="n">named_tuple_task</span><span class="o">.</span><span class="n">outputs</span><span class="p">[</span><span class="s1">&#39;id&#39;</span><span class="p">])</span>
</span></span><span class="line"><span class="cl">    
</span></span><span class="line"><span class="cl">    <span class="c1"># access an OutputPath parameter output via .outputs[&#39;&lt;parameter&gt;&#39;]</span>
</span></span><span class="line"><span class="cl">    <span class="n">identity_task_1</span> <span class="o">=</span> <span class="n">identity</span><span class="p">(</span><span class="n">x</span><span class="o">=</span><span class="n">identity_container_task</span><span class="o">.</span><span class="n">outputs</span><span class="p">[</span><span class="s1">&#39;output_int&#39;</span><span class="p">])</span>
</span></span><span class="line"><span class="cl">    
</span></span><span class="line"><span class="cl">    <span class="c1"># access a lightweight component return value via .output</span>
</span></span><span class="line"><span class="cl">    <span class="n">identity_task_2</span> <span class="o">=</span> <span class="n">identity</span><span class="p">(</span><span class="n">x</span><span class="o">=</span><span class="n">identity_task_1</span><span class="o">.</span><span class="n">output</span><span class="p">)</span>
</span></span></code></pre></div><h4 id="passing-artifacts-from-task-to-task">Passing artifacts from task to task</h4>
<p>Artifacts may only be annotated via <code>Input[&lt;ArtifactClass&gt;]</code>/<code>Output[&lt;ArtifactClass&gt;]</code> annotations and may only be accessed via the <code>.outputs['&lt;parameter&gt;']</code> syntax. This makes passing them between tasks somewhat simpler than for parameters.</p>
<p>The pipeline below demonstrates passing an artifact between tasks using an artifact producer and an artifact consumer:</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-python" data-lang="python"><span class="line"><span class="cl"><span class="kn">from</span> <span class="nn">kfp</span> <span class="kn">import</span> <span class="n">dsl</span>
</span></span><span class="line"><span class="cl"><span class="kn">from</span> <span class="nn">kfp.dsl</span> <span class="kn">import</span> <span class="n">Artifact</span><span class="p">,</span> <span class="n">Input</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="nd">@dsl</span><span class="o">.</span><span class="n">component</span>
</span></span><span class="line"><span class="cl"><span class="k">def</span> <span class="nf">producer</span><span class="p">(</span><span class="n">output_artifact</span><span class="p">:</span> <span class="n">Output</span><span class="p">[</span><span class="n">Artifact</span><span class="p">]):</span>
</span></span><span class="line"><span class="cl">    <span class="k">with</span> <span class="nb">open</span><span class="p">(</span><span class="n">output_artifact</span><span class="p">,</span> <span class="s1">&#39;w&#39;</span><span class="p">)</span> <span class="k">as</span> <span class="n">f</span><span class="p">:</span>
</span></span><span class="line"><span class="cl">        <span class="n">f</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s1">&#39;my artifact&#39;</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="nd">@dsl</span><span class="o">.</span><span class="n">component</span>
</span></span><span class="line"><span class="cl"><span class="k">def</span> <span class="nf">consumer</span><span class="p">(</span><span class="n">input_artifact</span><span class="p">:</span> <span class="n">Input</span><span class="p">[</span><span class="n">Artifact</span><span class="p">]):</span>
</span></span><span class="line"><span class="cl">    <span class="k">with</span> <span class="nb">open</span><span class="p">(</span><span class="n">input_artifact</span><span class="p">,</span> <span class="s1">&#39;r&#39;</span><span class="p">)</span> <span class="k">as</span> <span class="n">f</span><span class="p">:</span>
</span></span><span class="line"><span class="cl">        <span class="nb">print</span><span class="p">(</span><span class="n">f</span><span class="o">.</span><span class="n">read</span><span class="p">())</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="nd">@dsl</span><span class="o">.</span><span class="n">pipeline</span><span class="p">()</span>
</span></span><span class="line"><span class="cl"><span class="k">def</span> <span class="nf">my_pipeline</span><span class="p">():</span>
</span></span><span class="line"><span class="cl">    <span class="n">producer_task</span> <span class="o">=</span> <span class="n">producer</span><span class="p">()</span>
</span></span><span class="line"><span class="cl">    <span class="n">consumer</span><span class="p">(</span><span class="n">input_artifact</span><span class="o">=</span><span class="n">producer_task</span><span class="o">.</span><span class="n">outputs</span><span class="p">[</span><span class="s1">&#39;output_artifact&#39;</span><span class="p">])</span>
</span></span></code></pre></div><h2 id="special-input-values">Special input values</h2>
<p>There are a few special input values that may be used to access pipeline or task metadata within a component. These values can passed to input parameters typed with <code>str</code>. For example, the following <code>print_op</code> component can obtain the pipeline job name at component runtime by using the <code>dsl.PIPELINE_JOB_NAME_PLACEHOLDER</code>:</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-python" data-lang="python"><span class="line"><span class="cl"><span class="kn">from</span> <span class="nn">kfp</span> <span class="n">dsl</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="nd">@dsl</span><span class="o">.</span><span class="n">pipeline</span><span class="p">()</span>
</span></span><span class="line"><span class="cl"><span class="k">def</span> <span class="nf">my_pipeline</span><span class="p">():</span>
</span></span><span class="line"><span class="cl">    <span class="n">print_op</span><span class="p">(</span><span class="n">text</span><span class="o">=</span><span class="n">dsl</span><span class="o">.</span><span class="n">PIPELINE_JOB_NAME_PLACEHOLDER</span><span class="p">)</span>
</span></span></code></pre></div><p>There several placeholders that may be used in this style, including:</p>
<ul>
<li><code>dsl.PIPELINE_JOB_NAME_PLACEHOLDER</code></li>
<li><code>dsl.PIPELINE_JOB_RESOURCE_NAME_PLACEHOLDER</code></li>
<li><code>dsl.PIPELINE_JOB_ID_PLACEHOLDER</code></li>
<li><code>dsl.PIPELINE_TASK_NAME_PLACEHOLDER</code></li>
<li><code>dsl.PIPELINE_TASK_ID_PLACEHOLDER</code></li>
</ul>
<h2 id="placeholders">Placeholders</h2>
<p>In general, each of the three component authoring styles handle the injection of placeholders into your container <code>command</code> and <code>args</code>, allowing the component author to not have to worry about them. However, there are two types of placeholders you may wish to use directly: <code>ConcatPlaceholder</code> and <code>IfPresentPlaceholder</code>. These placeholders may only be used when authoring <a href="/docs/components/pipelines/v2/author-a-pipeline/components/#3-custom-container-components">custom container components</a> via the <code>@dsl.container_component</code> decorator.</p>
<h3 id="concatplaceholder">ConcatPlaceholder</h3>
<p>When you provide a container <code>command</code> or container <code>args</code> as a list of strings, each element in the list is concatenated using a space separator, then issued to the container. Concatenating an one input to another string without a space separator requires special handling provided by the <code>ConcatPlaceholder</code>.</p>
<p><code>ConcatPlaceholder</code> takes one argument, <code>items</code> which may be a list of any combination of static strings, parameter inputs, or other instances of <code>ConcatPlaceholder</code> or <code>IfPresentPlaceholder</code>. At runtime, these strings will be concatenated together without a separator.</p>
<p>For example, you can use <code>ConcatPlaceholder</code> to concatenate a file path prefix, suffix, and extension:</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-python" data-lang="python"><span class="line"><span class="cl"><span class="kn">from</span> <span class="nn">kfp</span> <span class="kn">import</span> <span class="n">dsl</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="nd">@dsl</span><span class="o">.</span><span class="n">container_component</span>
</span></span><span class="line"><span class="cl"><span class="k">def</span> <span class="nf">concatenator</span><span class="p">(</span><span class="n">prefix</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span> <span class="n">suffix</span><span class="p">:</span> <span class="nb">str</span><span class="p">):</span>
</span></span><span class="line"><span class="cl">    <span class="k">return</span> <span class="n">dsl</span><span class="o">.</span><span class="n">ContainerSpec</span><span class="p">(</span>
</span></span><span class="line"><span class="cl">        <span class="n">image</span><span class="o">=</span><span class="s1">&#39;alpine&#39;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">        <span class="n">command</span><span class="o">=</span><span class="p">[</span>
</span></span><span class="line"><span class="cl">            <span class="s1">&#39;my_program.sh&#39;</span>
</span></span><span class="line"><span class="cl">        <span class="p">],</span>
</span></span><span class="line"><span class="cl">        <span class="n">args</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;--input&#39;</span><span class="p">,</span> <span class="n">dsl</span><span class="o">.</span><span class="n">ConcatPlaceholder</span><span class="p">([</span><span class="n">prefix</span><span class="p">,</span> <span class="n">suffix</span><span class="p">,</span> <span class="s1">&#39;.txt&#39;</span><span class="p">])]</span>
</span></span><span class="line"><span class="cl">    <span class="p">)</span>
</span></span></code></pre></div><h3 id="ifpresentplaceholder">IfPresentPlaceholder</h3>
<p><code>IfPresentPlaceholder</code> is used to conditionally provide command line arguments. The <code>IfPresentPlaceholder</code> takes three arguments: <code>input_name</code>, <code>then</code>, and optionally <code>else_</code>. This placeholder is easiest to understand through an example:</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-python" data-lang="python"><span class="line"><span class="cl"><span class="nd">@dsl</span><span class="o">.</span><span class="n">container_component</span>
</span></span><span class="line"><span class="cl"><span class="k">def</span> <span class="nf">hello_someone</span><span class="p">(</span><span class="n">optional_name</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="kc">None</span><span class="p">):</span>
</span></span><span class="line"><span class="cl">    <span class="k">return</span> <span class="n">dsl</span><span class="o">.</span><span class="n">ContainerSpec</span><span class="p">(</span>
</span></span><span class="line"><span class="cl">        <span class="n">image</span><span class="o">=</span><span class="s1">&#39;python:3.7&#39;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">        <span class="n">command</span><span class="o">=</span><span class="p">[</span>
</span></span><span class="line"><span class="cl">            <span class="s1">&#39;echo&#39;</span><span class="p">,</span> <span class="s1">&#39;hello&#39;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">            <span class="n">dsl</span><span class="o">.</span><span class="n">IfPresentPlaceholder</span><span class="p">(</span>
</span></span><span class="line"><span class="cl">                <span class="n">input_name</span><span class="o">=</span><span class="s1">&#39;optional_name&#39;</span><span class="p">,</span> <span class="n">then</span><span class="o">=</span><span class="p">[</span><span class="n">optional_name</span><span class="p">])</span>
</span></span><span class="line"><span class="cl">        <span class="p">])</span>
</span></span></code></pre></div><p>If the <code>hello_someone</code> component is passed <code>'world'</code> as an argument for <code>optional_name</code>, the component will print <code>hello world</code>. If not, it will only print <code>hello</code>.</p>
<p>The third parameter <code>else_</code> can be used to provide a default value to fall back to if <code>input_name</code> is not provided.</p>
<p>Arguments to <code>then</code> and <code>else_</code> may be a list of any combination of static strings, parameter inputs, or other instances of <code>ConcatPlaceholder</code> or <code>IfPresentPlaceholder</code>.</p>
<h2 id="component-interfaces-and-type-checking">Component interfaces and type checking</h2>
<p>The KFP SDK compiler has the ability to use the type annotations you provide to type check your pipeline definition for mismatches between input and output types. The type checking logic is simple yet handy, particularly for complex pipelines. The type checking logic is:</p>
<ul>
<li>Parameter outputs may only be passed to parameter inputs. Artifact outputs may only be passed to artifact inputs.</li>
<li>A parameter output type (<code>int</code>, <code>str</code>, etc.) must match the annotation of the parameter input to which it is passed.</li>
<li>An artifact output type (<code>Dataset</code>, <code>Model</code>, etc.) must match the artifact input type to which it is passed <em>or</em> either of the two artifact annotations must use the generic KFP <code>Artifact</code> class.</li>
</ul>

</div>



    
	
  

    
	
  
    
    
	
    

<div class="td-content" style="page-break-before: always">
    
	<h1 id="pg-949036519b58594da97d168aa118d46d">3.2.5 - Compile a Pipeline</h1>
    <div class="lead">Compile a pipeline definition to YAML</div>
	<p>While pipelines and components are authored in Python, they can be compiled to intermediate representation (IR) YAML (<a href="https://github.com/kubeflow/pipelines/blob/984d8a039d2ff105ca6b21ab26be057b9552b51d/sdk/python/test_data/pipelines/two_step_pipeline.yaml">example</a>).</p>
<p>A YAML pipeline/component definition preserves a static representation of your pipeline/component. This YAML can be submitted to the KFP backend for execution or deserialized by the KFP SDK for integration into another pipeline.</p>
<h2 id="compiling">Compiling</h2>
<p>First let&rsquo;s define a very simple pipeline:</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-python" data-lang="python"><span class="line"><span class="cl"><span class="kn">from</span> <span class="nn">kfp</span> <span class="kn">import</span> <span class="n">compiler</span>
</span></span><span class="line"><span class="cl"><span class="kn">from</span> <span class="nn">kfp</span> <span class="kn">import</span> <span class="n">dsl</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="nd">@dsl</span><span class="o">.</span><span class="n">component</span>
</span></span><span class="line"><span class="cl"><span class="k">def</span> <span class="nf">addition_component</span><span class="p">(</span><span class="n">num1</span><span class="p">:</span> <span class="nb">int</span><span class="p">,</span> <span class="n">num2</span><span class="p">:</span> <span class="nb">int</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">int</span><span class="p">:</span>
</span></span><span class="line"><span class="cl">    <span class="k">return</span> <span class="n">num1</span> <span class="o">+</span> <span class="n">num2</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="nd">@dsl</span><span class="o">.</span><span class="n">pipeline</span><span class="p">(</span><span class="n">name</span><span class="o">=</span><span class="s1">&#39;addition-pipeline&#39;</span><span class="p">)</span>
</span></span><span class="line"><span class="cl"><span class="k">def</span> <span class="nf">my_pipeline</span><span class="p">(</span><span class="n">a</span><span class="p">:</span> <span class="nb">int</span><span class="p">,</span> <span class="n">b</span><span class="p">:</span> <span class="nb">int</span><span class="p">,</span> <span class="n">c</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="mi">10</span><span class="p">):</span>
</span></span><span class="line"><span class="cl">    <span class="n">add_task_1</span> <span class="o">=</span> <span class="n">addition_component</span><span class="p">(</span><span class="n">num1</span><span class="o">=</span><span class="n">a</span><span class="p">,</span> <span class="n">num2</span><span class="o">=</span><span class="n">b</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">    <span class="n">add_task_2</span> <span class="o">=</span> <span class="n">addition_component</span><span class="p">(</span><span class="n">num1</span><span class="o">=</span><span class="n">add_task_1</span><span class="o">.</span><span class="n">output</span><span class="p">,</span> <span class="n">num2</span><span class="o">=</span><span class="n">c</span><span class="p">)</span>
</span></span></code></pre></div><p>Now we can compile the pipeline to the file <code>my_pipeline.yaml</code>:</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-python" data-lang="python"><span class="line"><span class="cl"><span class="n">cmplr</span> <span class="o">=</span> <span class="n">compiler</span><span class="o">.</span><span class="n">Compiler</span><span class="p">()</span>
</span></span><span class="line"><span class="cl"><span class="n">cmplr</span><span class="o">.</span><span class="n">compile</span><span class="p">(</span><span class="n">my_pipeline</span><span class="p">,</span> <span class="n">package_path</span><span class="o">=</span><span class="s1">&#39;my_pipeline.yaml&#39;</span><span class="p">)</span>
</span></span></code></pre></div><p>Just as a pipeline is a template for a multi-step workflow, a component is a template for a single-step workflow. We can also compile the component <code>addition_component</code> directly:</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-python" data-lang="python"><span class="line"><span class="cl"><span class="n">cmplr</span><span class="o">.</span><span class="n">compile</span><span class="p">(</span><span class="n">addition_component</span><span class="p">,</span> <span class="n">package_path</span><span class="o">=</span><span class="s1">&#39;addition_component.yaml&#39;</span><span class="p">)</span>
</span></span></code></pre></div><p>The <code>Compiler.compile</code> method accepts a few optional additional parameters:</p>
<p><strong><code>pipeline_name</code></strong> (<code>string</code>)</p>
<p>Sets the name of the pipeline (or component). This is written to IR as the  <code>pipelineInfo.name</code> field. Will override the <code>name</code> passed to the <code>@dsl.pipeline</code> decorator.</p>
<p>The pipeline name, whether set through the decorator or the compiler, names your pipeline template. When you upload your pipeline, a pipeline context by this name will be created. The pipeline context enables the backend and the Dashboard to associate artifacts and executions created from runs of the same pipeline template. This allows you, for example, to compare metrics artifacts from multiple runs of the same training pipeline to find the best model.</p>
<p><strong><code>pipeline_parameters</code></strong> (<code>Dict[str, Any]</code>)</p>
<p>A map of parameter names to argument values. This amounts to providing default values for pipeline or component parameters. These defaults can be overriden at pipeline submission time.</p>
<p><strong><code>type_check</code></strong> (<code>bool</code>)</p>
<p>Whether to enable static type checking during compilation. For more information about type checking, see <a href="/docs/components/pipelines/v2/author-a-pipeline/component-io#component-interfaces-and-type-checking">Component I/O: Component interfaces and type checking</a>.</p>
<h2 id="ir-yaml">IR YAML</h2>
<p>When you compile a pipeline it is written to intermediate representation (IR) YAML. An IR YAML is an instance of the <a href="https://github.com/kubeflow/pipelines/blob/41b69fd90da812005965f2209b64fd1278f1cdc9/api/v2alpha1/pipeline_spec.proto#L50"><code>PipelineSpec</code></a> protocol buffer message type, a platform-agnostic pipeline representation protocol.</p>
<p>IR YAML is considered an intermediate representation because the KFP backend compiles <code>PipelineSpec</code> to <a href="https://argoproj.github.io/argo-workflows/">Argo Workflow</a> YAML as the final execution definition for execution on Kubernetes.</p>
<p>Unlike v1 component YAML, IR YAML is not intended to be written directly. For a KFP v2 authoring experience similar to the v1 component YAML authoring experience, see <a href="/docs/components/pipelines/v2/author-a-pipeline/components/#3-custom-container-components">Author a Pipeline: Custom Container Components</a>.</p>
<p>IR YAML contains 7 top-level fields:</p>
<p><strong>components</strong></p>
<p>The <a href="https://github.com/kubeflow/pipelines/blob/41b69fd90da812005965f2209b64fd1278f1cdc9/api/v2alpha1/pipeline_spec.proto#L74-L75"><code>components</code></a> section is a map of component name to <a href="https://github.com/kubeflow/pipelines/blob/41b69fd90da812005965f2209b64fd1278f1cdc9/api/v2alpha1/pipeline_spec.proto#L85-L96"><code>ComponentSpec</code></a> for all components used in the pipeline. <code>ComponentSpec</code> defines the interface (inputs and outputs) of a component. For primitive components, <code>ComponentSpec</code> contains a reference to the executor containing the component implementation. For pipelines used as components, <code>ComponentSpec</code> contains a <a href="https://github.com/kubeflow/pipelines/blob/41b69fd90da812005965f2209b64fd1278f1cdc9/api/v2alpha1/pipeline_spec.proto#L98-L105">DagSpec</a> which includes references to its underlying primitive components.</p>
<p><a href="https://github.com/kubeflow/pipelines/blob/984d8a039d2ff105ca6b21ab26be057b9552b51d/sdk/python/test_data/pipelines/two_step_pipeline.yaml#L1-L21">Example</a></p>
<p><strong>deployment_spec</strong></p>
<p>The <a href="https://github.com/kubeflow/pipelines/blob/41b69fd90da812005965f2209b64fd1278f1cdc9/api/v2alpha1/pipeline_spec.proto#L56"><code>deployment_spec</code></a> section contains a map of executor name to <a href="https://github.com/kubeflow/pipelines/blob/41b69fd90da812005965f2209b64fd1278f1cdc9/api/v2alpha1/pipeline_spec.proto#L788-L803"><code>ExecutorSpec</code></a>. <code>ExecutorSpec</code> contains the implementation for a primitive component.</p>
<p><a href="https://github.com/kubeflow/pipelines/blob/984d8a039d2ff105ca6b21ab26be057b9552b51d/sdk/python/test_data/pipelines/two_step_pipeline.yaml#L23-L49">Example</a></p>
<p><strong>root</strong><br>
<a href="https://github.com/kubeflow/pipelines/blob/41b69fd90da812005965f2209b64fd1278f1cdc9/api/v2alpha1/pipeline_spec.proto#L77-L79"><code>root</code></a> defines the steps of the outermost (root) pipeline definition. It is itself a <a href="https://github.com/kubeflow/pipelines/blob/41b69fd90da812005965f2209b64fd1278f1cdc9/api/v2alpha1/pipeline_spec.proto#L85-L96"><code>ComponentSpec</code></a>. This is the pipeline executed when the YAML is submitted.</p>
<p><a href="https://github.com/kubeflow/pipelines/blob/984d8a039d2ff105ca6b21ab26be057b9552b51d/sdk/python/test_data/pipelines/two_step_pipeline.yaml#L52-L85">Example</a></p>
<p><strong>pipeline_info</strong><br>
<a href="https://github.com/kubeflow/pipelines/blob/41b69fd90da812005965f2209b64fd1278f1cdc9/api/v2alpha1/pipeline_spec.proto#L51-L52"><code>pipeline_info</code></a> contains pipeline metadata, including the pipeline name.</p>
<p><a href="https://github.com/kubeflow/pipelines/blob/984d8a039d2ff105ca6b21ab26be057b9552b51d/sdk/python/test_data/pipelines/two_step_pipeline.yaml#L50-L51">Example</a></p>
<p><strong>sdk_version</strong><br>
<a href="https://github.com/kubeflow/pipelines/blob/41b69fd90da812005965f2209b64fd1278f1cdc9/api/v2alpha1/pipeline_spec.proto#L58-L59"><code>sdk_version</code></a> records which version of the KFP SDK compiled the pipeline.</p>
<p><a href="https://github.com/kubeflow/pipelines/blob/984d8a039d2ff105ca6b21ab26be057b9552b51d/sdk/python/test_data/pipelines/two_step_pipeline.yaml#L87">Example</a></p>
<p><strong>schema_version</strong><br>
<a href="https://github.com/kubeflow/pipelines/blob/41b69fd90da812005965f2209b64fd1278f1cdc9/api/v2alpha1/pipeline_spec.proto#L61-L62"><code>schema_version</code></a> records which version of the <code>PipelineSpec</code> schema is used for the IR YAML.</p>
<p><a href="https://github.com/kubeflow/pipelines/blob/984d8a039d2ff105ca6b21ab26be057b9552b51d/sdk/python/test_data/pipelines/two_step_pipeline.yaml#L86">Example</a></p>
<p><strong>default_pipeline_root</strong><br>
<a href="https://github.com/kubeflow/pipelines/blob/41b69fd90da812005965f2209b64fd1278f1cdc9/api/v2alpha1/pipeline_spec.proto#L81-L82"><code>default_pipeline_root</code></a> is the remote storage root path where the pipeline outputs will be written, such as a Google Cloud Storage URI (<code>gcs://my/path</code>).</p>
<p><a href="https://github.com/kubeflow/pipelines/blob/984d8a039d2ff105ca6b21ab26be057b9552b51d/sdk/python/test_data/pipelines/two_step_pipeline.yaml#L22">Example</a></p>

</div>



    
	
  
    
    
	
    

<div class="td-content" style="page-break-before: always">
    
	<h1 id="pg-a68b69ed119639161f8aa77ca8cb9aa9">3.2.6 - Run a Pipeline</h1>
    <div class="lead">Execute a pipeline on the KFP backend</div>
	<p>The KFP SDK offers three ways to run a pipeline.</p>
<h2 id="1-run-from-the-kfp-dashboard">1. Run from the KFP Dashboard</h2>
<p>The first and easiest way to run a pipeline is by submitting it via the KFP dashboard.</p>
<p>To submit a pipeline to the KFP Dashboard:</p>
<ol>
<li>
<p><a href="/docs/components/pipelines/v2/compile-a-pipeline/">Compile the pipeline</a> to IR YAML.</p>
</li>
<li>
<p>From the Dashboard, select &ldquo;+ Upload pipeline&rdquo;.</p>
</li>
</ol>
<p><img src="/docs/images/pipelines/submit-a-pipeline-on-dashboard.png" 
alt="Upload pipeline button"
class="mt-3 mb-3 border border-info rounded"></p>
<ol start="3">
<li>Upload the pipeline IR YAML to &ldquo;Upload a file&rdquo;, populate the upload pipeline form, and click &ldquo;Create&rdquo;.</li>
</ol>
<p><img src="/docs/images/pipelines/upload-a-pipeline.png" 
alt="Upload pipeline screen"
class="mt-3 mb-3 border border-info rounded"></p>
<ol start="4">
<li>From the Runs tab, select &ldquo;+ Create run&rdquo;:</li>
</ol>
<p><img src="/docs/images/pipelines/create-run.png" 
alt="Create run button"
class="mt-3 mb-3 border border-info rounded"></p>
<ol start="5">
<li>Choose the pipeline you uploaded, provide a name, any run parameters, and click &ldquo;Start&rdquo;.
<img src="/docs/images/pipelines/start-a-run.png" 
alt="Start a run screen"
class="mt-3 mb-3 border border-info rounded"></li>
</ol>
<h2 id="2-run-from-the-kfp-sdk-client">2. Run from the KFP SDK client</h2>
<p>You may also programatically submit pipeline runs from the KFP SDK client. The client supports two ways of submitting runs: from IR YAML or from a Python pipeline function. For either approach, start by instantiating a <code>Client</code> using the <code>host</code> URL of your KFP instance:</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-python" data-lang="python"><span class="line"><span class="cl"><span class="kn">from</span> <span class="nn">kfp.client</span> <span class="kn">import</span> <span class="n">Client</span>
</span></span><span class="line"><span class="cl"><span class="n">client</span> <span class="o">=</span> <span class="n">Client</span><span class="p">(</span><span class="n">host</span><span class="o">=</span><span class="s1">&#39;&lt;YOUR_HOST_URL&gt;&#39;</span><span class="p">)</span>
</span></span></code></pre></div><p>To submit IR YAML for execution use the <code>.create_run_from_pipeline_package</code> method:</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-python" data-lang="python"><span class="line"><span class="cl"><span class="n">client</span><span class="o">.</span><span class="n">create_run_from_pipeline_package</span><span class="p">(</span><span class="s1">&#39;pipeline.yaml&#39;</span><span class="p">,</span> <span class="n">arguments</span><span class="o">=</span><span class="p">{</span><span class="s1">&#39;param&#39;</span><span class="p">:</span> <span class="s1">&#39;a&#39;</span><span class="p">,</span> <span class="s1">&#39;other_param&#39;</span><span class="p">:</span> <span class="mi">2</span><span class="p">})</span>
</span></span></code></pre></div><p>To submit a Python pipeline function for execution use the <code>.create_run_from_pipeline_func</code> convenience method, which wraps compilation and run submission into one method:</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-python" data-lang="python"><span class="line"><span class="cl"><span class="n">client</span><span class="o">.</span><span class="n">create_run_from_pipeline_func</span><span class="p">(</span><span class="s1">&#39;pipeline.yaml&#39;</span><span class="p">,</span> <span class="n">arguments</span><span class="o">=</span><span class="p">{</span><span class="s1">&#39;param&#39;</span><span class="p">:</span> <span class="s1">&#39;a&#39;</span><span class="p">,</span> <span class="s1">&#39;other_param&#39;</span><span class="p">:</span> <span class="mi">2</span><span class="p">})</span>
</span></span></code></pre></div><p>See the <a href="https://kubeflow-pipelines.readthedocs.io/en/master/source/client.html">KFP SDK Client reference documentation</a> for a detailed description of the <code>Client</code> constructor and method parameters.</p>
<h2 id="3-run-from-the-kfp-sdk-cli">3. Run from the KFP SDK CLI</h2>
<p>The <code>kfp run create</code> command allows you to submit a pipeline from the command line. <code>kfp run create --help</code> shows that this command takes the form:</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-shell" data-lang="shell"><span class="line"><span class="cl">kfp run create <span class="o">[</span>OPTIONS<span class="o">]</span> <span class="o">[</span>ARGS<span class="o">]</span>...
</span></span></code></pre></div><p>For example, the following command submits the <code>path/to/pipeline.yaml</code> IR YAML to the KFP backend:</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-shell" data-lang="shell"><span class="line"><span class="cl">kfp run create --experiment-name my-experiment --package-file path/to/pipeline.yaml
</span></span></code></pre></div><p>For more information about the <code>kfp run create</code> command, see the <a href="https://kubeflow-pipelines.readthedocs.io/en/master/source/cli.html#kfp-run-create">KFP Command Line Interface reference documentation</a>. For more information on the KFP CLI generally see <a href="/docs/components/pipelines/v2/cli/">Command Line Interface user docs</a>.</p>

</div>



    
	
  
    
    
	
    

<div class="td-content" style="page-break-before: always">
    
	<h1 id="pg-417e76f1404dfae7c66273efdc10e05b">3.2.7 - Command Line Interface</h1>
    <div class="lead">Interact with KFP via the CLI</div>
	<!-- TODO: use /latest instead of /master when SDK goes GA -->
<p>This section provides a high-level summary of the KFP command line interface (CLI). For more detailed API documentation, see the <a href="https://kubeflow-pipelines.readthedocs.io/en/master/source/cli.html">KFP CLI reference</a>.</p>
<h2 id="usage">Usage</h2>
<p>The KFP CLI is installed with the KFP SDK as <code>kfp</code>.</p>
<p>You can check that the KFP CLI is installed in your environment by running:</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-shell" data-lang="shell"><span class="line"><span class="cl">kfp --version
</span></span></code></pre></div><p>All commands assume the general structure:</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-shell" data-lang="shell"><span class="line"><span class="cl">kfp <span class="o">[</span>OPTIONS<span class="o">]</span> COMMAND <span class="o">[</span>ARGS<span class="o">]</span>...
</span></span></code></pre></div><p>For example, to list all runs for a specific endpoint:</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-shell" data-lang="shell"><span class="line"><span class="cl">kfp --endpoint http://my_kfp_endpoint.com run list
</span></span></code></pre></div><p>You can get help for a particular command directly on the command line using <code>--help</code>:</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-shell" data-lang="shell"><span class="line"><span class="cl">kfp run --help
</span></span></code></pre></div><p>The KFP CLI serves three main functions:</p>
<ol>
<li>Interacting with KFP resources</li>
<li>Compiling pipelines</li>
<li>Building Python-based containerized components</li>
</ol>
<h2 id="interact-with-kfp-resources">Interact with KFP resources</h2>
<p>The majority of the KFP CLI commands involve creating, reading, updating, or deleting KFP resources via the KFP backend. All of these commands take a common structure:</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-shell" data-lang="shell"><span class="line"><span class="cl">kfp &lt;resource_name&gt; &lt;action&gt;
</span></span></code></pre></div><p><code>&lt;resource_name&gt;</code> can be one of the following:</p>
<ul>
<li><code>run</code></li>
<li><code>recurring-run</code></li>
<li><code>pipeline</code></li>
<li><code>experiment</code></li>
</ul>
<p>All resources support the following actions:</p>
<ul>
<li><code>create</code></li>
<li><code>list</code></li>
<li><code>get</code></li>
<li><code>delete</code></li>
</ul>
<p>Some resources have resource-specific actions, including:</p>
<ul>
<li>
<p>For <code>run</code>:</p>
<ul>
<li><code>archive</code></li>
<li><code>unarchive</code></li>
</ul>
</li>
<li>
<p>For <code>recurring-run</code>:</p>
<ul>
<li><code>disable</code></li>
<li><code>enable</code></li>
</ul>
</li>
<li>
<p>For <code>experiment</code></p>
<ul>
<li><code>archive</code></li>
<li><code>unarchive</code></li>
</ul>
</li>
<li>
<p>For <code>pipeline</code>:</p>
<ul>
<li><code>create-version</code></li>
<li><code>list-versions</code></li>
<li><code>get-versions</code></li>
<li><code>delete-versions</code></li>
</ul>
</li>
</ul>
<h2 id="compile-pipelines">Compile pipelines</h2>
<p>The KFP supports compiling a pipeline defined in a Python file to YAML using the <code>kfp dsl compile</code> command:</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-shell" data-lang="shell"><span class="line"><span class="cl">kfp dsl compile --py path/to/pipeline.py --output path/to/output.yaml
</span></span></code></pre></div><p>To compile a pipeline from a Python file containing multiple pipeline definitions or to compile a component, provide a <code>--function</code> argument:</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-shell" data-lang="shell"><span class="line"><span class="cl">kfp dsl compile --py path/to/pipeline.py --output path/to/output.yaml --function my_component
</span></span></code></pre></div><p>The CLI compiler also accepts a <code>--pipeline-parameters</code> argument as JSON:</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-shell" data-lang="shell"><span class="line"><span class="cl">kfp dsl compile --py path/to/pipeline.py --output path/to/output.yaml --pipeline-parameters <span class="s1">&#39;{&#34;param1&#34;: 2.0, &#34;param2&#34;: &#34;my_val&#34;}&#39;</span>
</span></span></code></pre></div><h2 id="build-kfp-containerized-python-components">Build KFP containerized Python components</h2>
<p>The KFP SDK support authoring <a href="/docs/components/pipelines/v2/author-a-pipeline/components/#2-containerized-python-components">containerized Python components</a>, allowing the use of more and better-organized source code than does the simpler <a href="/docs/components/pipelines/v2/author-a-pipeline/components/#1-lighweight-python-function-based-components">lightweight Python component</a> authoring experience.</p>
<p>The KFP CLI provides a convenience command for streamlining the process of building a containerized component:</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-shell" data-lang="shell"><span class="line"><span class="cl">kfp component build <span class="o">[</span>OPTIONS<span class="o">]</span> COMPONENTS_DIRECTORY <span class="o">[</span>ARGS<span class="o">]</span>...
</span></span></code></pre></div><p>This command builds an image with all the source code found in <code>COMPONENTS_DIRECTORY</code> and uses the component found in the directory as the component runtime entrypoint.</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-shell" data-lang="shell"><span class="line"><span class="cl">kfp component build src/ --component-filepattern my_component --push-image
</span></span></code></pre></div><p>For detailed information about all arguments/flags, see <a href="https://kubeflow-pipelines.readthedocs.io/en/master/source/cli.html#kfp-component-build">CLI reference documentation</a>. For information about creating containerized components, see [Authoring Python Containerized Components][/docs/components/pipelines/v2/author-a-pipeline/components/#2-containerized-python-components].</p>
<!-- TODO(GA): remove --pre -->
<p>Note: To use this command you&rsquo;ll need to install the KFP SDK with the additional Docker dependency: <code>pip install --pre kfp[all]</code>.</p>

</div>



    
	
  
    
    
	
    

<div class="td-content" style="page-break-before: always">
    
	<h1 id="pg-0aa565b096b841bd6171b56fe09e39c8">3.2.8 - Community and Support</h1>
    <div class="lead">Where to get help, contribute, and learn more</div>
	<h2 id="help">Help</h2>
<p>There are several places to get help with KFP:</p>
<ul>
<li><a href="https://stackoverflow.com/questions/tagged/kubeflow-pipelines">kubeflow-pipelines</a> on Stack Overflow</li>
<li>The #kubeflow-pipelines channel in the <a href="https://kubeflow.slack.com/">Kubeflow Slack Workspace</a></li>
<li>Via a GitHub Issue describing your problem in the <a href="https://github.com/kubeflow/pipelines/issues/new/choose">kubeflow/pipelines repository</a></li>
<li>In the Kubeflow Pipelines Community Meeting</li>
</ul>
<h2 id="kubeflow-pipelines-community-meeting">Kubeflow Pipelines Community Meeting</h2>
<p>There is a Kubeflow Pipelines Community meeting every other Wednesday. This is an opportunity to learn about changes to KFP developments, discuss feature requests, and ask questions. When making a feature request, it is best to include a <a href="https://github.com/kubeflow/pipelines/issues/new/choose">GitHub Issue</a> as a written accompaniment to your request.</p>
<p>To participate, join <a href="https://groups.google.com/g/kubeflow-discuss">kubeflow-discuss</a> on Google Groups.</p>
<h2 id="bugs-and-feature-requests">Bugs and Feature Requests</h2>
<p>Bugs and feature requests should be recorded as GitHub Issues in the <a href="https://github.com/kubeflow/pipelines/issues/new/choose">kubeflow/pipelines repository</a>.</p>
<h2 id="contributing">Contributing</h2>
<p>KFP is an open source project and welcomes community contribution. KFP has several components, each with its own contributing guidelines:</p>
<ul>
<li><a href="https://github.com/kubeflow/pipelines/blob/master/backend/README.md">Backend contributing guidelines</a></li>
<li><a href="https://github.com/kubeflow/pipelines/blob/master/frontend/README.md">Frontend contributing guidelines</a></li>
<li><a href="https://github.com/kubeflow/pipelines/blob/master/sdk/CONTRIBUTING.md">SDK contributing guidelines</a></li>
</ul>

</div>



    
	
  
    
    
	
    

<div class="td-content" style="page-break-before: always">
    
	<h1 id="pg-f0fb094d1c5469ccf9ae7e2c40cfebca">3.2.9 - Reference</h1>
    <div class="lead">Reference docs for Kubeflow Pipelines</div>
	<h2 id="kfp-sdk">KFP SDK</h2>
<!-- TODO: switch this to /latest once GA -->
<p><a href="https://kubeflow-pipelines.readthedocs.io/en/master/">KFP SDK reference documentation</a></p>

</div>



    
	
  

    
	
  

    
	
  
    
    
	
    

<div class="td-content" style="page-break-before: always">
    
	<h1 id="pg-4a244e194817114d25521449f4937d23">4 - Katib</h1>
    <div class="lead">Documentation for Kubeflow Katib</div>
	
</div>



    
      
  
  
  
  

  
  

  
    
    
	
    

<div class="td-content" style="">
    
	<h1 id="pg-00f61fe76ea63c90c498a3519d9a26a7">4.1 - Introduction to Katib</h1>
    <div class="lead">Overview of Katib for hyperparameter tuning and neural architecture search</div>
	<div class="alert alert-warning" role="alert">
  <h4 class="alert-heading">Beta</h4>
  This Kubeflow component has <b>beta</b> status. See the
  <a href="/docs/started/support/#application-status">Kubeflow versioning policies</a>.
  The Kubeflow team is interested in your   
  <a href="https://github.com/kubeflow/katib/issues">feedback</a></h4> 
  about the usability of the feature.
</div>
<p>This guide introduces the concepts of hyperparameter tuning, neural
architecture search, and the Katib system as a component of Kubeflow.</p>
<p>Katib is a Kubernetes-native project for automated machine learning (AutoML).
Katib supports hyperparameter tuning, early stopping and
neural architecture search (NAS).
Learn more about AutoML at <a href="https://www.fast.ai/2018/07/16/auto-ml2/">fast.ai</a>,
<a href="https://cloud.google.com/automl">Google Cloud</a>,
<a href="https://docs.microsoft.com/en-us/azure/machine-learning/concept-automated-ml#automl-in-azure-machine-learning">Microsoft Azure</a> or
<a href="https://aws.amazon.com/blogs/aws/amazon-sagemaker-autopilot-fully-managed-automatic-machine-learning/">Amazon SageMaker</a>.</p>
<p>Katib is the project which is agnostic to machine learning (ML) frameworks.
It can tune hyperparameters of applications written in any language
of the users&rsquo; choice and natively supports many ML frameworks,
such as TensorFlow, MXNet, PyTorch, XGBoost, and others.</p>
<p>Katib supports a lot of various AutoML algorithms, such as
<a href="https://arxiv.org/pdf/1012.2599.pdf">Bayesian optimization</a>,
<a href="https://papers.nips.cc/paper/2011/file/86e8f7ab32cfd12577bc2619bc635690-Paper.pdf">Tree of Parzen Estimators</a>,
<a href="https://en.wikipedia.org/wiki/Hyperparameter_optimization#Random_search">Random Search</a>,
<a href="https://en.wikipedia.org/wiki/CMA-ES">Covariance Matrix Adaptation Evolution Strategy</a>,
<a href="https://arxiv.org/pdf/1603.06560.pdf">Hyperband</a>,
<a href="https://arxiv.org/abs/1802.03268">Efficient Neural Architecture Search</a>,
<a href="https://arxiv.org/abs/1806.09055">Differentiable Architecture Search</a>
and many more. Additional algorithm support is coming soon.</p>
<p>The <a href="https://github.com/kubeflow/katib">Katib project</a> is open source.
The <a href="https://github.com/kubeflow/katib/blob/master/docs/developer-guide.md">developer guide</a>
is a good starting point for developers who want to contribute to the project.</p>
<h2 id="hyperparameters-and-hyperparameter-tuning">Hyperparameters and hyperparameter tuning</h2>
<p><em>Hyperparameters</em> are the variables that control the model training process.
They include:</p>
<ul>
<li>The learning rate.</li>
<li>The number of layers in a neural network.</li>
<li>The number of nodes in each layer.</li>
</ul>
<p>Hyperparameter values are not <em>learned</em>. In other words, in contrast to the
node weights and other training <em>parameters</em>, the model training process does
not adjust the hyperparameter values.</p>
<p><em>Hyperparameter tuning</em> is the process of optimizing the hyperparameter values
to maximize the predictive accuracy of the model. If you don&rsquo;t use Katib or a
similar system for hyperparameter tuning, you need to run many training jobs
yourself, manually adjusting the hyperparameters to find the optimal values.</p>
<p>Automated hyperparameter tuning works by optimizing a target variable,
also called the <em>objective metric</em>, that you specify in the configuration for
the hyperparameter tuning job. A common metric is the model&rsquo;s accuracy
in the validation pass of the training job (<em>validation-accuracy</em>). You also
specify whether you want the hyperparameter tuning job to <em>maximize</em> or
<em>minimize</em> the metric.</p>
<p>For example, the following graph from Katib shows the level of validation accuracy
for various combinations of hyperparameter values (the learning rate, the number of
layers, and the optimizer):</p>
<p><img src="/docs/components/katib/images/random-example-graph.png"
alt="Graph produced by the random example"
class="mt-3 mb-3 border border-info rounded"></p>
<p><em>(To run the example that produced this graph, follow the <a href="/docs/components/katib/hyperparameter/">getting-started
guide</a>.)</em></p>
<p>Katib runs several training jobs (known as <em>trials</em>) within each
hyperparameter tuning job (<em>experiment</em>). Each trial tests a different set of
hyperparameter configurations. At the end of the experiment, Katib outputs
the optimized values for the hyperparameters.</p>
<p>You can improve your hyperparameter tunning experiments by using
<a href="https://en.wikipedia.org/wiki/Early_stopping">early stopping</a> techniques.
Follow the <a href="/docs/components/katib/early-stopping/">early stopping guide</a>
for the details.</p>
<h2 id="neural-architecture-search">Neural architecture search</h2>


<div class="alert alert-warning" role="alert">
<h4 class="alert-heading">Alpha version</h4>

    NAS is currently in <b>alpha</b> with limited support. The Kubeflow team is
interested in any feedback you may have, in particular with regards to usability
of the feature. You can log issues and comments in
the <a href="https://github.com/kubeflow/katib/issues">Katib issue tracker</a>.

</div>

<p>In addition to hyperparameter tuning, Katib offers a <em>neural architecture
search</em> feature. You can use the NAS to design
your artificial neural network, with a goal of maximizing the predictive
accuracy and performance of your model.</p>
<p>NAS is closely related to hyperparameter tuning. Both are subsets of AutoML.
While hyperparameter tuning optimizes the model&rsquo;s hyperparameters, a NAS system
optimizes the model&rsquo;s structure, node weights and hyperparameters.</p>
<p>NAS technology in general uses various techniques to find the optimal neural
network design.</p>
<p>You can submit Katib jobs from the command line or from the UI. (Learn more
about the Katib interfaces later on this page.) The following screenshot shows
part of the form for submitting a NAS job from the Katib UI:</p>
<p><img src="/docs/components/katib/images/nas-parameters.png"
alt="Submitting a neural architecture search from the Katib UI"
class="mt-3 mb-3 border border-info rounded"></p>
<h2 id="katib-interfaces">Katib interfaces</h2>
<p>You can use the following interfaces to interact with Katib:</p>
<ul>
<li>
<p>A web UI that you can use to submit experiments and to monitor your results.
Check the <a href="/docs/components/katib/hyperparameter/#katib-ui">getting-started
guide</a>
for information on how to access the UI.
The Katib home page within Kubeflow looks like this:</p>
<p><img src="/docs/components/katib/images/home-page.png"
alt="The Katib home page within the Kubeflow UI"
class="mt-3 mb-3 border border-info rounded"></p>
</li>
<li>
<p>A gRPC API. Check the <a href="https://github.com/kubeflow/katib/blob/master/pkg/apis/manager/v1beta1/gen-doc/api.md">API reference on GitHub</a>.</p>
</li>
<li>
<p>Command-line interfaces (CLIs):</p>
<ul>
<li>The Kubernetes CLI, <strong>kubectl</strong>, is useful for running commands against your
Kubeflow cluster. Learn about kubectl in the <a href="https://kubernetes.io/docs/tasks/tools/install-kubectl/">Kubernetes
documentation</a>.</li>
</ul>
</li>
<li>
<p>Katib Python SDK. Check the <a href="https://github.com/kubeflow/katib/tree/master/sdk/python/v1beta1">Katib Python SDK documentation on GitHub</a>.</p>
</li>
</ul>
<h2 id="katib-concepts">Katib concepts</h2>
<p>This section describes the terms used in Katib.</p>
<h3 id="experiment">Experiment</h3>
<p>An <em>experiment</em> is a single tuning run, also called an optimization run.</p>
<p>You specify configuration settings to define the experiment. The following are
the main configurations:</p>
<ul>
<li>
<p><strong>Objective</strong>: What you want to optimize. This is the objective metric, also
called the target variable. A common metric is the model&rsquo;s accuracy
in the validation pass of the training job (<em>validation-accuracy</em>). You also
specify whether you want the hyperparameter tuning job to <em>maximize</em> or
<em>minimize</em> the metric.</p>
</li>
<li>
<p><strong>Search space</strong>: The set of all possible hyperparameter values that the
hyperparameter tuning job should consider for optimization, and the
constraints for each hyperparameter. Other names for search space include
<em>feasible set</em> and <em>solution space</em>. For example, you may provide the
names of the hyperparameters that you want to optimize. For each
hyperparameter, you may provide a <em>minimum</em> and <em>maximum</em> value or a <em>list</em>
of allowable values.</p>
</li>
<li>
<p><strong>Search algorithm</strong>: The algorithm to use when searching for the optimal
hyperparameter values.</p>
</li>
</ul>
<p>Katib experiment is defined as a
<a href="https://kubernetes.io/docs/concepts/extend-kubernetes/api-extension/custom-resources/">Kubernetes CRD</a> .</p>
<p>For details of how to define your experiment, follow the guide to <a href="/docs/components/katib/experiment/">running an
experiment</a>.</p>
<h3 id="suggestion">Suggestion</h3>
<p>A <em>suggestion</em> is a set of hyperparameter values that the hyperparameter
tuning process has proposed. Katib creates a trial to evaluate the suggested
set of values.</p>
<p>Katib suggestion is defined as a
<a href="https://kubernetes.io/docs/concepts/extend-kubernetes/api-extension/custom-resources/">Kubernetes CRD</a> .</p>
<h3 id="trial">Trial</h3>
<p>A <em>trial</em> is one iteration of the hyperparameter tuning process. A trial
corresponds to one worker job instance with a list of parameter assignments.
The list of parameter assignments corresponds to a suggestion.</p>
<p>Each experiment runs several trials. The experiment runs the trials until it
reaches either the objective or the configured maximum number of trials.</p>
<p>Katib trial is defined as a
<a href="https://kubernetes.io/docs/concepts/extend-kubernetes/api-extension/custom-resources/">Kubernetes CRD</a> .</p>
<h3 id="worker-job">Worker job</h3>
<p>The <em>worker job</em> is the process that runs to evaluate a trial and calculate
its objective value.</p>
<p>The worker job can be any type of Kubernetes resource or
<a href="https://kubernetes.io/docs/concepts/extend-kubernetes/api-extension/custom-resources/">Kubernetes CRD</a>.
Follow the
<a href="/docs/components/katib/trial-template/#custom-resource">trial template guide</a>
to check how to support your own Kubernetes resource in Katib.</p>
<p>Katib has these CRD examples in upstream:</p>
<ul>
<li>
<p><a href="https://kubernetes.io/docs/concepts/workloads/controllers/job/">Kubernetes <code>Job</code></a></p>
</li>
<li>
<p><a href="/docs/components/training/tftraining/">Kubeflow <code>TFJob</code></a></p>
</li>
<li>
<p><a href="/docs/components/training/pytorch/">Kubeflow <code>PyTorchJob</code></a></p>
</li>
<li>
<p><a href="/docs/components/training/mxnet">Kubeflow <code>MXJob</code></a></p>
</li>
<li>
<p><a href="/docs/components/training/xgboost">Kubeflow <code>XGBoostJob</code></a></p>
</li>
<li>
<p><a href="/docs/components/training/mpi">Kubeflow <code>MPIJob</code></a></p>
</li>
<li>
<p><a href="https://github.com/kubeflow/katib/tree/master/examples/v1beta1/tekton">Tekton <code>Pipelines</code></a></p>
</li>
<li>
<p><a href="https://github.com/kubeflow/katib/tree/master/examples/v1beta1/argo">Argo <code>Workflows</code></a></p>
</li>
</ul>
<p>By offering the above worker job types, Katib supports multiple ML frameworks.</p>
<h2 id="next-steps">Next steps</h2>
<p>Follow the <a href="/docs/components/katib/hyperparameter/">getting-started guide</a>
to set up Katib and run some hyperparameter tuning examples.</p>

</div>



    
	
  
    
    
	
    

<div class="td-content" style="page-break-before: always">
    
	<h1 id="pg-0884c858a705c182d2436896e0bef13e">4.2 - Getting Started with Katib</h1>
    <div class="lead">How to set up Katib and perform hyperparameter tuning</div>
	<p>This guide shows how to get started with Katib and run a few examples using the
command line and the Katib user interface (UI) to perform hyperparameter tuning.</p>
<p>For an overview of the concepts around Katib and hyperparameter tuning, check the
<a href="/docs/components/katib/overview/">introduction to Katib</a>.</p>
<h2 id="katib-setup">Katib setup</h2>
<p>Let&rsquo;s set up and configure Katib on your Kubernetes cluster with Kubeflow.</p>
<h3 id="prerequisites">Prerequisites</h3>
<p>This is the minimal requirements to install Katib:</p>
<ul>
<li>Kubernetes &gt;= 1.17</li>
<li><code>kubectl</code> &gt;= 1.21</li>
</ul>
<p><a id="katib-install"></a></p>
<h3 id="installing-katib">Installing Katib</h3>
<p>You can skip this step if you have already installed Kubeflow. Your Kubeflow
deployment includes Katib.</p>
<p>To install Katib as part of Kubeflow, follow the
<a href="/docs/started/getting-started/">Kubeflow installation guide</a>.</p>
<p>If you want to install Katib separately from Kubeflow, or to get a later version
of Katib, you can use one of the following Katib installs. To install the specific
Katib release (e.g. <code>v0.11.1</code>), modify <code>ref=master</code> to <code>ref=v0.11.1</code>.</p>
<ol>
<li>
<p><strong>Katib Standalone Installation</strong></p>
<p>There are two ways to install Katib by standalone,
both of which do not require any additional setup on your Kubernetes cluster.</p>
<ol>
<li>
<p><strong>Basic Installation</strong></p>
<p>Run the following command to deploy Katib with the main components
(<code>katib-controller</code>, <code>katib-ui</code>, <code>katib-mysql</code>, <code>katib-db-manager</code>, and <code>katib-cert-generator</code>):</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-shell" data-lang="shell"><span class="line"><span class="cl">kubectl apply -k <span class="s2">&#34;github.com/kubeflow/katib.git/manifests/v1beta1/installs/katib-standalone?ref=master&#34;</span>
</span></span></code></pre></div></li>
<li>
<p><strong>Controller Leader Election Support</strong></p>
<p>Run the following command to deploy Katib with Controller
<a href="https://kubernetes.io/blog/2016/01/simple-leader-election-with-kubernetes/">Leader Election</a>:</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-shell" data-lang="shell"><span class="line"><span class="cl">kubectl apply -k <span class="s2">&#34;github.com/kubeflow/katib.git/manifests/v1beta1/installs/katib-leader-election?ref=master&#34;</span>
</span></span></code></pre></div><p>This installation is almost the same as <code>Basic Installation</code>,
although you can make <code>katib-controller</code> Highly Available (HA) using leader election.
If you plan to use Katib in an environment where high Service Level Agreements (SLAs) and Service Level Objectives (SLOs) are required,
such as a production environment, consider choosing this installation.</p>
</li>
</ol>
</li>
<li>
<p><strong>Katib Cert Manager Installation</strong></p>
<p>Run the following command to deploy Katib with
<a href="https://cert-manager.io/docs/installation/kubernetes/">Cert Manager</a> requirement:</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-shell" data-lang="shell"><span class="line"><span class="cl">kubectl apply -k <span class="s2">&#34;github.com/kubeflow/katib.git/manifests/v1beta1/installs/katib-cert-manager?ref=master&#34;</span>
</span></span></code></pre></div><p>This installation uses Cert Manager instead of <code>katib-cert-generator</code>
to provision Katib webhooks certificates. You have to deploy Cert Manager on
your Kubernetes cluster before deploying Katib using this installation.</p>
</li>
<li>
<p><strong>Katib External DB Installation</strong></p>
<p>Run the following command to deploy Katib with custom Database (DB) backend:</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-shell" data-lang="shell"><span class="line"><span class="cl">kubectl apply -k <span class="s2">&#34;github.com/kubeflow/katib.git/manifests/v1beta1/installs/katib-external-db?ref=master&#34;</span>
</span></span></code></pre></div><p>This installation allows to use custom MySQL DB instead of <code>katib-mysql</code>.
You have to modify appropriate environment variables for <code>katib-db-manager</code> in the
<a href="https://github.com/kubeflow/katib/blob/master/manifests/v1beta1/installs/katib-external-db/secrets.env"><code>secrets.env</code></a>
to point at your custom MySQL DB. Learn more about <code>katib-db-manager</code>
environment variables in <a href="https://www.kubeflow.org/docs/components/katib/env-variables/#katib-db-manager">this guide</a>.</p>
</li>
<li>
<p><strong>Katib on OpenShift</strong></p>
<p>Run the following command to deploy Katib on <a href="https://docs.openshift.com/">OpenShift</a> v4.4+:</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-shell" data-lang="shell"><span class="line"><span class="cl">kubectl apply -k <span class="s2">&#34;github.com/kubeflow/katib.git/manifests/v1beta1/installs/katib-openshift?ref=master&#34;</span>
</span></span></code></pre></div><p>This installation uses OpenShift service controller instead of <code>katib-cert-generator</code>
to provision Katib webhooks certificates.</p>
</li>
</ol>
<p>Above installations deploy
<a href="https://kubernetes.io/docs/concepts/storage/persistent-volumes/#persistentvolumeclaims">PersistentVolumeClaim (PVC)</a>
for the Katib DB component.</p>
<p>Your Kubernetes cluster must have <code>StorageClass</code> for dynamic volume provisioning.
For more information, check the Kubernetes documentation on
<a href="https://kubernetes.io/docs/concepts/storage/dynamic-provisioning/">dynamic provisioning</a>.</p>
<p>If your cluster doesn&rsquo;t have dynamic volume provisioning, you must manually
deploy <a href="https://kubernetes.io/docs/concepts/storage/persistent-volumes/#persistent-volumes">PersistentVolume (PV)</a>
to bind <a href="https://github.com/kubeflow/katib/blob/master/manifests/v1beta1/components/mysql/pvc.yaml">PVC</a>
for the Katib DB component.</p>
<h3 id="katib-components">Katib components</h3>
<p>Run the following command to verify that Katib components are running:</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-shell" data-lang="shell"><span class="line"><span class="cl">$ kubectl get pods -n kubeflow
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">NAME                                READY   STATUS      RESTARTS   AGE
</span></span><span class="line"><span class="cl">katib-cert-generator-79g7d          0/1     Completed   <span class="m">0</span>          79s
</span></span><span class="line"><span class="cl">katib-controller-566595bdd8-8w7sx   1/1     Running     <span class="m">0</span>          82s
</span></span><span class="line"><span class="cl">katib-db-manager-57cd769cdb-vt7zs   1/1     Running     <span class="m">0</span>          82s
</span></span><span class="line"><span class="cl">katib-mysql-7894994f88-djp7m        1/1     Running     <span class="m">0</span>          81s
</span></span><span class="line"><span class="cl">katib-ui-5767cfccdc-v9fcs           1/1     Running     <span class="m">0</span>          80s
</span></span></code></pre></div><ul>
<li>
<p><code>katib-controller</code> - the controller to manage Katib Kubernetes CRDs
(<a href="/docs/components/katib/overview/#experiment"><code>Experiment</code></a>,
<a href="/docs/components/katib/overview/#suggestion"><code>Suggestion</code></a>,
<a href="/docs/components/katib/overview/#trial"><code>Trial</code></a>)</p>
</li>
<li>
<p><code>katib-ui</code> - the Katib user interface.</p>
</li>
<li>
<p><code>katib-db-manager</code> - the GRPC API server to control Katib DB interface.</p>
</li>
<li>
<p><code>katib-mysql</code> - the <code>mysql</code> DB backend to store Katib experiments metrics.</p>
</li>
<li>
<p>(Optional) <code>katib-cert-generator</code> - the certificate generator for Katib
standalone installation. Learn more about the cert generator in the
<a href="https://github.com/kubeflow/katib/blob/master/docs/developer-guide.md#katib-cert-generator">developer guide</a></p>
</li>
</ul>
<h2 id="accessing-the-katib-ui">Accessing the Katib UI</h2>
<p>You can use the Katib user interface (UI) to submit experiments and to monitor
your results. The Katib home page within Kubeflow looks like this:</p>
<p><img src="/docs/components/katib/images/home-page.png"
alt="The Katib home page within the Kubeflow UI"
class="mt-3 mb-3 border border-info rounded"></p>
<p>If you installed Katib as part of Kubeflow, you can access the
Katib UI from the Kubeflow UI:</p>
<ol>
<li>Open the Kubeflow UI. Check the guide to
<a href="/docs/components/central-dash/overview/">accessing the central dashboard</a>.</li>
<li>Click <strong>Katib</strong> in the left-hand menu.</li>
</ol>
<p>Alternatively, you can set port-forwarding for the Katib UI service:</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-shell" data-lang="shell"><span class="line"><span class="cl">kubectl port-forward svc/katib-ui -n kubeflow 8080:80
</span></span></code></pre></div><p>Then you can access the Katib UI at this URL:</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-shell" data-lang="shell"><span class="line"><span class="cl">http://localhost:8080/katib/
</span></span></code></pre></div><p>Check <a href="https://github.com/kubeflow/katib/tree/master/pkg/ui/v1beta1">this guide</a>
if you want to contribute to Katib UI.</p>
<h2 id="examples">Examples</h2>
<p>This section introduces some examples that you can run to try Katib.</p>
<p><a id="random-search"></a></p>
<h3 id="example-using-random-search-algorithm">Example using random search algorithm</h3>
<p>You can create an experiment for Katib by defining the experiment in a YAML
configuration file. The YAML file defines the configurations for the experiment,
including the hyperparameter feasible space, optimization parameter,
optimization goal, suggestion algorithm, and so on.</p>
<p>This example uses the <a href="https://github.com/kubeflow/katib/blob/master/examples/v1beta1/hp-tuning/random.yaml">YAML file for the
random search example</a>.</p>
<p>The random search algorithm example uses an MXNet neural network to train an image
classification model using the MNIST dataset. You can check training container source code
<a href="https://github.com/kubeflow/katib/tree/master/examples/v1beta1/trial-images/mxnet-mnist">here</a>.
The experiment runs twelve training jobs with various hyperparameters and saves the results.</p>
<p>If you installed Katib as part of Kubeflow, you can&rsquo;t run experiments in the
Kubeflow namespace. Run the following commands to change namespace and launch
an experiment using the random search example:</p>
<ol>
<li>
<p>Download the example:</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-shell" data-lang="shell"><span class="line"><span class="cl">curl https://raw.githubusercontent.com/kubeflow/katib/master/examples/v1beta1/hp-tuning/random.yaml --output random.yaml
</span></span></code></pre></div></li>
<li>
<p>Edit <code>random.yaml</code> and change the following line to use your Kubeflow
user profile namespace (e.g. <code>kubeflow-user-example-com</code>):</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-fallback" data-lang="fallback"><span class="line"><span class="cl">namespace: kubeflow
</span></span></code></pre></div></li>
<li>
<p>(Optional) <strong>Note:</strong> Katib&rsquo;s experiments don&rsquo;t work with
<a href="https://istio.io/latest/docs/setup/additional-setup/sidecar-injection/#automatic-sidecar-injection">Istio sidecar injection</a>.
If you are using Kubeflow with
Istio, you have to disable sidecar injection. To do that, specify this annotation:
<code>sidecar.istio.io/inject: &quot;false&quot;</code> in your experiment&rsquo;s trial template.</p>
<p>For the provided random search example with Kubernetes
<a href="https://kubernetes.io/docs/concepts/workloads/controllers/job/"><code>Job</code></a>
trial template, annotation should be under
<a href="https://github.com/kubeflow/katib/blob/master/examples/v1beta1/hp-tuning/random.yaml#L52"><code>.trialSpec.spec.template.metadata.annotations</code></a>.
For the Kubeflow <code>TFJob</code> or other training operators check
<a href="/docs/components/training/tftraining/#what-is-tfjob">here</a>
how to set the annotation.</p>
</li>
<li>
<p>Deploy the example:</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-shell" data-lang="shell"><span class="line"><span class="cl">kubectl apply -f random.yaml
</span></span></code></pre></div></li>
</ol>
<p>This example embeds the hyperparameters as arguments. You can embed
hyperparameters in another way (for example, using environment variables)
by using the template defined in the <code>trialTemplate.trialSpec</code> section of
the YAML file. The template uses the
<a href="https://godoc.org/k8s.io/apimachinery/pkg/apis/meta/v1/unstructured">unstructured</a>
format and substitutes parameters from the <code>trialTemplate.trialParameters</code>.
Follow the <a href="/docs/components/katib/trial-template/">trial template guide</a>
to know more about it.</p>
<p>This example randomly generates the following hyperparameters:</p>
<ul>
<li><code>--lr</code>: Learning rate. Type: double.</li>
<li><code>--num-layers</code>: Number of layers in the neural network. Type: integer.</li>
<li><code>--optimizer</code>: Optimization method to change the neural network attributes.
Type: categorical.</li>
</ul>
<p>Check the experiment status:</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-shell" data-lang="shell"><span class="line"><span class="cl">kubectl -n kubeflow-user-example-com get experiment random -o yaml
</span></span></code></pre></div><p>The output of the above command should look similar to this:</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-yaml" data-lang="yaml"><span class="line"><span class="cl"><span class="nt">apiVersion</span><span class="p">:</span><span class="w"> </span><span class="l">kubeflow.org/v1beta1</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="nt">kind</span><span class="p">:</span><span class="w"> </span><span class="l">Experiment</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="nt">metadata</span><span class="p">:</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">  </span><span class="l">...</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">  </span><span class="nt">name</span><span class="p">:</span><span class="w"> </span><span class="l">random</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">  </span><span class="nt">namespace</span><span class="p">:</span><span class="w"> </span><span class="l">kubeflow-user-example-com</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">  </span><span class="l">...</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="nt">spec</span><span class="p">:</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">  </span><span class="nt">algorithm</span><span class="p">:</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="nt">algorithmName</span><span class="p">:</span><span class="w"> </span><span class="l">random</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">  </span><span class="nt">maxFailedTrialCount</span><span class="p">:</span><span class="w"> </span><span class="m">3</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">  </span><span class="nt">maxTrialCount</span><span class="p">:</span><span class="w"> </span><span class="m">12</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">  </span><span class="nt">metricsCollectorSpec</span><span class="p">:</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="nt">collector</span><span class="p">:</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">      </span><span class="nt">kind</span><span class="p">:</span><span class="w"> </span><span class="l">StdOut</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">  </span><span class="nt">objective</span><span class="p">:</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="nt">additionalMetricNames</span><span class="p">:</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">      </span>- <span class="l">Train-accuracy</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="nt">goal</span><span class="p">:</span><span class="w"> </span><span class="m">0.99</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="nt">metricStrategies</span><span class="p">:</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">      </span>- <span class="nt">name</span><span class="p">:</span><span class="w"> </span><span class="l">Validation-accuracy</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">        </span><span class="nt">value</span><span class="p">:</span><span class="w"> </span><span class="l">max</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">      </span>- <span class="nt">name</span><span class="p">:</span><span class="w"> </span><span class="l">Train-accuracy</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">        </span><span class="nt">value</span><span class="p">:</span><span class="w"> </span><span class="l">max</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="nt">objectiveMetricName</span><span class="p">:</span><span class="w"> </span><span class="l">Validation-accuracy</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="nt">type</span><span class="p">:</span><span class="w"> </span><span class="l">maximize</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">  </span><span class="nt">parallelTrialCount</span><span class="p">:</span><span class="w"> </span><span class="m">3</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">  </span><span class="nt">parameters</span><span class="p">:</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span>- <span class="nt">feasibleSpace</span><span class="p">:</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">        </span><span class="nt">max</span><span class="p">:</span><span class="w"> </span><span class="s2">&#34;0.03&#34;</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">        </span><span class="nt">min</span><span class="p">:</span><span class="w"> </span><span class="s2">&#34;0.01&#34;</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">      </span><span class="nt">name</span><span class="p">:</span><span class="w"> </span><span class="l">lr</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">      </span><span class="nt">parameterType</span><span class="p">:</span><span class="w"> </span><span class="l">double</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span>- <span class="nt">feasibleSpace</span><span class="p">:</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">        </span><span class="nt">max</span><span class="p">:</span><span class="w"> </span><span class="s2">&#34;5&#34;</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">        </span><span class="nt">min</span><span class="p">:</span><span class="w"> </span><span class="s2">&#34;2&#34;</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">      </span><span class="nt">name</span><span class="p">:</span><span class="w"> </span><span class="l">num-layers</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">      </span><span class="nt">parameterType</span><span class="p">:</span><span class="w"> </span><span class="l">int</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span>- <span class="nt">feasibleSpace</span><span class="p">:</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">        </span><span class="nt">list</span><span class="p">:</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">          </span>- <span class="l">sgd</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">          </span>- <span class="l">adam</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">          </span>- <span class="l">ftrl</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">      </span><span class="nt">name</span><span class="p">:</span><span class="w"> </span><span class="l">optimizer</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">      </span><span class="nt">parameterType</span><span class="p">:</span><span class="w"> </span><span class="l">categorical</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">  </span><span class="nt">resumePolicy</span><span class="p">:</span><span class="w"> </span><span class="l">LongRunning</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">  </span><span class="nt">trialTemplate</span><span class="p">:</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="nt">failureCondition</span><span class="p">:</span><span class="w"> </span><span class="l">status.conditions.#(type==&#34;Failed&#34;)#|#(status==&#34;True&#34;)#</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="nt">primaryContainerName</span><span class="p">:</span><span class="w"> </span><span class="l">training-container</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="nt">successCondition</span><span class="p">:</span><span class="w"> </span><span class="l">status.conditions.#(type==&#34;Complete&#34;)#|#(status==&#34;True&#34;)#</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="nt">trialParameters</span><span class="p">:</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">      </span>- <span class="nt">description</span><span class="p">:</span><span class="w"> </span><span class="l">Learning rate for the training model</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">        </span><span class="nt">name</span><span class="p">:</span><span class="w"> </span><span class="l">learningRate</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">        </span><span class="nt">reference</span><span class="p">:</span><span class="w"> </span><span class="l">lr</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">      </span>- <span class="nt">description</span><span class="p">:</span><span class="w"> </span><span class="l">Number of training model layers</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">        </span><span class="nt">name</span><span class="p">:</span><span class="w"> </span><span class="l">numberLayers</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">        </span><span class="nt">reference</span><span class="p">:</span><span class="w"> </span><span class="l">num-layers</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">      </span>- <span class="nt">description</span><span class="p">:</span><span class="w"> </span><span class="l">Training model optimizer (sdg, adam or ftrl)</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">        </span><span class="nt">name</span><span class="p">:</span><span class="w"> </span><span class="l">optimizer</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">        </span><span class="nt">reference</span><span class="p">:</span><span class="w"> </span><span class="l">optimizer</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="nt">trialSpec</span><span class="p">:</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">      </span><span class="nt">apiVersion</span><span class="p">:</span><span class="w"> </span><span class="l">batch/v1</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">      </span><span class="nt">kind</span><span class="p">:</span><span class="w"> </span><span class="l">Job</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">      </span><span class="nt">spec</span><span class="p">:</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">        </span><span class="nt">template</span><span class="p">:</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">          </span><span class="nt">metadata</span><span class="p">:</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">            </span><span class="nt">annotations</span><span class="p">:</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">              </span><span class="nt">sidecar.istio.io/inject</span><span class="p">:</span><span class="w"> </span><span class="s2">&#34;false&#34;</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">          </span><span class="nt">spec</span><span class="p">:</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">            </span><span class="nt">containers</span><span class="p">:</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">              </span>- <span class="nt">command</span><span class="p">:</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">                  </span>- <span class="l">python3</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">                  </span>- <span class="l">/opt/mxnet-mnist/mnist.py</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">                  </span>- --<span class="l">batch-size=64</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">                  </span>- --<span class="l">lr=${trialParameters.learningRate}</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">                  </span>- --<span class="l">num-layers=${trialParameters.numberLayers}</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">                  </span>- --<span class="l">optimizer=${trialParameters.optimizer}</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">                </span><span class="nt">image</span><span class="p">:</span><span class="w"> </span><span class="l">docker.io/kubeflowkatib/mxnet-mnist:v1beta1-45c5727</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">                </span><span class="nt">name</span><span class="p">:</span><span class="w"> </span><span class="l">training-container</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">            </span><span class="nt">restartPolicy</span><span class="p">:</span><span class="w"> </span><span class="l">Never</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="nt">status</span><span class="p">:</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">  </span><span class="nt">conditions</span><span class="p">:</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span>- <span class="nt">lastTransitionTime</span><span class="p">:</span><span class="w"> </span><span class="s2">&#34;2021-10-07T21:12:06Z&#34;</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">      </span><span class="nt">lastUpdateTime</span><span class="p">:</span><span class="w"> </span><span class="s2">&#34;2021-10-07T21:12:06Z&#34;</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">      </span><span class="nt">message</span><span class="p">:</span><span class="w"> </span><span class="l">Experiment is created</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">      </span><span class="nt">reason</span><span class="p">:</span><span class="w"> </span><span class="l">ExperimentCreated</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">      </span><span class="nt">status</span><span class="p">:</span><span class="w"> </span><span class="s2">&#34;True&#34;</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">      </span><span class="nt">type</span><span class="p">:</span><span class="w"> </span><span class="l">Created</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span>- <span class="nt">lastTransitionTime</span><span class="p">:</span><span class="w"> </span><span class="s2">&#34;2021-10-07T21:12:28Z&#34;</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">      </span><span class="nt">lastUpdateTime</span><span class="p">:</span><span class="w"> </span><span class="s2">&#34;2021-10-07T21:12:28Z&#34;</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">      </span><span class="nt">message</span><span class="p">:</span><span class="w"> </span><span class="l">Experiment is running</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">      </span><span class="nt">reason</span><span class="p">:</span><span class="w"> </span><span class="l">ExperimentRunning</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">      </span><span class="nt">status</span><span class="p">:</span><span class="w"> </span><span class="s2">&#34;True&#34;</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">      </span><span class="nt">type</span><span class="p">:</span><span class="w"> </span><span class="l">Running</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">  </span><span class="nt">currentOptimalTrial</span><span class="p">:</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="nt">bestTrialName</span><span class="p">:</span><span class="w"> </span><span class="l">random-hpsrsdqp</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="nt">observation</span><span class="p">:</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">      </span><span class="nt">metrics</span><span class="p">:</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">        </span>- <span class="nt">latest</span><span class="p">:</span><span class="w"> </span><span class="s2">&#34;0.993054&#34;</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">          </span><span class="nt">max</span><span class="p">:</span><span class="w"> </span><span class="s2">&#34;0.993054&#34;</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">          </span><span class="nt">min</span><span class="p">:</span><span class="w"> </span><span class="s2">&#34;0.917694&#34;</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">          </span><span class="nt">name</span><span class="p">:</span><span class="w"> </span><span class="l">Train-accuracy</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">        </span>- <span class="nt">latest</span><span class="p">:</span><span class="w"> </span><span class="s2">&#34;0.979598&#34;</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">          </span><span class="nt">max</span><span class="p">:</span><span class="w"> </span><span class="s2">&#34;0.979598&#34;</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">          </span><span class="nt">min</span><span class="p">:</span><span class="w"> </span><span class="s2">&#34;0.957106&#34;</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">          </span><span class="nt">name</span><span class="p">:</span><span class="w"> </span><span class="l">Validation-accuracy</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="nt">parameterAssignments</span><span class="p">:</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">      </span>- <span class="nt">name</span><span class="p">:</span><span class="w"> </span><span class="l">lr</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">        </span><span class="nt">value</span><span class="p">:</span><span class="w"> </span><span class="s2">&#34;0.024736875661534784&#34;</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">      </span>- <span class="nt">name</span><span class="p">:</span><span class="w"> </span><span class="l">num-layers</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">        </span><span class="nt">value</span><span class="p">:</span><span class="w"> </span><span class="s2">&#34;4&#34;</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">      </span>- <span class="nt">name</span><span class="p">:</span><span class="w"> </span><span class="l">optimizer</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">        </span><span class="nt">value</span><span class="p">:</span><span class="w"> </span><span class="l">sgd</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">  </span><span class="nt">runningTrialList</span><span class="p">:</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span>- <span class="l">random-2dwxbwcg</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span>- <span class="l">random-6jd8hmnd</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span>- <span class="l">random-7gks8bmf</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">  </span><span class="nt">startTime</span><span class="p">:</span><span class="w"> </span><span class="s2">&#34;2021-10-07T21:12:06Z&#34;</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">  </span><span class="nt">succeededTrialList</span><span class="p">:</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span>- <span class="l">random-xhpcrt2p</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span>- <span class="l">random-hpsrsdqp</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span>- <span class="l">random-kddxqqg9</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span>- <span class="l">random-4lkr5cjp</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">  </span><span class="nt">trials</span><span class="p">:</span><span class="w"> </span><span class="m">7</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">  </span><span class="nt">trialsRunning</span><span class="p">:</span><span class="w"> </span><span class="m">3</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">  </span><span class="nt">trialsSucceeded</span><span class="p">:</span><span class="w"> </span><span class="m">4</span><span class="w">
</span></span></span></code></pre></div><p>When the last value in <code>status.conditions.type</code> is <code>Succeeded</code>, the experiment
is complete. You can check information about the best trial in <code>status.currentOptimalTrial</code>.</p>
<ul>
<li>
<p><code>.currentOptimalTrial.bestTrialName</code> is the trial name.</p>
</li>
<li>
<p><code>.currentOptimalTrial.observation.metrics</code> is the <code>max</code>, <code>min</code> and <code>latest</code> recorded values for objective
and additional metrics.</p>
</li>
<li>
<p><code>.currentOptimalTrial.parameterAssignments</code> is the corresponding hyperparameter set.</p>
</li>
</ul>
<p>In addition, <code>status</code> shows the experiment&rsquo;s trials with their current status.</p>
<p><a id="view-ui"></a></p>
<p>View the results of the experiment in the Katib UI:</p>
<ol>
<li>
<p>Open the Katib UI as described <a href="#katib-ui">above</a>.</p>
</li>
<li>
<p>You should be able to view the list of experiments:</p>
<p><img src="/docs/components/katib/images/experiment-list.png"
alt="The random example in the list of Katib experiments"
class="mt-3 mb-3 border border-info rounded"></p>
</li>
<li>
<p>Click the name of the experiment, <strong>random-example</strong>.</p>
</li>
<li>
<p>There should be a graph showing the level of validation and train accuracy
for various combinations of the hyperparameter values
(learning rate, number of layers, and optimizer):</p>
<p><img src="/docs/components/katib/images/random-example-graph.png"
alt="Graph produced by the random example"
class="mt-3 mb-3 border border-info rounded"></p>
</li>
<li>
<p>Below the graph is a list of trials that ran within the experiment:</p>
<p><img src="/docs/components/katib/images/random-example-trials.png"
alt="Trials that ran during the experiment"
class="mt-3 mb-3 border border-info rounded"></p>
</li>
<li>
<p>You can click on trial name to get metrics for the particular trial:</p>
<p><img src="/docs/components/katib/images/random-example-trial-info.png"
alt="Trials that ran during the experiment"
class="mt-3 mb-3 border border-info rounded"></p>
</li>
</ol>
<h3 id="tensorflow-example">TensorFlow example</h3>
<p>If you installed Katib as part of Kubeflow, you cant run experiments in the
Kubeflow namespace. Run the following commands to launch an experiment using
the Kubeflow&rsquo;s <a href="/docs/components/training/tftraining">TensorFlow training job operator</a>, <code>TFJob</code>:</p>
<ol>
<li>
<p>Download <code>tfjob-mnist-with-summaries.yaml</code>:</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-shell" data-lang="shell"><span class="line"><span class="cl">curl https://raw.githubusercontent.com/kubeflow/katib/master/examples/v1beta1/kubeflow-training-operator/tfjob-mnist-with-summaries.yaml --output tfjob-mnist-with-summaries.yaml
</span></span></code></pre></div></li>
<li>
<p>Edit <code>tfjob-mnist-with-summaries.yaml</code> and change the following line to use your Kubeflow
user profile namespace (e.g. <code>kubeflow-user-example-com</code>):</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-fallback" data-lang="fallback"><span class="line"><span class="cl">namespace: kubeflow
</span></span></code></pre></div></li>
<li>
<p>(Optional) <strong>Note:</strong> Katib&rsquo;s experiments don&rsquo;t work with
<a href="https://istio.io/latest/docs/setup/additional-setup/sidecar-injection/#automatic-sidecar-injection">Istio sidecar injection</a>.
If you are using Kubeflow with
Istio, you have to disable sidecar injection. To do that, specify this annotation:
<code>sidecar.istio.io/inject: &quot;false&quot;</code> in your experiment&rsquo;s trial template.
For the provided <code>TFJob</code> example check
<a href="/docs/components/training/tftraining/#what-is-tfjob">here</a>
how to set the annotation.</p>
</li>
<li>
<p>Deploy the example:</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-shell" data-lang="shell"><span class="line"><span class="cl">kubectl apply -f tfjob-mnist-with-summaries.yaml
</span></span></code></pre></div></li>
<li>
<p>You can check the status of the experiment:</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-shell" data-lang="shell"><span class="line"><span class="cl">kubectl -n kubeflow-user-example-com get experiment tfjob-mnist-with-summaries -o yaml
</span></span></code></pre></div></li>
</ol>
<p>Follow the steps as described for the <em>random search algorithm example</em>
<a href="#view-ui">above</a> to obtain the results of the experiment in the Katib UI.</p>
<h3 id="pytorch-example">PyTorch example</h3>
<p>If you installed Katib as part of Kubeflow, you cant run experiments in the
Kubeflow namespace. Run the following commands to launch an experiment
using Kubeflow&rsquo;s <a href="/docs/components/training/pytorch">PyTorch training job operator</a>, <code>PyTorchJob</code>:</p>
<ol>
<li>
<p>Download <code>pytorchjob-mnist.yaml</code>:</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-shell" data-lang="shell"><span class="line"><span class="cl">curl https://raw.githubusercontent.com/kubeflow/katib/master/examples/v1beta1/kubeflow-training-operator/pytorchjob-mnist.yaml --output pytorchjob-mnist.yaml
</span></span></code></pre></div></li>
<li>
<p>Edit <code>pytorchjob-mnist.yaml</code> and change the following line to use your
Kubeflow user profile namespace (e.g. <code>kubeflow-user-example-com</code>):</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-fallback" data-lang="fallback"><span class="line"><span class="cl">namespace: kubeflow
</span></span></code></pre></div></li>
<li>
<p>(Optional) <strong>Note:</strong> Katib&rsquo;s experiments don&rsquo;t work with
<a href="https://istio.io/latest/docs/setup/additional-setup/sidecar-injection/#automatic-sidecar-injection">Istio sidecar injection</a>.
If you are using Kubeflow with
Istio, you have to disable sidecar injection. To do that, specify this annotation:
<code>sidecar.istio.io/inject: &quot;false&quot;</code> in your experiment&rsquo;s trial template.
For the provided <code>PyTorchJob</code> example setting the annotation should be similar to
<a href="/docs/components/training/tftraining/#what-is-tfjob"><code>TFJob</code></a></p>
</li>
<li>
<p>Deploy the example:</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-shell" data-lang="shell"><span class="line"><span class="cl">kubectl apply -f pytorchjob-mnist.yaml
</span></span></code></pre></div></li>
<li>
<p>You can check the status of the experiment:</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-shell" data-lang="shell"><span class="line"><span class="cl">kubectl -n kubeflow-user-example-com describe experiment pytorchjob-mnist
</span></span></code></pre></div></li>
</ol>
<p>Follow the steps as described for the <em>random search algorithm example</em>
<a href="#view-ui">above</a> to get the results of the experiment in the Katib UI.</p>
<h2 id="cleaning-up">Cleaning up</h2>
<p>To remove Katib from your Kubernetes cluster run:</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-shell" data-lang="shell"><span class="line"><span class="cl">kubectl delete -k <span class="s2">&#34;github.com/kubeflow/katib.git/manifests/v1beta1/installs/katib-standalone?ref=master&#34;</span>
</span></span></code></pre></div><h2 id="next-steps">Next steps</h2>
<ul>
<li>
<p>Learn how to
<a href="/docs/components/katib/experiment/">configure and run your Katib experiments</a>.</p>
</li>
<li>
<p>Learn to configure your
<a href="/docs/components/katib/trial-template/">trial templates</a>.</p>
</li>
<li>
<p>Check the
<a href="/docs/components/katib/katib-config/">Katib Configuration (Katib config)</a>.</p>
</li>
<li>
<p>How to <a href="/docs/components/katib/env-variables/">set up environment variables</a>
for each Katib component.</p>
</li>
</ul>

</div>



    
	
  
    
    
	
    

<div class="td-content" style="page-break-before: always">
    
	<h1 id="pg-7f397238fac71de59685256a78cd9f76">4.3 - Running an Experiment</h1>
    <div class="lead">How to configure and run a hyperparameter tuning or neural architecture search experiment in Katib</div>
	<p>This guide describes how to configure and run a Katib experiment.
The experiment can perform hyperparameter tuning or a neural architecture search
(NAS) (<strong>alpha</strong>), depending on the configuration settings.</p>
<p>For an overview of the concepts involved, check the
<a href="/docs/components/katib/overview/">introduction to Katib</a>.</p>
<p><a id="docker-image"></a></p>
<h2 id="packaging-your-training-code-in-a-container-image">Packaging your training code in a container image</h2>
<p>Katib and Kubeflow are Kubernetes-based systems. To use Katib, you must package
your training code in a Docker container image and make the image available
in a registry. Check the
<a href="https://docs.docker.com/develop/develop-images/baseimages/">Docker documentation</a>
and the
<a href="https://kubernetes.io/docs/concepts/containers/images/">Kubernetes documentation</a>.</p>
<h2 id="configuring-the-experiment">Configuring the experiment</h2>
<p>To create a hyperparameter tuning or NAS experiment in Katib, you define the
experiment in a YAML configuration file. The YAML file defines the range of
potential values (the search space) for the parameters that you want to
optimize, the objective metric to use when determining optimal values, the
search algorithm to use during optimization, and other configurations.</p>
<p>As a reference, you can use the YAML file of the
<a href="https://github.com/kubeflow/katib/blob/master/examples/v1beta1/hp-tuning/random.yaml">random search algorithm example</a>.</p>
<p>The list below describes the fields in the YAML file for an experiment. The
Katib UI offers the corresponding fields. You can choose to configure and run
the experiment from the UI or from the command line.</p>
<h3 id="configuration-spec">Configuration spec</h3>
<p>These are the fields in the experiment configuration spec:</p>
<ul>
<li>
<p><strong>parameters</strong>: The range of the hyperparameters or other parameters that you
want to tune for your machine learning (ML) model. The parameters define the <em>search space</em>,
also known as the <em>feasible set</em> or the <em>solution space</em>.
In this section of the spec, you define the name and the distribution
(discrete or continuous) of every hyperparameter that you need to search.
For example, you may provide a minimum and maximum value or a list
of allowed values for each hyperparameter.
Katib generates hyperparameter combinations in the range based on the
hyperparameter tuning algorithm that you specify.
Refer to the
<a href="https://github.com/kubeflow/katib/blob/master/pkg/apis/controller/experiments/v1beta1/experiment_types.go#L185-L206"><code>ParameterSpec</code> type</a>.</p>
</li>
<li>
<p><strong>objective</strong>: The metric that you want to optimize.
The objective metric is also called the <em>target variable</em>.
A common metric is the model&rsquo;s accuracy in the validation pass of the training
job (<em>validation-accuracy</em>). You also specify whether you want Katib to
maximize or minimize the metric.</p>
<p>Katib uses the <code>objectiveMetricName</code> and <code>additionalMetricNames</code> to monitor
how the hyperparameters work with the model.
Katib records the value of the best <code>objectiveMetricName</code> metric (maximized
or minimized based on <code>type</code>) and the corresponding hyperparameter set
in the experiment&rsquo;s <code>.status.currentOptimalTrial.parameterAssignments</code>.
If the <code>objectiveMetricName</code> metric for a set of hyperparameters reaches the
<code>goal</code>, Katib stops trying more hyperparameter combinations.</p>
<p>You can run the experiment without specifying the <code>goal</code>. In that case, Katib
runs the experiment until the corresponding successful trials reach <code>maxTrialCount</code>.
<code>maxTrialCount</code> parameter is described below.</p>
<p>The default way to calculate the experiment&rsquo;s objective is:</p>
<ul>
<li>
<p>When the objective <code>type</code> is <code>maximize</code>, Katib compares all maximum
metric values.</p>
</li>
<li>
<p>When the objective <code>type</code> is <code>minimize</code>, Katib compares all minimum
metric values.</p>
</li>
</ul>
<p>To change the default settings, define <code>metricStrategies</code> with various rules
(<code>min</code>, <code>max</code> or <code>latest</code>) to extract values for each metric from the
experiment&rsquo;s <code>objectiveMetricName</code> and <code>additionalMetricNames</code>.
The experiment&rsquo;s objective value is calculated in
accordance with the selected strategy.</p>
<p>For example, you can set the parameters in your experiment as follows:</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-yaml" data-lang="yaml"><span class="line"><span class="cl"><span class="l">. . .</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="nt">objectiveMetricName</span><span class="p">:</span><span class="w"> </span><span class="l">accuracy</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="nt">type</span><span class="p">:</span><span class="w"> </span><span class="l">maximize</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="nt">metricStrategies</span><span class="p">:</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">  </span>- <span class="nt">name</span><span class="p">:</span><span class="w"> </span><span class="l">accuracy</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="nt">value</span><span class="p">:</span><span class="w"> </span><span class="l">latest</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="l">. . .</span><span class="w">
</span></span></span></code></pre></div><p>where the Katib controller is searching for the best maximum from the all
latest reported <code>accuracy</code> metrics for each trial. Check the
<a href="https://github.com/kubeflow/katib/blob/master/examples/v1beta1/metrics-collector/metrics-collection-strategy.yaml">metrics strategies example</a>.
The default strategy type for each metric is equal to the objective <code>type</code>.</p>
<p>Refer to the
<a href="https://github.com/kubeflow/katib/blob/master/pkg/apis/controller/common/v1beta1/common_types.go#L93"><code>ObjectiveSpec</code> type</a>.</p>
</li>
<li>
<p><strong>parallelTrialCount</strong>: The maximum number of hyperparameter sets that Katib
should train in parallel. The default value is 3.</p>
</li>
<li>
<p><strong>maxTrialCount</strong>: The maximum number of trials to run.
This is equivalent to the number of hyperparameter sets that Katib should
generate to test the model. If the <code>maxTrialCount</code> value is <strong>omitted</strong>, your
experiment will be running until the objective goal is reached or the experiment
reaches a maximum number of failed trials.</p>
</li>
<li>
<p><strong>maxFailedTrialCount</strong>: The maximum number of trials allowed to fail.
This is equivalent to the number of failed hyperparameter sets that Katib should test.
Katib recognizes trials with a status of <code>Failed</code> or <code>MetricsUnavailable</code> as <code>Failed</code> trials,
and if the number of failed trials reaches <code>maxFailedTrialCount</code>, Katib stops the
experiment with a status of <code>Failed</code>.</p>
</li>
<li>
<p><strong>algorithm</strong>: The search algorithm that you want Katib to use to find the
best hyperparameters or neural architecture configuration. Examples include
random search, grid search, Bayesian optimization, and more.
Check the <a href="#search-algorithms">search algorithm details</a> below.</p>
</li>
<li>
<p><strong>trialTemplate</strong>: The template that defines the trial.
You have to package your ML training code into a Docker image, as described
<a href="#docker-image">above</a>. <code>trialTemplate.trialSpec</code> is your
<a href="https://godoc.org/k8s.io/apimachinery/pkg/apis/meta/v1/unstructured">unstructured</a>
template with model parameters, which are substituted from <code>trialTemplate.trialParameters</code>.
For example, your training container can receive hyperparameters as command-line
arguments or as environment variables. You have to set the name of your training
container in <code>trialTemplate.primaryContainerName</code>.</p>
<p>Katib dynamically supports any kind of
<a href="https://kubernetes.io/docs/concepts/extend-kubernetes/api-extension/custom-resources/">Kubernetes CRD</a>.
In Katib <a href="https://github.com/kubeflow/katib/tree/master/examples/v1beta1">examples</a>,
you can find the following job types to train your model:</p>
<ul>
<li>
<p><a href="https://kubernetes.io/docs/concepts/workloads/controllers/job/">Kubernetes <code>Job</code></a></p>
</li>
<li>
<p><a href="/docs/components/training/tftraining/">Kubeflow <code>TFJob</code></a></p>
</li>
<li>
<p><a href="/docs/components/training/pytorch/">Kubeflow <code>PyTorchJob</code></a></p>
</li>
<li>
<p><a href="/docs/components/training/mxnet">Kubeflow <code>MXJob</code></a></p>
</li>
<li>
<p><a href="/docs/components/training/xgboost">Kubeflow <code>XGBoostJob</code></a></p>
</li>
<li>
<p><a href="/docs/components/training/mpi">Kubeflow <code>MPIJob</code></a></p>
</li>
<li>
<p><a href="https://github.com/kubeflow/katib/tree/master/examples/v1beta1/tekton">Tekton <code>Pipelines</code></a></p>
</li>
<li>
<p><a href="https://github.com/kubeflow/katib/tree/master/examples/v1beta1/argo">Argo <code>Workflows</code></a></p>
</li>
</ul>
<p>Refer to the
<a href="https://github.com/kubeflow/katib/blob/master/pkg/apis/controller/experiments/v1beta1/experiment_types.go#L208-L270"><code>TrialTemplate</code> type</a>.
Follow the <a href="/docs/components/katib/trial-template/">trial template guide</a>
to understand how to specify <code>trialTemplate</code> parameters, save templates in
<code>ConfigMaps</code> and support custom Kubernetes resources in Katib.</p>
</li>
<li>
<p><strong>metricsCollectorSpec</strong>: A specification of how to collect the metrics from
each trial, such as the accuracy and loss metrics.
Learn the <a href="#metrics-collector">details of the metrics collector</a> below.
The default metrics collector is <code>StdOut</code>.</p>
</li>
<li>
<p><strong>nasConfig</strong>: The configuration for a neural architecture search (NAS).
<strong>Note</strong>: NAS is currently in <strong>alpha</strong> with limited support.
You can specify the configurations of the neural network design that you want
to optimize, including the number of layers in the network, the types of
operations, and more.
Refer to the
<a href="https://github.com/kubeflow/katib/blob/master/pkg/apis/controller/experiments/v1beta1/experiment_types.go#L296"><code>NasConfig</code> type</a>.</p>
<ul>
<li>
<p><strong>graphConfig</strong>: The graph config that defines structure for a
directed acyclic graph of the neural network. You can specify the number of layers,
<code>input_sizes</code> for the input layer and <code>output_sizes</code> for the output layer.
Refer to the
<a href="https://github.com/kubeflow/katib/blob/master/pkg/apis/controller/experiments/v1beta1/experiment_types.go#L301-L306"><code>GraphConfig</code> type</a>.</p>
</li>
<li>
<p><strong>operations</strong>: The range of operations that you want to tune for your ML model.
For each neural network layer the NAS algorithm selects one of the operations
to build a neural network. Each operation contains sets of <strong>parameters</strong> which
are described above.
Refer to the
<a href="https://github.com/kubeflow/katib/blob/master/pkg/apis/controller/experiments/v1beta1/experiment_types.go#L308-L312"><code>Operation</code> type</a>.</p>
<p>You can find all NAS examples <a href="https://github.com/kubeflow/katib/tree/master/examples/v1beta1/nas">here</a>.</p>
</li>
</ul>
</li>
<li>
<p><strong>resumePolicy</strong>: The experiment resume policy. Can be one of
<code>LongRunning</code>, <code>Never</code> or <code>FromVolume</code>. The default value is <code>LongRunning</code>.
Refer to the
<a href="https://github.com/kubeflow/katib/blob/master/pkg/apis/controller/experiments/v1beta1/experiment_types.go#L58"><code>ResumePolicy</code> type</a>.
To find out how to modify a running experiment and use various
restart policies follow the
<a href="/docs/components/katib/resume-experiment/">resume an experiment guide</a>.</p>
</li>
</ul>
<p><em>Background information about Katib&rsquo;s <code>Experiment</code>, <code>Suggestion</code> and <code>Trial</code>
type:</em> In Kubernetes terminology, Katib&rsquo;s
<a href="https://github.com/kubeflow/katib/blob/master/pkg/apis/controller/experiments/v1beta1/experiment_types.go#L278"><code>Experiment</code> type</a>,
<a href="https://github.com/kubeflow/katib/blob/master/pkg/apis/controller/suggestions/v1beta1/suggestion_types.go#L128"><code>Suggestion</code> type</a> and
<a href="https://github.com/kubeflow/katib/blob/master/pkg/apis/controller/trials/v1beta1/trial_types.go#L129"><code>Trial</code> type</a>
is a <a href="https://kubernetes.io/docs/concepts/extend-kubernetes/api-extension/custom-resources/">custom resource (CR)</a>.
The YAML file that you create for your experiment is the CR specification.</p>
<p><a id="search-algorithms"></a></p>
<h3 id="search-algorithms-in-detail">Search algorithms in detail</h3>
<p>Katib currently supports several search algorithms.
Refer to the
<a href="https://github.com/kubeflow/katib/blob/master/pkg/apis/controller/common/v1beta1/common_types.go#L22-L39"><code>AlgorithmSpec</code> type</a>.</p>
<p>Here&rsquo;s a list of the search algorithms available in Katib:</p>
<ul>
<li><a href="#grid-search">Grid search</a></li>
<li><a href="#random-search">Random search</a></li>
<li><a href="#bayesian">Bayesian optimization</a></li>
<li><a href="#hyperband">Hyperband</a></li>
<li><a href="#tpe-search">Tree of Parzen Estimators (TPE)</a></li>
<li><a href="#multivariate-tpe-search">Multivariate TPE</a></li>
<li><a href="#cmaes">Covariance Matrix Adaptation Evolution Strategy (CMA-ES)</a></li>
<li><a href="#sobol">Sobol&rsquo;s Quasirandom Sequence</a></li>
<li><a href="#enas">Neural Architecture Search based on ENAS</a></li>
<li><a href="#darts">Differentiable Architecture Search (DARTS)</a></li>
<li><a href="#pbt">Population Based Training (PBT)</a></li>
</ul>
<p>More algorithms are under development.</p>
<p>You can add an algorithm to Katib yourself. Check the guide to
<a href="https://github.com/kubeflow/katib/blob/master/docs/new-algorithm-service.md">adding a new algorithm</a>
and the
<a href="https://github.com/kubeflow/katib/blob/master/docs/developer-guide.md">developer guide</a>.</p>
<p><a id="grid-search"></a></p>
<h4 id="grid-search">Grid search</h4>
<p>The algorithm name in Katib is <code>grid</code>.</p>
<p>Grid sampling is useful when all variables are discrete (as opposed to
continuous) and the number of possibilities is low. A grid search
performs an exhaustive combinatorial search over all possibilities,
making the search process extremely long even for medium sized problems.</p>
<p>Katib uses the <a href="https://chocolate.readthedocs.io">Chocolate</a> optimization
framework for its grid search.</p>
<p><a id="random-search"></a></p>
<h4 id="random-search">Random search</h4>
<p>The algorithm name in Katib is <code>random</code>.</p>
<p>Random sampling is an alternative to grid search and is used when the number of
discrete variables to optimize is large and the time required for each
evaluation is long. When all parameters are discrete, random search performs
sampling without replacement. Random search is therefore the best algorithm to
use when combinatorial exploration is not possible. If the number of continuous
variables is high, you should use quasi random sampling instead.</p>
<p>Katib uses the <a href="http://hyperopt.github.io/hyperopt/">Hyperopt</a>,
<a href="https://github.com/c-bata/goptuna">Goptuna</a>,
<a href="https://chocolate.readthedocs.io">Chocolate</a> or
<a href="https://github.com/optuna/optuna">Optuna</a> optimization
framework for its random search.</p>
<p>Katib supports the following algorithm settings:</p>
<div class="table-responsive">
  <table class="table table-bordered">
    <thead class="thead-light">
      <tr>
        <th>Setting name</th>
        <th>Description</th>
        <th>Example</th>
      </tr>
    </thead>
    <tbody>
      <tr>
        <td>random_state</td>
        <td>[int]: Set <code>random_state</code> to something other than None
          for reproducible results.</td>
        <td>10</td>
      </tr>
    </tbody>
  </table>
</div>
<p><a id="bayesian"></a></p>
<h4 id="bayesian-optimization">Bayesian optimization</h4>
<p>The algorithm name in Katib is <code>bayesianoptimization</code>.</p>
<p>The <a href="https://arxiv.org/pdf/1012.2599.pdf">Bayesian optimization</a> method uses
Gaussian process regression to model the search space. This technique calculates
an estimate of the loss function and the uncertainty of that estimate at every
point in the search space. The method is suitable when the number of
dimensions in the search space is low. Since the method models both
the expected loss and the uncertainty, the search algorithm converges in a few
steps, making it a good choice when the time to
complete the evaluation of a parameter configuration is long.</p>
<p>Katib uses the
<a href="https://github.com/scikit-optimize/scikit-optimize">Scikit-Optimize</a> or
<a href="https://chocolate.readthedocs.io">Chocolate</a> optimization framework
for its Bayesian search. Scikit-Optimize is also known as <code>skopt</code>.</p>
<p>Katib supports the following algorithm settings:</p>
<div class="table-responsive">
  <table class="table table-bordered">
    <thead class="thead-light">
      <tr>
        <th>Setting Name</th>
        <th>Description</th>
        <th>Example</th>
      </tr>
    </thead>
    <tbody>
      <tr>
        <td>base_estimator</td>
        <td>[GP, RF, ET, GBRT or sklearn regressor, default=GP]:
          Should inherit from <code>sklearn.base.RegressorMixin</code>.
          The <code>predict</code> method should have an optional
          <code>return_std</code> argument, which returns
          <code>std(Y | x)</code> along with <code>E[Y | x]</code>. If
          <code>base_estimator</code> is one of
          [GP, RF, ET, GBRT], the system uses a default surrogate model
          of the corresponding type. Learn more information in the
          <a href="https://scikit-optimize.github.io/stable/modules/generated/skopt.Optimizer.html#skopt.Optimizer">skopt
          documentation</a>.</td>
        <td>GP</td>
      </tr>
      <tr>
        <td>n_initial_points</td>
        <td>[int, default=10]: Number of evaluations of <code>func</code> with
          initialization points before approximating it with
          <code>base_estimator</code>. Points provided as <code>x0</code> count
          as initialization points.
          If <code>len(x0) &lt; n_initial_points</code>, the
          system samples additional points at random. Learn more information in the
          <a href="https://scikit-optimize.github.io/stable/modules/generated/skopt.Optimizer.html#skopt.Optimizer">skopt
          documentation</a>.</td>
        <td>10</td>
      </tr>
      <tr>
        <td>acq_func</td>
        <td>[string, default=<code>&quot;gp_hedge&quot;</code>]: The function to
          minimize over the posterior distribution. Learn more information in the
          <a href="https://scikit-optimize.github.io/stable/modules/generated/skopt.Optimizer.html#skopt.Optimizer">skopt
          documentation</a>.</td>
        <td>gp_hedge</td>
      </tr>
      <tr>
        <td>acq_optimizer</td>
        <td>[string, sampling or lbfgs, default=auto]: The method to
          minimize the acquisition function. The system updates the fit model
          with the optimal value obtained by optimizing <code>acq_func</code>
          with <code>acq_optimizer</code>. Learn more information in the
          <a href="https://scikit-optimize.github.io/stable/modules/generated/skopt.Optimizer.html#skopt.Optimizer">skopt
          documentation</a>.</td>
        <td>auto</td>
      </tr>
      <tr>
        <td>random_state</td>
        <td>[int]: Set <code>random_state</code> to something other than None
          for reproducible results.</td>
        <td>10</td>
      </tr>
    </tbody>
  </table>
</div>
<p><a id="hyperband"></a></p>
<h4 id="hyperband">Hyperband</h4>
<p>The algorithm name in Katib is <code>hyperband</code>.</p>
<p>Katib supports the <a href="https://arxiv.org/pdf/1603.06560.pdf">Hyperband</a>
optimization framework.
Instead of using Bayesian optimization to select configurations, Hyperband
focuses on early stopping as a strategy for optimizing resource allocation and
thus for maximizing the number of configurations that it can evaluate.
Hyperband also focuses on the speed of the search.</p>
<p><a id="tpe-search"></a></p>
<h4 id="tree-of-parzen-estimators-tpe">Tree of Parzen Estimators (TPE)</h4>
<p>The algorithm name in Katib is <code>tpe</code>.</p>
<p>Katib uses the <a href="http://hyperopt.github.io/hyperopt/">Hyperopt</a>,
<a href="https://github.com/c-bata/goptuna">Goptuna</a> or
<a href="https://github.com/optuna/optuna">Optuna</a> optimization
framework for its TPE search.</p>
<p>This method provides a <a href="https://arxiv.org/pdf/1703.01785.pdf">forward and reverse gradient-based</a>
search.</p>
<p>Katib supports the following algorithm settings:</p>
<div class="table-responsive">
  <table class="table table-bordered">
    <thead class="thead-light">
      <tr>
        <th>Setting name</th>
        <th>Description</th>
        <th>Example</th>
      </tr>
    </thead>
    <tbody>
      <tr>
        <td>n_EI_candidates</td>
        <td>[int]: Number of candidate samples used to calculate the expected improvement.</td>
        <td>25</td>
      </tr>
      <tr>
        <td>random_state</td>
        <td>[int]: Set <code>random_state</code> to something other than None
          for reproducible results.</td>
        <td>10</td>
      </tr>
      <tr>
        <td>gamma</td>
        <td>[float]: The threshold to split between l(x) and g(x), check equation 2 in
        <a href="https://papers.nips.cc/paper/2011/file/86e8f7ab32cfd12577bc2619bc635690-Paper.pdf">
        this Paper</a>. Value must be in (0, 1) range.</td>
        <td>0.25</td>
      </tr>
      <tr>
        <td>prior_weight</td>
        <td>[float]: Smoothing factor for counts, to avoid having 0 probability.
        Value must be > 0.</td>
        <td>1.1</td>
      </tr>
    </tbody>
  </table>
</div>
<p><a id="multivariate-tpe-search"></a></p>
<h4 id="multivariate-tpe">Multivariate TPE</h4>
<p>The algorithm name in Katib is <code>multivariate-tpe</code>.</p>
<p>Katib uses the <a href="http://hyperopt.github.io/hyperopt/">Optuna</a> optimization
framework for its Multivariate TPE search.</p>
<p><a href="https://tech.preferred.jp/en/blog/multivariate-tpe-makes-optuna-even-more-powerful/">Multivariate TPE</a>
is improved version of independent (default) TPE. This method finds
dependencies among hyperparameters in search space.</p>
<p>Katib supports the following algorithm settings:</p>
<div class="table-responsive">
  <table class="table table-bordered">
    <thead class="thead-light">
      <tr>
        <th>Setting name</th>
        <th>Description</th>
        <th>Example</th>
      </tr>
    </thead>
    <tbody>
      <tr>
        <td>n_ei_candidates</td>
        <td>[int]: Number of Trials used to calculate the expected improvement.</td>
        <td>25</td>
      </tr>
      <tr>
        <td>random_state</td>
        <td>[int]: Set <code>random_state</code> to something other than None
          for reproducible results.</td>
        <td>10</td>
      </tr>
      <tr>
        <td>n_startup_trials</td>
        <td>[int]: Number of initial Trials for which the random search algorithm generates
        hyperparameters.</td>
        <td>5</td>
      </tr>
    </tbody>
  </table>
</div>
<p><a id="cmaes"></a></p>
<h4 id="covariance-matrix-adaptation-evolution-strategy-cma-es">Covariance Matrix Adaptation Evolution Strategy (CMA-ES)</h4>
<p>The algorithm name in Katib is <code>cmaes</code>.</p>
<p>Katib uses the <a href="https://github.com/c-bata/goptuna">Goptuna</a> or
<a href="https://github.com/optuna/optuna">Optuna</a> optimization
framework for its CMA-ES search.</p>
<p>The <a href="https://en.wikipedia.org/wiki/CMA-ES">Covariance Matrix Adaptation Evolution Strategy</a>
is a stochastic derivative-free numerical optimization algorithm for optimization
problems in continuous search spaces.
You can also use <a href="https://sci2s.ugr.es/sites/default/files/files/TematicWebSites/EAMHCO/contributionsCEC05/auger05ARCMA.pdf">IPOP-CMA-ES</a> and <a href="https://hal.inria.fr/inria-00382093/document">BIPOP-CMA-ES</a>, variant algorithms for restarting optimization when converges to local minimum.</p>
<p>Katib supports the following algorithm settings:</p>
<div class="table-responsive">
  <table class="table table-bordered">
    <thead class="thead-light">
      <tr>
        <th>Setting name</th>
        <th>Description</th>
        <th>Example</th>
      </tr>
    </thead>
    <tbody>
      <tr>
        <td>random_state</td>
        <td>[int]: Set <code>random_state</code> to something other than None
          for reproducible results.</td>
        <td>10</td>
      </tr>
      <tr>
        <td>sigma</td>
        <td>[float]: Initial standard deviation of CMA-ES.</td>
        <td>0.001</td>
      </tr>
      <tr>
        <td>restart_strategy</td>
        <td>[string, "none", "ipop", or "bipop", default="none"]: Strategy for restarting CMA-ES optimization when converges to a local minimum.</td>
        <td>"ipop"</td>
      </tr>
    </tbody>
  </table>
</div>
<p><a id="sobol"></a></p>
<h4 id="sobols-quasirandom-sequence">Sobol&rsquo;s Quasirandom Sequence</h4>
<p>The algorithm name in Katib is <code>sobol</code>.</p>
<p>Katib uses the <a href="https://github.com/c-bata/goptuna">Goptuna</a> optimization
framework for its Sobol&rsquo;s quasirandom search.</p>
<p>The <a href="https://dl.acm.org/doi/10.1145/641876.641879">Sobol&rsquo;s quasirandom sequence</a>
is a low-discrepancy sequence. And it is known that Sobol&rsquo;s quasirandom sequence can
provide better uniformity properties.</p>
<p><a id="enas"></a></p>
<h4 id="neural-architecture-search-based-on-enas">Neural Architecture Search based on ENAS</h4>
<p>The algorithm name in Katib is <code>enas</code>.</p>


<div class="alert alert-warning" role="alert">
<h4 class="alert-heading">Alpha version</h4>

    Neural architecture search is currently in <b>alpha</b> with limited support.
The Kubeflow team is interested in any feedback you may have, in particular with
regards to usability of the feature. You can log issues and comments in
the <a href="https://github.com/kubeflow/katib/issues">Katib issue tracker</a>.

</div>

<p>This NAS algorithm is ENAS-based. Currently, it doesn&rsquo;t support parameter sharing.</p>
<p>Katib supports the following algorithm settings:</p>
<div class="table-responsive">
  <table class="table table-bordered">
    <thead class="thead-light">
      <tr>
        <th>Setting Name</th>
        <th>Type</th>
        <th>Default value</th>
        <th>Description</th>
      </tr>
    </thead>
    <tbody>
      <tr>
        <td>controller_hidden_size</td>
        <td>int</td>
        <td>64</td>
        <td>RL controller lstm hidden size. Value must be >= 1.</td>
      </tr>
      <tr>
        <td>controller_temperature</td>
        <td>float</td>
        <td>5.0</td>
        <td>RL controller temperature for the sampling logits. Value must be > 0.
          Set value to "None" to disable it in the controller.</td>
      </tr>
      <tr>
        <td>controller_tanh_const</td>
        <td>float</td>
        <td>2.25</td>
        <td>RL controller tanh constant to prevent premature convergence.
          Value must be > 0. Set value to "None" to disable it in the controller.</td>
      </tr>
      <tr>
        <td>controller_entropy_weight</td>
        <td>float</td>
        <td>1e-5</td>
        <td>RL controller weight for entropy applying to reward. Value must be > 0.
          Set value to "None" to disable it in the controller.</td>
      </tr>
      <tr>
        <td>controller_baseline_decay</td>
        <td>float</td>
        <td>0.999</td>
        <td>RL controller baseline factor. Value must be > 0 and <= 1.</td>
      </tr>
      <tr>
        <td>controller_learning_rate</td>
        <td>float</td>
        <td>5e-5</td>
        <td>RL controller learning rate for Adam optimizer. Value must be > 0 and <= 1.</td>
      </tr>
      <tr>
        <td>controller_skip_target</td>
        <td>float</td>
        <td>0.4</td>
        <td>RL controller probability, which represents the prior belief of a
          skip connection being formed. Value must be > 0 and <= 1.</td>
      </tr>
      <tr>
        <td>controller_skip_weight</td>
        <td>float</td>
        <td>0.8</td>
        <td>RL controller weight of skip penalty loss. Value must be > 0.
          Set value to "None" to disable it in the controller.</td>
      </tr>
      <tr>
        <td>controller_train_steps</td>
        <td>int</td>
        <td>50</td>
        <td>Number of RL controller training steps after each candidate runs.
          Value must be >= 1.</td>
      </tr>
      <tr>
        <td>controller_log_every_steps</td>
        <td>int</td>
        <td>10</td>
        <td>Number of RL controller training steps before logging it. Value must be >= 1.</td>
      </tr>
    </tbody>
  </table>
</div>
<p>For more information, check:</p>
<ul>
<li>
<p>Documentation in the Katib repository on the
<a href="https://github.com/kubeflow/katib/tree/master/pkg/suggestion/v1beta1/nas/enas">Efficient Neural Architecture Search (ENAS)</a>.</p>
</li>
<li>
<p>The ENAS example 
<a href="https://github.com/kubeflow/katib/blob/master/examples/v1beta1/nas/enas-gpu.yaml"><code>enas-gpu.yaml</code></a> 
which attempts to show all possible operations. Due to the large search
space, the example is not likely to generate a good result.</p>
</li>
</ul>
<p><a id="darts"></a></p>
<h4 id="differentiable-architecture-search-darts">Differentiable Architecture Search (DARTS)</h4>
<p>The algorithm name in Katib is <code>darts</code>.</p>


<div class="alert alert-warning" role="alert">
<h4 class="alert-heading">Alpha version</h4>

    Neural architecture search is currently in <b>alpha</b> with limited support.
The Kubeflow team is interested in any feedback you may have, in particular with
regards to usability of the feature. You can log issues and comments in
the <a href="https://github.com/kubeflow/katib/issues">Katib issue tracker</a>.

</div>

<p>Currently, you can&rsquo;t view results of this algorithm in the Katib UI and
you can run experiments only on a single GPU.</p>
<p>Katib supports the following algorithm settings:</p>
<div class="table-responsive">
  <table class="table table-bordered">
    <thead class="thead-light">
      <tr>
        <th>Setting Name</th>
        <th>Type</th>
        <th>Default value</th>
        <th>Description</th>
      </tr>
    </thead>
    <tbody>
      <tr>
        <td>num_epochs</td>
        <td>int</td>
        <td>50</td>
        <td>Number of epochs to train model</td>
      </tr>
      <tr>
        <td>w_lr</td>
        <td>float</td>
        <td>0.025</td>
        <td>Initial learning rate for training model weights.
          This learning rate annealed down to <code>w_lr_min</code>
          following a cosine schedule without restart.</td>
      </tr>
      <tr>
        <td>w_lr_min</td>
        <td>float</td>
        <td>0.001</td>
        <td>Minimum learning rate for training model weights.</td>
      </tr>
      <tr>
        <td>w_momentum</td>
        <td>float</td>
        <td>0.9</td>
        <td>Momentum for training training model weights.</td>
      </tr>
      <tr>
        <td>w_weight_decay</td>
        <td>float</td>
        <td>3e-4</td>
        <td>Training model weight decay.</td>
      </tr>
      <tr>
        <td>w_grad_clip</td>
        <td>float</td>
        <td>5.0</td>
        <td>Max norm value for clipping gradient norm of training model weights.</td>
      </tr>
      <tr>
        <td>alpha_lr</td>
        <td>float</td>
        <td>3e-4</td>
        <td>Initial learning rate for alphas weights.</td>
      </tr>
      <tr>
        <td>alpha_weight_decay</td>
        <td>float</td>
        <td>1e-3</td>
        <td>Alphas weight decay.</td>
      </tr>
      <tr>
        <td>batch_size</td>
        <td>int</td>
        <td>128</td>
        <td>Batch size for dataset.</td>
      </tr>
      <tr>
        <td>num_workers</td>
        <td>int</td>
        <td>4</td>
        <td>Number of subprocesses to download the dataset.</td>
      </tr>
      <tr>
        <td>init_channels</td>
        <td>int</td>
        <td>16</td>
        <td>Initial number of channels.</td>
      </tr>
      <tr>
        <td>print_step</td>
        <td>int</td>
        <td>50</td>
        <td>Number of training or validation steps before logging it.</td>
      </tr>
      <tr>
        <td>num_nodes</td>
        <td>int</td>
        <td>4</td>
        <td>Number of DARTS nodes.</td>
      </tr>
      <tr>
        <td>stem_multiplier</td>
        <td>int</td>
        <td>3</td>
        <td>Multiplier for initial channels. It is used in the first stem cell.</td>
      </tr>
    </tbody>
  </table>
</div>
<p>For more information, check:</p>
<ul>
<li>
<p>Documentation in the Katib repository on the
<a href="https://github.com/kubeflow/katib/tree/master/pkg/suggestion/v1beta1/nas/darts">Differentiable Architecture Search</a>.</p>
</li>
<li>
<p>The DARTS example 
<a href="https://github.com/kubeflow/katib/blob/master/examples/v1beta1/nas/darts-gpu.yaml"><code>darts-gpu.yaml</code></a>.</p>
</li>
</ul>
<p><a id="pbt"></a></p>
<h4 id="population-based-training-pbt">Population Based Training (PBT)</h4>
<p>The algorithm name in Katib is <code>pbt</code>.</p>
<p>Review the population based training <a href="https://arxiv.org/abs/1711.09846">paper</a> for more details about the algorithm.</p>
<p>The PBT service requires a Persistent Volume Claim with <a href="https://kubernetes.io/docs/concepts/storage/persistent-volumes/#access-modes">RWX access mode</a> to share resources between Suggestion and Trials. Currently, Katib Experiments should have <code>resumePolicy: FromVolume</code> to run the PBT algorithm. Learn more about resume policies in <a href="/docs/components/katib/resume-experiment/">this guide</a>.</p>
<p>Katib supports the following algorithm settings:</p>
<div class="table-responsive">
  <table class="table table-bordered">
    <thead class="thead-light">
      <tr>
        <th>Setting name</th>
        <th>Description</th>
        <th>Example</th>
      </tr>
    </thead>
    <tbody>
      <tr>
        <td>suggestion_trial_dir</td>
        <td>The location within the trial container where checkpoints are saved</td>
        <td><code>/var/log/katib/checkpoints/</code></td>
      </tr>
      <tr>
        <td>n_population</td>
        <td>Number of trial seeds per generation</td>
        <td>40</td>
      </tr>
      <tr>
        <td>resample_probability</td>
        <td>null (default): perturbs the hyperparameter by 0.8 or 1.2. 0-1: resamples the original distribution by the specified probability</td>
        <td>0.3</td>
      </tr>
      <tr>
        <td>truncation_threshold</td>
        <td>Exploit threshold for pruning low performing seeds</td>
        <td>0.4</td>
      </tr>
    </tbody>
  </table>
</div>
<p><a id="metrics-collector"></a></p>
<h3 id="metrics-collector">Metrics collector</h3>
<p>In the <code>metricsCollectorSpec</code> section of the YAML configuration file, you can
define how Katib should collect the metrics from each trial, such as the
accuracy and loss metrics.
Refer to the
<a href="https://github.com/kubeflow/katib/blob/master/pkg/apis/controller/common/v1beta1/common_types.go#L155-L225"><code>MetricsCollectorSpec</code> type</a></p>
<p>Your training code can record the metrics into <code>stdout</code> or into arbitrary output
files. Katib collects the metrics using a <em>sidecar</em> container. A sidecar is
a utility container that supports the main container in the Kubernetes Pod.</p>
<p>To define the metrics collector for your experiment:</p>
<ol>
<li>
<p>Specify the collector type in the <code>.collector.kind</code> field.
Katib&rsquo;s metrics collector supports the following collector types:</p>
<ul>
<li>
<p><code>StdOut</code>: Katib collects the metrics from the operating system&rsquo;s default
output location (<em>standard output</em>). This is the default metrics collector.</p>
</li>
<li>
<p><code>File</code>: Katib collects the metrics from an arbitrary file, which
you specify in the <code>.source.fileSystemPath.path</code> field. Training container
should log metrics to this file in <code>TEXT</code> or <code>JSON</code> format. If you select <code>JSON</code> format, metrics must be line-separated by <code>epoch</code> or <code>step</code> as follows, and the key for timestamp must be <code>timestamp</code>:</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-json" data-lang="json"><span class="line"><span class="cl"><span class="p">{</span><span class="nt">&#34;epoch&#34;</span><span class="p">:</span> <span class="mi">0</span><span class="p">,</span> <span class="nt">&#34;foo&#34;</span><span class="p">:</span> <span class="err">bar</span><span class="s2">&#34;, fizz&#34;</span><span class="p">:</span> <span class="err">buzz</span><span class="s2">&#34;, &#34;</span><span class="err">timestamp</span><span class="s2">&#34;: 1638422847.28721}
</span></span></span><span class="line"><span class="cl"><span class="s2">{&#34;</span><span class="err">epoch</span><span class="s2">&#34;: 1, &#34;</span><span class="err">foo</span><span class="s2">&#34;: bar&#34;</span><span class="p">,</span> <span class="err">fizz</span><span class="nt">&#34;: buzz&#34;</span><span class="p">,</span> <span class="nt">&#34;timestamp&#34;</span><span class="p">:</span> <span class="mf">1638422847.287801</span><span class="err"></span><span class="p">}</span>
</span></span><span class="line"><span class="cl"><span class="p">{</span><span class="nt">&#34;epoch&#34;</span><span class="p">:</span> <span class="mi">2</span><span class="p">,</span> <span class="nt">&#34;foo&#34;</span><span class="p">:</span> <span class="err">bar</span><span class="s2">&#34;, fizz&#34;</span><span class="p">:</span> <span class="err">buzz</span><span class="s2">&#34;, &#34;</span><span class="err">timestamp</span><span class="s2">&#34;: &#34;</span><span class="mi">2021-12-02</span><span class="err">T</span><span class="mi">14</span><span class="p">:</span><span class="mi">27</span><span class="p">:</span><span class="mf">50.000035161</span><span class="err">+</span><span class="mi">09</span><span class="p">:</span><span class="mi">00</span><span class="s2">&#34;}
</span></span></span><span class="line"><span class="cl"><span class="s2">{&#34;</span><span class="err">epoch</span><span class="s2">&#34;: 3, &#34;</span><span class="err">foo</span><span class="s2">&#34;: bar&#34;</span><span class="p">,</span> <span class="err">fizz</span><span class="nt">&#34;: buzz&#34;</span><span class="p">,</span> <span class="nt">&#34;timestamp&#34;</span><span class="p">:</span> <span class="s2">&#34;2021-12-02T14:27:50.000037459+09:00&#34;</span><span class="err"></span><span class="p">}</span>
</span></span><span class="line"><span class="cl"><span class="err"></span>
</span></span></code></pre></div><p>Check the file metrics collector example for <a href="https://github.com/kubeflow/katib/blob/master/examples/v1beta1/metrics-collector/file-metrics-collector.yaml#L13-L22"><code>TEXT</code></a> and <a href="https://github.com/kubeflow/katib/blob/master/examples/v1beta1/metrics-collector/file-metrics-collector-with-json-format.yaml#L13-L20"><code>JSON</code></a> format.
Also, the default file path is <code>/var/log/katib/metrics.log</code>, and the default file format is <code>TEXT</code>.</p>
</li>
<li>
<p><code>TensorFlowEvent</code>: Katib collects the metrics from a directory path
containing a <a href="https://www.tensorflow.org/api_docs/python/tf/compat/v1/Event">tf.Event</a>.
You should specify the path in the <code>.source.fileSystemPath.path</code> field.
Check the
<a href="https://github.com/kubeflow/katib/blob/master/examples/v1beta1/kubeflow-training-operator/tfjob-mnist-with-summaries.yaml#L16-L22">TFJob example</a>.
The default directory path is <code>/var/log/katib/tfevent/</code>.</p>
</li>
<li>
<p><code>Custom</code>: Specify this value if you need to use a custom way to collect
metrics. You must define your custom metrics collector container
in the <code>.collector.customCollector</code> field.
Check the
<a href="https://github.com/kubeflow/katib/blob/master/examples/v1beta1/metrics-collector/custom-metrics-collector.yaml#L13-L35">custom metrics collector example</a>.</p>
</li>
<li>
<p><code>None</code>: Specify this value if you don&rsquo;t need to use Katib&rsquo;s metrics
collector. For example, your training code may handle the persistent
storage of its own metrics.</p>
</li>
</ul>
</li>
<li>
<p>Write code in your training container to print or save to the file metrics in the format
specified in the <code>.source.filter.metricsFormat</code>
field. The default format is <code>([\w|-]+)\s*=\s*([+-]?\d*(\.\d+)?([Ee][+-]?\d+)?)</code>.
Each element is a regular expression with two subexpressions. The first
matched expression is taken as the metric name. The second matched
expression is taken as the metric value.</p>
<p>For example, using the default metrics format and <code>StdOut</code> metrics collector,
if the name of your objective metric is <code>loss</code> and the additional metrics are
<code>recall</code> and <code>precision</code>, your training code should print the following output:</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-shell" data-lang="shell"><span class="line"><span class="cl">epoch 1:
</span></span><span class="line"><span class="cl"><span class="nv">loss</span><span class="o">=</span>3.0e-02
</span></span><span class="line"><span class="cl"><span class="nv">recall</span><span class="o">=</span>0.5
</span></span><span class="line"><span class="cl"><span class="nv">precision</span><span class="o">=</span>.4
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">epoch 2:
</span></span><span class="line"><span class="cl"><span class="nv">loss</span><span class="o">=</span>1.3e-02
</span></span><span class="line"><span class="cl"><span class="nv">recall</span><span class="o">=</span>0.55
</span></span><span class="line"><span class="cl"><span class="nv">precision</span><span class="o">=</span>.5
</span></span></code></pre></div></li>
</ol>
<h2 id="running-the-experiment">Running the experiment</h2>
<p>You can run a Katib experiment from the command line or from the Katib UI.</p>
<h3 id="running-the-experiment-from-the-command-line">Running the experiment from the command line</h3>
<p>You can use <a href="https://kubernetes.io/docs/reference/kubectl/overview/">kubectl</a>
to launch an experiment from the command line:</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-shell" data-lang="shell"><span class="line"><span class="cl">kubectl apply -f &lt;your-path/your-experiment-config.yaml&gt;
</span></span></code></pre></div><p><strong>Note:</strong></p>
<ul>
<li>
<p>If you deployed Katib as part of Kubeflow (your Kubeflow deployment
should include Katib), you need to change Kubeflow namespace to your
profile namespace.</p>
</li>
<li>
<p>(Optional) Katib&rsquo;s experiments don&rsquo;t work with
<a href="https://istio.io/latest/docs/setup/additional-setup/sidecar-injection/#automatic-sidecar-injection">Istio sidecar injection</a>.
If you are running Kubeflow using Istio, you have to disable sidecar injection. To do that, specify this annotation:
<code>sidecar.istio.io/inject: &quot;false&quot;</code> in your experiment&rsquo;s trial template. For
examples on how to do it for <code>Job</code>, <code>TFJob</code> (TensorFlow) or
<code>PyTorchJob</code> (PyTorch), refer to the
<a href="/docs/components/katib/hyperparameter/#examples">getting-started guide</a>.</p>
</li>
</ul>
<p>Run the following command to launch an experiment
using the random search algorithm example:</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-shell" data-lang="shell"><span class="line"><span class="cl">kubectl apply -f https://raw.githubusercontent.com/kubeflow/katib/master/examples/v1beta1/hp-tuning/random.yaml
</span></span></code></pre></div><p>Check the experiment status:</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-shell" data-lang="shell"><span class="line"><span class="cl">kubectl -n kubeflow describe experiment &lt;your-experiment-name&gt;
</span></span></code></pre></div><p>For example, to check the status of the random search algorithm experiment run:</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-shell" data-lang="shell"><span class="line"><span class="cl">kubectl -n kubeflow describe experiment random
</span></span></code></pre></div><h3 id="running-the-experiment-from-the-katib-ui">Running the experiment from the Katib UI</h3>
<p>Instead of using the command line, you can submit an experiment from the Katib
UI. The following steps assume you want to run a hyperparameter tuning
experiment. If you want to run a neural architecture search, access the <strong>NAS</strong>
section of the UI (instead of the <strong>HP</strong> section) and then follow a similar
sequence of steps.</p>
<p>To run a hyperparameter tuning experiment from the Katib UI:</p>
<ol>
<li>
<p>Follow the getting-started guide to
<a href="/docs/components/katib/hyperparameter/#katib-ui">access the Katib UI</a>.</p>
</li>
<li>
<p>Click <strong>NEW EXPERIMENT</strong> on the Katib home page.</p>
</li>
<li>
<p>You should be able to view tabs offering you the following options:</p>
<ul>
<li>
<p><strong>YAML file:</strong> Choose this option to supply an entire YAML file containing
the configuration for the experiment.</p>
<p><img src="/docs/components/katib/images/deploy-yaml.png"
alt="UI tab to paste a YAML configuration file"
class="mt-3 mb-3 border border-info rounded"></p>
</li>
<li>
<p><strong>Parameters:</strong> Choose this option to enter the configuration values
into a form.</p>
<p><img src="/docs/components/katib/images/deploy-parameters.png"
alt="UI form to deploy a Katib experiment"
class="mt-3 mb-3 border border-info rounded"></p>
</li>
</ul>
</li>
</ol>
<p>View the results of the experiment in the Katib UI:</p>
<ol>
<li>
<p>You should be able to view the list of experiments:</p>
<p><img src="/docs/components/katib/images/experiment-list.png"
alt="The random example in the list of Katib experiments"
class="mt-3 mb-3 border border-info rounded"></p>
</li>
<li>
<p>Click the name of your experiment. For example, click <strong>random-example</strong>.</p>
</li>
<li>
<p>There should be a graph showing the level of validation and train accuracy
for various combinations of the hyperparameter values (learning rate, number
of layers, and optimizer):</p>
<p><img src="/docs/components/katib/images/random-example-graph.png"
alt="Graph produced by the random example"
class="mt-3 mb-3 border border-info rounded"></p>
</li>
<li>
<p>Below the graph is a list of trials that ran within the experiment:</p>
<p><img src="/docs/components/katib/images/random-example-trials.png"
alt="Trials that ran during the experiment"
class="mt-3 mb-3 border border-info rounded"></p>
</li>
<li>
<p>You can click on trial name to get metrics for the particular trial:</p>
<p><img src="/docs/components/katib/images/random-example-trial-info.png"
alt="Trials that ran during the experiment"
class="mt-3 mb-3 border border-info rounded"></p>
</li>
</ol>
<h2 id="next-steps">Next steps</h2>
<ul>
<li>
<p>Learn how to run the
<a href="/docs/components/katib/hyperparameter/#random-search">random search algorithm and other Katib examples</a>.</p>
</li>
<li>
<p>How to
<a href="/docs/components/katib/resume-experiment/">restart your experiment and use the resume policies</a>.</p>
</li>
<li>
<p>Learn to configure your
<a href="/docs/components/katib/trial-template/">trial templates</a>.</p>
</li>
<li>
<p>For an overview of the concepts involved in hyperparameter tuning and
neural architecture search, check the
<a href="/docs/components/katib/overview/">introduction to Katib</a>.</p>
</li>
<li>
<p>Boost your hyperparameter tuning experiment with
the <a href="/docs/components/katib/early-stopping/">early stopping guide</a></p>
</li>
<li>
<p>Check the
<a href="/docs/components/katib/katib-config/">Katib Configuration (Katib config)</a>.</p>
</li>
<li>
<p>How to <a href="/docs/components/katib/env-variables/">set up environment variables</a>
for each Katib component.</p>
</li>
</ul>

</div>



    
	
  
    
    
	
    

<div class="td-content" style="page-break-before: always">
    
	<h1 id="pg-bfd3194b361e71038ee054637a0a8043">4.4 - Resuming an Experiment</h1>
    <div class="lead">How to restart and modify running experiments</div>
	<p>This guide describes how to modify running experiments
and restart completed experiments. You will learn
about changing the experiment execution process and use various
resume policies for the Katib experiment.</p>
<p>For the details on how to configure and run your experiment, follow the
<a href="/docs/components/katib/experiment/">running an experiment guide</a>.</p>
<a id="modify-experiment">
<h2 id="modify-running-experiment">Modify running experiment</h2>
<p>While the experiment is running you are able to change trial count parameters.
For example, you can decrease the maximum number of
hyperparameter sets that are trained in parallel.</p>
<p>You can change only <strong><code>parallelTrialCount</code></strong>, <strong><code>maxTrialCount</code></strong> and <strong><code>maxFailedTrialCount</code></strong>
experiment parameters.</p>
<p>Use Kubernetes API or <code>kubectl</code>
<a href="https://kubernetes.io/docs/concepts/cluster-administration/manage-deployment/#in-place-updates-of-resources">in-place update of resources</a>
to make experiment changes. For example, run:</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-fallback" data-lang="fallback"><span class="line"><span class="cl">kubectl edit experiment &lt;experiment-name&gt; -n &lt;experiment-namespace&gt;
</span></span></code></pre></div><p>Make appropriate changes and save it. Controller automatically processes
the new parameters and makes necessary changes.</p>
<ul>
<li>
<p>If you want to increase or decrease parallel trial execution,
modify <code>parallelTrialCount</code>. Controller accordingly creates or
deletes trials in line with the <code>parallelTrialCount</code> value.</p>
</li>
<li>
<p>If you want to increase or decrease maximum trial count,
modify <code>maxTrialCount</code>. <code>maxTrialCount</code> should be greater than current
count of <code>Succeeded</code> trials. You can remove the <code>maxTrialCount</code> parameter,
if your experiment should run endless with <code>parallelTrialCount</code> of parallel
trials until the experiment reaches <code>Goal</code> or <code>maxFailedTrialCount</code></p>
</li>
<li>
<p>If you want to increase or decrease maximum failed trial count,
modify <code>maxFailedTrialCount</code>. You can remove the <code>maxFailedTrialCount</code>
parameter, if the experiment should not reach <code>Failed</code> status.</p>
</li>
</ul>
<h2 id="resume-succeeded-experiment">Resume succeeded experiment</h2>
<p>Katib experiment is restartable only if it is in <strong><code>Succeeded</code></strong> status because
<code>maxTrialCount</code> has been reached. To check current experiment status run:
<code>kubectl get experiment &lt;experiment-name&gt; -n &lt;experiment-namespace&gt;</code>.</p>
<p>To restart an experiment, you are able to change only <strong><code>parallelTrialCount</code></strong>,
<strong><code>maxTrialCount</code></strong> and <strong><code>maxFailedTrialCount</code></strong>
as described <a href="#modify-experiment">above</a></p>
<p>To control various resume policies, you can specify <code>.spec.resumePolicy</code>
for the experiment.
Refer to the
<a href="https://github.com/kubeflow/katib/blob/master/pkg/apis/controller/experiments/v1beta1/experiment_types.go#L58"><code>ResumePolicy</code> type</a>.</p>
<h3 id="resume-policy-never">Resume policy: Never</h3>
<p>Use this policy if your experiment should not be resumed at any time.
After the experiment has finished,
the suggestion&rsquo;s <a href="https://kubernetes.io/docs/concepts/workloads/controllers/deployment/">Deployment</a>
and <a href="https://kubernetes.io/docs/concepts/services-networking/service/">Service</a>
are deleted and you can&rsquo;t restart the experiment.
Learn more about Katib concepts
in the <a href="/docs/components/katib/overview/#katib-concepts">overview guide</a>.</p>
<p>Check the
<a href="https://github.com/kubeflow/katib/blob/master/examples/v1beta1/resume-experiment/never-resume.yaml#L18"><code>never-resume.yaml</code></a>
example for more details.</p>
<h3 id="resume-policy-longrunning">Resume policy: LongRunning</h3>
<p>Use this policy if you intend to restart the experiment.
After the experiment has finished, the suggestion&rsquo;s Deployment and Service stay
running. Modify experiment&rsquo;s trial count parameters to restart the experiment.</p>
<p>When you delete the experiment, the suggestion&rsquo;s Deployment and
Service are deleted.</p>
<p>This is the default policy for all Katib experiments.
You can omit <code>.spec.resumePolicy</code> parameter for that functionality.</p>
<h3 id="resume-policy-fromvolume">Resume policy: FromVolume</h3>
<p>Use this policy if you intend to restart the experiment.
In that case, <a href="https://kubernetes.io/docs/concepts/storage/volumes/">volume</a>
is attached to the suggestion&rsquo;s Deployment.</p>
<p>Katib controller creates
<a href="https://kubernetes.io/docs/concepts/storage/persistent-volumes/#persistentvolumeclaims">PersistentVolumeClaim (PVC)</a>
in addition to the suggestion&rsquo;s Deployment and Service.</p>
<p><strong>Note:</strong> Your Kubernetes cluster must have <code>StorageClass</code> for
<a href="https://kubernetes.io/docs/concepts/storage/dynamic-provisioning/">dynamic volume provisioning</a>
to automatically provision storage for the created PVC. Otherwise, you have to define
suggestion&rsquo;s <a href="https://kubernetes.io/docs/concepts/storage/persistent-volumes/#persistent-volumes">PersistentVolume (PV)</a>
specification in the Katib configuration settings and Katib controller will create PVC and PV.
Follow the <a href="/docs/components/katib/katib-config/#suggestion-volume-settings">Katib configuration guide</a>
to set up the suggestion&rsquo;s volume settings.</p>
<ul>
<li>
<p>PVC is deployed with the name: <code>&lt;suggestion-name&gt;-&lt;suggestion-algorithm&gt;</code>
in the suggestion namespace.</p>
</li>
<li>
<p>PV is deployed with the name:
<code>&lt;suggestion-name&gt;-&lt;suggestion-algorithm&gt;-&lt;suggestion-namespace&gt;</code></p>
</li>
</ul>
<p>After the experiment has finished, the suggestion&rsquo;s Deployment and
Service are deleted. Suggestion data can be retained in the volume.
When you restart the experiment, the suggestion&rsquo;s Deployment and Service
are created and suggestion statistics can be recovered from the volume.</p>
<p>When you delete the experiment, the suggestion&rsquo;s Deployment, Service,
PVC and PV are deleted automatically.</p>
<p>Check the
<a href="https://github.com/kubeflow/katib/blob/master/examples/v1beta1/resume-experiment/from-volume-resume.yaml#L18"><code>from-volume-resume.yaml</code></a>
example for more details.</p>
<h2 id="next-steps">Next steps</h2>
<ul>
<li>
<p>Learn how to
<a href="/docs/components/katib/experiment/">configure and run your Katib experiments</a>.</p>
</li>
<li>
<p>Check the
<a href="/docs/components/katib/katib-config/">Katib Configuration (Katib config)</a>.</p>
</li>
<li>
<p>How to <a href="/docs/components/katib/env-variables/">set up environment variables</a>
for each Katib component.</p>
</li>
</ul>

</div>



    
	
  
    
    
	
    

<div class="td-content" style="page-break-before: always">
    
	<h1 id="pg-ae840460e289e0593ca27a1274d3e948">4.5 - Overview of Trial Templates</h1>
    <div class="lead">How to specify trial template parameters and support a custom resource (CRD) in Katib</div>
	<p>This guide describes how to configure trial template parameters and use custom
<a href="https://kubernetes.io/docs/concepts/extend-kubernetes/api-extension/custom-resources/">Kubernetes CRD</a>
in Katib. You will learn about changing trial template specification, how to use
<a href="https://kubernetes.io/docs/concepts/configuration/configmap/">Kubernetes ConfigMaps</a>
to store templates and how to modify Katib controller to support your
Kubernetes CRD in Katib experiments.</p>
<p>Katib has these CRD examples in upstream:</p>
<ul>
<li>
<p><a href="https://kubernetes.io/docs/concepts/workloads/controllers/job/">Kubernetes <code>Job</code></a></p>
</li>
<li>
<p><a href="/docs/components/training/tftraining/">Kubeflow <code>TFJob</code></a></p>
</li>
<li>
<p><a href="/docs/components/training/pytorch/">Kubeflow <code>PyTorchJob</code></a></p>
</li>
<li>
<p><a href="/docs/components/training/mxnet">Kubeflow <code>MXJob</code></a></p>
</li>
<li>
<p><a href="/docs/components/training/xgboost">Kubeflow <code>XGBoostJob</code></a></p>
</li>
<li>
<p><a href="/docs/components/training/mpi">Kubeflow <code>MPIJob</code></a></p>
</li>
<li>
<p><a href="https://github.com/kubeflow/katib/tree/master/examples/v1beta1/tekton">Tekton <code>Pipelines</code></a></p>
</li>
<li>
<p><a href="https://github.com/kubeflow/katib/tree/master/examples/v1beta1/argo">Argo <code>Workflows</code></a></p>
</li>
</ul>
<p>To use your own Kubernetes resource follow the steps <a href="#custom-resource">below</a>.</p>
<p>For the details on how to configure and run your experiment, follow the
<a href="/docs/components/katib/experiment/">running an experiment guide</a>.</p>
<h2 id="use-trial-template-to-submit-experiment">Use trial template to submit experiment</h2>
<p>To run the Katib experiment you have to specify a trial template for your
worker job where actual training is running. Learn more about Katib concepts
in the <a href="/docs/components/katib/overview/#trial">overview guide</a>.</p>
<h3 id="configure-trial-template-specification">Configure trial template specification</h3>
<p>Trial template specification is located under <code>.spec.trialTemplate</code> of your experiment.
For the API overview refer to the
<a href="https://github.com/kubeflow/katib/blob/master/pkg/apis/controller/experiments/v1beta1/experiment_types.go#L208-L270"><code>TrialTemplate</code> type</a>.</p>
<p>To define experiment&rsquo;s trial, you should specify these parameters in <code>.spec.trialTemplate</code>:</p>
<ul>
<li>
<p><code>trialParameters</code> - list of the parameters which are used in the trial template
during experiment execution.</p>
<p><strong>Note:</strong> Your trial template must contain each parameter from the
<code>trialParameters</code>. You can set these parameters in any field of your template,
except <code>.metadata.name</code> and <code>.metadata.namespace</code>.
Check <a href="#template-metadata">below</a> how you can use trial <code>metadata</code> parameters
in your template. For example, your training container can receive
hyperparameters as command-line or arguments or as environment variables.</p>
<p>Your experiment&rsquo;s suggestion produces <code>trialParameters</code> before running the trial.
Each <code>trialParameter</code> has these structure:</p>
<ul>
<li>
<p><code>name</code> - the parameter name that is replaced in your template.</p>
</li>
<li>
<p><code>description</code> (optional) - the description of the parameter.</p>
</li>
<li>
<p><code>reference</code> - the parameter name that experiment&rsquo;s suggestion returns.
Usually, for the hyperparameter tuning parameter references are equal to the
experiment search space. For example, in grid example search space has
<a href="https://github.com/kubeflow/katib/blob/master/examples/v1beta1/hp-tuning/grid.yaml#L18-L36">three parameters</a>
(<code>lr</code>, <code>num-layers</code> and <code>optimizer</code>) and <code>trialParameters</code> contains each of
these parameters in
<a href="https://github.com/kubeflow/katib/blob/master/examples/v1beta1/hp-tuning/grid.yaml#L39-L48"><code>reference</code></a>.</p>
</li>
</ul>
</li>
<li>
<p>You have to define your experiment&rsquo;s trial template in <strong>one</strong> of the <code>trialSpec</code>
or <code>configMap</code> sources.</p>
<p><strong>Note:</strong> Your template must omit <code>.metadata.name</code> and <code>.metadata.namespace</code>.</p>
<p>To set the parameters from the <code>trialParameters</code>, you need to use this
expression: <code>${trialParameters.&lt;parameter-name&gt;}</code> in your template.
Katib automatically replaces it with the appropriate values from the
experiment&rsquo;s suggestion.</p>
<p>For example,
<a href="https://github.com/kubeflow/katib/blob/master/examples/v1beta1/hp-tuning/grid.yaml#L62"><code>--lr=${trialParameters.learningRate}</code></a>
is the <a href="https://github.com/kubeflow/katib/blob/master/examples/v1beta1/hp-tuning/grid.yaml#L40"><code>learningRate</code></a>
parameter.</p>
<ul>
<li>
<p><code>trialSpec</code> - the experiment&rsquo;s trial template in
<a href="https://godoc.org/k8s.io/apimachinery/pkg/apis/meta/v1/unstructured">unstructured</a>
format. The template should be a valid YAML. Check the
<a href="https://github.com/kubeflow/katib/blob/master/examples/v1beta1/hp-tuning/grid.yaml#L49-L65">grid example</a>.</p>
</li>
<li>
<p><code>configMap</code> - Kubernetes ConfigMap specification where the experiment&rsquo;s
trial template is located. This ConfigMap must have the label
<code>katib.kubeflow.org/component: trial-templates</code> and contains key-value pairs, where
<code>key: &lt;template-name&gt;, value: &lt;template-yaml&gt;</code>. Check the example of the
<a href="https://github.com/kubeflow/katib/blob/master/manifests/v1beta1/components/controller/trial-templates.yaml">ConfigMap with trial templates</a>.</p>
<p>The <code>configMap</code> specification should have:</p>
<ol>
<li>
<p><code>configMapName</code> - the ConfigMap name with the trial templates.</p>
</li>
<li>
<p><code>configMapNamespace</code> - the ConfigMap namespace with the trial templates.</p>
</li>
<li>
<p><code>templatePath</code> - the ConfigMap&rsquo;s data path to the template.</p>
</li>
</ol>
<p>Check the example with
<a href="https://github.com/kubeflow/katib/blob/master/examples/v1beta1/trial-template/trial-configmap-source.yaml#L50-L53">ConfigMap source</a>
for the trial template.</p>
</li>
</ul>
</li>
</ul>
<p><code>.spec.trialTemplate</code> parameters below are used to control trial behavior.
If parameter has the default value, it can be <strong>omitted</strong> in the experiment YAML.</p>
<ul>
<li>
<p><code>retain</code> - indicates that trial&rsquo;s resources are not clean-up after the trial
is complete. Check the example with
<a href="https://github.com/kubeflow/katib/blob/master/examples/v1beta1/tekton/pipeline-run.yaml#L32"><code>retain: true</code></a>
parameter.</p>
<p>The default value is <code>false</code></p>
</li>
<li>
<p><code>primaryPodLabels</code> - the
<a href="/docs/components/katib/overview/#worker-job">trial worker&rsquo;s</a> Pod or Pods
labels. These Pods are injected by Katib metrics collector.</p>
<p><strong>Note:</strong> If <code>primaryPodLabels</code> is <strong>omitted</strong>, the metrics collector wraps
all worker&rsquo;s Pods. Learn more about Katib metrics collector in
<a href="/docs/components/katib/experiment/#metrics-collector">running an experiment guide</a>.
Check the example with
<a href="https://github.com/kubeflow/katib/blob/master/examples/v1beta1/kubeflow-training-operator/mpijob-horovod.yaml#L29-L30"><code>primaryPodLabels</code></a>.</p>
<p>The default value for Kubeflow <code>TFJob</code>, <code>PyTorchJob</code>, <code>MXJob</code>, and <code>XGBoostJob</code> is <code>job-role: master</code></p>
<p>The <code>primaryPodLabels</code> default value works only if you specify your template
in <code>.spec.trialTemplate.trialSpec</code>. For the <code>configMap</code> template source you
have to manually set <code>primaryPodLabels</code>.</p>
</li>
<li>
<p><code>primaryContainerName</code> - the training container name where actual
model training is running. Katib metrics collector wraps this container
to collect required metrics for the single experiment optimization step.</p>
</li>
<li>
<p><code>successCondition</code> - The trial worker&rsquo;s object
<a href="https://kubernetes.io/docs/concepts/overview/working-with-objects/kubernetes-objects/#object-spec-and-status">status</a>
in which trial&rsquo;s job has succeeded. This condition must be in
<a href="https://github.com/tidwall/gjson">GJSON format</a>. Check the example with
<a href="https://github.com/kubeflow/katib/blob/master/examples/v1beta1/tekton/pipeline-run.yaml#L36"><code>successCondition</code></a>.</p>
<p>The default value for Kubernetes <code>Job</code> is
<code>status.conditions.#(type==&quot;Complete&quot;)#|#(status==&quot;True&quot;)#</code></p>
<p>The default value for Kubeflow <code>TFJob</code>, <code>PyTorchJob</code>, <code>MXJob</code>, and <code>XGBoostJob</code> is
<code>status.conditions.#(type==&quot;Succeeded&quot;)#|#(status==&quot;True&quot;)#</code></p>
<p>The <code>successCondition</code> default value works only if you specify your template
in <code>.spec.trialTemplate.trialSpec</code>. For the <code>configMap</code> template source
you have to manually set <code>successCondition</code>.</p>
</li>
<li>
<p><code>failureCondition</code> - The trial worker&rsquo;s object
<a href="https://kubernetes.io/docs/concepts/overview/working-with-objects/kubernetes-objects/#object-spec-and-status">status</a>
in which trial&rsquo;s job has failed. This condition must be in
<a href="https://github.com/tidwall/gjson">GJSON format</a>. Check the example with
<a href="https://github.com/kubeflow/katib/blob/master/examples/v1beta1/tekton/pipeline-run.yaml#L37"><code>failureCondition</code></a>.</p>
<p>The default value for Kubernetes <code>Job</code> is
<code>status.conditions.#(type==&quot;Failed&quot;)#|#(status==&quot;True&quot;)#</code></p>
<p>The default value for Kubeflow <code>TFJob</code>, <code>PyTorchJob</code>, <code>MXJob</code>, and <code>XGBoostJob</code> is
<code>status.conditions.#(type==&quot;Failed&quot;)#|#(status==&quot;True&quot;)#</code></p>
<p>The <code>failureCondition</code> default value works only if you specify your template
in <code>.spec.trialTemplate.trialSpec</code>. For the <code>configMap</code> template source you
have to manually set <code>failureCondition</code>.</p>
</li>
</ul>
<p><a id="template-metadata"></a></p>
<h3 id="use-trial-metadata-in-template">Use trial metadata in template</h3>
<p>You can&rsquo;t specify <code>.metadata.name</code> and <code>.metadata.namespace</code> in your
trial template, but you can get this data during the experiment run.
For example, if you want to append the trial&rsquo;s name to your model storage.</p>
<p>To do this, point <code>.trialParameters[x].reference</code> to the
appropriate metadata parameter and use <code>.trialParameters[x].name</code>
in your trial template.</p>
<p>The table below shows the connection between
<code>.trialParameters[x].reference</code> value and trial metadata.</p>
<div class="table-responsive">
  <table class="table table-bordered">
    <thead class="thead-light">
      <tr>
        <th>Reference</th>
        <th>Trial metadata</th>
      </tr>
    </thead>
    <tbody>
      <tr>
        <td><code>${trialSpec.Name}</code></td>
        <td>Trial name</td>
      </tr>
      <tr>
        <td><code>${trialSpec.Namespace}</code></td>
        <td>Trial namespace</td>
      </tr>
      <tr>
        <td><code>${trialSpec.Kind}</code></td>
        <td>Kubernetes resource kind for the trial's worker</td>
      </tr>
      <tr>
        <td><code>${trialSpec.APIVersion}</code></td>
        <td>Kubernetes resource APIVersion for the trial's worker</td>
      </tr>
      <tr>
        <td><code>${trialSpec.Labels[custom-key]}</code></td>
        <td>Trial's worker label with <code>custom-key</code> key </td>
      </tr>
      <tr>
        <td><code>${trialSpec.Annotations[custom-key]}</code></td>
        <td>Trial's worker annotation with <code>custom-key</code> key </td>
      </tr>
    </tbody>
  </table>
</div>
<p>Check the example of
<a href="https://github.com/kubeflow/katib/blob/master/examples/v1beta1/trial-template/trial-metadata-substitution.yaml">using trial metadata</a>.</p>
<p><a id="custom-resource"></a></p>
<h2 id="use-custom-kubernetes-resource-as-a-trial-template">Use custom Kubernetes resource as a trial template</h2>
<p>In Katib examples you can find the following trial worker types:
<a href="https://github.com/kubeflow/katib/blob/master/examples/v1beta1/hp-tuning/random.yaml">Kubernetes <code>Job</code></a>,
<a href="https://github.com/kubeflow/katib/blob/master/examples/v1beta1/kubeflow-training-operator/tfjob-mnist-with-summaries.yaml">Kubeflow <code>TFJob</code></a>,
<a href="https://github.com/kubeflow/katib/blob/master/examples/v1beta1/kubeflow-training-operator/pytorchjob-mnist.yaml">Kubeflow <code>PyTorchJob</code></a>,
<a href="https://github.com/kubeflow/katib/blob/master/examples/v1beta1/kubeflow-training-operator/mxjob-byteps.yaml">Kubeflow <code>MXJob</code></a>,
<a href="https://github.com/kubeflow/katib/blob/master/examples/v1beta1/kubeflow-training-operator/xgboostjob-lightgbm.yaml">Kubeflow <code>XGBoostJob</code></a>,
<a href="https://github.com/kubeflow/katib/blob/master/examples/v1beta1/kubeflow-training-operator/mpijob-horovod.yaml">Kubeflow <code>MPIJob</code></a>,
<a href="https://github.com/kubeflow/katib/tree/master/examples/v1beta1/tekton">Tekton <code>Pipelines</code></a>,
and <a href="https://github.com/kubeflow/katib/tree/master/examples/v1beta1/argo">Argo <code>Workflows</code></a>.</p>
<p>It is possible to use your own Kubernetes CRD or other Kubernetes resource
(e.g. <a href="https://kubernetes.io/docs/concepts/workloads/controllers/deployment/">Kubernetes <code>Deployment</code></a>)
as a trial worker without modifying Katib controller source code and building
the new image. As long as your CRD creates Kubernetes Pods, allows to inject
the <a href="https://kubernetes.io/docs/concepts/workloads/pods/">sidecar container</a> on
these Pods and has succeeded and failed status, you can use it in Katib.</p>
<p>To do that, you need to modify Katib components before installing it on your
Kubernetes cluster. Accordingly, you have to know your CRD API group and version,
the CRD object&rsquo;s kind. Also, you need to know which resources your custom object
is created. Check the
<a href="https://kubernetes.io/docs/tasks/extend-kubernetes/custom-resources/custom-resource-definitions/">Kubernetes guide</a>
to know more about CRDs.</p>
<p>Follow these two simple steps to integrate your custom CRD in Katib:</p>
<ol>
<li>
<p>Modify Katib controller
<a href="https://github.com/kubeflow/katib/blob/master/manifests/v1beta1/components/controller/rbac.yaml#L5">ClusterRole&rsquo;s rules</a>
with the new rule to give Katib access to all resources that are created
by the trial. To know more about ClusterRole, check
<a href="https://kubernetes.io/docs/reference/access-authn-authz/rbac/#role-and-clusterrole">Kubernetes guide</a>.</p>
<p>In case of Tekton <code>Pipelines</code>, trial creates Tekton <code>PipelineRun</code>, then
Tekton <code>PipelineRun</code> creates Tekton <code>TaskRun</code>. Therefore, Katib controller
ClusterRole should have access to the <code>pipelineruns</code> and <code>taskruns</code>:</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-yaml" data-lang="yaml"><span class="line"><span class="cl">- <span class="nt">apiGroups</span><span class="p">:</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span>- <span class="l">tekton.dev</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">  </span><span class="nt">resources</span><span class="p">:</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span>- <span class="l">pipelineruns</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span>- <span class="l">taskruns</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">  </span><span class="nt">verbs</span><span class="p">:</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span>- <span class="s2">&#34;*&#34;</span><span class="w">
</span></span></span></code></pre></div></li>
<li>
<p>Modify Katib controller
<a href="https://github.com/kubeflow/katib/blob/master/manifests/v1beta1/components/controller/controller.yaml#L27">Deployment&rsquo;s <code>args</code></a>
with the new flag:
<code>--trial-resources=&lt;object-kind&gt;.&lt;object-API-version&gt;.&lt;object-API-group&gt;</code>.</p>
<p>For example, to support Tekton <code>Pipelines</code>:</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-yaml" data-lang="yaml"><span class="line"><span class="cl">- <span class="s2">&#34;--trial-resources=PipelineRun.v1beta1.tekton.dev&#34;</span><span class="w">
</span></span></span></code></pre></div></li>
</ol>
<p>After these changes, deploy Katib as described in the
<a href="/docs/components/katib/hyperparameter/#installing-katib">getting started guide</a>
and wait until the <code>katib-controller</code> Pod is created.
You can check logs from the Katib controller to verify your resource integration:</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-shell" data-lang="shell"><span class="line"><span class="cl">$ kubectl logs <span class="k">$(</span>kubectl get pods -n kubeflow -o name <span class="p">|</span> grep katib-controller<span class="k">)</span> -n kubeflow <span class="p">|</span> grep <span class="s1">&#39;&#34;CRD Kind&#34;:&#34;PipelineRun&#34;&#39;</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="o">{</span><span class="s2">&#34;level&#34;</span>:<span class="s2">&#34;info&#34;</span>,<span class="s2">&#34;ts&#34;</span>:1628032648.6285546,<span class="s2">&#34;logger&#34;</span>:<span class="s2">&#34;trial-controller&#34;</span>,<span class="s2">&#34;msg&#34;</span>:<span class="s2">&#34;Job watch added successfully&#34;</span>,<span class="s2">&#34;CRD Group&#34;</span>:<span class="s2">&#34;tekton.dev&#34;</span>,<span class="s2">&#34;CRD Version&#34;</span>:<span class="s2">&#34;v1beta1&#34;</span>,<span class="s2">&#34;CRD Kind&#34;</span>:<span class="s2">&#34;PipelineRun&#34;</span><span class="o">}</span>
</span></span></code></pre></div><p>If you ran the above steps successfully, you should be able to use your custom
object YAML in the experiment&rsquo;s trial template source spec.</p>
<p>We appreciate your feedback on using various CRDs in Katib.
It would be great, if you let us know about your experiments.
The <a href="https://github.com/kubeflow/katib/blob/master/docs/developer-guide.md">developer guide</a>
is a good starting point to know how to contribute to the project.</p>
<h2 id="next-steps">Next steps</h2>
<ul>
<li>
<p>Learn how to
<a href="/docs/components/katib/experiment/">configure and run your Katib experiments</a>.</p>
</li>
<li>
<p>Check the
<a href="/docs/components/katib/katib-config/">Katib Configuration (Katib config)</a>.</p>
</li>
<li>
<p>How to <a href="/docs/components/katib/env-variables/">set up environment variables</a>
for each Katib component.</p>
</li>
</ul>

</div>



    
	
  
    
    
	
    

<div class="td-content" style="page-break-before: always">
    
	<h1 id="pg-b80a2e37cea35fb836557e60f56f4ce2">4.6 - Using Early Stopping</h1>
    <div class="lead">How to use early stopping in Katib experiments</div>
	<p>This guide shows how you can use
<a href="https://en.wikipedia.org/wiki/Early_stopping">early stopping</a> to improve your
Katib experiments. Early stopping allows you to avoid overfitting when you
train your model during Katib experiments. It also helps by saving computing
resources and reducing experiment execution time by stopping the experiment&rsquo;s
trials when the target metric(s) no longer improves before the training process
is complete.</p>
<p>The major advantage of using early stopping in Katib is that you don&rsquo;t
need to modify your
<a href="/docs/components/katib/experiment/#packaging-your-training-code-in-a-container-image">training container package</a>.
All you have to do is make necessary changes in your experiment&rsquo;s YAML file.</p>
<p>Early stopping works in the same way as Katib&rsquo;s
<a href="/docs/components/katib/experiment/#metrics-collector">metrics collector</a>.
It analyses required metrics from the <code>stdout</code> or from the arbitrary output file
and an early stopping algorithm makes the decision if the trial needs to be
stopped. Currently, early stopping works only with
<code>StdOut</code> or <code>File</code> metrics collectors.</p>
<p><strong>Note</strong>: Your training container must print training logs with the timestamp,
because early stopping algorithms need to know the sequence of reported metrics.
Check the
<a href="https://github.com/kubeflow/katib/blob/master/examples/v1beta1/trial-images/mxnet-mnist/mnist.py#L36"><code>MXNet</code> example</a>
to learn how to add a date format to your logs.</p>
<h2 id="configure-the-experiment-with-early-stopping">Configure the experiment with early stopping</h2>
<p>As a reference, you can use the YAML file of the
<a href="https://github.com/kubeflow/katib/blob/master/examples/v1beta1/early-stopping/median-stop.yaml">early stopping example</a>.</p>
<ol>
<li>
<p>Follow the
<a href="/docs/components/katib/experiment/#configuring-the-experiment">guide</a>
to configure your Katib experiment.</p>
</li>
<li>
<p>Next, to apply early stopping for your experiment, specify the <code>.spec.earlyStopping</code>
parameter, similar to the <code>.spec.algorithm</code>. Refer to the
<a href="https://github.com/kubeflow/katib/blob/master/pkg/apis/controller/common/v1beta1/common_types.go#L41-L58"><code>EarlyStoppingSpec</code> type</a>
for more information.</p>
<ul>
<li>
<p><code>.earlyStopping.algorithmName</code> - the name of the early stopping algorithm.</p>
</li>
<li>
<p><code>.earlyStopping.algorithmSettings</code>- the settings for the early stopping algorithm.</p>
</li>
</ul>
</li>
</ol>
<p>What happens is your experiment&rsquo;s suggestion produces new trials. After that,
the early stopping algorithm generates early stopping rules for the created
trials. Once the trial reaches all the rules, it is stopped and the trial status
is changed to the <code>EarlyStopped</code>. Then, Katib calls the suggestion again to
ask for the new trials.</p>
<p>Learn more about Katib concepts
in the <a href="/docs/components/katib/overview/#katib-concepts">overview guide</a>.</p>
<p>Follow the
<a href="/docs/components/katib/katib-config/#early-stopping-settings">Katib configuration guide</a>
to specify your own image for the early stopping algorithm.</p>
<h3 id="early-stopping-algorithms-in-detail">Early stopping algorithms in detail</h3>
<p>Heres a list of the early stopping algorithms available in Katib:</p>
<ul>
<li><a href="#median-stopping-rule">Median Stopping Rule</a></li>
</ul>
<p>More algorithms are under development.</p>
<p>You can add an early stopping algorithm to Katib yourself. Check the
<a href="https://github.com/kubeflow/katib/blob/master/docs/developer-guide.md">developer guide</a>
to contribute.</p>
<p><a id="median-stopping-rule"></a></p>
<h3 id="median-stopping-rule">Median Stopping Rule</h3>
<p>The early stopping algorithm name in Katib is <code>medianstop</code>.</p>
<p>The median stopping rule stops a pending trial <code>X</code> at step <code>S</code> if the trial&rsquo;s
best objective value by step <code>S</code> is worse than the median value of the running
averages of all completed trials&rsquo; objectives reported up to step <code>S</code>.</p>
<p>To learn more about it, check
<a href="https://static.googleusercontent.com/media/research.google.com/en//pubs/archive/46180.pdf">Google Vizier: A Service for Black-Box Optimization</a>.</p>
<p>Katib supports the following early stopping settings:</p>
<div class="table-responsive">
  <table class="table table-bordered">
    <thead class="thead-light">
      <tr>
        <th>Setting Name</th>
        <th>Description</th>
        <th>Default Value</th>
      </tr>
    </thead>
    <tbody>
      <tr>
        <td>min_trials_required</td>
        <td>Minimal number of successful trials to compute median value</td>
        <td>3</td>
      </tr>
      <tr>
        <td>start_step</td>
        <td>Number of reported intermediate results before stopping the trial</td>
        <td>4</td>
      </tr>
    </tbody>
  </table>
</div>
<h3 id="submit-an-early-stopping-experiment-from-the-ui">Submit an early stopping experiment from the UI</h3>
<p>You can use Katib UI to submit an early stopping experiment. Follow
<a href="/docs/components/katib/experiment/#running-the-experiment-from-the-katib-ui">these steps</a>
to create an experiment from the UI.</p>
<p>Once you reach the early stopping section, select the appropriate values:</p>
<p><img src="/docs/components/katib/images/early-stopping-parameter.png"
alt="UI form to deploy an early stopping Katib experiment"
class="mt-3 mb-3 border border-info rounded"></p>
<h2 id="view-the-early-stopping-experiment-results">View the early stopping experiment results</h2>
<p>First, make sure you have <a href="https://stedolan.github.io/jq/download/">jq</a>
installed.</p>
<p>Check the early stopped trials in your experiment:</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-shell" data-lang="shell"><span class="line"><span class="cl">kubectl get experiment &lt;experiment-name&gt;  -n &lt;experiment-namespace&gt; -o json <span class="p">|</span> jq -r <span class="s2">&#34;.status&#34;</span>
</span></span></code></pre></div><p>The last part of the above command output looks similar to this:</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-yaml" data-lang="yaml"><span class="line"><span class="cl"><span class="w">  </span><span class="l">. . .</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">  </span><span class="nt">&#34;earlyStoppedTrialList&#34;: </span><span class="p">[</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="s2">&#34;median-stop-2ml8h96d&#34;</span><span class="p">,</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="s2">&#34;median-stop-cgjkq8zn&#34;</span><span class="p">,</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="s2">&#34;median-stop-pvn5p54p&#34;</span><span class="p">,</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="s2">&#34;median-stop-sjc9tcgc&#34;</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">  </span><span class="p">],</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">  </span><span class="nt">&#34;startTime&#34;: </span><span class="s2">&#34;2020-11-05T03:03:43Z&#34;</span><span class="p">,</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">  </span><span class="nt">&#34;succeededTrialList&#34;: </span><span class="p">[</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="s2">&#34;median-stop-2kmh57qf&#34;</span><span class="p">,</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="s2">&#34;median-stop-7ccstz4z&#34;</span><span class="p">,</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="s2">&#34;median-stop-7sqt7556&#34;</span><span class="p">,</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="s2">&#34;median-stop-lgvhfch2&#34;</span><span class="p">,</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="s2">&#34;median-stop-mkfjtwbj&#34;</span><span class="p">,</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="s2">&#34;median-stop-nfmgqd7w&#34;</span><span class="p">,</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="s2">&#34;median-stop-nsbxw5m9&#34;</span><span class="p">,</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="s2">&#34;median-stop-nsmhg4p2&#34;</span><span class="p">,</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="s2">&#34;median-stop-rp88xflk&#34;</span><span class="p">,</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="s2">&#34;median-stop-xl7dlf5n&#34;</span><span class="p">,</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="s2">&#34;median-stop-ztc58kwq&#34;</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">  </span><span class="p">],</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">  </span><span class="nt">&#34;trials&#34;: </span><span class="m">15</span><span class="p">,</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">  </span><span class="nt">&#34;trialsEarlyStopped&#34;: </span><span class="m">4</span><span class="p">,</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">  </span><span class="nt">&#34;trialsSucceeded&#34;: </span><span class="m">11</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span>}<span class="w">
</span></span></span></code></pre></div><p>Check the status of the early stopped trial by running this command:</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-shell" data-lang="shell"><span class="line"><span class="cl">kubectl get trial median-stop-2ml8h96d -n &lt;experiment-namespace&gt;
</span></span></code></pre></div><p>and you should be able to view <code>EarlyStopped</code> status for the trial:</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-shell" data-lang="shell"><span class="line"><span class="cl">NAME                   TYPE           STATUS   AGE
</span></span><span class="line"><span class="cl">median-stop-2ml8h96d   EarlyStopped   True     15m
</span></span></code></pre></div><p>In addition, you can check your results on the Katib UI.
The trial statuses on the experiment monitor page should look as follows:</p>
<p><img src="/docs/components/katib/images/early-stopping-trials.png"
alt="UI form to view trials"
class="mt-3 mb-3 border border-info rounded"></p>
<p>You can click on the early stopped trial name to get reported metrics before
this trial is early stopped:</p>
<p><img src="/docs/components/katib/images/early-stopping-trial-info.png"
alt="UI form to view trial info"
class="mt-3 mb-3 border border-info rounded"></p>
<h2 id="next-steps">Next steps</h2>
<ul>
<li>
<p>Learn how to
<a href="/docs/components/katib/experiment/">configure and run your Katib experiments</a>.</p>
</li>
<li>
<p>How to
<a href="/docs/components/katib/resume-experiment/">restart your experiment and use the resume policies</a>.</p>
</li>
<li>
<p>Check the
<a href="/docs/components/katib/katib-config/">Katib Configuration (Katib config)</a>.</p>
</li>
<li>
<p>How to <a href="/docs/components/katib/env-variables/">set up environment variables</a>
for each Katib component.</p>
</li>
</ul>

</div>



    
	
  
    
    
	
    

<div class="td-content" style="page-break-before: always">
    
	<h1 id="pg-51e1645fcfdf30aa149835216f6f8cd0">4.7 - Katib Configuration Overview</h1>
    <div class="lead">How to make changes in Katib configuration</div>
	<p>This guide describes
<a href="https://github.com/kubeflow/katib/blob/master/manifests/v1beta1/components/controller/katib-config.yaml">Katib config</a> 
the Kubernetes
<a href="https://kubernetes.io/docs/tasks/configure-pod-container/configure-pod-configmap/">Config Map</a> that contains information about:</p>
<ol>
<li>
<p>Current
<a href="/docs/components/katib/experiment/#metrics-collector">metrics collectors</a>
(<code>key = metrics-collector-sidecar</code>).</p>
</li>
<li>
<p>Current
<a href="/docs/components/katib/experiment/#search-algorithms-in-detail">algorithms</a>
(suggestions) (<code>key = suggestion</code>).</p>
</li>
<li>
<p>Current
<a href="/docs/components/katib/early-stopping/#early-stopping-algorithms-in-detail">early stopping algorithms</a>
(<code>key = early-stopping</code>).</p>
</li>
</ol>
<p>The Katib Config Map must be deployed in the
<a href="/docs/components/katib/env-variables/#katib-controller"><code>KATIB_CORE_NAMESPACE</code></a>
namespace with the <code>katib-config</code> name. The Katib controller parses the Katib config when
you submit your experiment.</p>
<p>You can edit this Config Map even after deploying Katib.</p>
<p>If you are deploying Katib in the Kubeflow namespace, run this command to edit your Katib config:</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-shell" data-lang="shell"><span class="line"><span class="cl">kubectl edit configMap katib-config -n kubeflow
</span></span></code></pre></div><h2 id="metrics-collector-sidecar-settings">Metrics Collector Sidecar settings</h2>
<p>These settings are related to Katib metrics collectors, where:</p>
<ul>
<li>key: <code>metrics-collector-sidecar</code></li>
<li>value: corresponding JSON settings for each metrics collector kind</li>
</ul>
<p>Example for the <code>File</code> metrics collector with all settings:</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-json" data-lang="json"><span class="line"><span class="cl"><span class="err">metrics-collector-sidecar:</span> <span class="err">|-</span>
</span></span><span class="line"><span class="cl"><span class="p">{</span>
</span></span><span class="line"><span class="cl">  <span class="nt">&#34;File&#34;</span><span class="p">:</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">    <span class="nt">&#34;image&#34;</span><span class="p">:</span> <span class="s2">&#34;docker.io/kubeflowkatib/file-metrics-collector&#34;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">    <span class="nt">&#34;imagePullPolicy&#34;</span><span class="p">:</span> <span class="s2">&#34;Always&#34;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">    <span class="nt">&#34;resources&#34;</span><span class="p">:</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">      <span class="nt">&#34;requests&#34;</span><span class="p">:</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">        <span class="nt">&#34;memory&#34;</span><span class="p">:</span> <span class="s2">&#34;200Mi&#34;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">        <span class="nt">&#34;cpu&#34;</span><span class="p">:</span> <span class="s2">&#34;250m&#34;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">        <span class="nt">&#34;ephemeral-storage&#34;</span><span class="p">:</span> <span class="s2">&#34;200Mi&#34;</span>
</span></span><span class="line"><span class="cl">      <span class="p">},</span>
</span></span><span class="line"><span class="cl">      <span class="nt">&#34;limits&#34;</span><span class="p">:</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">        <span class="nt">&#34;memory&#34;</span><span class="p">:</span> <span class="s2">&#34;1Gi&#34;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">        <span class="nt">&#34;cpu&#34;</span><span class="p">:</span> <span class="s2">&#34;500m&#34;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">        <span class="nt">&#34;ephemeral-storage&#34;</span><span class="p">:</span> <span class="s2">&#34;2Gi&#34;</span>
</span></span><span class="line"><span class="cl">      <span class="p">}</span>
</span></span><span class="line"><span class="cl">    <span class="p">},</span>
</span></span><span class="line"><span class="cl">    <span class="nt">&#34;waitAllProcesses&#34;</span><span class="p">:</span> <span class="kc">false</span>
</span></span><span class="line"><span class="cl">  <span class="p">},</span>
</span></span><span class="line"><span class="cl">  <span class="err">...</span>
</span></span><span class="line"><span class="cl"><span class="p">}</span>
</span></span></code></pre></div><p>All of these settings except <strong><code>image</code></strong> can be omitted. If you don&rsquo;t specify any other settings,
a default value is set automatically.</p>
<ol>
<li>
<p><code>image</code> - a Docker image for the <code>File</code> metrics collector&rsquo;s container (<strong>must be specified</strong>).</p>
</li>
<li>
<p><code>imagePullPolicy</code> - an <a href="https://kubernetes.io/docs/concepts/configuration/overview/#container-images">image pull policy</a>
for the <code>File</code> metrics collector&rsquo;s container.</p>
<p>The default value is <code>IfNotPresent</code></p>
</li>
<li>
<p><code>resources</code> - <a href="https://kubernetes.io/docs/concepts/configuration/manage-compute-resources-container/#resource-requests-and-limits-of-pod-and-container">resources</a>
for the <code>File</code> metrics collector&rsquo;s container. In the above example you
can check how to specify <code>limits</code> and <code>requests</code>. Currently, you can specify
only <code>memory</code>, <code>cpu</code> and <code>ephemeral-storage</code> resources.</p>
<p>The default values for the <code>requests</code> are:</p>
<ul>
<li><code>memory = 10Mi</code></li>
<li><code>cpu = 50m</code></li>
<li><code>ephemeral-storage = 500Mi</code></li>
</ul>
<p>The default values for the <code>limits</code> are:</p>
<ul>
<li><code>memory = 100Mi</code></li>
<li><code>cpu = 500m</code></li>
<li><code>ephemeral-storage = 5Gi</code></li>
</ul>
<p>You can run your metrics collector&rsquo;s container without requesting
the <code>cpu</code>, <code>memory</code>, or <code>ephemeral-storage</code> resource from the Kubernetes cluster.
For instance, you have to remove <code>ephemeral-storage</code> from the container resources to use the
<a href="https://cloud.google.com/kubernetes-engine/docs/concepts/cluster-autoscaler#limitations">Google Kubernetes Engine cluster autoscaler</a>.</p>
<p>To remove specific resources from the metrics collector&rsquo;s container set the
negative values in requests and limits in your Katib config as follows:</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-json" data-lang="json"><span class="line"><span class="cl"><span class="s2">&#34;requests&#34;</span><span class="err">:</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">  <span class="nt">&#34;cpu&#34;</span><span class="p">:</span> <span class="s2">&#34;-1&#34;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">  <span class="nt">&#34;memory&#34;</span><span class="p">:</span> <span class="s2">&#34;-1&#34;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">  <span class="nt">&#34;ephemeral-storage&#34;</span><span class="p">:</span> <span class="s2">&#34;-1&#34;</span>
</span></span><span class="line"><span class="cl"><span class="p">}</span><span class="err">,</span>
</span></span><span class="line"><span class="cl"><span class="s2">&#34;limits&#34;</span><span class="err">:</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">  <span class="nt">&#34;cpu&#34;</span><span class="p">:</span> <span class="s2">&#34;-1&#34;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">  <span class="nt">&#34;memory&#34;</span><span class="p">:</span> <span class="s2">&#34;-1&#34;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">  <span class="nt">&#34;ephemeral-storage&#34;</span><span class="p">:</span> <span class="s2">&#34;-1&#34;</span>
</span></span><span class="line"><span class="cl"><span class="p">}</span>
</span></span></code></pre></div></li>
<li>
<p><code>waitAllProcesses</code> - a flag to define whether the metrics collector should
wait until all processes in the training container are finished before start
to collect metrics.</p>
<p>The default value is <code>true</code></p>
</li>
</ol>
<h2 id="suggestion-settings">Suggestion settings</h2>
<p>These settings are related to Katib suggestions, where:</p>
<ul>
<li>key: <code>suggestion</code></li>
<li>value: corresponding JSON settings for each algorithm name</li>
</ul>
<p>If you want to use a new algorithm, you need to update the Katib config. For example,
using a <code>random</code> algorithm with all settings looks as follows:</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-json" data-lang="json"><span class="line"><span class="cl"><span class="err">suggestion:</span> <span class="err">|-</span>
</span></span><span class="line"><span class="cl"><span class="p">{</span>
</span></span><span class="line"><span class="cl">  <span class="nt">&#34;random&#34;</span><span class="p">:</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">    <span class="nt">&#34;image&#34;</span><span class="p">:</span> <span class="s2">&#34;docker.io/kubeflowkatib/suggestion-hyperopt&#34;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">    <span class="nt">&#34;imagePullPolicy&#34;</span><span class="p">:</span> <span class="s2">&#34;Always&#34;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">    <span class="nt">&#34;resources&#34;</span><span class="p">:</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">      <span class="nt">&#34;requests&#34;</span><span class="p">:</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">        <span class="nt">&#34;memory&#34;</span><span class="p">:</span> <span class="s2">&#34;100Mi&#34;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">        <span class="nt">&#34;cpu&#34;</span><span class="p">:</span> <span class="s2">&#34;100m&#34;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">        <span class="nt">&#34;ephemeral-storage&#34;</span><span class="p">:</span> <span class="s2">&#34;100Mi&#34;</span>
</span></span><span class="line"><span class="cl">      <span class="p">},</span>
</span></span><span class="line"><span class="cl">      <span class="nt">&#34;limits&#34;</span><span class="p">:</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">        <span class="nt">&#34;memory&#34;</span><span class="p">:</span> <span class="s2">&#34;500Mi&#34;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">        <span class="nt">&#34;cpu&#34;</span><span class="p">:</span> <span class="s2">&#34;500m&#34;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">        <span class="nt">&#34;ephemeral-storage&#34;</span><span class="p">:</span> <span class="s2">&#34;3Gi&#34;</span>
</span></span><span class="line"><span class="cl">      <span class="p">}</span>
</span></span><span class="line"><span class="cl">    <span class="p">},</span>
</span></span><span class="line"><span class="cl">    <span class="nt">&#34;serviceAccountName&#34;</span><span class="p">:</span> <span class="s2">&#34;random-sa&#34;</span>
</span></span><span class="line"><span class="cl">  <span class="p">},</span>
</span></span><span class="line"><span class="cl">  <span class="err">...</span>
</span></span><span class="line"><span class="cl"><span class="p">}</span>
</span></span></code></pre></div><p>All of these settings except <strong><code>image</code></strong> can be omitted. If you don&rsquo;t specify
any other settings, a default value is set automatically.</p>
<ol>
<li>
<p><code>image</code> - a Docker image for the suggestion&rsquo;s container with a <code>random</code>
algorithm (<strong>must be specified</strong>).</p>
<p>Image example: <code>docker.io/kubeflowkatib/&lt;suggestion-name&gt;</code></p>
<p>For each algorithm (suggestion) you can specify one of the following
suggestion names in the Docker image:</p>
<div class="table-responsive">
  <table class="table table-bordered">
    <thead class="thead-light">
      <tr>
        <th>Suggestion name</th>
        <th>List of supported algorithms</th>
        <th>Description</th>
      </tr>
    </thead>
    <tbody>
      <tr>
        <td><code>suggestion-hyperopt</code></td>
        <td><code>random</code>, <code>tpe</code></td>
        <td><a href="https://github.com/hyperopt/hyperopt">Hyperopt</a> optimization framework</td>
      </tr>
      <tr>
        <td><code>suggestion-chocolate</code></td>
        <td><code>grid</code>, <code>random</code>, <code>quasirandom</code>, <code>bayesianoptimization</code>, <code>mocmaes</code></td>
        <td><a href="https://github.com/AIworx-Labs/chocolate">Chocolate</a> optimization framework</td>
      </tr>
      <tr>
        <td><code>suggestion-skopt</code></td>
        <td><code>bayesianoptimization</code></td>
        <td><a href="https://github.com/scikit-optimize/scikit-optimize">Scikit-optimize</a> optimization framework</td>
      </tr>
      <tr>
        <td><code>suggestion-goptuna</code></td>
        <td><code>cmaes</code>, <code>random</code>, <code>tpe</code>, <code>sobol</code></td>
        <td><a href="https://github.com/c-bata/goptuna">Goptuna</a> optimization framework</td>
      </tr>
      <tr>
        <td><code>suggestion-optuna</code></td>
        <td><code>multivariate-tpe</code>, <code>tpe</code>, <code>cmaes</code>, <code>random</code></td>
        <td><a href="https://github.com/optuna/optuna">Optuna</a> optimization framework</td>
      </tr>
      <tr>
        <td><code>suggestion-hyperband</code></td>
        <td><code>hyperband</code></td>
        <td><a href="https://github.com/kubeflow/katib/tree/master/pkg/suggestion/v1beta1/hyperband">Katib
          Hyperband</a> implementation</td>
      </tr>
      <tr>
        <td><code>suggestion-pbt</code></td>
        <td><code>pbt</code></td>
        <td><a href="https://github.com/kubeflow/katib/tree/master/pkg/suggestion/v1beta1/pbt">Katib
          PBT</a> implementation</td>
      </tr>
      <tr>
        <td><code>suggestion-enas</code></td>
        <td><code>enas</code></td>
        <td><a href="https://github.com/kubeflow/katib/tree/master/pkg/suggestion/v1beta1/nas/enas">Katib
          ENAS</a> implementation</td>
      </tr>
      <tr>
        <td><code>suggestion-darts</code></td>
        <td><code>darts</code></td>
        <td><a href="https://github.com/kubeflow/katib/tree/master/pkg/suggestion/v1beta1/nas/darts">Katib
          DARTS</a> implementation</td>
      </tr>
    </tbody>
  </table>
</div>
</li>
<li>
<p><code>imagePullPolicy</code> - an <a href="https://kubernetes.io/docs/concepts/configuration/overview/#container-images">image pull policy</a>
for the suggestion&rsquo;s container with a <code>random</code> algorithm.</p>
<p>The default value is <code>IfNotPresent</code></p>
</li>
<li>
<p><code>resources</code> - <a href="https://kubernetes.io/docs/concepts/configuration/manage-compute-resources-container/#resource-requests-and-limits-of-pod-and-container">resources</a>
for the suggestion&rsquo;s container with a <code>random</code> algorithm.
In the above example you can check how to specify <code>limits</code> and <code>requests</code>.
Currently, you can specify only <code>memory</code>, <code>cpu</code> and
<code>ephemeral-storage</code> resources.</p>
<p>The default values for the <code>requests</code> are:</p>
<ul>
<li><code>memory = 10Mi</code></li>
<li><code>cpu = 50m</code></li>
<li><code>ephemeral-storage = 500Mi</code></li>
</ul>
<p>The default values for the <code>limits</code> are:</p>
<ul>
<li><code>memory = 100Mi</code></li>
<li><code>cpu = 500m</code></li>
<li><code>ephemeral-storage = 5Gi</code></li>
</ul>
<p>You can run your suggestion&rsquo;s container without requesting
the <code>cpu</code>, <code>memory</code>, or <code>ephemeral-storage</code> resource from the Kubernetes cluster.
For instance, you have to remove <code>ephemeral-storage</code> from the container resources to use the
<a href="https://cloud.google.com/kubernetes-engine/docs/concepts/cluster-autoscaler#limitations">Google Kubernetes Engine cluster autoscaler</a>.</p>
<p>To remove specific resources from the suggestion&rsquo;s container set the
negative values in requests and limits in your Katib config as follows:</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-json" data-lang="json"><span class="line"><span class="cl"><span class="s2">&#34;requests&#34;</span><span class="err">:</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">  <span class="nt">&#34;cpu&#34;</span><span class="p">:</span> <span class="s2">&#34;-1&#34;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">  <span class="nt">&#34;memory&#34;</span><span class="p">:</span> <span class="s2">&#34;-1&#34;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">  <span class="nt">&#34;ephemeral-storage&#34;</span><span class="p">:</span> <span class="s2">&#34;-1&#34;</span>
</span></span><span class="line"><span class="cl"><span class="p">}</span><span class="err">,</span>
</span></span><span class="line"><span class="cl"><span class="s2">&#34;limits&#34;</span><span class="err">:</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">  <span class="nt">&#34;cpu&#34;</span><span class="p">:</span> <span class="s2">&#34;-1&#34;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">  <span class="nt">&#34;memory&#34;</span><span class="p">:</span> <span class="s2">&#34;-1&#34;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">  <span class="nt">&#34;ephemeral-storage&#34;</span><span class="p">:</span> <span class="s2">&#34;-1&#34;</span>
</span></span><span class="line"><span class="cl"><span class="p">}</span>
</span></span></code></pre></div></li>
<li>
<p><code>serviceAccountName</code> - a <a href="https://kubernetes.io/docs/tasks/configure-pod-container/configure-service-account/">service account</a>
for the suggestion&rsquo;s container with a <code>random</code> algorithm.</p>
<p>In the above example, the <code>random-sa</code> service account is attached for each
experiment&rsquo;s suggestion with a <code>random</code> algorithm until you change or delete
this service account from the Katib config.</p>
<p>By default, the suggestion pod doesn&rsquo;t have any specific service account,
in which case, the pod uses the
<a href="https://kubernetes.io/docs/tasks/configure-pod-container/configure-service-account/#use-the-default-service-account-to-access-the-api-server">default</a>
service account.</p>
<p><strong>Note:</strong> If you want to run your experiments with
<a href="/docs/components/katib/early-stopping/">early stopping</a>,
the suggestion&rsquo;s deployment must have permission to update the experiment&rsquo;s
trial status. If you don&rsquo;t specify a service account in the Katib config,
Katib controller creates required
<a href="https://kubernetes.io/docs/reference/access-authn-authz/rbac">Kubernetes Role-based access control</a>
for the suggestion.</p>
<p>If you need your own service account for the experiment&rsquo;s
suggestion with early stopping, you have to follow the rules:</p>
<ul>
<li>
<p>The service account name can&rsquo;t be equal to
<code>&lt;experiment-name&gt;-&lt;experiment-algorithm&gt;</code></p>
</li>
<li>
<p>The service account must have sufficient permissions to update
the experiment&rsquo;s trial status.</p>
</li>
</ul>
</li>
</ol>
<h3 id="suggestion-volume-settings">Suggestion volume settings</h3>
<p>When you create an experiment with
<a href="/docs/components/katib/resume-experiment#resume-policy-fromvolume"><code>FromVolume</code> resume policy</a>,
you are able to specify
<a href="https://kubernetes.io/docs/concepts/storage/persistent-volumes/#persistent-volumes">PersistentVolume (PV)</a>
and
<a href="https://kubernetes.io/docs/concepts/storage/persistent-volumes/#persistentvolumeclaims">PersistentVolumeClaim (PVC)</a>
settings for the experiment&rsquo;s suggestion. Learn more about Katib concepts
in the <a href="/docs/components/katib/overview/#suggestion">overview guide</a>.</p>
<p>If PV settings are empty, Katib controller creates only PVC.
If you want to use the default volume specification, you can omit these settings.</p>
<p>Follow the example for the <code>random</code> algorithm:</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-json" data-lang="json"><span class="line"><span class="cl"><span class="err">suggestion:</span> <span class="err">|-</span>
</span></span><span class="line"><span class="cl"><span class="p">{</span>
</span></span><span class="line"><span class="cl">  <span class="nt">&#34;random&#34;</span><span class="p">:</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">    <span class="nt">&#34;image&#34;</span><span class="p">:</span> <span class="s2">&#34;docker.io/kubeflowkatib/suggestion-hyperopt&#34;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">    <span class="nt">&#34;volumeMountPath&#34;</span><span class="p">:</span> <span class="s2">&#34;/opt/suggestion/data&#34;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">    <span class="nt">&#34;persistentVolumeClaimSpec&#34;</span><span class="p">:</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">      <span class="nt">&#34;accessModes&#34;</span><span class="p">:</span> <span class="p">[</span>
</span></span><span class="line"><span class="cl">        <span class="s2">&#34;ReadWriteMany&#34;</span>
</span></span><span class="line"><span class="cl">      <span class="p">],</span>
</span></span><span class="line"><span class="cl">      <span class="nt">&#34;resources&#34;</span><span class="p">:</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">        <span class="nt">&#34;requests&#34;</span><span class="p">:</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">          <span class="nt">&#34;storage&#34;</span><span class="p">:</span> <span class="s2">&#34;3Gi&#34;</span>
</span></span><span class="line"><span class="cl">        <span class="p">}</span>
</span></span><span class="line"><span class="cl">      <span class="p">},</span>
</span></span><span class="line"><span class="cl">      <span class="nt">&#34;storageClassName&#34;</span><span class="p">:</span> <span class="s2">&#34;katib-suggestion&#34;</span>
</span></span><span class="line"><span class="cl">    <span class="p">},</span>
</span></span><span class="line"><span class="cl">    <span class="nt">&#34;persistentVolumeSpec&#34;</span><span class="p">:</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">      <span class="nt">&#34;accessModes&#34;</span><span class="p">:</span> <span class="p">[</span>
</span></span><span class="line"><span class="cl">        <span class="s2">&#34;ReadWriteMany&#34;</span>
</span></span><span class="line"><span class="cl">      <span class="p">],</span>
</span></span><span class="line"><span class="cl">      <span class="nt">&#34;capacity&#34;</span><span class="p">:</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">        <span class="nt">&#34;storage&#34;</span><span class="p">:</span> <span class="s2">&#34;3Gi&#34;</span>
</span></span><span class="line"><span class="cl">      <span class="p">},</span>
</span></span><span class="line"><span class="cl">      <span class="nt">&#34;hostPath&#34;</span><span class="p">:</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">        <span class="nt">&#34;path&#34;</span><span class="p">:</span> <span class="s2">&#34;/tmp/suggestion/unique/path&#34;</span>
</span></span><span class="line"><span class="cl">      <span class="p">},</span>
</span></span><span class="line"><span class="cl">      <span class="nt">&#34;storageClassName&#34;</span><span class="p">:</span> <span class="s2">&#34;katib-suggestion&#34;</span>
</span></span><span class="line"><span class="cl">    <span class="p">},</span>
</span></span><span class="line"><span class="cl">    <span class="nt">&#34;persistentVolumeLabels&#34;</span><span class="p">:</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">      <span class="nt">&#34;type&#34;</span><span class="p">:</span> <span class="s2">&#34;local&#34;</span>
</span></span><span class="line"><span class="cl">    <span class="p">}</span>
</span></span><span class="line"><span class="cl">  <span class="p">},</span>
</span></span><span class="line"><span class="cl">  <span class="err">...</span>
</span></span><span class="line"><span class="cl"><span class="p">}</span>
</span></span></code></pre></div><ol>
<li>
<p><code>volumeMountPath</code> - a <a href="https://kubernetes.io/docs/tasks/configure-pod-container/configure-volume-storage/#configure-a-volume-for-a-pod">mount path</a>
for the suggestion&rsquo;s container with <code>random</code> algorithm.</p>
<p>The default value is <code>/opt/katib/data</code></p>
</li>
<li>
<p><code>persistentVolumeClaimSpec</code> - a <a href="https://v1-18.docs.kubernetes.io/docs/reference/generated/kubernetes-api/v1.18/#persistentvolumeclaimspec-v1-core">PVC specification</a>
for the suggestion&rsquo;s PVC.</p>
<p>The default value is set, if you don&rsquo;t specify any of these settings:</p>
<ul>
<li>
<p><code>persistentVolumeClaimSpec.accessModes[0]</code> - the default value is
<a href="https://kubernetes.io/docs/concepts/storage/persistent-volumes/#access-modes"><code>ReadWriteOnce</code></a></p>
</li>
<li>
<p><code>persistentVolumeClaimSpec.resources.requests.storage</code> - the default value
is <code>1Gi</code></p>
</li>
</ul>
</li>
<li>
<p><code>persistentVolumeSpec</code> - a <a href="https://v1-18.docs.kubernetes.io/docs/reference/generated/kubernetes-api/v1.18/#persistentvolumespec-v1-core">PV specification</a>
for the suggestion&rsquo;s PV.</p>
<p>PV <code>persistentVolumeReclaimPolicy</code> is always equal to <strong><code>Delete</code></strong> to properly
remove all resources once Katib experiment is deleted. To know more about
PV reclaim policies check the
<a href="https://kubernetes.io/docs/concepts/storage/persistent-volumes/#reclaiming">Kubernetes documentation</a>.</p>
</li>
<li>
<p><code>persistentVolumeLabels</code> - <a href="https://kubernetes.io/docs/concepts/overview/working-with-objects/labels/">PV labels</a>
for the suggestion&rsquo;s PV.</p>
</li>
</ol>
<h2 id="early-stopping-settings">Early stopping settings</h2>
<p>These settings are related to Katib early stopping, where:</p>
<ul>
<li>key: <code>early-stopping</code></li>
<li>value: corresponding JSON settings for each early stopping algorithm name</li>
</ul>
<p>If you want to use a new early stopping algorithm, you need to update the
Katib config. For example, using a <code>medianstop</code> early stopping algorithm with
all settings looks as follows:</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-json" data-lang="json"><span class="line"><span class="cl"><span class="err">early-stopping:</span> <span class="err">|-</span>
</span></span><span class="line"><span class="cl"><span class="p">{</span>
</span></span><span class="line"><span class="cl">  <span class="nt">&#34;medianstop&#34;</span><span class="p">:</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">    <span class="nt">&#34;image&#34;</span><span class="p">:</span> <span class="s2">&#34;docker.io/kubeflowkatib/earlystopping-medianstop&#34;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">    <span class="nt">&#34;imagePullPolicy&#34;</span><span class="p">:</span> <span class="s2">&#34;Always&#34;</span>
</span></span><span class="line"><span class="cl">  <span class="p">},</span>
</span></span><span class="line"><span class="cl">  <span class="err">...</span>
</span></span><span class="line"><span class="cl"><span class="p">}</span>
</span></span></code></pre></div><p>All of these settings except <strong><code>image</code></strong> can be omitted. If you don&rsquo;t specify
any other settings, a default value is set automatically.</p>
<ol>
<li>
<p><code>image</code> - a Docker image for the early stopping&rsquo;s container with a
<code>medianstop</code> algorithm (<strong>must be specified</strong>).</p>
<p>Image example: <code>docker.io/kubeflowkatib/&lt;early-stopping-name&gt;</code></p>
<p>For each early stopping algorithm you can specify one of the following
early stopping names in the Docker image:</p>
<div class="table-responsive">
  <table class="table table-bordered">
    <thead class="thead-light">
      <tr>
        <th>Early stopping name</th>
        <th>Early stopping algorithm</th>
        <th>Description</th>
      </tr>
    </thead>
    <tbody>
      <tr>
        <td><code>earlystopping-medianstop</code></td>
        <td><code>medianstop</code></td>
        <td><a href="https://github.com/kubeflow/katib/tree/master/pkg/earlystopping/v1beta1/medianstop">Katib
          Median Stopping</a> implementation</td>
      </tr>
    </tbody>
  </table>
</div>
</li>
<li>
<p><code>imagePullPolicy</code> - an
<a href="https://kubernetes.io/docs/concepts/configuration/overview/#container-images">image pull policy</a>
for the early stopping&rsquo;s container with a <code>medianstop</code> algorithm.</p>
<p>The default value is <code>IfNotPresent</code></p>
</li>
</ol>
<h2 id="next-steps">Next steps</h2>
<ul>
<li>
<p>Learn how to
<a href="/docs/components/katib/experiment/">configure and run your Katib experiments</a>.</p>
</li>
<li>
<p>How to
<a href="/docs/components/katib/resume-experiment/">restart your experiment and use the resume policies</a>.</p>
</li>
<li>
<p>How to <a href="/docs/components/katib/env-variables/">set up environment variables</a>
for each Katib component.</p>
</li>
</ul>

</div>



    
	
  
    
    
	
    

<div class="td-content" style="page-break-before: always">
    
	<h1 id="pg-cffe32d69412f2ff2bd13ff9e8bcea7f">4.8 - Environment Variables for Katib Components</h1>
    <div class="lead">How to set up environment variables for each Katib component</div>
	<p>This guide describes environment variables for each Katib component.
If you want to change your Katib installation,
you can modify some of these variables.</p>
<p>In the tables below you can find descriptions, default values and mandatory
properties for all environment variables in each Katib component.
If a variable has a mandatory property, you need to set the relevant
environment variable in an appropriate Katib component&rsquo;s manifest.</p>
<h2 id="katib-controller">Katib Controller</h2>
<p>Bellow are the environment variables for the
<a href="https://github.com/kubeflow/katib/blob/master/manifests/v1beta1/components/controller/controller.yaml">Katib Controller</a>
deployment:</p>
<div class="table-responsive">
  <table class="table table-bordered">
    <thead class="thead-light">
      <tr>
        <th>Variable</th>
        <th>Description</th>
        <th>Default Value</th>
        <th>Mandatory</th>
      </tr>
    </thead>
    <tbody>
      <tr>
        <td><code>KATIB_CORE_NAMESPACE</code></td>
        <td>Base Namespace for all Katib components and default Experiment</td>
        <td><code>metadata.namespace</code></td>
        <td>Yes</td>
      </tr>
      <tr>
        <td><code>KATIB_SUGGESTION_COMPOSER</code></td>
        <td> <a href="https://github.com/kubeflow/katib/blob/master/pkg/controller.v1beta1/suggestion/composer/composer.go">Composer</a>
          for the Katib Suggestions. You can use your own Composer</td>
        <td>general</td>
        <td>No</td>
      </tr>
      <tr>
        <td><code>KATIB_DB_MANAGER_SERVICE_NAMESPACE</code></td>
        <td>Katib DB Manager Namespace</td>
        <td><code>KATIB_CORE_NAMESPACE</code> env variable</td>
        <td>No</td>
      </tr>
      <tr>
        <td><code>KATIB_DB_MANAGER_SERVICE_IP</code></td>
        <td>Katib DB Manager IP</td>
        <td>katib-db-manager</td>
        <td>No</td>
      </tr>
       <tr>
        <td><code>KATIB_DB_MANAGER_SERVICE_PORT</code></td>
        <td>Katib DB Manager Port</td>
        <td>6789</td>
        <td>No</td>
      </tr>
    </tbody>
  </table>
</div>
<p>Katib Controller calls Katib DB Manager with this address expression:</p>
<p><strong><code>KATIB_DB_MANAGER_SERVICE_IP.KATIB_DB_MANAGER_SERVICE_NAMESPACE:KATIB_DB_MANAGER_SERVICE_PORT</code></strong></p>
<p>If you set <code>KATIB_DB_MANAGER_SERVICE_NAMESPACE=&quot;&quot;</code>, Katib Controller calls Katib DB Manager with this address:</p>
<p><strong><code>KATIB_DB_MANAGER_SERVICE_IP:KATIB_DB_MANAGER_SERVICE_PORT</code></strong></p>
<p>If you want to use your own DB Manager to report Katib metrics, you can change <code>KATIB_DB_MANAGER_SERVICE_NAMESPACE</code>, <code>KATIB_DB_MANAGER_SERVICE_IP</code> and <code>KATIB_DB_MANAGER_SERVICE_PORT</code> variables.</p>
<h2 id="katib-ui">Katib UI</h2>
<p>Below are the environment variables for the
<a href="https://github.com/kubeflow/katib/blob/master/manifests/v1beta1/components/ui/ui.yaml">Katib UI</a>
deployment:</p>
<div class="table-responsive">
  <table class="table table-bordered">
    <thead class="thead-light">
      <tr>
        <th>Variable</th>
        <th>Description</th>
        <th>Default Value</th>
        <th>Mandatory</th>
      </tr>
    </thead>
    <tbody>
      <tr>
        <td><code>KATIB_CORE_NAMESPACE</code></td>
        <td>Base Namespace for all Katib components and default Experiment</td>
        <td><code>metadata.namespace</code></td>
        <td>Yes</td>
      </tr>
      <tr>
        <td><code>KATIB_DB_MANAGER_SERVICE_NAMESPACE</code></td>
        <td>Katib DB Manager Namespace</td>
        <td><code>KATIB_CORE_NAMESPACE</code> env variable</td>
        <td>No</td>
      </tr>
      <tr>
        <td><code>KATIB_DB_MANAGER_SERVICE_IP</code></td>
        <td>Katib DB Manager IP</td>
        <td>katib-db-manager</td>
        <td>No</td>
      </tr>
       <tr>
        <td><code>KATIB_DB_MANAGER_SERVICE_PORT</code></td>
        <td>Katib DB Manager Port</td>
        <td>6789</td>
        <td>No</td>
      </tr>
    </tbody>
  </table>
</div>
<p>Katib UI calls Katib DB Manager with the same address expression as Katib Controller.</p>
<h2 id="katib-db-manager">Katib DB Manager</h2>
<p>Bellow are the environment variables for the
<a href="https://github.com/kubeflow/katib/blob/master/manifests/v1beta1/components/db-manager/db-manager.yaml">Katib DB Manager</a>
deployment:</p>
<div class="table-responsive">
  <table class="table table-bordered">
    <thead class="thead-light">
      <tr>
        <th>Variable</th>
        <th>Description</th>
        <th>Default Value</th>
        <th>Mandatory</th>
      </tr>
    </thead>
    <tbody>
      <tr>
        <td><code>DB_NAME</code></td>
        <td>Katib DB Name: 'mysql' or 'postgres'</td>
        <td>  </td> 
        <td>Yes</td>
      </tr>
      <tr>
        <td><code>DB_PASSWORD</code></td>
        <td>Katib DB Password</td>
        <td>test (MySQL)<br>katib (Postgres)</td>
        <td>Yes</td>
      </tr>
      <tr>
        <td><code>DB_USER</code></td>
        <td>Katib DB User</td>
        <td>root (MySQL)<br>katib (Postgres)</td>
        <td>No</td>
      </tr>
      <tr>
        <td><code>KATIB_MYSQL_DB_HOST</code></td>
        <td>Katib MySQL Host</td>
        <td>katib-mysql</td>
        <td>No</td>
      </tr>
      <tr>
        <td><code>KATIB_MYSQL_DB_PORT</code></td>
        <td>Katib MySQL Port</td>
        <td>3306</td>
        <td>No</td>
      </tr>
      <tr>
        <td><code>KATIB_MYSQL_DB_DATABASE</code></td>
        <td>Katib MySQL Database name</td>
        <td>katib</td>
        <td>No</td>
      </tr>
      <tr>
        <td><code>KATIB_POSTGRESQL_DB_HOST</code></td>
        <td>Katib Postgres Host</td>
        <td>katib-postgres</td>
        <td>No</td>
      </tr>
      <tr>
        <td><code>KATIB_POSTGRESQL_DB_PORT</code></td>
        <td>Katib Postgres Port</td>
        <td>5432</td>
        <td>No</td>
      </tr>
      <tr>
        <td><code>KATIB_POSTGRESQL_DATABASE</code></td>
        <td>Katib Postgres Database name</td>
        <td>katib</td>
        <td>No</td>
      </tr>
    </tbody>
  </table>
</div>
<p>Currently, Katib DB Manager supports only <strong>MySQL</strong> and <strong>Postgres</strong> database. (<code>DB_NAME</code> env variable must be filled with one of <code>mysql</code> or <code>postgres</code>)<br>
However, you can use your own DB Manager and Database to report metrics by implements the <a href="https://github.com/kubeflow/katib/blob/master/pkg/db/v1beta1/common/kdb.go">katib db interface</a>.</p>
<p>For the <a href="https://github.com/kubeflow/katib/blob/master/manifests/v1beta1/components/db-manager/db-manager.yaml#L25">Katib DB Manager</a>
you can change <code>DB_PASSWORD</code> to your own DB password.</p>
<p>Katib DB Manager creates DB connection to the DB by the type of DB.<br>
If <code>DB_NAME=mysql</code>, it uses <code>mysql</code> driver and this data source name:<br>
<strong><code>DB_USER:DB_PASSWORD@tcp(KATIB_MYSQL_DB_HOST:KATIB_MYSQL_DB_PORT)/KATIB_MYSQL_DB_DATABASE?timeout=5s</code></strong></p>
<p>If <code>DB_NAME=postgres</code>, it uses <code>pq</code> driver and this data source name:<br>
<strong><code>postgresql://[DB_USER[:DB_PASSWORD]@][KATIB_POSTGRESQL_DB_HOST][:KATIB_POSTGRESQL_DB_PORT][/KATIB_POSTGRESQL_DB_DATABASE]</code></strong></p>
<h2 id="katib-db">Katib DB</h2>
<p>Katib DB components supports MySQL and Postgres.</p>
<h3 id="katib-mysql">Katib MySQL</h3>
<p>For the <a href="https://github.com/kubeflow/katib/blob/master/manifests/v1beta1/components/mysql/mysql.yaml">Katib MySQL</a>
you need to set these environment variables:</p>
<ul>
<li><code>MYSQL_ROOT_PASSWORD</code> to a value from <a href="https://github.com/kubeflow/katib/blob/master/manifests/v1beta1/components/mysql/secret.yaml">katib-mysql-secrets</a>,
which is equal to &ldquo;test&rdquo;.</li>
<li><code>MYSQL_ALLOW_EMPTY_PASSWORD</code> as <code>true</code></li>
<li><code>MYSQL_DATABASE</code> as <code>katib</code>.</li>
</ul>
<p>You can refer to the list of
<a href="https://github.com/docker-library/docs/tree/master/mysql#environment-variables">all environment variables</a>
for the MySQL Docker image.</p>
<p>Katib MySQL environment variables must be matched with the Katib DB Manager environment variables, it means:</p>
<ol>
<li><code>MYSQL_ROOT_PASSWORD</code> = <code>DB_PASSWORD</code></li>
<li><code>MYSQL_DATABASE</code> = <code>KATIB_MYSQL_DB_DATABASE</code></li>
</ol>
<h3 id="katib-postgres">Katib Postgres</h3>
<p>For the <a href="https://github.com/kubeflow/katib/blob/master/manifests/v1beta1/components/postgres/postgres.yaml">Katib Postgres</a>
you need to set these environment variables:</p>
<ul>
<li><code>POSTGRES_USER</code>, <code>POSTGRES_PASSWORD</code> and <code>POSTGRES_DB</code> to a value from <a href="https://github.com/kubeflow/katib/blob/master/manifests/v1beta1/components/postgres/secret.yaml">katib-postgres-secrets</a>,
which are equal to &ldquo;katib&rdquo;.</li>
</ul>
<p>You can refer to the list of
<a href="https://github.com/docker-library/docs/blob/master/postgres/README.md#environment-variables">all environment variables</a>
for the Postgres Docker image.</p>
<p>Katib Postgres environment variables must be matched with the Katib DB Manager environment variables, it means:</p>
<ol>
<li><code>POSTGRES_USER</code> = <code>DB_USER</code></li>
<li><code>POSTGRES_PASSWORD</code> = <code>DB_PASSWORD</code></li>
<li><code>POSTGRES_DB</code> = <code>KATIB_POSTGRESQL_DB_DATABASE</code></li>
</ol>

</div>



    
	
  

    
	
  
    
    
	
    

<div class="td-content" style="page-break-before: always">
    
	<h1 id="pg-51fdbf378e6f2d230f7206aeacd43a90">5 - Training Operators</h1>
    <div class="lead">Training of ML models in Kubeflow through operators</div>
	
</div>



    
      
  
  
  
  

  
  

  
    
    
	
    

<div class="td-content" style="">
    
	<h1 id="pg-576bf8908783688384260fc466c40af5">5.1 - TensorFlow Training (TFJob)</h1>
    <div class="lead">Using TFJob to train a model with TensorFlow</div>
	<div class="alert alert-primary" role="alert">
This Kubeflow component has <b>stable</b> status. See the
<a href="/docs/started/support/#application-status">Kubeflow versioning policies</a>.
</div>
<p>This page describes <code>TFJob</code> for training a machine learning model with <a href="https://www.tensorflow.org/">TensorFlow</a>.</p>
<h2 id="what-is-tfjob">What is TFJob?</h2>
<p><code>TFJob</code> is a Kubernetes
<a href="https://kubernetes.io/docs/concepts/extend-kubernetes/api-extension/custom-resources/">custom resource</a>
to run TensorFlow training jobs on Kubernetes. The Kubeflow implementation of
<code>TFJob</code> is in <a href="https://github.com/kubeflow/training-operator"><code>training-operator</code></a>.</p>
<p><strong>Note</strong>: <code>TFJob</code> doesn&rsquo;t work in a user namespace by default because of Istio <a href="https://istio.io/v1.3/docs/setup/additional-setup/sidecar-injection/#automatic-sidecar-injection">automatic sidecar injection</a>. In order to get <code>TFJob</code> running, it needs annotation <code>sidecar.istio.io/inject: &quot;false&quot;</code> to disable it for <code>TFJob</code> pods.</p>
<p>A <code>TFJob</code> is a resource with a YAML representation like the one below (edit to use the container image and command for your own training code):</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-yaml" data-lang="yaml"><span class="line"><span class="cl"><span class="nt">apiVersion</span><span class="p">:</span><span class="w"> </span><span class="l">kubeflow.org/v1</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="nt">kind</span><span class="p">:</span><span class="w"> </span><span class="l">TFJob</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="nt">metadata</span><span class="p">:</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">  </span><span class="nt">generateName</span><span class="p">:</span><span class="w"> </span><span class="l">tfjob</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">  </span><span class="nt">namespace</span><span class="p">:</span><span class="w"> </span><span class="l">your-user-namespace</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="nt">spec</span><span class="p">:</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">  </span><span class="nt">tfReplicaSpecs</span><span class="p">:</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="nt">PS</span><span class="p">:</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">      </span><span class="nt">replicas</span><span class="p">:</span><span class="w"> </span><span class="m">1</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">      </span><span class="nt">restartPolicy</span><span class="p">:</span><span class="w"> </span><span class="l">OnFailure</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">      </span><span class="nt">template</span><span class="p">:</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">        </span><span class="nt">metadata</span><span class="p">:</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">          </span><span class="nt">annotations</span><span class="p">:</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">            </span><span class="nt">sidecar.istio.io/inject</span><span class="p">:</span><span class="w"> </span><span class="s2">&#34;false&#34;</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">        </span><span class="nt">spec</span><span class="p">:</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">          </span><span class="nt">containers</span><span class="p">:</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">            </span>- <span class="nt">name</span><span class="p">:</span><span class="w"> </span><span class="l">tensorflow</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">              </span><span class="nt">image</span><span class="p">:</span><span class="w"> </span><span class="l">gcr.io/your-project/your-image</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">              </span><span class="nt">command</span><span class="p">:</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">                </span>- <span class="l">python</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">                </span>- -<span class="l">m</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">                </span>- <span class="l">trainer.task</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">                </span>- --<span class="l">batch_size=32</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">                </span>- --<span class="l">training_steps=1000</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="nt">Worker</span><span class="p">:</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">      </span><span class="nt">replicas</span><span class="p">:</span><span class="w"> </span><span class="m">3</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">      </span><span class="nt">restartPolicy</span><span class="p">:</span><span class="w"> </span><span class="l">OnFailure</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">      </span><span class="nt">template</span><span class="p">:</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">        </span><span class="nt">metadata</span><span class="p">:</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">          </span><span class="nt">annotations</span><span class="p">:</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">            </span><span class="nt">sidecar.istio.io/inject</span><span class="p">:</span><span class="w"> </span><span class="s2">&#34;false&#34;</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">        </span><span class="nt">spec</span><span class="p">:</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">          </span><span class="nt">containers</span><span class="p">:</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">            </span>- <span class="nt">name</span><span class="p">:</span><span class="w"> </span><span class="l">tensorflow</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">              </span><span class="nt">image</span><span class="p">:</span><span class="w"> </span><span class="l">gcr.io/your-project/your-image</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">              </span><span class="nt">command</span><span class="p">:</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">                </span>- <span class="l">python</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">                </span>- -<span class="l">m</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">                </span>- <span class="l">trainer.task</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">                </span>- --<span class="l">batch_size=32</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">                </span>- --<span class="l">training_steps=1000</span><span class="w">
</span></span></span></code></pre></div><p>If you want to give your <code>TFJob</code> pods access to credentials secrets, such as the GCP credentials automatically created when you do a GKE-based Kubeflow installation, you can mount and use a secret like this:</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-yaml" data-lang="yaml"><span class="line"><span class="cl"><span class="nt">apiVersion</span><span class="p">:</span><span class="w"> </span><span class="l">kubeflow.org/v1</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="nt">kind</span><span class="p">:</span><span class="w"> </span><span class="l">TFJob</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="nt">metadata</span><span class="p">:</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">  </span><span class="nt">generateName</span><span class="p">:</span><span class="w"> </span><span class="l">tfjob</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">  </span><span class="nt">namespace</span><span class="p">:</span><span class="w"> </span><span class="l">your-user-namespace</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="nt">spec</span><span class="p">:</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">  </span><span class="nt">tfReplicaSpecs</span><span class="p">:</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="nt">PS</span><span class="p">:</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">      </span><span class="nt">replicas</span><span class="p">:</span><span class="w"> </span><span class="m">1</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">      </span><span class="nt">restartPolicy</span><span class="p">:</span><span class="w"> </span><span class="l">OnFailure</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">      </span><span class="nt">template</span><span class="p">:</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">        </span><span class="nt">metadata</span><span class="p">:</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">          </span><span class="nt">annotations</span><span class="p">:</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">            </span><span class="nt">sidecar.istio.io/inject</span><span class="p">:</span><span class="w"> </span><span class="s2">&#34;false&#34;</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">        </span><span class="nt">spec</span><span class="p">:</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">          </span><span class="nt">containers</span><span class="p">:</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">            </span>- <span class="nt">name</span><span class="p">:</span><span class="w"> </span><span class="l">tensorflow</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">              </span><span class="nt">image</span><span class="p">:</span><span class="w"> </span><span class="l">gcr.io/your-project/your-image</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">              </span><span class="nt">command</span><span class="p">:</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">                </span>- <span class="l">python</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">                </span>- -<span class="l">m</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">                </span>- <span class="l">trainer.task</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">                </span>- --<span class="l">batch_size=32</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">                </span>- --<span class="l">training_steps=1000</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">              </span><span class="nt">env</span><span class="p">:</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">                </span>- <span class="nt">name</span><span class="p">:</span><span class="w"> </span><span class="l">GOOGLE_APPLICATION_CREDENTIALS</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">                  </span><span class="nt">value</span><span class="p">:</span><span class="w"> </span><span class="s2">&#34;/etc/secrets/user-gcp-sa.json&#34;</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">              </span><span class="nt">volumeMounts</span><span class="p">:</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">                </span>- <span class="nt">name</span><span class="p">:</span><span class="w"> </span><span class="l">sa</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">                  </span><span class="nt">mountPath</span><span class="p">:</span><span class="w"> </span><span class="s2">&#34;/etc/secrets&#34;</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">                  </span><span class="nt">readOnly</span><span class="p">:</span><span class="w"> </span><span class="kc">true</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">          </span><span class="nt">volumes</span><span class="p">:</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">            </span>- <span class="nt">name</span><span class="p">:</span><span class="w"> </span><span class="l">sa</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">              </span><span class="nt">secret</span><span class="p">:</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">                </span><span class="nt">secretName</span><span class="p">:</span><span class="w"> </span><span class="l">user-gcp-sa</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="nt">Worker</span><span class="p">:</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">      </span><span class="nt">replicas</span><span class="p">:</span><span class="w"> </span><span class="m">1</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">      </span><span class="nt">restartPolicy</span><span class="p">:</span><span class="w"> </span><span class="l">OnFailure</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">      </span><span class="nt">template</span><span class="p">:</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">        </span><span class="nt">metadata</span><span class="p">:</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">          </span><span class="nt">annotations</span><span class="p">:</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">            </span><span class="nt">sidecar.istio.io/inject</span><span class="p">:</span><span class="w"> </span><span class="s2">&#34;false&#34;</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">        </span><span class="nt">spec</span><span class="p">:</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">          </span><span class="nt">containers</span><span class="p">:</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">            </span>- <span class="nt">name</span><span class="p">:</span><span class="w"> </span><span class="l">tensorflow</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">              </span><span class="nt">image</span><span class="p">:</span><span class="w"> </span><span class="l">gcr.io/your-project/your-image</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">              </span><span class="nt">command</span><span class="p">:</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">                </span>- <span class="l">python</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">                </span>- -<span class="l">m</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">                </span>- <span class="l">trainer.task</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">                </span>- --<span class="l">batch_size=32</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">                </span>- --<span class="l">training_steps=1000</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">              </span><span class="nt">env</span><span class="p">:</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">                </span>- <span class="nt">name</span><span class="p">:</span><span class="w"> </span><span class="l">GOOGLE_APPLICATION_CREDENTIALS</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">                  </span><span class="nt">value</span><span class="p">:</span><span class="w"> </span><span class="s2">&#34;/etc/secrets/user-gcp-sa.json&#34;</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">              </span><span class="nt">volumeMounts</span><span class="p">:</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">                </span>- <span class="nt">name</span><span class="p">:</span><span class="w"> </span><span class="l">sa</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">                  </span><span class="nt">mountPath</span><span class="p">:</span><span class="w"> </span><span class="s2">&#34;/etc/secrets&#34;</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">                  </span><span class="nt">readOnly</span><span class="p">:</span><span class="w"> </span><span class="kc">true</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">          </span><span class="nt">volumes</span><span class="p">:</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">            </span>- <span class="nt">name</span><span class="p">:</span><span class="w"> </span><span class="l">sa</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">              </span><span class="nt">secret</span><span class="p">:</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">                </span><span class="nt">secretName</span><span class="p">:</span><span class="w"> </span><span class="l">user-gcp-sa</span><span class="w">
</span></span></span></code></pre></div><p>If you are not familiar with Kubernetes resources please refer to the page <a href="https://kubernetes.io/docs/concepts/overview/working-with-objects/kubernetes-objects/">Understanding Kubernetes Objects</a>.</p>
<p>What makes <code>TFJob</code> different from built in <a href="https://kubernetes.io/docs/concepts/workloads/controllers/">controllers</a> is the <code>TFJob</code> spec is designed to manage
<a href="https://www.tensorflow.org/guide/distributed_training">distributed TensorFlow training jobs</a>.</p>
<p>A distributed TensorFlow job typically contains 0 or more of the following processes</p>
<ul>
<li><strong>Chief</strong> The chief is responsible for orchestrating training and performing tasks
like checkpointing the model.</li>
<li><strong>Ps</strong> The ps are parameter servers; these servers provide a distributed data store
for the model parameters.</li>
<li><strong>Worker</strong> The workers do the actual work of training the model. In some cases,
worker 0 might also act as the chief.</li>
<li><strong>Evaluator</strong> The evaluators can be used to compute evaluation metrics as the model
is trained.</li>
</ul>
<p>The field <strong>tfReplicaSpecs</strong> in <code>TFJob</code> spec contains a map from the type of
replica (as listed above) to the <strong>TFReplicaSpec</strong> for that replica. <strong>TFReplicaSpec</strong>
consists of 3 fields</p>
<ul>
<li>
<p><strong>replicas</strong> The number of replicas of this type to spawn for this <code>TFJob</code>.</p>
</li>
<li>
<p><strong>template</strong> A <a href="https://kubernetes.io/docs/reference/generated/kubernetes-api/v1.11/#podtemplatespec-v1-core">PodTemplateSpec</a> that describes the pod to create
for each replica.</p>
<ul>
<li><strong>The pod must include a container named <code>tensorflow</code></strong>.</li>
</ul>
</li>
<li>
<p><strong>restartPolicy</strong> Determines whether pods will be restarted when they exit. The
allowed values are as follows</p>
<ul>
<li>
<p><strong>Always</strong> means the pod will always be restarted. This policy is good
for parameter servers since they never exit and should always be restarted
in the event of failure.</p>
</li>
<li>
<p><strong>OnFailure</strong> means the pod will be restarted if the pod exits due to failure.</p>
<ul>
<li>A non-zero exit code indicates a failure.</li>
<li>An exit code of 0 indicates success and the pod will not be restarted.</li>
<li>This policy is good for chief and workers.</li>
</ul>
</li>
<li>
<p><strong>ExitCode</strong> means the restart behavior is dependent on the exit code of
the <code>tensorflow</code> container as follows:</p>
<ul>
<li>
<p>Exit code <code>0</code> indicates the process completed successfully and will
not be restarted.</p>
</li>
<li>
<p>The following exit codes indicate a permanent error and the container
will not be restarted:</p>
<ul>
<li><code>1</code>: general errors</li>
<li><code>2</code>: misuse of shell builtins</li>
<li><code>126</code>: command invoked cannot execute</li>
<li><code>127</code>: command not found</li>
<li><code>128</code>: invalid argument to exit</li>
<li><code>139</code>: container terminated by SIGSEGV (invalid memory reference)</li>
</ul>
</li>
<li>
<p>The following exit codes indicate a retryable error and the container
will be restarted:</p>
<ul>
<li><code>130</code>: container terminated by SIGINT (keyboard Control-C)</li>
<li><code>137</code>: container received a SIGKILL</li>
<li><code>143</code>: container received a SIGTERM</li>
</ul>
</li>
<li>
<p>Exit code <code>138</code> corresponds to SIGUSR1 and is reserved for
user-specified retryable errors.</p>
</li>
<li>
<p>Other exit codes are undefined and there is no guarantee about the
behavior.</p>
</li>
</ul>
<p>For background information on exit codes, see the <a href="https://www.gnu.org/software/libc/manual/html_node/Termination-Signals.html">GNU guide to
termination signals</a>
and the <a href="http://tldp.org/LDP/abs/html/exitcodes.html">Linux Documentation
Project</a>.</p>
</li>
<li>
<p><strong>Never</strong> means pods that terminate will never be restarted. This policy
should rarely be used because Kubernetes will terminate pods for any number
of reasons (e.g. node becomes unhealthy) and this will prevent the job from
recovering.</p>
</li>
</ul>
</li>
</ul>
<h2 id="installing-tensorflow-operator">Installing TensorFlow Operator</h2>
<p>If you haven&rsquo;t already done so please follow the <a href="/docs/started/getting-started/">Getting Started Guide</a> to deploy Kubeflow.</p>
<blockquote>
<p>By default, <code>TFJob</code> Operator will be deployed as a controller in training operator.</p>
</blockquote>
<p>If you want to install a standalone version of the training operator without Kubeflow,
see the <a href="https://github.com/kubeflow/training-operator#installation">kubeflow/training-operator&rsquo;s README</a>.</p>
<h3 id="verify-that-tfjob-support-is-included-in-your-kubeflow-deployment">Verify that TFJob support is included in your Kubeflow deployment</h3>
<p>Check that the TensorFlow custom resource is installed:</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-fallback" data-lang="fallback"><span class="line"><span class="cl">kubectl get crd
</span></span></code></pre></div><p>The output should include <code>tfjobs.kubeflow.org</code> like the following:</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-fallback" data-lang="fallback"><span class="line"><span class="cl">NAME                                             CREATED AT
</span></span><span class="line"><span class="cl">...
</span></span><span class="line"><span class="cl">tfjobs.kubeflow.org                         2021-09-06T18:33:58Z
</span></span><span class="line"><span class="cl">...
</span></span></code></pre></div><p>Check that the Training operator is running via:</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-fallback" data-lang="fallback"><span class="line"><span class="cl">kubectl get pods -n kubeflow
</span></span></code></pre></div><p>The output should include <code>training-operaror-xxx</code> like the following:</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-fallback" data-lang="fallback"><span class="line"><span class="cl">NAME                                READY   STATUS    RESTARTS   AGE
</span></span><span class="line"><span class="cl">training-operator-d466b46bc-xbqvs   1/1     Running   0          4m37s
</span></span></code></pre></div><h2 id="running-the-mnist-example">Running the Mnist example</h2>
<p>See the manifests for the <a href="https://github.com/kubeflow/training-operator/blob/master/examples/tensorflow/simple.yaml">distributed MNIST example</a>. You may change the config file based on your requirements.</p>
<p>Deploy the <code>TFJob</code> resource to start training:</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-fallback" data-lang="fallback"><span class="line"><span class="cl">kubectl create -f https://raw.githubusercontent.com/kubeflow/training-operator/master/examples/tensorflow/simple.yaml
</span></span></code></pre></div><p>Monitor the job (see the <a href="#monitoring-your-job">detailed guide below</a>):</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-fallback" data-lang="fallback"><span class="line"><span class="cl">kubectl -n kubeflow get tfjob tfjob-simple -o yaml
</span></span></code></pre></div><p>Delete it</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-fallback" data-lang="fallback"><span class="line"><span class="cl">kubectl -n kubeflow delete tfjob tfjob-simple
</span></span></code></pre></div><h2 id="customizing-the-tfjob">Customizing the TFJob</h2>
<p>Typically you can change the following values in the <code>TFJob</code> yaml file:</p>
<ol>
<li>
<p>Change the image to point to the docker image containing your code</p>
</li>
<li>
<p>Change the number and types of replicas</p>
</li>
<li>
<p>Change the resources (requests and limits) assigned to each resource</p>
</li>
<li>
<p>Set any environment variables</p>
<ul>
<li>For example, you might need to configure various environment variables to talk to datastores like GCS or S3</li>
</ul>
</li>
<li>
<p>Attach PVs if you want to use PVs for storage.</p>
</li>
</ol>
<h2 id="using-gpus">Using GPUs</h2>
<p>To use GPUs your cluster must be configured to use GPUs.</p>
<ul>
<li>Nodes must have GPUs attached.</li>
<li>The Kubernetes cluster must recognize the <code>nvidia.com/gpu</code> resource type.</li>
<li>GPU drivers must be installed on the cluster.</li>
<li>For more information:
<ul>
<li><a href="https://kubernetes.io/docs/tasks/manage-gpus/scheduling-gpus/">Kubernetes instructions for scheduling GPUs</a></li>
<li><a href="https://cloud.google.com/kubernetes-engine/docs/concepts/gpus">GKE instructions</a></li>
<li><a href="https://docs.aws.amazon.com/eks/latest/userguide/gpu-ami.html">EKS instructions</a></li>
</ul>
</li>
</ul>
<p>To attach GPUs specify the GPU resource on the container in the replicas
that should contain the GPUs; for example.</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-yaml" data-lang="yaml"><span class="line"><span class="cl"><span class="nt">apiVersion</span><span class="p">:</span><span class="w"> </span><span class="s2">&#34;kubeflow.org/v1&#34;</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="nt">kind</span><span class="p">:</span><span class="w"> </span><span class="s2">&#34;TFJob&#34;</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="nt">metadata</span><span class="p">:</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">  </span><span class="nt">name</span><span class="p">:</span><span class="w"> </span><span class="s2">&#34;tf-smoke-gpu&#34;</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="nt">spec</span><span class="p">:</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">  </span><span class="nt">tfReplicaSpecs</span><span class="p">:</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="nt">PS</span><span class="p">:</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">      </span><span class="nt">replicas</span><span class="p">:</span><span class="w"> </span><span class="m">1</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">      </span><span class="nt">template</span><span class="p">:</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">        </span><span class="nt">metadata</span><span class="p">:</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">          </span><span class="nt">creationTimestamp</span><span class="p">:</span><span class="w"> </span><span class="kc">null</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">        </span><span class="nt">spec</span><span class="p">:</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">          </span><span class="nt">containers</span><span class="p">:</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">            </span>- <span class="nt">args</span><span class="p">:</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">                </span>- <span class="l">python</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">                </span>- <span class="l">tf_cnn_benchmarks.py</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">                </span>- --<span class="l">batch_size=32</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">                </span>- --<span class="l">model=resnet50</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">                </span>- --<span class="l">variable_update=parameter_server</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">                </span>- --<span class="l">flush_stdout=true</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">                </span>- --<span class="l">num_gpus=1</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">                </span>- --<span class="l">local_parameter_device=cpu</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">                </span>- --<span class="l">device=cpu</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">                </span>- --<span class="l">data_format=NHWC</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">              </span><span class="nt">image</span><span class="p">:</span><span class="w"> </span><span class="l">gcr.io/kubeflow/tf-benchmarks-cpu:v20171202-bdab599-dirty-284af3</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">              </span><span class="nt">name</span><span class="p">:</span><span class="w"> </span><span class="l">tensorflow</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">              </span><span class="nt">ports</span><span class="p">:</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">                </span>- <span class="nt">containerPort</span><span class="p">:</span><span class="w"> </span><span class="m">2222</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">                  </span><span class="nt">name</span><span class="p">:</span><span class="w"> </span><span class="l">tfjob-port</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">              </span><span class="nt">resources</span><span class="p">:</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">                </span><span class="nt">limits</span><span class="p">:</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">                  </span><span class="nt">cpu</span><span class="p">:</span><span class="w"> </span><span class="s2">&#34;1&#34;</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">              </span><span class="nt">workingDir</span><span class="p">:</span><span class="w"> </span><span class="l">/opt/tf-benchmarks/scripts/tf_cnn_benchmarks</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">          </span><span class="nt">restartPolicy</span><span class="p">:</span><span class="w"> </span><span class="l">OnFailure</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="nt">Worker</span><span class="p">:</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">      </span><span class="nt">replicas</span><span class="p">:</span><span class="w"> </span><span class="m">1</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">      </span><span class="nt">template</span><span class="p">:</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">        </span><span class="nt">metadata</span><span class="p">:</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">          </span><span class="nt">creationTimestamp</span><span class="p">:</span><span class="w"> </span><span class="kc">null</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">        </span><span class="nt">spec</span><span class="p">:</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">          </span><span class="nt">containers</span><span class="p">:</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">            </span>- <span class="nt">args</span><span class="p">:</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">                </span>- <span class="l">python</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">                </span>- <span class="l">tf_cnn_benchmarks.py</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">                </span>- --<span class="l">batch_size=32</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">                </span>- --<span class="l">model=resnet50</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">                </span>- --<span class="l">variable_update=parameter_server</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">                </span>- --<span class="l">flush_stdout=true</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">                </span>- --<span class="l">num_gpus=1</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">                </span>- --<span class="l">local_parameter_device=cpu</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">                </span>- --<span class="l">device=gpu</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">                </span>- --<span class="l">data_format=NHWC</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">              </span><span class="nt">image</span><span class="p">:</span><span class="w"> </span><span class="l">gcr.io/kubeflow/tf-benchmarks-gpu:v20171202-bdab599-dirty-284af3</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">              </span><span class="nt">name</span><span class="p">:</span><span class="w"> </span><span class="l">tensorflow</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">              </span><span class="nt">ports</span><span class="p">:</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">                </span>- <span class="nt">containerPort</span><span class="p">:</span><span class="w"> </span><span class="m">2222</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">                  </span><span class="nt">name</span><span class="p">:</span><span class="w"> </span><span class="l">tfjob-port</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">              </span><span class="nt">resources</span><span class="p">:</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">                </span><span class="nt">limits</span><span class="p">:</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">                  </span><span class="nt">nvidia.com/gpu</span><span class="p">:</span><span class="w"> </span><span class="m">1</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">              </span><span class="nt">workingDir</span><span class="p">:</span><span class="w"> </span><span class="l">/opt/tf-benchmarks/scripts/tf_cnn_benchmarks</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">          </span><span class="nt">restartPolicy</span><span class="p">:</span><span class="w"> </span><span class="l">OnFailure</span><span class="w">
</span></span></span></code></pre></div><p>Follow TensorFlow&rsquo;s <a href="https://www.tensorflow.org/guide/gpu">instructions</a>
for using GPUs.</p>
<h2 id="monitoring-your-job">Monitoring your job</h2>
<p>To get the status of your job</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash"><span class="line"><span class="cl">kubectl -n kubeflow get -o yaml tfjobs tfjob-simple
</span></span></code></pre></div><p>Here is sample output for an example job</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-yaml" data-lang="yaml"><span class="line"><span class="cl"><span class="nt">apiVersion</span><span class="p">:</span><span class="w"> </span><span class="l">kubeflow.org/v1</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="nt">kind</span><span class="p">:</span><span class="w"> </span><span class="l">TFJob</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="nt">metadata</span><span class="p">:</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">  </span><span class="nt">creationTimestamp</span><span class="p">:</span><span class="w"> </span><span class="s2">&#34;2021-09-06T11:48:09Z&#34;</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">  </span><span class="nt">generation</span><span class="p">:</span><span class="w"> </span><span class="m">1</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">  </span><span class="nt">name</span><span class="p">:</span><span class="w"> </span><span class="l">tfjob-simple</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">  </span><span class="nt">namespace</span><span class="p">:</span><span class="w"> </span><span class="l">kubeflow</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">  </span><span class="nt">resourceVersion</span><span class="p">:</span><span class="w"> </span><span class="s2">&#34;5764004&#34;</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">  </span><span class="nt">selfLink</span><span class="p">:</span><span class="w"> </span><span class="l">/apis/kubeflow.org/v1/namespaces/kubeflow/tfjobs/tfjob-simple</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">  </span><span class="nt">uid</span><span class="p">:</span><span class="w"> </span><span class="l">3a67a9a9-cb89-4c1f-a189-f49f0b581e29</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="nt">spec</span><span class="p">:</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">  </span><span class="nt">tfReplicaSpecs</span><span class="p">:</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="nt">Worker</span><span class="p">:</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">      </span><span class="nt">replicas</span><span class="p">:</span><span class="w"> </span><span class="m">2</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">      </span><span class="nt">restartPolicy</span><span class="p">:</span><span class="w"> </span><span class="l">OnFailure</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">      </span><span class="nt">template</span><span class="p">:</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">        </span><span class="nt">spec</span><span class="p">:</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">          </span><span class="nt">containers</span><span class="p">:</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">            </span>- <span class="nt">command</span><span class="p">:</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">                </span>- <span class="l">python</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">                </span>- <span class="l">/var/tf_mnist/mnist_with_summaries.py</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">              </span><span class="nt">image</span><span class="p">:</span><span class="w"> </span><span class="l">gcr.io/kubeflow-ci/tf-mnist-with-summaries:1.0</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">              </span><span class="nt">name</span><span class="p">:</span><span class="w"> </span><span class="l">tensorflow</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="nt">status</span><span class="p">:</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">  </span><span class="nt">completionTime</span><span class="p">:</span><span class="w"> </span><span class="s2">&#34;2021-09-06T11:49:30Z&#34;</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">  </span><span class="nt">conditions</span><span class="p">:</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span>- <span class="nt">lastTransitionTime</span><span class="p">:</span><span class="w"> </span><span class="s2">&#34;2021-09-06T11:48:09Z&#34;</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">      </span><span class="nt">lastUpdateTime</span><span class="p">:</span><span class="w"> </span><span class="s2">&#34;2021-09-06T11:48:09Z&#34;</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">      </span><span class="nt">message</span><span class="p">:</span><span class="w"> </span><span class="l">TFJob tfjob-simple is created.</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">      </span><span class="nt">reason</span><span class="p">:</span><span class="w"> </span><span class="l">TFJobCreated</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">      </span><span class="nt">status</span><span class="p">:</span><span class="w"> </span><span class="s2">&#34;True&#34;</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">      </span><span class="nt">type</span><span class="p">:</span><span class="w"> </span><span class="l">Created</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span>- <span class="nt">lastTransitionTime</span><span class="p">:</span><span class="w"> </span><span class="s2">&#34;2021-09-06T11:48:12Z&#34;</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">      </span><span class="nt">lastUpdateTime</span><span class="p">:</span><span class="w"> </span><span class="s2">&#34;2021-09-06T11:48:12Z&#34;</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">      </span><span class="nt">message</span><span class="p">:</span><span class="w"> </span><span class="l">TFJob kubeflow/tfjob-simple is running.</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">      </span><span class="nt">reason</span><span class="p">:</span><span class="w"> </span><span class="l">TFJobRunning</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">      </span><span class="nt">status</span><span class="p">:</span><span class="w"> </span><span class="s2">&#34;False&#34;</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">      </span><span class="nt">type</span><span class="p">:</span><span class="w"> </span><span class="l">Running</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span>- <span class="nt">lastTransitionTime</span><span class="p">:</span><span class="w"> </span><span class="s2">&#34;2021-09-06T11:49:30Z&#34;</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">      </span><span class="nt">lastUpdateTime</span><span class="p">:</span><span class="w"> </span><span class="s2">&#34;2021-09-06T11:49:30Z&#34;</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">      </span><span class="nt">message</span><span class="p">:</span><span class="w"> </span><span class="l">TFJob kubeflow/tfjob-simple successfully completed.</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">      </span><span class="nt">reason</span><span class="p">:</span><span class="w"> </span><span class="l">TFJobSucceeded</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">      </span><span class="nt">status</span><span class="p">:</span><span class="w"> </span><span class="s2">&#34;True&#34;</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">      </span><span class="nt">type</span><span class="p">:</span><span class="w"> </span><span class="l">Succeeded</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">  </span><span class="nt">replicaStatuses</span><span class="p">:</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="nt">Worker</span><span class="p">:</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">      </span><span class="nt">succeeded</span><span class="p">:</span><span class="w"> </span><span class="m">2</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">  </span><span class="nt">startTime</span><span class="p">:</span><span class="w"> </span><span class="s2">&#34;2021-09-06T11:48:10Z&#34;</span><span class="w">
</span></span></span></code></pre></div><h3 id="conditions">Conditions</h3>
<p>A <code>TFJob</code> has a <code>TFJobStatus</code>, which has an array of <code>TFJobConditions</code> through which the <code>TFJob</code> has or has not passed.
Each element of the <code>TFJobCondition</code> array has six possible fields:</p>
<ul>
<li>The <strong>lastUpdateTime</strong> field provides the last time this condition was updated.</li>
<li>The <strong>lastTransitionTime</strong> field provides the last time the condition transitioned from one status to another.</li>
<li>The <strong>message</strong> field is a human readable message indicating details about the transition.</li>
<li>The <strong>reason</strong> field is a unique, one-word, CamelCase reason for the condition&rsquo;s
last transition.</li>
<li>The <strong>status</strong> field is a string with possible values &ldquo;True&rdquo;, &ldquo;False&rdquo;, and &ldquo;Unknown&rdquo;.</li>
<li>The <strong>type</strong> field is a string with the following possible values:
<ul>
<li><strong>TFJobCreated</strong> means the <code>TFJob</code> has been accepted by the system,
but one or more of the pods/services has not been started.</li>
<li><strong>TFJobRunning</strong> means all sub-resources (e.g. services/pods) of this <code>TFJob</code>
have been successfully scheduled and launched and the job is running.</li>
<li><strong>TFJobRestarting</strong> means one or more sub-resources (e.g. services/pods)
of this <code>TFJob</code> had a problem and is being restarted.</li>
<li><strong>TFJobSucceeded</strong> means the job completed successfully.</li>
<li><strong>TFJobFailed</strong> means the job has failed.</li>
</ul>
</li>
</ul>
<p>Success or failure of a job is determined as follows</p>
<ul>
<li>If a job has a <strong>chief</strong>, success or failure is determined by the status
of the chief.</li>
<li>If a job has no chief, success or failure is determined by the workers.</li>
<li>In both cases, the <code>TFJob</code> succeeds if the process being monitored exits
with exit code 0.</li>
<li>In the case of non-zero exit code, the behavior is determined by the restartPolicy
for the replica.</li>
<li>If the restartPolicy allows for restarts then the process will just be restarted and the <code>TFJob</code> will continue to execute.
<ul>
<li>For the restartPolicy ExitCode the behavior is exit code dependent.</li>
<li>If the restartPolicy doesn&rsquo;t allow restarts a non-zero exit code is considered
a permanent failure and the job is marked failed.</li>
</ul>
</li>
</ul>
<h3 id="tfreplicastatuses">tfReplicaStatuses</h3>
<p>tfReplicaStatuses provides a map indicating the number of pods for each
replica in a given state. There are three possible states</p>
<ul>
<li><strong>Active</strong> is the number of currently running pods.</li>
<li><strong>Succeeded</strong> is the number of pods that completed successfully.</li>
<li><strong>Failed</strong> is the number of pods that completed with an error.</li>
</ul>
<h3 id="events">Events</h3>
<p>During execution, <code>TFJob</code> will emit events to indicate whats happening such
as the creation/deletion of pods and services. Kubernetes doesn&rsquo;t retain
events older than 1 hour by default. To see recent events for a job run</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-fallback" data-lang="fallback"><span class="line"><span class="cl">kubectl -n kubeflow describe tfjobs tfjob-simple
</span></span></code></pre></div><p>which will produce output like</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-fallback" data-lang="fallback"><span class="line"><span class="cl">Name:         tfjob-simple
</span></span><span class="line"><span class="cl">Namespace:    kubeflow
</span></span><span class="line"><span class="cl">Labels:       &lt;none&gt;
</span></span><span class="line"><span class="cl">Annotations:  &lt;none&gt;
</span></span><span class="line"><span class="cl">API Version:  kubeflow.org/v1
</span></span><span class="line"><span class="cl">Kind:         TFJob
</span></span><span class="line"><span class="cl">Metadata:
</span></span><span class="line"><span class="cl">  Creation Timestamp:  2021-09-06T11:48:09Z
</span></span><span class="line"><span class="cl">  Generation:          1
</span></span><span class="line"><span class="cl">  Managed Fields:
</span></span><span class="line"><span class="cl">    API Version:  kubeflow.org/v1
</span></span><span class="line"><span class="cl">    Fields Type:  FieldsV1
</span></span><span class="line"><span class="cl">    fieldsV1:
</span></span><span class="line"><span class="cl">      f:spec:
</span></span><span class="line"><span class="cl">        .:
</span></span><span class="line"><span class="cl">        f:tfReplicaSpecs:
</span></span><span class="line"><span class="cl">          .:
</span></span><span class="line"><span class="cl">          f:Worker:
</span></span><span class="line"><span class="cl">            .:
</span></span><span class="line"><span class="cl">            f:replicas:
</span></span><span class="line"><span class="cl">            f:restartPolicy:
</span></span><span class="line"><span class="cl">            f:template:
</span></span><span class="line"><span class="cl">              .:
</span></span><span class="line"><span class="cl">              f:spec:
</span></span><span class="line"><span class="cl">    Manager:      kubectl-create
</span></span><span class="line"><span class="cl">    Operation:    Update
</span></span><span class="line"><span class="cl">    Time:         2021-09-06T11:48:09Z
</span></span><span class="line"><span class="cl">    API Version:  kubeflow.org/v1
</span></span><span class="line"><span class="cl">    Fields Type:  FieldsV1
</span></span><span class="line"><span class="cl">    fieldsV1:
</span></span><span class="line"><span class="cl">      f:spec:
</span></span><span class="line"><span class="cl">        f:runPolicy:
</span></span><span class="line"><span class="cl">          .:
</span></span><span class="line"><span class="cl">          f:cleanPodPolicy:
</span></span><span class="line"><span class="cl">        f:successPolicy:
</span></span><span class="line"><span class="cl">        f:tfReplicaSpecs:
</span></span><span class="line"><span class="cl">          f:Worker:
</span></span><span class="line"><span class="cl">            f:template:
</span></span><span class="line"><span class="cl">              f:metadata:
</span></span><span class="line"><span class="cl">              f:spec:
</span></span><span class="line"><span class="cl">                f:containers:
</span></span><span class="line"><span class="cl">      f:status:
</span></span><span class="line"><span class="cl">        .:
</span></span><span class="line"><span class="cl">        f:completionTime:
</span></span><span class="line"><span class="cl">        f:conditions:
</span></span><span class="line"><span class="cl">        f:replicaStatuses:
</span></span><span class="line"><span class="cl">          .:
</span></span><span class="line"><span class="cl">          f:Worker:
</span></span><span class="line"><span class="cl">            .:
</span></span><span class="line"><span class="cl">            f:succeeded:
</span></span><span class="line"><span class="cl">        f:startTime:
</span></span><span class="line"><span class="cl">    Manager:         manager
</span></span><span class="line"><span class="cl">    Operation:       Update
</span></span><span class="line"><span class="cl">    Time:            2021-09-06T11:49:30Z
</span></span><span class="line"><span class="cl">  Resource Version:  5764004
</span></span><span class="line"><span class="cl">  Self Link:         /apis/kubeflow.org/v1/namespaces/kubeflow/tfjobs/tfjob-simple
</span></span><span class="line"><span class="cl">  UID:               3a67a9a9-cb89-4c1f-a189-f49f0b581e29
</span></span><span class="line"><span class="cl">Spec:
</span></span><span class="line"><span class="cl">  Tf Replica Specs:
</span></span><span class="line"><span class="cl">    Worker:
</span></span><span class="line"><span class="cl">      Replicas:        2
</span></span><span class="line"><span class="cl">      Restart Policy:  OnFailure
</span></span><span class="line"><span class="cl">      Template:
</span></span><span class="line"><span class="cl">        Spec:
</span></span><span class="line"><span class="cl">          Containers:
</span></span><span class="line"><span class="cl">            Command:
</span></span><span class="line"><span class="cl">              python
</span></span><span class="line"><span class="cl">              /var/tf_mnist/mnist_with_summaries.py
</span></span><span class="line"><span class="cl">            Image:  gcr.io/kubeflow-ci/tf-mnist-with-summaries:1.0
</span></span><span class="line"><span class="cl">            Name:   tensorflow
</span></span><span class="line"><span class="cl">Status:
</span></span><span class="line"><span class="cl">  Completion Time:  2021-09-06T11:49:30Z
</span></span><span class="line"><span class="cl">  Conditions:
</span></span><span class="line"><span class="cl">    Last Transition Time:  2021-09-06T11:48:09Z
</span></span><span class="line"><span class="cl">    Last Update Time:      2021-09-06T11:48:09Z
</span></span><span class="line"><span class="cl">    Message:               TFJob tfjob-simple is created.
</span></span><span class="line"><span class="cl">    Reason:                TFJobCreated
</span></span><span class="line"><span class="cl">    Status:                True
</span></span><span class="line"><span class="cl">    Type:                  Created
</span></span><span class="line"><span class="cl">    Last Transition Time:  2021-09-06T11:48:12Z
</span></span><span class="line"><span class="cl">    Last Update Time:      2021-09-06T11:48:12Z
</span></span><span class="line"><span class="cl">    Message:               TFJob kubeflow/tfjob-simple is running.
</span></span><span class="line"><span class="cl">    Reason:                TFJobRunning
</span></span><span class="line"><span class="cl">    Status:                False
</span></span><span class="line"><span class="cl">    Type:                  Running
</span></span><span class="line"><span class="cl">    Last Transition Time:  2021-09-06T11:49:30Z
</span></span><span class="line"><span class="cl">    Last Update Time:      2021-09-06T11:49:30Z
</span></span><span class="line"><span class="cl">    Message:               TFJob kubeflow/tfjob-simple successfully completed.
</span></span><span class="line"><span class="cl">    Reason:                TFJobSucceeded
</span></span><span class="line"><span class="cl">    Status:                True
</span></span><span class="line"><span class="cl">    Type:                  Succeeded
</span></span><span class="line"><span class="cl">  Replica Statuses:
</span></span><span class="line"><span class="cl">    Worker:
</span></span><span class="line"><span class="cl">      Succeeded:  2
</span></span><span class="line"><span class="cl">  Start Time:     2021-09-06T11:48:10Z
</span></span><span class="line"><span class="cl">Events:
</span></span><span class="line"><span class="cl">  Type    Reason                   Age                    From              Message
</span></span><span class="line"><span class="cl">  ----    ------                   ----                   ----              -------
</span></span><span class="line"><span class="cl">  Normal  SuccessfulCreatePod      7m9s                   tfjob-controller  Created pod: tfjob-simple-worker-0
</span></span><span class="line"><span class="cl">  Normal  SuccessfulCreatePod      7m8s                   tfjob-controller  Created pod: tfjob-simple-worker-1
</span></span><span class="line"><span class="cl">  Normal  SuccessfulCreateService  7m8s                   tfjob-controller  Created service: tfjob-simple-worker-0
</span></span><span class="line"><span class="cl">  Normal  SuccessfulCreateService  7m8s                   tfjob-controller  Created service: tfjob-simple-worker-1
</span></span><span class="line"><span class="cl">  Normal  ExitedWithCode           5m48s (x3 over 5m48s)  tfjob-controller  Pod: kubeflow.tfjob-simple-worker-1 exited with code 0
</span></span><span class="line"><span class="cl">  Normal  ExitedWithCode           5m48s                  tfjob-controller  Pod: kubeflow.tfjob-simple-worker-0 exited with code 0
</span></span><span class="line"><span class="cl">  Normal  TFJobSucceeded           5m48s                  tfjob-controller  TFJob kubeflow/tfjob-simple successfully completed.
</span></span></code></pre></div><p>Here the events indicate that the pods and services were successfully created.</p>
<h2 id="tensorflow-logs">TensorFlow Logs</h2>
<p>Logging follows standard K8s logging practices.</p>
<p>You can use kubectl to get standard output/error for any pods
that haven&rsquo;t been <strong>deleted</strong>.</p>
<p>First find the pod created by the job controller for the replica of
interest. Pods will be named</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-fallback" data-lang="fallback"><span class="line"><span class="cl">${JOBNAME}-${REPLICA-TYPE}-${INDEX}
</span></span></code></pre></div><p>Once you&rsquo;ve identified your pod you can get the logs using kubectl.</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-fallback" data-lang="fallback"><span class="line"><span class="cl">kubectl logs ${PODNAME}
</span></span></code></pre></div><p>The <strong>CleanPodPolicy</strong> in the <code>TFJob</code> spec controls deletion of pods when a job terminates.
The policy can be one of the following values</p>
<ul>
<li>The <strong>Running</strong> policy means that only pods still running when a job completes
(e.g. parameter servers) will be deleted immediately; completed pods will
not be deleted so that the logs will be preserved. This is the default value.</li>
<li>The <strong>All</strong> policy means all pods even completed pods will be deleted immediately
when the job finishes.</li>
<li>The <strong>None</strong> policy means that no pods will be deleted when the job completes.</li>
</ul>
<p>If your cluster takes advantage of Kubernetes
<a href="https://kubernetes.io/docs/concepts/cluster-administration/logging/">cluster logging</a>
then your logs may also be shipped to an appropriate data store for
further analysis.</p>
<h3 id="stackdriver-on-gke">Stackdriver on GKE</h3>
<p>See the guide to <a href="/docs/gke/monitoring/">logging and monitoring</a> for
instructions on getting logs using Stackdriver.</p>
<p>As described in the guide to
<a href="https://www.kubeflow.org/docs/gke/monitoring/#filter-with-labels">logging and monitoring</a>,
it&rsquo;s possible to fetch the logs for a particular replica based on pod labels.</p>
<p>Using the Stackdriver UI you can use a query like</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-fallback" data-lang="fallback"><span class="line"><span class="cl">resource.type=&#34;k8s_container&#34;
</span></span><span class="line"><span class="cl">resource.labels.cluster_name=&#34;${CLUSTER}&#34;
</span></span><span class="line"><span class="cl">metadata.userLabels.job-name=&#34;${JOB_NAME}&#34;
</span></span><span class="line"><span class="cl">metadata.userLabels.replica-type=&#34;${TYPE}&#34;
</span></span><span class="line"><span class="cl">metadata.userLabels.replica-index=&#34;${INDEX}&#34;
</span></span></code></pre></div><p>Alternatively using gcloud</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-fallback" data-lang="fallback"><span class="line"><span class="cl">QUERY=&#34;resource.type=\&#34;k8s_container\&#34; &#34;
</span></span><span class="line"><span class="cl">QUERY=&#34;${QUERY} resource.labels.cluster_name=\&#34;${CLUSTER}\&#34; &#34;
</span></span><span class="line"><span class="cl">QUERY=&#34;${QUERY} metadata.userLabels.job-name=\&#34;${JOB_NAME}\&#34; &#34;
</span></span><span class="line"><span class="cl">QUERY=&#34;${QUERY} metadata.userLabels.replica-type=\&#34;${TYPE}\&#34; &#34;
</span></span><span class="line"><span class="cl">QUERY=&#34;${QUERY} metadata.userLabels.replica-index=\&#34;${INDEX}\&#34; &#34;
</span></span><span class="line"><span class="cl">gcloud --project=${PROJECT} logging read  \
</span></span><span class="line"><span class="cl">     --freshness=24h \
</span></span><span class="line"><span class="cl">     --order asc  ${QUERY}
</span></span></code></pre></div><h2 id="troubleshooting">Troubleshooting</h2>
<p>Here are some steps to follow to troubleshoot your job</p>
<ol>
<li>
<p>Is a status present for your job? Run the command</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-fallback" data-lang="fallback"><span class="line"><span class="cl">kubectl -n ${USER_NAMESPACE} get tfjobs -o yaml ${JOB_NAME}
</span></span></code></pre></div><ul>
<li>
<p><strong>USER_NAMESPACE</strong> is the namespace created for your user profile.</p>
</li>
<li>
<p>If the resulting output doesn&rsquo;t include a status for your job then this typically
indicates the job spec is invalid.</p>
</li>
<li>
<p>If the <code>TFJob</code> spec is invalid there should be a log message in the tf operator logs</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-fallback" data-lang="fallback"><span class="line"><span class="cl">kubectl -n ${KUBEFLOW_NAMESPACE} logs `kubectl get pods --selector=name=tf-job-operator -o jsonpath=&#39;{.items[0].metadata.name}&#39;`
</span></span></code></pre></div><ul>
<li><strong>KUBEFLOW_NAMESPACE</strong> Is the namespace you deployed the <code>TFJob</code> operator in.</li>
</ul>
</li>
</ul>
</li>
<li>
<p>Check the events for your job to see if the pods were created</p>
<ul>
<li>
<p>There are a number of ways to get the events; if your job is less than <strong>1 hour old</strong>
then you can do</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-fallback" data-lang="fallback"><span class="line"><span class="cl">kubectl -n ${USER_NAMESPACE} describe tfjobs ${JOB_NAME}
</span></span></code></pre></div></li>
<li>
<p>The bottom of the output should include a list of events emitted by the job; e.g.</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-yaml" data-lang="yaml"><span class="line"><span class="cl"><span class="nt">Events</span><span class="p">:</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"> </span><span class="l">Type    Reason                   Age   From              Message</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"> </span>---- <span class="w">   </span>------ <span class="w">                  </span>---- <span class="w"> </span>---- <span class="w">             </span>-------<span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"> </span><span class="nt">Normal  SuccessfulCreatePod      90s   tfjob-controller  Created pod</span><span class="p">:</span><span class="w"> </span><span class="l">tfjob2-worker-0</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"> </span><span class="nt">Normal  SuccessfulCreatePod      90s   tfjob-controller  Created pod</span><span class="p">:</span><span class="w"> </span><span class="l">tfjob2-ps-0</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"> </span><span class="nt">Normal  SuccessfulCreateService  90s   tfjob-controller  Created service</span><span class="p">:</span><span class="w"> </span><span class="l">tfjob2-worker-0</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"> </span><span class="nt">Normal  SuccessfulCreateService  90s   tfjob-controller  Created service</span><span class="p">:</span><span class="w"> </span><span class="l">tfjob2-ps-0</span><span class="w">
</span></span></span></code></pre></div></li>
<li>
<p>Kubernetes only preserves events for <strong>1 hour</strong> (see <a href="https://github.com/kubernetes/kubernetes/issues/52521">kubernetes/kubernetes#52521</a>)</p>
<ul>
<li>Depending on your cluster setup events might be persisted to external storage and accessible for longer periods</li>
<li>On GKE events are persisted in stackdriver and can be accessed using the instructions in the previous section.</li>
</ul>
</li>
<li>
<p>If the pods and services aren&rsquo;t being created then this suggests the <code>TFJob</code> isn&rsquo;t being processed; common causes are</p>
<ul>
<li>The <code>TFJob</code> spec is invalid (see above)</li>
<li>The <code>TFJob</code> operator isn&rsquo;t running</li>
</ul>
</li>
</ul>
</li>
<li>
<p>Check the events for the pods to ensure they are scheduled.</p>
<ul>
<li>
<p>There are a number of ways to get the events; if your pod is less than <strong>1 hour old</strong>
then you can do</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-fallback" data-lang="fallback"><span class="line"><span class="cl"> kubectl -n ${USER_NAMESPACE} describe pods ${POD_NAME}
</span></span></code></pre></div></li>
<li>
<p>The bottom of the output should contain events like the following</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-fallback" data-lang="fallback"><span class="line"><span class="cl">Events:
</span></span><span class="line"><span class="cl">Type    Reason                 Age   From                                                  Message
</span></span><span class="line"><span class="cl">----    ------                 ----  ----                                                  -------
</span></span><span class="line"><span class="cl">Normal  Scheduled              18s   default-scheduler                                     Successfully assigned tfjob2-ps-0 to gke-jl-kf-v0-2-2-default-pool-347936c1-1qkt
</span></span><span class="line"><span class="cl">Normal  SuccessfulMountVolume  17s   kubelet, gke-jl-kf-v0-2-2-default-pool-347936c1-1qkt  MountVolume.SetUp succeeded for volume &#34;default-token-h8rnv&#34;
</span></span><span class="line"><span class="cl">Normal  Pulled                 17s   kubelet, gke-jl-kf-v0-2-2-default-pool-347936c1-1qkt  Container image &#34;gcr.io/kubeflow/tf-benchmarks-cpu:v20171202-bdab599-dirty-284af3&#34; already present on machine
</span></span><span class="line"><span class="cl">Normal  Created                17s   kubelet, gke-jl-kf-v0-2-2-default-pool-347936c1-1qkt  Created container
</span></span><span class="line"><span class="cl">Normal  Started                16s   kubelet, gke-jl-kf-v0-2-2-default-pool-347936c1-1qkt  Started container
</span></span></code></pre></div></li>
<li>
<p>Some common problems that can prevent a container from starting are</p>
<ul>
<li>Insufficient resources to schedule the pod</li>
<li>The pod tries to mount a volume (or secret) that doesn&rsquo;t exist or is unavailable</li>
<li>The docker image doesn&rsquo;t exist or can&rsquo;t be accessed (e.g due to permission issues)</li>
</ul>
</li>
</ul>
</li>
<li>
<p>If the containers start; check the logs of the containers following the instructions
in the previous section.</p>
</li>
</ol>
<h2 id="more-information">More information</h2>
<ul>
<li>Explore the <a href="/docs/reference/tfjob"><code>TFJob</code> reference documentation</a>.</li>
<li>See how to <a href="/docs/use-cases/job-scheduling#running-jobs-with-gang-scheduling">run a job with gang-scheduling</a>.</li>
</ul>

</div>



    
	
  
    
    
	
    

<div class="td-content" style="page-break-before: always">
    
	<h1 id="pg-94aec72d7979152842ed2f8cbe6dbe06">5.2 - PyTorch Training (PyTorchJob)</h1>
    <div class="lead">Using PyTorchJob to train a model with PyTorch</div>
	<div class="alert alert-primary" role="alert">
This Kubeflow component has <b>stable</b> status. See the
<a href="/docs/started/support/#application-status">Kubeflow versioning policies</a>.
</div>
<p>This page describes <code>PyTorchJob</code> for training a machine learning model with <a href="https://pytorch.org/">PyTorch</a>.</p>
<p><code>PyTorchJob</code> is a Kubernetes
<a href="https://kubernetes.io/docs/concepts/extend-kubernetes/api-extension/custom-resources/">custom resource</a>
to run PyTorch training jobs on Kubernetes. The Kubeflow implementation of
<code>PyTorchJob</code> is in <a href="https://github.com/kubeflow/training-operator"><code>training-operator</code></a>.</p>
<h2 id="installing-pytorch-operator">Installing PyTorch Operator</h2>
<p>If you haven&rsquo;t already done so please follow the <a href="/docs/started/getting-started/">Getting Started Guide</a> to deploy Kubeflow.</p>
<blockquote>
<p>By default, PyTorch Operator will be deployed as a controller in training operator.</p>
</blockquote>
<p>If you want to install a standalone version of the training operator without Kubeflow,
see the <a href="https://github.com/kubeflow/training-operator#installation">kubeflow/training-operator&rsquo;s README</a>.</p>
<h3 id="verify-that-pytorchjob-support-is-included-in-your-kubeflow-deployment">Verify that PyTorchJob support is included in your Kubeflow deployment</h3>
<p>Check that the PyTorch custom resource is installed:</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-fallback" data-lang="fallback"><span class="line"><span class="cl">kubectl get crd
</span></span></code></pre></div><p>The output should include <code>pytorchjobs.kubeflow.org</code> like the following:</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-fallback" data-lang="fallback"><span class="line"><span class="cl">NAME                                             CREATED AT
</span></span><span class="line"><span class="cl">...
</span></span><span class="line"><span class="cl">pytorchjobs.kubeflow.org                         2021-09-06T18:33:58Z
</span></span><span class="line"><span class="cl">...
</span></span></code></pre></div><p>Check that the Training operator is running via:</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-fallback" data-lang="fallback"><span class="line"><span class="cl">kubectl get pods -n kubeflow
</span></span></code></pre></div><p>The output should include <code>training-operaror-xxx</code> like the following:</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-fallback" data-lang="fallback"><span class="line"><span class="cl">NAME                                READY   STATUS    RESTARTS   AGE
</span></span><span class="line"><span class="cl">training-operator-d466b46bc-xbqvs   1/1     Running   0          4m37s
</span></span></code></pre></div><h2 id="creating-a-pytorch-training-job">Creating a PyTorch training job</h2>
<p>You can create a training job by defining a <code>PyTorchJob</code> config file. See the manifests for the <a href="https://github.com/kubeflow/training-operator/blob/master/examples/pytorch/simple.yaml">distributed MNIST example</a>. You may change the config file based on your requirements.</p>
<p>Deploy the <code>PyTorchJob</code> resource to start training:</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-fallback" data-lang="fallback"><span class="line"><span class="cl">kubectl create -f https://raw.githubusercontent.com/kubeflow/training-operator/master/examples/pytorch/simple.yaml
</span></span></code></pre></div><p>You should now be able to see the created pods matching the specified number of replicas.</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-fallback" data-lang="fallback"><span class="line"><span class="cl">kubectl get pods -l job-name=pytorch-simple -n kubeflow
</span></span></code></pre></div><p>Training takes 5-10 minutes on a cpu cluster. Logs can be inspected to see its training progress.</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-fallback" data-lang="fallback"><span class="line"><span class="cl">PODNAME=$(kubectl get pods -l job-name=pytorch-simple,replica-type=master,replica-index=0 -o name -n kubeflow)
</span></span><span class="line"><span class="cl">kubectl logs -f ${PODNAME} -n kubeflow
</span></span></code></pre></div><h2 id="monitoring-a-pytorchjob">Monitoring a PyTorchJob</h2>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-fallback" data-lang="fallback"><span class="line"><span class="cl">kubectl get -o yaml pytorchjobs pytorch-simple -n kubeflow
</span></span></code></pre></div><p>See the status section to monitor the job status. Here is sample output when the job is successfully completed.</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-fallback" data-lang="fallback"><span class="line"><span class="cl">apiVersion: kubeflow.org/v1
</span></span><span class="line"><span class="cl">kind: PyTorchJob
</span></span><span class="line"><span class="cl">metadata:
</span></span><span class="line"><span class="cl">  clusterName: &#34;&#34;
</span></span><span class="line"><span class="cl">  creationTimestamp: 2018-12-16T21:39:09Z
</span></span><span class="line"><span class="cl">  generation: 1
</span></span><span class="line"><span class="cl">  name: pytorch-tcp-dist-mnist
</span></span><span class="line"><span class="cl">  namespace: default
</span></span><span class="line"><span class="cl">  resourceVersion: &#34;15532&#34;
</span></span><span class="line"><span class="cl">  selfLink: /apis/kubeflow.org/v1/namespaces/default/pytorchjobs/pytorch-tcp-dist-mnist
</span></span><span class="line"><span class="cl">  uid: 059391e8-017b-11e9-bf13-06afd8f55a5c
</span></span><span class="line"><span class="cl">spec:
</span></span><span class="line"><span class="cl">  cleanPodPolicy: None
</span></span><span class="line"><span class="cl">  pytorchReplicaSpecs:
</span></span><span class="line"><span class="cl">    Master:
</span></span><span class="line"><span class="cl">      replicas: 1
</span></span><span class="line"><span class="cl">      restartPolicy: OnFailure
</span></span><span class="line"><span class="cl">      template:
</span></span><span class="line"><span class="cl">        metadata:
</span></span><span class="line"><span class="cl">          creationTimestamp: null
</span></span><span class="line"><span class="cl">        spec:
</span></span><span class="line"><span class="cl">          containers:
</span></span><span class="line"><span class="cl">          - image: gcr.io/kubeflow-ci/pytorch-dist-mnist_test:1.0
</span></span><span class="line"><span class="cl">            name: pytorch
</span></span><span class="line"><span class="cl">            ports:
</span></span><span class="line"><span class="cl">            - containerPort: 23456
</span></span><span class="line"><span class="cl">              name: pytorchjob-port
</span></span><span class="line"><span class="cl">            resources: {}
</span></span><span class="line"><span class="cl">    Worker:
</span></span><span class="line"><span class="cl">      replicas: 3
</span></span><span class="line"><span class="cl">      restartPolicy: OnFailure
</span></span><span class="line"><span class="cl">      template:
</span></span><span class="line"><span class="cl">        metadata:
</span></span><span class="line"><span class="cl">          creationTimestamp: null
</span></span><span class="line"><span class="cl">        spec:
</span></span><span class="line"><span class="cl">          containers:
</span></span><span class="line"><span class="cl">          - image: gcr.io/kubeflow-ci/pytorch-dist-mnist_test:1.0
</span></span><span class="line"><span class="cl">            name: pytorch
</span></span><span class="line"><span class="cl">            ports:
</span></span><span class="line"><span class="cl">            - containerPort: 23456
</span></span><span class="line"><span class="cl">              name: pytorchjob-port
</span></span><span class="line"><span class="cl">            resources: {}
</span></span><span class="line"><span class="cl">status:
</span></span><span class="line"><span class="cl">  completionTime: 2018-12-16T21:43:27Z
</span></span><span class="line"><span class="cl">  conditions:
</span></span><span class="line"><span class="cl">  - lastTransitionTime: 2018-12-16T21:39:09Z
</span></span><span class="line"><span class="cl">    lastUpdateTime: 2018-12-16T21:39:09Z
</span></span><span class="line"><span class="cl">    message: PyTorchJob pytorch-tcp-dist-mnist is created.
</span></span><span class="line"><span class="cl">    reason: PyTorchJobCreated
</span></span><span class="line"><span class="cl">    status: &#34;True&#34;
</span></span><span class="line"><span class="cl">    type: Created
</span></span><span class="line"><span class="cl">  - lastTransitionTime: 2018-12-16T21:39:09Z
</span></span><span class="line"><span class="cl">    lastUpdateTime: 2018-12-16T21:40:45Z
</span></span><span class="line"><span class="cl">    message: PyTorchJob pytorch-tcp-dist-mnist is running.
</span></span><span class="line"><span class="cl">    reason: PyTorchJobRunning
</span></span><span class="line"><span class="cl">    status: &#34;False&#34;
</span></span><span class="line"><span class="cl">    type: Running
</span></span><span class="line"><span class="cl">  - lastTransitionTime: 2018-12-16T21:39:09Z
</span></span><span class="line"><span class="cl">    lastUpdateTime: 2018-12-16T21:43:27Z
</span></span><span class="line"><span class="cl">    message: PyTorchJob pytorch-tcp-dist-mnist is successfully completed.
</span></span><span class="line"><span class="cl">    reason: PyTorchJobSucceeded
</span></span><span class="line"><span class="cl">    status: &#34;True&#34;
</span></span><span class="line"><span class="cl">    type: Succeeded
</span></span><span class="line"><span class="cl">  replicaStatuses:
</span></span><span class="line"><span class="cl">    Master: {}
</span></span><span class="line"><span class="cl">    Worker: {}
</span></span><span class="line"><span class="cl">  startTime: 2018-12-16T21:40:45Z
</span></span></code></pre></div>
</div>



    
	
  
    
    
	
    

<div class="td-content" style="page-break-before: always">
    
	<h1 id="pg-918c00c4648652b4a145759ea270e3fe">5.3 - MXNet Training (MXJob)</h1>
    <div class="lead">Using MXJob to train a model with Apache MXNet</div>
	<p>This guide walks you through using <a href="https://github.com/apache/incubator-mxnet">Apache MXNet (incubating)</a> with Kubeflow.</p>
<p>MXNet Operator provides a Kubernetes custom resource <code>MXJob</code> that makes it easy to run distributed or non-distributed
Apache MXNet jobs (training and tuning) and other extended framework like <a href="https://github.com/bytedance/byteps">BytePS</a>
jobs on Kubernetes. Using a Custom Resource Definition (CRD) gives users the ability to create
and manage Apache MXNet jobs just like built-in K8S resources.</p>
<p>The Kubeflow implementation of <code>MXJob</code> is in <a href="https://github.com/kubeflow/training-operator"><code>training-operator</code></a>.</p>
<h2 id="installing-mxnet-operator">Installing MXNet Operator</h2>
<p>If you haven&rsquo;t already done so please follow the <a href="/docs/started/getting-started/">Getting Started Guide</a> to deploy Kubeflow.</p>
<blockquote>
<p>By default, MXNet Operator will be deployed as a controller in training operator.</p>
</blockquote>
<p>If you want to install a standalone version of the training operator without Kubeflow,
see the <a href="https://github.com/kubeflow/training-operator#installation">kubeflow/training-operator&rsquo;s README</a>.</p>
<h3 id="verify-that-mxjob-support-is-included-in-your-kubeflow-deployment">Verify that MXJob support is included in your Kubeflow deployment</h3>
<p>Check that the Apache MXNet custom resource is installed:</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-fallback" data-lang="fallback"><span class="line"><span class="cl">kubectl get crd
</span></span></code></pre></div><p>The output should include <code>mxjobs.kubeflow.org</code> like the following:</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-fallback" data-lang="fallback"><span class="line"><span class="cl">NAME                                             CREATED AT
</span></span><span class="line"><span class="cl">...
</span></span><span class="line"><span class="cl">mxjobs.kubeflow.org                              2021-09-06T18:33:57Z
</span></span><span class="line"><span class="cl">...
</span></span></code></pre></div><p>Check that the Training operator is running via:</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-fallback" data-lang="fallback"><span class="line"><span class="cl">kubectl get pods -n kubeflow
</span></span></code></pre></div><p>The output should include <code>training-operator-xxx</code> like the following:</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-fallback" data-lang="fallback"><span class="line"><span class="cl">NAME                                READY   STATUS    RESTARTS   AGE
</span></span><span class="line"><span class="cl">training-operator-d466b46bc-xbqvs   1/1     Running   0          4m37s
</span></span></code></pre></div><h2 id="creating-a-apache-mxnet-training-job">Creating a Apache MXNet training job</h2>
<p>You create a training job by defining a <code>MXJob</code> with <code>MXTrain</code> mode and then creating it with.</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-fallback" data-lang="fallback"><span class="line"><span class="cl">kubectl create -f https://raw.githubusercontent.com/kubeflow/training-operator/master/examples/mxnet/train/mx_job_dist_gpu_v1.yaml
</span></span></code></pre></div><p>Each <code>mxReplicaSpecs</code> defines a set of Apache MXNet processes.
The <code>mxReplicaType</code> defines the semantics for the set of processes.
The semantics are as follows:</p>
<p><strong>scheduler</strong></p>
<ul>
<li>A job must have 1 and only 1 scheduler</li>
<li>The pod must contain a container named <code>mxnet</code></li>
<li>The overall status of the <code>MXJob</code> is determined by the exit code of the
mxnet container
<ul>
<li>0 = success</li>
<li>1 || 2 || 126 || 127 || 128 || 139 = permanent errors:
<ul>
<li>1: general errors</li>
<li>2: misuse of shell builtins</li>
<li>126: command invoked cannot execute</li>
<li>127: command not found</li>
<li>128: invalid argument to exit</li>
<li>139: container terminated by SIGSEGV(Invalid memory reference)</li>
</ul>
</li>
<li>130 || 137 || 143 = retryable error for unexpected system signals:
<ul>
<li>130: container terminated by Control-C</li>
<li>137: container received a SIGKILL</li>
<li>143: container received a SIGTERM</li>
</ul>
</li>
<li>138 = reserved in training-operator for user specified retryable errors</li>
<li>others = undefined and no guarantee</li>
</ul>
</li>
</ul>
<p><strong>worker</strong></p>
<ul>
<li>A job can have 0 to N workers</li>
<li>The pod must contain a container named mxnet</li>
<li>Workers are automatically restarted if they exit</li>
</ul>
<p><strong>server</strong></p>
<ul>
<li>A job can have 0 to N servers</li>
<li>parameter servers are automatically restarted if they exit</li>
</ul>
<p>For each replica you define a <strong>template</strong> which is a K8S
<a href="https://v1-21.docs.kubernetes.io/docs/reference/kubernetes-api/workload-resources/pod-template-v1/#PodTemplateSpec">PodTemplateSpec</a>.
The template allows you to specify the containers, volumes, etc&hellip; that
should be created for each replica.</p>
<h2 id="creating-a-tvm-tuning-job-autotvm">Creating a TVM tuning job (AutoTVM)</h2>
<p><a href="https://docs.tvm.ai/tutorials/">TVM</a> is a end to end deep learning compiler stack, you can easily run AutoTVM with MXJob.
You can create a auto tuning job by define a type of MXTune job and then creating it with</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-fallback" data-lang="fallback"><span class="line"><span class="cl">kubectl create -f https://raw.githubusercontent.com/kubeflow/training-operator/master/examples/mxnet/tune/mx_job_tune_gpu_v1.yaml
</span></span></code></pre></div><p>Before you use the auto-tuning example, there is some preparatory work need to be finished in advance.
To let TVM tune your network, you should create a docker image which has TVM module.
Then, you need a auto-tuning script to specify which network will be tuned and set the auto-tuning parameters.
For more details, please see <a href="https://docs.tvm.ai/tutorials/autotvm/tune_relay_mobile_gpu.html#sphx-glr-tutorials-autotvm-tune-relay-mobile-gpu-py">tutorials</a>.
Finally, you need a startup script to start the auto-tuning program. In fact,
MXJob will set all the parameters as environment variables and the startup script
needs to read these variable and then transmit them to the auto-tuning script.</p>
<h2 id="using-gpus">Using GPUs</h2>
<p>MXNet Operator supports training with GPUs.</p>
<p>Please verify your image is available for distributed training with GPUs.</p>
<p>For example, if you have the following, MXNet Operator will arrange the pod to nodes to satisfy the GPU limit.</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-fallback" data-lang="fallback"><span class="line"><span class="cl">command: [&#34;python&#34;]
</span></span><span class="line"><span class="cl">args: [&#34;/incubator-mxnet/example/image-classification/train_mnist.py&#34;,&#34;--num-epochs&#34;,&#34;1&#34;,&#34;--num-layers&#34;,&#34;2&#34;,&#34;--kv-store&#34;,&#34;dist_device_sync&#34;,&#34;--gpus&#34;,&#34;0&#34;]
</span></span><span class="line"><span class="cl">resources:
</span></span><span class="line"><span class="cl">  limits:
</span></span><span class="line"><span class="cl">    nvidia.com/gpu: 1
</span></span></code></pre></div><h2 id="monitoring-your-apache-mxnet-job">Monitoring your Apache MXNet job</h2>
<p>To get the status of your job</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash"><span class="line"><span class="cl">kubectl get -o yaml mxjobs <span class="nv">$JOB</span>
</span></span></code></pre></div><p>Here is sample output for an example job</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-yaml" data-lang="yaml"><span class="line"><span class="cl"><span class="nt">apiVersion</span><span class="p">:</span><span class="w"> </span><span class="l">kubeflow.org/v1</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="nt">kind</span><span class="p">:</span><span class="w"> </span><span class="l">MXJob</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="nt">metadata</span><span class="p">:</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">  </span><span class="nt">creationTimestamp</span><span class="p">:</span><span class="w"> </span><span class="ld">2021-03-24T15:37:27Z</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">  </span><span class="nt">generation</span><span class="p">:</span><span class="w"> </span><span class="m">1</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">  </span><span class="nt">name</span><span class="p">:</span><span class="w"> </span><span class="l">mxnet-job</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">  </span><span class="nt">namespace</span><span class="p">:</span><span class="w"> </span><span class="l">default</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">  </span><span class="nt">resourceVersion</span><span class="p">:</span><span class="w"> </span><span class="s2">&#34;5123435&#34;</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">  </span><span class="nt">selfLink</span><span class="p">:</span><span class="w"> </span><span class="l">/apis/kubeflow.org/v1/namespaces/default/mxjobs/mxnet-job</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">  </span><span class="nt">uid</span><span class="p">:</span><span class="w"> </span><span class="l">xx11013b-4a28-11e9-s5a1-704d7bb912f91</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="nt">spec</span><span class="p">:</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">  </span><span class="nt">runPolicy</span><span class="p">:</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="nt">cleanPodPolicy</span><span class="p">:</span><span class="w"> </span><span class="l">All</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">  </span><span class="nt">jobMode</span><span class="p">:</span><span class="w"> </span><span class="l">MXTrain</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">  </span><span class="nt">mxReplicaSpecs</span><span class="p">:</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="nt">Scheduler</span><span class="p">:</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">      </span><span class="nt">replicas</span><span class="p">:</span><span class="w"> </span><span class="m">1</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">      </span><span class="nt">restartPolicy</span><span class="p">:</span><span class="w"> </span><span class="l">Never</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">      </span><span class="nt">template</span><span class="p">:</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">        </span><span class="nt">metadata</span><span class="p">:</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">          </span><span class="nt">creationTimestamp</span><span class="p">:</span><span class="w"> </span><span class="kc">null</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">        </span><span class="nt">spec</span><span class="p">:</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">          </span><span class="nt">containers</span><span class="p">:</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">            </span>- <span class="nt">image</span><span class="p">:</span><span class="w"> </span><span class="l">mxjob/mxnet:gpu</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">              </span><span class="nt">name</span><span class="p">:</span><span class="w"> </span><span class="l">mxnet</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">              </span><span class="nt">ports</span><span class="p">:</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">                </span>- <span class="nt">containerPort</span><span class="p">:</span><span class="w"> </span><span class="m">9091</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">                  </span><span class="nt">name</span><span class="p">:</span><span class="w"> </span><span class="l">mxjob-port</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">              </span><span class="nt">resources</span><span class="p">:</span><span class="w"> </span>{}<span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="nt">Server</span><span class="p">:</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">      </span><span class="nt">replicas</span><span class="p">:</span><span class="w"> </span><span class="m">1</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">      </span><span class="nt">restartPolicy</span><span class="p">:</span><span class="w"> </span><span class="l">Never</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">      </span><span class="nt">template</span><span class="p">:</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">        </span><span class="nt">metadata</span><span class="p">:</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">          </span><span class="nt">creationTimestamp</span><span class="p">:</span><span class="w"> </span><span class="kc">null</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">        </span><span class="nt">spec</span><span class="p">:</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">          </span><span class="nt">containers</span><span class="p">:</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">            </span>- <span class="nt">image</span><span class="p">:</span><span class="w"> </span><span class="l">mxjob/mxnet:gpu</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">              </span><span class="nt">name</span><span class="p">:</span><span class="w"> </span><span class="l">mxnet</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">              </span><span class="nt">ports</span><span class="p">:</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">                </span>- <span class="nt">containerPort</span><span class="p">:</span><span class="w"> </span><span class="m">9091</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">                  </span><span class="nt">name</span><span class="p">:</span><span class="w"> </span><span class="l">mxjob-port</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">              </span><span class="nt">resources</span><span class="p">:</span><span class="w"> </span>{}<span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="nt">Worker</span><span class="p">:</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">      </span><span class="nt">replicas</span><span class="p">:</span><span class="w"> </span><span class="m">1</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">      </span><span class="nt">restartPolicy</span><span class="p">:</span><span class="w"> </span><span class="l">Never</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">      </span><span class="nt">template</span><span class="p">:</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">        </span><span class="nt">metadata</span><span class="p">:</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">          </span><span class="nt">creationTimestamp</span><span class="p">:</span><span class="w"> </span><span class="kc">null</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">        </span><span class="nt">spec</span><span class="p">:</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">          </span><span class="nt">containers</span><span class="p">:</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">            </span>- <span class="nt">args</span><span class="p">:</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">                </span>- <span class="l">/incubator-mxnet/example/image-classification/train_mnist.py</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">                </span>- --<span class="l">num-epochs</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">                </span>- <span class="s2">&#34;10&#34;</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">                </span>- --<span class="l">num-layers</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">                </span>- <span class="s2">&#34;2&#34;</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">                </span>- --<span class="l">kv-store</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">                </span>- <span class="l">dist_device_sync</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">                </span>- --<span class="l">gpus</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">                </span>- <span class="s2">&#34;0&#34;</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">              </span><span class="nt">command</span><span class="p">:</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">                </span>- <span class="l">python</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">              </span><span class="nt">image</span><span class="p">:</span><span class="w"> </span><span class="l">mxjob/mxnet:gpu</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">              </span><span class="nt">name</span><span class="p">:</span><span class="w"> </span><span class="l">mxnet</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">              </span><span class="nt">ports</span><span class="p">:</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">                </span>- <span class="nt">containerPort</span><span class="p">:</span><span class="w"> </span><span class="m">9091</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">                  </span><span class="nt">name</span><span class="p">:</span><span class="w"> </span><span class="l">mxjob-port</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">              </span><span class="nt">resources</span><span class="p">:</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">                </span><span class="nt">limits</span><span class="p">:</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">                  </span><span class="nt">nvidia.com/gpu</span><span class="p">:</span><span class="w"> </span><span class="s2">&#34;1&#34;</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="nt">status</span><span class="p">:</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">  </span><span class="nt">completionTime</span><span class="p">:</span><span class="w"> </span><span class="ld">2021-03-24T09:25:11Z</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">  </span><span class="nt">conditions</span><span class="p">:</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span>- <span class="nt">lastTransitionTime</span><span class="p">:</span><span class="w"> </span><span class="ld">2021-03-24T15:37:27Z</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">      </span><span class="nt">lastUpdateTime</span><span class="p">:</span><span class="w"> </span><span class="ld">2021-03-24T15:37:27Z</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">      </span><span class="nt">message</span><span class="p">:</span><span class="w"> </span><span class="l">MXJob mxnet-job is created.</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">      </span><span class="nt">reason</span><span class="p">:</span><span class="w"> </span><span class="l">MXJobCreated</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">      </span><span class="nt">status</span><span class="p">:</span><span class="w"> </span><span class="s2">&#34;True&#34;</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">      </span><span class="nt">type</span><span class="p">:</span><span class="w"> </span><span class="l">Created</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span>- <span class="nt">lastTransitionTime</span><span class="p">:</span><span class="w"> </span><span class="ld">2021-03-24T15:37:27Z</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">      </span><span class="nt">lastUpdateTime</span><span class="p">:</span><span class="w"> </span><span class="ld">2021-03-24T15:37:29Z</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">      </span><span class="nt">message</span><span class="p">:</span><span class="w"> </span><span class="l">MXJob mxnet-job is running.</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">      </span><span class="nt">reason</span><span class="p">:</span><span class="w"> </span><span class="l">MXJobRunning</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">      </span><span class="nt">status</span><span class="p">:</span><span class="w"> </span><span class="s2">&#34;False&#34;</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">      </span><span class="nt">type</span><span class="p">:</span><span class="w"> </span><span class="l">Running</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span>- <span class="nt">lastTransitionTime</span><span class="p">:</span><span class="w"> </span><span class="ld">2021-03-24T15:37:27Z</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">      </span><span class="nt">lastUpdateTime</span><span class="p">:</span><span class="w"> </span><span class="ld">2021-03-24T09:25:11Z</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">      </span><span class="nt">message</span><span class="p">:</span><span class="w"> </span><span class="l">MXJob mxnet-job is successfully completed.</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">      </span><span class="nt">reason</span><span class="p">:</span><span class="w"> </span><span class="l">MXJobSucceeded</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">      </span><span class="nt">status</span><span class="p">:</span><span class="w"> </span><span class="s2">&#34;True&#34;</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">      </span><span class="nt">type</span><span class="p">:</span><span class="w"> </span><span class="l">Succeeded</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">  </span><span class="nt">mxReplicaStatuses</span><span class="p">:</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="nt">Scheduler</span><span class="p">:</span><span class="w"> </span>{}<span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="nt">Server</span><span class="p">:</span><span class="w"> </span>{}<span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="nt">Worker</span><span class="p">:</span><span class="w"> </span>{}<span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">  </span><span class="nt">startTime</span><span class="p">:</span><span class="w"> </span><span class="ld">2021-03-24T15:37:29Z</span><span class="w">
</span></span></span></code></pre></div><p>The first thing to note is the <strong>RuntimeId</strong>. This is a random unique
string which is used to give names to all the K8s resouces
(e.g Job controllers &amp; services) that are created by the <code>MXJob</code>.</p>
<p>As with other K8S resources status provides information about the state
of the resource.</p>
<p><strong>phase</strong> - Indicates the phase of a job and will be one of</p>
<ul>
<li>Creating</li>
<li>Running</li>
<li>CleanUp</li>
<li>Failed</li>
<li>Done</li>
</ul>
<p><strong>state</strong> - Provides the overall status of the job and will be one of</p>
<ul>
<li>Running</li>
<li>Succeeded</li>
<li>Failed</li>
</ul>
<p>For each replica type in the job, there will be a <code>ReplicaStatus</code> that
provides the number of replicas of that type in each state.</p>
<p>For each replica type, the job creates a set of K8s
<a href="https://kubernetes.io/docs/concepts/workloads/controllers/jobs-run-to-completion/">Job Controllers</a>
named</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-fallback" data-lang="fallback"><span class="line"><span class="cl">${REPLICA-TYPE}-${RUNTIME_ID}-${INDEX}
</span></span></code></pre></div><p>For example, if you have 2 servers and the runtime id is &ldquo;76n0&rdquo;, then <code>MXJob</code>
will create the following two jobs:</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-fallback" data-lang="fallback"><span class="line"><span class="cl">server-76no-0
</span></span><span class="line"><span class="cl">server-76no-1
</span></span></code></pre></div><h2 id="more-information">More Information</h2>
<ul>
<li>Check out <a href="https://www.kubeflow.org/docs/about/community/">Kubeflow community page</a>
for more information on how to get involved in our community.</li>
</ul>

</div>



    
	
  
    
    
	
    

<div class="td-content" style="page-break-before: always">
    
	<h1 id="pg-66d70221609b85eb891d6f7d3b11fbe6">5.4 - XGBoost Training (XGBoostJob)</h1>
    <div class="lead">Using XGBoostJob to train a model with XGBoost</div>
	<div class="alert alert-primary" role="alert">
This Kubeflow component has <b>stable</b> status. See the
<a href="/docs/started/support/#application-status">Kubeflow versioning policies</a>.
</div>
<p>This page describes <code>XGBoostJob</code> for training a machine learning model with <a href="https://github.com/dmlc/xgboost">XGBoost</a>.</p>
<p><code>XGBoostJob</code> is a Kubernetes
<a href="https://kubernetes.io/docs/concepts/extend-kubernetes/api-extension/custom-resources/">custom resource</a>
to run XGBoost training jobs on Kubernetes. The Kubeflow implementation of
<code>XGBoostJob</code> is in <a href="https://github.com/kubeflow/training-operator"><code>training-operator</code></a>.</p>
<h2 id="installing-xgboost-operator">Installing XGBoost Operator</h2>
<p>If you haven&rsquo;t already done so please follow the <a href="/docs/started/getting-started/">Getting Started Guide</a> to deploy Kubeflow.</p>
<blockquote>
<p>By default, XGBoost Operator will be deployed as a controller in training operator.</p>
</blockquote>
<p>If you want to install a standalone version of the training operator without Kubeflow,
see the <a href="https://github.com/kubeflow/training-operator#installation">kubeflow/training-operator&rsquo;s README</a>.</p>
<h2 id="verify-that-xgboost-support-is-included-in-your-kubeflow-deployment">Verify that XGBoost support is included in your Kubeflow deployment</h2>
<p>Check that the XGboost custom resource is installed</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-fallback" data-lang="fallback"><span class="line"><span class="cl">kubectl get crd
</span></span></code></pre></div><p>The output should include <code>xgboostjobs.kubeflow.org</code></p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-fallback" data-lang="fallback"><span class="line"><span class="cl">NAME                                           AGE
</span></span><span class="line"><span class="cl">...
</span></span><span class="line"><span class="cl">xgboostjobs.kubeflow.org                       4d
</span></span><span class="line"><span class="cl">...
</span></span></code></pre></div><p>Check that the Training operator is running via:</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-fallback" data-lang="fallback"><span class="line"><span class="cl">kubectl get pods -n kubeflow
</span></span></code></pre></div><p>The output should include <code>training-operator-xxx</code> like the following:</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-fallback" data-lang="fallback"><span class="line"><span class="cl">NAME                                READY   STATUS    RESTARTS   AGE
</span></span><span class="line"><span class="cl">training-operator-d466b46bc-xbqvs   1/1     Running   0          4m37s
</span></span></code></pre></div><h2 id="creating-a-xgboost-training-job">Creating a XGBoost training job</h2>
<p>You can create a training job by defining a <code>XGboostJob</code> config file. See the
manifests for the <a href="https://github.com/kubeflow/training-operator/blob/master/examples/xgboost/xgboostjob.yaml">IRIS example</a>.
You may change the config file based on your requirements. E.g.: add <code>CleanPodPolicy</code>
in Spec to <code>None</code> to retain pods after job termination.</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-fallback" data-lang="fallback"><span class="line"><span class="cl">cat xgboostjob.yaml
</span></span></code></pre></div><p>Deploy the <code>XGBoostJob</code> resource to start training:</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-fallback" data-lang="fallback"><span class="line"><span class="cl">kubectl create -f xgboostjob.yaml
</span></span></code></pre></div><p>You should now be able to see the created pods matching the specified number of replicas.</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-fallback" data-lang="fallback"><span class="line"><span class="cl">kubectl get pods -l job-name=xgboost-dist-iris-test-train
</span></span></code></pre></div><p>Training takes 5-10 minutes on a cpu cluster. Logs can be inspected to see its training progress.</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-fallback" data-lang="fallback"><span class="line"><span class="cl">PODNAME=$(kubectl get pods -l job-name=xgboost-dist-iris-test-train,replica-type=master,replica-index=0 -o name)
</span></span><span class="line"><span class="cl">kubectl logs -f ${PODNAME}
</span></span></code></pre></div><h2 id="monitoring-a-xgboostjob">Monitoring a XGBoostJob</h2>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-fallback" data-lang="fallback"><span class="line"><span class="cl">kubectl get -o yaml xgboostjobs xgboost-dist-iris-test-train
</span></span></code></pre></div><p>See the status section to monitor the job status. Here is sample output when the job is successfully completed.</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-yaml" data-lang="yaml"><span class="line"><span class="cl"><span class="nt">apiVersion</span><span class="p">:</span><span class="w"> </span><span class="l">kubeflow.org/v1</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="nt">kind</span><span class="p">:</span><span class="w"> </span><span class="l">XGBoostJob</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="nt">metadata</span><span class="p">:</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">  </span><span class="nt">creationTimestamp</span><span class="p">:</span><span class="w"> </span><span class="s2">&#34;2021-09-06T18:34:06Z&#34;</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">  </span><span class="nt">generation</span><span class="p">:</span><span class="w"> </span><span class="m">1</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">  </span><span class="nt">name</span><span class="p">:</span><span class="w"> </span><span class="l">xgboost-dist-iris-test-train</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">  </span><span class="nt">namespace</span><span class="p">:</span><span class="w"> </span><span class="l">default</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">  </span><span class="nt">resourceVersion</span><span class="p">:</span><span class="w"> </span><span class="s2">&#34;5844304&#34;</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">  </span><span class="nt">selfLink</span><span class="p">:</span><span class="w"> </span><span class="l">/apis/kubeflow.org/v1/namespaces/default/xgboostjobs/xgboost-dist-iris-test-train</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">  </span><span class="nt">uid</span><span class="p">:</span><span class="w"> </span><span class="l">a1ea6675-3cb5-482b-95dd-68b2c99b8adc</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="nt">spec</span><span class="p">:</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">  </span><span class="nt">runPolicy</span><span class="p">:</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="nt">cleanPodPolicy</span><span class="p">:</span><span class="w"> </span><span class="l">None</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">  </span><span class="nt">xgbReplicaSpecs</span><span class="p">:</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="nt">Master</span><span class="p">:</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">      </span><span class="nt">replicas</span><span class="p">:</span><span class="w"> </span><span class="m">1</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">      </span><span class="nt">restartPolicy</span><span class="p">:</span><span class="w"> </span><span class="l">Never</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">      </span><span class="nt">template</span><span class="p">:</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">        </span><span class="nt">spec</span><span class="p">:</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">          </span><span class="nt">containers</span><span class="p">:</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">            </span>- <span class="nt">args</span><span class="p">:</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">                </span>- --<span class="l">job_type=Train</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">                </span>- --<span class="l">xgboost_parameter=objective:multi:softprob,num_class:3</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">                </span>- --<span class="l">n_estimators=10</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">                </span>- --<span class="l">learning_rate=0.1</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">                </span>- --<span class="l">model_path=/tmp/xgboost-model</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">                </span>- --<span class="l">model_storage_type=local</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">              </span><span class="nt">image</span><span class="p">:</span><span class="w"> </span><span class="l">docker.io/merlintang/xgboost-dist-iris:1.1</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">              </span><span class="nt">imagePullPolicy</span><span class="p">:</span><span class="w"> </span><span class="l">Always</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">              </span><span class="nt">name</span><span class="p">:</span><span class="w"> </span><span class="l">xgboost</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">              </span><span class="nt">ports</span><span class="p">:</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">                </span>- <span class="nt">containerPort</span><span class="p">:</span><span class="w"> </span><span class="m">9991</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">                  </span><span class="nt">name</span><span class="p">:</span><span class="w"> </span><span class="l">xgboostjob-port</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">                  </span><span class="nt">protocol</span><span class="p">:</span><span class="w"> </span><span class="l">TCP</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="nt">Worker</span><span class="p">:</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">      </span><span class="nt">replicas</span><span class="p">:</span><span class="w"> </span><span class="m">2</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">      </span><span class="nt">restartPolicy</span><span class="p">:</span><span class="w"> </span><span class="l">ExitCode</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">      </span><span class="nt">template</span><span class="p">:</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">        </span><span class="nt">spec</span><span class="p">:</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">          </span><span class="nt">containers</span><span class="p">:</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">            </span>- <span class="nt">args</span><span class="p">:</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">                </span>- --<span class="l">job_type=Train</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">                </span>- --<span class="l">xgboost_parameter=&#34;objective:multi:softprob,num_class:3&#34;</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">                </span>- --<span class="l">n_estimators=10</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">                </span>- --<span class="l">learning_rate=0.1</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">              </span><span class="nt">image</span><span class="p">:</span><span class="w"> </span><span class="l">docker.io/merlintang/xgboost-dist-iris:1.1</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">              </span><span class="nt">imagePullPolicy</span><span class="p">:</span><span class="w"> </span><span class="l">Always</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">              </span><span class="nt">name</span><span class="p">:</span><span class="w"> </span><span class="l">xgboost</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">              </span><span class="nt">ports</span><span class="p">:</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">                </span>- <span class="nt">containerPort</span><span class="p">:</span><span class="w"> </span><span class="m">9991</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">                  </span><span class="nt">name</span><span class="p">:</span><span class="w"> </span><span class="l">xgboostjob-port</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">                  </span><span class="nt">protocol</span><span class="p">:</span><span class="w"> </span><span class="l">TCP</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="nt">status</span><span class="p">:</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">  </span><span class="nt">completionTime</span><span class="p">:</span><span class="w"> </span><span class="s2">&#34;2021-09-06T18:34:23Z&#34;</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">  </span><span class="nt">conditions</span><span class="p">:</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span>- <span class="nt">lastTransitionTime</span><span class="p">:</span><span class="w"> </span><span class="s2">&#34;2021-09-06T18:34:06Z&#34;</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">      </span><span class="nt">lastUpdateTime</span><span class="p">:</span><span class="w"> </span><span class="s2">&#34;2021-09-06T18:34:06Z&#34;</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">      </span><span class="nt">message</span><span class="p">:</span><span class="w"> </span><span class="l">xgboostJob xgboost-dist-iris-test-train is created.</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">      </span><span class="nt">reason</span><span class="p">:</span><span class="w"> </span><span class="l">XGBoostJobCreated</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">      </span><span class="nt">status</span><span class="p">:</span><span class="w"> </span><span class="s2">&#34;True&#34;</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">      </span><span class="nt">type</span><span class="p">:</span><span class="w"> </span><span class="l">Created</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span>- <span class="nt">lastTransitionTime</span><span class="p">:</span><span class="w"> </span><span class="s2">&#34;2021-09-06T18:34:06Z&#34;</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">      </span><span class="nt">lastUpdateTime</span><span class="p">:</span><span class="w"> </span><span class="s2">&#34;2021-09-06T18:34:06Z&#34;</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">      </span><span class="nt">message</span><span class="p">:</span><span class="w"> </span><span class="l">XGBoostJob xgboost-dist-iris-test-train is running.</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">      </span><span class="nt">reason</span><span class="p">:</span><span class="w"> </span><span class="l">XGBoostJobRunning</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">      </span><span class="nt">status</span><span class="p">:</span><span class="w"> </span><span class="s2">&#34;False&#34;</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">      </span><span class="nt">type</span><span class="p">:</span><span class="w"> </span><span class="l">Running</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span>- <span class="nt">lastTransitionTime</span><span class="p">:</span><span class="w"> </span><span class="s2">&#34;2021-09-06T18:34:23Z&#34;</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">      </span><span class="nt">lastUpdateTime</span><span class="p">:</span><span class="w"> </span><span class="s2">&#34;2021-09-06T18:34:23Z&#34;</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">      </span><span class="nt">message</span><span class="p">:</span><span class="w"> </span><span class="l">XGBoostJob xgboost-dist-iris-test-train is successfully completed.</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">      </span><span class="nt">reason</span><span class="p">:</span><span class="w"> </span><span class="l">XGBoostJobSucceeded</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">      </span><span class="nt">status</span><span class="p">:</span><span class="w"> </span><span class="s2">&#34;True&#34;</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">      </span><span class="nt">type</span><span class="p">:</span><span class="w"> </span><span class="l">Succeeded</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">  </span><span class="nt">replicaStatuses</span><span class="p">:</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="nt">Master</span><span class="p">:</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">      </span><span class="nt">succeeded</span><span class="p">:</span><span class="w"> </span><span class="m">1</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="nt">Worker</span><span class="p">:</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">      </span><span class="nt">succeeded</span><span class="p">:</span><span class="w"> </span><span class="m">2</span><span class="w">
</span></span></span></code></pre></div>
</div>



    
	
  
    
    
	
    

<div class="td-content" style="page-break-before: always">
    
	<h1 id="pg-e31f8fe300fca877319ecc67f6f703f2">5.5 - MPI Training (MPIJob)</h1>
    <div class="lead">Instructions for using MPI for training</div>
	<div class="alert alert-warning" role="alert">
  <h4 class="alert-heading">Alpha</h4>
  This Kubeflow component has <b>alpha</b> status with limited support. See the
  <a href="/docs/started/support/#application-status">Kubeflow versioning policies</a>.
  The Kubeflow team is interested in your   
  <a href="https://github.com/kubeflow/mpi-operator/issues">feedback</a></h4> 
  about the usability of the feature.
</div>
<p>This guide walks you through using MPI for training.</p>
<p>The MPI Operator makes it easy to run allreduce-style distributed training on Kubernetes. Please check out <a href="https://medium.com/kubeflow/introduction-to-kubeflow-mpi-operator-and-industry-adoption-296d5f2e6edc">this blog post</a> for an introduction to MPI Operator and its industry adoption.</p>
<h2 id="installation">Installation</h2>
<p>You can deploy the operator with default settings by running the following commands:</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-shell" data-lang="shell"><span class="line"><span class="cl">git clone https://github.com/kubeflow/mpi-operator
</span></span><span class="line"><span class="cl"><span class="nb">cd</span> mpi-operator
</span></span><span class="line"><span class="cl">kubectl apply -f deploy/v2beta1/mpi-operator.yaml
</span></span></code></pre></div><p>Alternatively, follow the <a href="https://www.kubeflow.org/docs/started/getting-started/">getting started guide</a> to deploy Kubeflow.</p>
<p>An alpha version of MPI support was introduced with Kubeflow 0.2.0. You must be using a version of Kubeflow newer than 0.2.0.</p>
<p>You can check whether the MPI Job custom resource is installed via:</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-fallback" data-lang="fallback"><span class="line"><span class="cl">kubectl get crd
</span></span></code></pre></div><p>The output should include <code>mpijobs.kubeflow.org</code> like the following:</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-fallback" data-lang="fallback"><span class="line"><span class="cl">NAME                                       AGE
</span></span><span class="line"><span class="cl">...
</span></span><span class="line"><span class="cl">mpijobs.kubeflow.org                       4d
</span></span><span class="line"><span class="cl">...
</span></span></code></pre></div><p>If it is not included, you can add it as follows using <a href="https://github.com/kubernetes-sigs/kustomize">kustomize</a>:</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash"><span class="line"><span class="cl">git clone https://github.com/kubeflow/mpi-operator
</span></span><span class="line"><span class="cl"><span class="nb">cd</span> mpi-operator
</span></span><span class="line"><span class="cl">kustomize build manifests/overlays/kubeflow <span class="p">|</span> kubectl apply -f -
</span></span></code></pre></div><p>Note that since Kubernetes v1.14, <code>kustomize</code> became a subcommand in <code>kubectl</code> so you can also run the following command instead:</p>
<p>Since Kubernetes v1.21, you can use:</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash"><span class="line"><span class="cl">kubectl apply -k manifests/overlays/kubeflow
</span></span></code></pre></div><div class="highlight"><pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash"><span class="line"><span class="cl">kubectl kustomize base <span class="p">|</span> kubectl apply -f -
</span></span></code></pre></div><h2 id="creating-an-mpi-job">Creating an MPI Job</h2>
<p>You can create an MPI job by defining an <code>MPIJob</code> config file. See <a href="https://github.com/kubeflow/mpi-operator/blob/master/examples/v2beta1/tensorflow-benchmarks.yaml">TensorFlow benchmark example</a> config file for launching a multi-node TensorFlow benchmark training job. You may change the config file based on your requirements.</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-fallback" data-lang="fallback"><span class="line"><span class="cl">cat examples/v2beta1/tensorflow-benchmarks.yaml
</span></span></code></pre></div><p>Deploy the <code>MPIJob</code> resource to start training:</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-fallback" data-lang="fallback"><span class="line"><span class="cl">kubectl apply -f examples/v2beta1/tensorflow-benchmarks.yaml
</span></span></code></pre></div><h2 id="monitoring-an-mpi-job">Monitoring an MPI Job</h2>
<p>Once the <code>MPIJob</code> resource is created, you should now be able to see the created pods matching the specified number of GPUs. You can also monitor the job status from the status section. Here is sample output when the job is successfully completed.</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-fallback" data-lang="fallback"><span class="line"><span class="cl">kubectl get -o yaml mpijobs tensorflow-benchmarks
</span></span></code></pre></div><div class="highlight"><pre tabindex="0" class="chroma"><code class="language-fallback" data-lang="fallback"><span class="line"><span class="cl">apiVersion: kubeflow.org/v2beta1
</span></span><span class="line"><span class="cl">kind: MPIJob
</span></span><span class="line"><span class="cl">metadata:
</span></span><span class="line"><span class="cl">  creationTimestamp: &#34;2019-07-09T22:15:51Z&#34;
</span></span><span class="line"><span class="cl">  generation: 1
</span></span><span class="line"><span class="cl">  name: tensorflow-benchmarks
</span></span><span class="line"><span class="cl">  namespace: default
</span></span><span class="line"><span class="cl">  resourceVersion: &#34;5645868&#34;
</span></span><span class="line"><span class="cl">  selfLink: /apis/kubeflow.org/v1alpha2/namespaces/default/mpijobs/tensorflow-benchmarks
</span></span><span class="line"><span class="cl">  uid: 1c5b470f-a297-11e9-964d-88d7f67c6e6d
</span></span><span class="line"><span class="cl">spec:
</span></span><span class="line"><span class="cl">  runPolicy:
</span></span><span class="line"><span class="cl">    cleanPodPolicy: Running
</span></span><span class="line"><span class="cl">  mpiReplicaSpecs:
</span></span><span class="line"><span class="cl">    Launcher:
</span></span><span class="line"><span class="cl">      replicas: 1
</span></span><span class="line"><span class="cl">      template:
</span></span><span class="line"><span class="cl">        spec:
</span></span><span class="line"><span class="cl">          containers:
</span></span><span class="line"><span class="cl">          - command:
</span></span><span class="line"><span class="cl">            - mpirun
</span></span><span class="line"><span class="cl">            - --allow-run-as-root
</span></span><span class="line"><span class="cl">            - -np
</span></span><span class="line"><span class="cl">            - &#34;2&#34;
</span></span><span class="line"><span class="cl">            - -bind-to
</span></span><span class="line"><span class="cl">            - none
</span></span><span class="line"><span class="cl">            - -map-by
</span></span><span class="line"><span class="cl">            - slot
</span></span><span class="line"><span class="cl">            - -x
</span></span><span class="line"><span class="cl">            - NCCL_DEBUG=INFO
</span></span><span class="line"><span class="cl">            - -x
</span></span><span class="line"><span class="cl">            - LD_LIBRARY_PATH
</span></span><span class="line"><span class="cl">            - -x
</span></span><span class="line"><span class="cl">            - PATH
</span></span><span class="line"><span class="cl">            - -mca
</span></span><span class="line"><span class="cl">            - pml
</span></span><span class="line"><span class="cl">            - ob1
</span></span><span class="line"><span class="cl">            - -mca
</span></span><span class="line"><span class="cl">            - btl
</span></span><span class="line"><span class="cl">            - ^openib
</span></span><span class="line"><span class="cl">            - python
</span></span><span class="line"><span class="cl">            - scripts/tf_cnn_benchmarks/tf_cnn_benchmarks.py
</span></span><span class="line"><span class="cl">            - --model=resnet101
</span></span><span class="line"><span class="cl">            - --batch_size=64
</span></span><span class="line"><span class="cl">            - --variable_update=horovod
</span></span><span class="line"><span class="cl">            image: mpioperator/tensorflow-benchmarks:latest
</span></span><span class="line"><span class="cl">            name: tensorflow-benchmarks
</span></span><span class="line"><span class="cl">    Worker:
</span></span><span class="line"><span class="cl">      replicas: 1
</span></span><span class="line"><span class="cl">      template:
</span></span><span class="line"><span class="cl">        spec:
</span></span><span class="line"><span class="cl">          containers:
</span></span><span class="line"><span class="cl">          - image: mpioperator/tensorflow-benchmarks:latest
</span></span><span class="line"><span class="cl">            name: tensorflow-benchmarks
</span></span><span class="line"><span class="cl">            resources:
</span></span><span class="line"><span class="cl">              limits:
</span></span><span class="line"><span class="cl">                nvidia.com/gpu: 2
</span></span><span class="line"><span class="cl">  slotsPerWorker: 2
</span></span><span class="line"><span class="cl">status:
</span></span><span class="line"><span class="cl">  completionTime: &#34;2019-07-09T22:17:06Z&#34;
</span></span><span class="line"><span class="cl">  conditions:
</span></span><span class="line"><span class="cl">  - lastTransitionTime: &#34;2019-07-09T22:15:51Z&#34;
</span></span><span class="line"><span class="cl">    lastUpdateTime: &#34;2019-07-09T22:15:51Z&#34;
</span></span><span class="line"><span class="cl">    message: MPIJob default/tensorflow-benchmarks is created.
</span></span><span class="line"><span class="cl">    reason: MPIJobCreated
</span></span><span class="line"><span class="cl">    status: &#34;True&#34;
</span></span><span class="line"><span class="cl">    type: Created
</span></span><span class="line"><span class="cl">  - lastTransitionTime: &#34;2019-07-09T22:15:54Z&#34;
</span></span><span class="line"><span class="cl">    lastUpdateTime: &#34;2019-07-09T22:15:54Z&#34;
</span></span><span class="line"><span class="cl">    message: MPIJob default/tensorflow-benchmarks is running.
</span></span><span class="line"><span class="cl">    reason: MPIJobRunning
</span></span><span class="line"><span class="cl">    status: &#34;False&#34;
</span></span><span class="line"><span class="cl">    type: Running
</span></span><span class="line"><span class="cl">  - lastTransitionTime: &#34;2019-07-09T22:17:06Z&#34;
</span></span><span class="line"><span class="cl">    lastUpdateTime: &#34;2019-07-09T22:17:06Z&#34;
</span></span><span class="line"><span class="cl">    message: MPIJob default/tensorflow-benchmarks successfully completed.
</span></span><span class="line"><span class="cl">    reason: MPIJobSucceeded
</span></span><span class="line"><span class="cl">    status: &#34;True&#34;
</span></span><span class="line"><span class="cl">    type: Succeeded
</span></span><span class="line"><span class="cl">  replicaStatuses:
</span></span><span class="line"><span class="cl">    Launcher:
</span></span><span class="line"><span class="cl">      succeeded: 1
</span></span><span class="line"><span class="cl">    Worker: {}
</span></span><span class="line"><span class="cl">  startTime: &#34;2019-07-09T22:15:51Z&#34;
</span></span></code></pre></div><p>Training should run for 100 steps and takes a few minutes on a GPU cluster. You can inspect the logs to see the training progress. When the job starts, access the logs from the <code>launcher</code> pod:</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-fallback" data-lang="fallback"><span class="line"><span class="cl">PODNAME=$(kubectl get pods -l mpi_job_name=tensorflow-benchmarks,mpi_role_type=launcher -o name)
</span></span><span class="line"><span class="cl">kubectl logs -f ${PODNAME}
</span></span></code></pre></div><div class="highlight"><pre tabindex="0" class="chroma"><code class="language-fallback" data-lang="fallback"><span class="line"><span class="cl">TensorFlow:  1.14
</span></span><span class="line"><span class="cl">Model:       resnet101
</span></span><span class="line"><span class="cl">Dataset:     imagenet (synthetic)
</span></span><span class="line"><span class="cl">Mode:        training
</span></span><span class="line"><span class="cl">SingleSess:  False
</span></span><span class="line"><span class="cl">Batch size:  128 global
</span></span><span class="line"><span class="cl">             64 per device
</span></span><span class="line"><span class="cl">Num batches: 100
</span></span><span class="line"><span class="cl">Num epochs:  0.01
</span></span><span class="line"><span class="cl">Devices:     [&#39;horovod/gpu:0&#39;, &#39;horovod/gpu:1&#39;]
</span></span><span class="line"><span class="cl">NUMA bind:   False
</span></span><span class="line"><span class="cl">Data format: NCHW
</span></span><span class="line"><span class="cl">Optimizer:   sgd
</span></span><span class="line"><span class="cl">Variables:   horovod
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">...
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">40	images/sec: 154.4 +/- 0.7 (jitter = 4.0)	8.280
</span></span><span class="line"><span class="cl">40	images/sec: 154.4 +/- 0.7 (jitter = 4.1)	8.482
</span></span><span class="line"><span class="cl">50	images/sec: 154.8 +/- 0.6 (jitter = 4.0)	8.397
</span></span><span class="line"><span class="cl">50	images/sec: 154.8 +/- 0.6 (jitter = 4.2)	8.450
</span></span><span class="line"><span class="cl">60	images/sec: 154.5 +/- 0.5 (jitter = 4.1)	8.321
</span></span><span class="line"><span class="cl">60	images/sec: 154.5 +/- 0.5 (jitter = 4.4)	8.349
</span></span><span class="line"><span class="cl">70	images/sec: 154.5 +/- 0.5 (jitter = 4.0)	8.433
</span></span><span class="line"><span class="cl">70	images/sec: 154.5 +/- 0.5 (jitter = 4.4)	8.430
</span></span><span class="line"><span class="cl">80	images/sec: 154.8 +/- 0.4 (jitter = 3.6)	8.199
</span></span><span class="line"><span class="cl">80	images/sec: 154.8 +/- 0.4 (jitter = 3.8)	8.404
</span></span><span class="line"><span class="cl">90	images/sec: 154.6 +/- 0.4 (jitter = 3.7)	8.418
</span></span><span class="line"><span class="cl">90	images/sec: 154.6 +/- 0.4 (jitter = 3.6)	8.459
</span></span><span class="line"><span class="cl">100	images/sec: 154.2 +/- 0.4 (jitter = 4.0)	8.372
</span></span><span class="line"><span class="cl">100	images/sec: 154.2 +/- 0.4 (jitter = 4.0)	8.542
</span></span><span class="line"><span class="cl">----------------------------------------------------------------
</span></span><span class="line"><span class="cl">total images/sec: 308.27
</span></span></code></pre></div><p>For a sample that uses Intel MPI, see:</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash"><span class="line"><span class="cl">cat examples/pi/pi-intel.yaml
</span></span></code></pre></div><h2 id="exposed-metrics">Exposed Metrics</h2>
<table>
<thead>
<tr>
<th>Metric name</th>
<th>Metric type</th>
<th>Description</th>
<th>Labels</th>
</tr>
</thead>
<tbody>
<tr>
<td>mpi_operator_jobs_created_total</td>
<td>Counter</td>
<td>Counts number of MPI jobs created</td>
<td></td>
</tr>
<tr>
<td>mpi_operator_jobs_successful_total</td>
<td>Counter</td>
<td>Counts number of MPI jobs successful</td>
<td></td>
</tr>
<tr>
<td>mpi_operator_jobs_failed_total</td>
<td>Counter</td>
<td>Counts number of MPI jobs failed</td>
<td></td>
</tr>
<tr>
<td>mpi_operator_job_info</td>
<td>Gauge</td>
<td>Information about MPIJob</td>
<td><code>launcher</code>=&lt;launcher-pod-name&gt; <br> <code>namespace</code>=&lt;job-namespace&gt;</td>
</tr>
</tbody>
</table>
<h3 id="join-metrics">Join Metrics</h3>
<p>With <a href="https://github.com/kubernetes/kube-state-metrics">kube-state-metrics</a>, one can join metrics by labels.
For example <code>kube_pod_info * on(pod,namespace) group_left label_replace(mpi_operator_job_infos, &quot;pod&quot;, &quot;$0&quot;, &quot;launcher&quot;, &quot;.*&quot;)</code></p>
<h2 id="docker-images">Docker Images</h2>
<p>We push Docker images of <a href="https://hub.docker.com/u/mpioperator">mpioperator on Dockerhub</a> for every release.
You can use the following Dockerfile to build the image yourself:</p>
<ul>
<li><a href="https://github.com/kubeflow/mpi-operator/blob/master/Dockerfile">mpi-operator</a></li>
</ul>
<p>Alternative, you can build the image using make:</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash"><span class="line"><span class="cl">make <span class="nv">RELEASE_VERSION</span><span class="o">=</span>dev <span class="nv">IMAGE_NAME</span><span class="o">=</span>registry.example.com/mpi-operator images
</span></span></code></pre></div><p>This will produce an image with the tag <code>registry.example.com/mpi-operator:dev</code>.</p>
<h2 id="contributing">Contributing</h2>
<p>Learn more in <a href="https://github.com/kubeflow/mpi-operator/blob/master/CONTRIBUTING.md">CONTRIBUTING</a>.</p>

</div>



    
	
  
    
    
	
    

<div class="td-content" style="page-break-before: always">
    
	<h1 id="pg-0f6575cd7361e2994f36778f82849b99">5.6 - Job Scheduling</h1>
    <div class="lead">How to schedule a job with gang-scheduling</div>
	<div class="alert alert-warning" role="alert">
  <h4 class="alert-heading">Alpha</h4>
  This Kubeflow component has <b>alpha</b> status with limited support. See the
  <a href="/docs/started/support/#application-status">Kubeflow versioning policies</a>.
  The Kubeflow team is interested in your   
  <a href="https://github.com/kubeflow/training-operator/issues">feedback</a></h4> 
  about the usability of the feature.
</div>
<p>This guide describes how to use <a href="https://github.com/volcano-sh/volcano">volcano scheduler</a> to support gang-scheduling in
Kubeflow, to allow jobs to run multiple pods at the same time.</p>
<h2 id="running-jobs-with-gang-scheduling">Running jobs with gang-scheduling</h2>
<p>To use gang-scheduling, you have to install volcano scheduler in your cluster first as a secondary scheduler of Kubernetes and configure operator to enable gang-scheduling.</p>
<ul>
<li>Follow the <a href="https://github.com/volcano-sh/volcano">instructions in the volcano repository</a> to install Volcano.</li>
<li>Take <code>TFJob</code> for example, enable gang-scheduling in training-operator by setting true to <code>--enable-gang-scheduling</code> flag.</li>
</ul>
<p><strong>Note:</strong> Volcano scheduler and operator in Kubeflow achieve gang-scheduling by using <a href="https://github.com/volcano-sh/volcano/blob/master/pkg/apis/scheduling/types.go">PodGroup</a>. operator will create the PodGroup of the job automatically.</p>
<p>The yaml to use volcano scheduler to schedule your job as a gang is the same as non-gang-scheduler, for example.</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-yaml" data-lang="yaml"><span class="line"><span class="cl"><span class="nt">apiVersion</span><span class="p">:</span><span class="w"> </span><span class="s2">&#34;kubeflow.org/v1beta1&#34;</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="nt">kind</span><span class="p">:</span><span class="w"> </span><span class="s2">&#34;TFJob&#34;</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="nt">metadata</span><span class="p">:</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">  </span><span class="nt">name</span><span class="p">:</span><span class="w"> </span><span class="s2">&#34;tfjob-gang-scheduling&#34;</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="nt">spec</span><span class="p">:</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">  </span><span class="nt">tfReplicaSpecs</span><span class="p">:</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="nt">Worker</span><span class="p">:</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">      </span><span class="nt">replicas</span><span class="p">:</span><span class="w"> </span><span class="m">1</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">      </span><span class="nt">template</span><span class="p">:</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">        </span><span class="nt">spec</span><span class="p">:</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">          </span><span class="nt">containers</span><span class="p">:</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">            </span>- <span class="nt">args</span><span class="p">:</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">                </span>- <span class="l">python</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">                </span>- <span class="l">tf_cnn_benchmarks.py</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">                </span>- --<span class="l">batch_size=32</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">                </span>- --<span class="l">model=resnet50</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">                </span>- --<span class="l">variable_update=parameter_server</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">                </span>- --<span class="l">flush_stdout=true</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">                </span>- --<span class="l">num_gpus=1</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">                </span>- --<span class="l">local_parameter_device=cpu</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">                </span>- --<span class="l">device=gpu</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">                </span>- --<span class="l">data_format=NHWC</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">              </span><span class="nt">image</span><span class="p">:</span><span class="w"> </span><span class="l">gcr.io/kubeflow/tf-benchmarks-gpu:v20171202-bdab599-dirty-284af3</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">              </span><span class="nt">name</span><span class="p">:</span><span class="w"> </span><span class="l">tensorflow</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">              </span><span class="nt">resources</span><span class="p">:</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">                </span><span class="nt">limits</span><span class="p">:</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">                  </span><span class="nt">nvidia.com/gpu</span><span class="p">:</span><span class="w"> </span><span class="m">1</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">              </span><span class="nt">workingDir</span><span class="p">:</span><span class="w"> </span><span class="l">/opt/tf-benchmarks/scripts/tf_cnn_benchmarks</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">          </span><span class="nt">restartPolicy</span><span class="p">:</span><span class="w"> </span><span class="l">OnFailure</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="nt">PS</span><span class="p">:</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">      </span><span class="nt">replicas</span><span class="p">:</span><span class="w"> </span><span class="m">1</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">      </span><span class="nt">template</span><span class="p">:</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">        </span><span class="nt">spec</span><span class="p">:</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">          </span><span class="nt">containers</span><span class="p">:</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">            </span>- <span class="nt">args</span><span class="p">:</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">                </span>- <span class="l">python</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">                </span>- <span class="l">tf_cnn_benchmarks.py</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">                </span>- --<span class="l">batch_size=32</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">                </span>- --<span class="l">model=resnet50</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">                </span>- --<span class="l">variable_update=parameter_server</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">                </span>- --<span class="l">flush_stdout=true</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">                </span>- --<span class="l">num_gpus=1</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">                </span>- --<span class="l">local_parameter_device=cpu</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">                </span>- --<span class="l">device=cpu</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">                </span>- --<span class="l">data_format=NHWC</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">              </span><span class="nt">image</span><span class="p">:</span><span class="w"> </span><span class="l">gcr.io/kubeflow/tf-benchmarks-cpu:v20171202-bdab599-dirty-284af3</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">              </span><span class="nt">name</span><span class="p">:</span><span class="w"> </span><span class="l">tensorflow</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">              </span><span class="nt">resources</span><span class="p">:</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">                </span><span class="nt">limits</span><span class="p">:</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">                  </span><span class="nt">cpu</span><span class="p">:</span><span class="w"> </span><span class="s2">&#34;1&#34;</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">              </span><span class="nt">workingDir</span><span class="p">:</span><span class="w"> </span><span class="l">/opt/tf-benchmarks/scripts/tf_cnn_benchmarks</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">          </span><span class="nt">restartPolicy</span><span class="p">:</span><span class="w"> </span><span class="l">OnFailure</span><span class="w">
</span></span></span></code></pre></div><h2 id="about-volcano-scheduler-and-gang-scheduling">About volcano scheduler and gang-scheduling</h2>
<p>With using volcano scheduler to apply gang-scheduling, a job can run only if there are enough resources for all the pods of the job. Otherwise, all the pods will be in pending state waiting for enough resources. For example, if a job requiring N pods is created and there are only enough resources to schedule N-2 pods, then N pods of the job will stay pending.</p>
<p><strong>Note:</strong> when in a high workload, if a pod of the job dies when the job is still running, it might give other pods a chance to occupy the resources and cause deadlock.</p>
<h2 id="troubleshooting">Troubleshooting</h2>
<p>If you keep getting problems related to RBAC in your volcano scheduler.</p>
<p>You can try to add the following rules into your clusterrole of scheduler used by volcano scheduler.</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-fallback" data-lang="fallback"><span class="line"><span class="cl">- apiGroups:
</span></span><span class="line"><span class="cl">  - &#39;*&#39;
</span></span><span class="line"><span class="cl">  resources:
</span></span><span class="line"><span class="cl">  - &#39;*&#39;
</span></span><span class="line"><span class="cl">  verbs:
</span></span><span class="line"><span class="cl">  - &#39;*&#39;
</span></span></code></pre></div>
</div>



    
	
  

    
	
  
    
    
	
    

<div class="td-content" style="page-break-before: always">
    
	<h1 id="pg-ae6de7cad0e76d5df6250988a0160212">6 - Multi-Tenancy</h1>
    <div class="lead">Multi-user isolation and identity access management (IAM)</div>
	
</div>



    
      
  
  
  
  

  
  

  
    
    
	
    

<div class="td-content" style="">
    
	<h1 id="pg-e87786fc6cd6ef512d86583d427d2d72">6.1 - Introduction to Multi-user Isolation</h1>
    <div class="lead">Why do Kubeflow administrators need multi-user isolation?</div>
	<div class="alert alert-primary" role="alert">
This Kubeflow component has <b>stable</b> status. See the
<a href="/docs/started/support/#application-status">Kubeflow versioning policies</a>.
</div>
<p>In Kubeflow clusters, users often need to be isolated into a group, where a group includes one or more users.   Additionally, a user may need to belong to multiple groups.  Kubeflows multi-user isolation simplifies user operations because each user only views and edited\s the Kubeflow components and model artifacts defined in their configuration.  A users view is not cluttered by components or model artifacts that are not in their configuration. This isolation also provides for efficient infrastructure and operations i.e. a single cluster supports multiple isolated users, and does not require the administrator to operate different clusters to isolate users.</p>
<h2 id="key-concepts">Key concepts</h2>
<p><strong>Administrator</strong>: An Administrator is someone who creates and maintains the Kubeflow cluster. This person configures permissions (i.e. view, edit) for other users.</p>
<p><strong>User</strong>: A User is someone who has access to some set of resources in the cluster. A user needs to be granted access permissions by the administrator.</p>
<p><strong>Profile</strong>: A Profile is a unique configuration for a user, which determines their access privileges and is defined by the Administrator.</p>
<p><strong>Isolation</strong>: Isolation uses Kubernetes Namespaces.  Namespaces isolate users or a group of users i.e. Bobs namespace or ML Eng namespace that is shared by Bob and Sara.</p>
<p><strong>Authentication</strong>: Authentication is provided by an integration of Istio and OIDC and is secured by mTLS.  More details can be found <a href="https://journal.arrikto.com/kubeflow-authentication-with-istio-dex-5eafdfac4782">here</a></p>
<p><strong>Authorization</strong>: Authorization is provided by an integration with Kubernetes RBAC.</p>
<p>Kubeflow multi-user isolation is configured by Kubeflow administrators.   Administrators configure Kubeflow User Profiles for each user.  After the configuration is created and applied, a User can only access the Kubeflow components that the Administrator has configured for them.  The configuration limits non-authorized UI users from viewing or accidentally deleting model artifacts.</p>
<p>With multi-user isolation, Users are authenticated and authorized, and then provided with a time-based token i.e. a json web token (JWT).   The access token is carried as a web header in user requests, and authorizes the user to access the resources configured in their Profile.  The Profile configures several items including the Users namespace(s), RBAC RoleBinding, Istio ServiceRole and ServiceRoleBindings along with Resource Quotas and Custom Plug-ins.   More information on the Profile definition and related CRD can be found <a href="https://github.com/kubeflow/kubeflow/blob/master/components/profile-controller/README.md">here</a></p>
<h2 id="current-integration">Current integration</h2>
<p>These Kubeflow Components can support multi-user isolation: Central Dashboard, Notebooks, Pipelines, AutoML (Katib), KFServing.  Furthermore, resources created by the notebooks (for example, training jobs and deployments) also inherit the same access.</p>
<p>Important notes: Multi-user isolation has several configurable dependencies, especially those related to how Kubeflow is configured with the underlying Kubernetes clusters identity management system.   Additionally, Kubeflow multi-user isolation doesnt provide hard security guarantees against malicious attempts to infiltrate another users profile.</p>
<p>When configuring multi-user isolation along with your security and identity management requirements, it is recommended that you consult with your <a href="https://www.kubeflow.org/docs/distributions/">distribution provider</a>.   This KubeCon <a href="https://www.youtube.com/watch?v=U8yWOKOhzes">presentation</a> provides a detailed review of the architecture and implementation.   For on-premise deployments, Kubeflow uses Dex as a federated OpenID connection provider and can be integrated with LDAP or Active Directory to provide authentication and identity services.   This can be an advanced configuration and it is recommended that you consult with a distribution provider, or a team that provides advanced technical support for on-premise Kubeflow.</p>
<h2 id="next-steps">Next steps</h2>
<ul>
<li>Learn more about <a href="/docs/components/multi-tenancy/design/">multi-user isolation design</a>.</li>
</ul>

</div>



    
	
  
    
    
	
    

<div class="td-content" style="page-break-before: always">
    
	<h1 id="pg-ddca94c4aa141a8f92713881d827f9d7">6.2 - Design for Multi-user Isolation</h1>
    <div class="lead">In-depth design for supporting multi-user isolation</div>
	<div class="alert alert-primary" role="alert">
This Kubeflow component has <b>stable</b> status. See the
<a href="/docs/started/support/#application-status">Kubeflow versioning policies</a>.
</div>
<h2 id="design-overview">Design overview</h2>
<p>Kubeflow multi-tenancy is currently built around <em>user namespaces</em>.
Specifically, Kubeflow defines user-specific namespaces and uses Kubernetes
<a href="https://kubernetes.io/docs/reference/access-authn-authz/rbac/">role-based access control (RBAC) policies</a>
to manage user access.</p>
<p>This feature enables users to share access to their workspaces.
Workspace owners can share/revoke workspace access with other users through the
Kubeflow UI.
After being invited, users have permissions to edit the workspace and operate
Kubeflow custom resources.</p>
<p>Kubeflow multi-tenancy is self-served - a new user can self-register to create and own
their workspace through the UI.</p>
<p>Kubeflow uses Istio to control in-cluster traffic. By default, requests to user
workspaces are denied unless allowed by Istio RBAC. In-bound user requests are
identified using an identity provider (for example, Identity Aware Proxy (IAP) on
Google Cloud or Dex for on-premises deployments), and then validated by Istio RBAC rules.</p>
<p>Internally, Kubeflow uses the <em>Profile</em> custom resource to control all policies, roles, and bindings involved,
and to guarantee consistency. Kubeflow also offers a plugin interface to manage external resource/policy outside Kubernetes,
for example interfacing with Amazon Web Services APIs for identity management.</p>
<p>The following diagram illustrates a Kubeflow multi-tenancy cluster with two user-access routes:
via the Kubeflow central dashboard and via the kubectl command-line interface (CLI).</p>
<p><img src="/docs/images/multi-tenancy-cluster.png"
alt="multi tenancy cluster "
class="mt-3 mb-3 border border-info rounded"></p>
<h2 id="feature-requirements">Feature requirements</h2>
<ul>
<li>Kubeflow uses <a href="https://istio.io/">Istio</a> to apply access control over in-cluster traffic.</li>
<li>Kubeflow profile controller needs <code>cluster admin</code> permission.</li>
<li>Kubeflow UI needs to be served behind an identity aware proxy. The identity aware proxy and Kubernetes
master should share the same identity management.</li>
<li>The Kubeflow installation on Google Cloud uses <a href="https://cloud.google.com/kubernetes-engine">GKE</a> and <a href="https://cloud.google.com/iap/docs/concepts-overview">IAP</a>.</li>
<li>On-premises installations of Kubeflow make use of <a href="https://github.com/dexidp/dex">Dex</a>, a flexible OpenID Connect (OIDC) provider.</li>
</ul>
<h2 id="supported-platforms">Supported platforms</h2>
<ul>
<li>Kubeflow multi-tenancy is enabled by default if you deploy Kubeflow on GCP with <a href="/docs/gke/deploy">IAP</a>.</li>
</ul>
<h2 id="next-steps">Next steps</h2>
<ul>
<li>Learn <a href="/docs/components/multi-tenancy/getting-started/">how to use multi-user isolation and profiles</a>.</li>
<li>Read more about <a href="/docs/external-add-ons/istio/istio-in-kubeflow/">Istio in Kubeflow</a>.</li>
</ul>

</div>



    
	
  
    
    
	
    

<div class="td-content" style="page-break-before: always">
    
	<h1 id="pg-e865bd308ad26da3a77cd89815745e7f">6.3 - Getting Started with Multi-user Isolation</h1>
    <div class="lead">How to use multi-user isolation with profiles</div>
	<div class="alert alert-primary" role="alert">
This Kubeflow component has <b>stable</b> status. See the
<a href="/docs/started/support/#application-status">Kubeflow versioning policies</a>.
</div>
<h2 id="usage-overview">Usage overview</h2>
<p>After Kubeflow is installed and configured, you will by default
be accessing your <em>primary profile</em>. A <em>profile</em> owns a Kubernetes namespace of
the same name along with a collection of Kubernetes resources. Users have view
and modify access to their primary profiles. You can share
access to your profile with another user in the system. When sharing the access
to a profile with another user, you can choose to whether to provide only read access or read/modify
access. For all practical purposes when working
through the Kubeflow central dashboard, the active namespace is directly tied
with the active profile.</p>
<h2 id="example-of-usage">Example of usage</h2>
<p>You can select your active profile from the top bar on the Kubeflow central
dashboard.  Note that you can only see the profiles
to which you have view or modify access.</p>
<p><img src="/docs/images/select-profile.png"
alt="Select active profile "
class="mt-3 mb-3 border border-info rounded"></p>
<p>This guide illustrates the user isolation functionality using the Jupyter
notebooks service which is the first service in the system to have full
integration with the multi-user isolation functionality.</p>
<p>After you select an active profile, the Notebooks Servers UI
displays only the active notebook servers in the currently selected
profile. All other notebook servers remain hidden from you. If you switch
the active profile, the view switches the list of active notebooks
appropriately. You can connect to any of the listed notebook servers and
view and modify the existing Jupyter notebooks available in the server.</p>
<p>For example, the following image shows the list of notebook servers available
in a user&rsquo;s primary profile:</p>
<p><img src="/docs/images/notebooks-in-profile.png"
alt="List of notebooks in active profile "
class="mt-3 mb-3 border border-info rounded"></p>
<p>When an unauthorized user accesses the notebooks in this profile, they see an
error:</p>
<p><img src="/docs/images/notebook-access-error.png"
alt="Error listing notebooks in inacessible profile"
class="mt-3 mb-3 border border-info rounded"></p>
<p>When you create Jupyter notebook servers from the Notebooks Servers UI,
the notebook pods are created in your active profile. If you don&rsquo;t have
modify access to the active profile, you can only browse currently active
notebook servers and access the existing notebooks but cannot create
new notebook servers in that profile. You can create notebook
servers in your primary profile which you have view and modify access to.</p>
<h2 id="onboarding-a-new-user">Onboarding a new user</h2>
<p>An <strong>administrator</strong> can manually create a profile for any user in the Kubeflow cluster.
Here an administrator is a person who has <a href="https://kubernetes.io/docs/reference/access-authn-authz/rbac/#user-facing-roles"><em>cluster-admin</em></a>
role binding in the Kubernetes cluster. This person has permissions to create
and modify Kubernetes resources in the cluster. For example, the person who
deployed Kubeflow will have administration privileges in the cluster.</p>
<p>We recommend this approach, since it encourages the adoption of GitOps processes for handling the Profile creation.</p>
<p>Kubeflow v1.6.0 optionally provides automatic Profile creation workflow for authenticated users on first login.</p>
<h3 id="pre-requisites-grant-user-minimal-kubernetes-cluster-access">Pre-requisites: grant user minimal Kubernetes cluster access</h3>
<p>You must grant each user the minimal permission scope that allows them to
connect to the Kubernetes cluster.</p>
<p>For example, for Google Cloud users, you should grant the
following Cloud Identity and Access Management (IAM) roles. In the following
commands, replace <code>[PROJECT]</code> with your Google Cloud project and replace <code>[EMAIL]</code> with
the user&rsquo;s email address:</p>
<ul>
<li>
<p>To access the Kubernetes cluster, the user needs the <a href="https://cloud.google.com/kubernetes-engine/docs/how-to/iam">Kubernetes Engine
Cluster Viewer</a>
role:</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-fallback" data-lang="fallback"><span class="line"><span class="cl">gcloud projects add-iam-policy-binding [PROJECT] --member=user:[EMAIL] --role=roles/container.clusterViewer
</span></span></code></pre></div></li>
<li>
<p>To access the Kubeflow UI through IAP, the user needs the
<a href="https://cloud.google.com/iap/docs/managing-access">IAP-secured Web App User</a>
role:</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-fallback" data-lang="fallback"><span class="line"><span class="cl">gcloud projects add-iam-policy-binding [PROJECT] --member=user:[EMAIL] --role=roles/iap.httpsResourceAccessor
</span></span></code></pre></div><p><strong>Note:</strong> you need to grant the user <code>IAP-secured Web App User</code> role even if the user is already an owner or editor of the project. <code>IAP-secured Web App User</code> role is not implied by just <code>Project Owner</code> or <code>Project Editor</code> roles.</p>
</li>
<li>
<p>To be able to run <code>gcloud get credentials</code> and see logs in Cloud Logging
(formerly Stackdriver), the user needs viewer access on the project:</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-fallback" data-lang="fallback"><span class="line"><span class="cl">gcloud projects add-iam-policy-binding [PROJECT] --member=user:[EMAIL] --role=roles/viewer
</span></span></code></pre></div></li>
</ul>
<h3 id="manual-profile-creation">Manual profile creation</h3>
<p>An administrator can manually create profiles for users as described below.</p>
<p>Create a
<code>profile.yaml</code> file with the following content on your local machine:</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-fallback" data-lang="fallback"><span class="line"><span class="cl">apiVersion: kubeflow.org/v1beta1
</span></span><span class="line"><span class="cl">kind: Profile
</span></span><span class="line"><span class="cl">metadata:
</span></span><span class="line"><span class="cl">  name: profileName   # replace with the name of profile you want, this will be user&#39;s namespace name
</span></span><span class="line"><span class="cl">spec:
</span></span><span class="line"><span class="cl">  owner:
</span></span><span class="line"><span class="cl">    kind: User
</span></span><span class="line"><span class="cl">    name: userid@email.com   # replace with the email of the user
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">  resourceQuotaSpec:    # resource quota can be set optionally
</span></span><span class="line"><span class="cl">   hard:
</span></span><span class="line"><span class="cl">     cpu: &#34;2&#34;
</span></span><span class="line"><span class="cl">     memory: 2Gi
</span></span><span class="line"><span class="cl">     requests.nvidia.com/gpu: &#34;1&#34;
</span></span><span class="line"><span class="cl">     persistentvolumeclaims: &#34;1&#34;
</span></span><span class="line"><span class="cl">     requests.storage: &#34;5Gi&#34;
</span></span></code></pre></div><p>Run the following command to create the corresponding profile resource:</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-fallback" data-lang="fallback"><span class="line"><span class="cl">kubectl create -f profile.yaml
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">kubectl apply -f profile.yaml  #if you are modifying the profile
</span></span></code></pre></div><p>The above command creates a profile named <em>profileName</em>. The profile owner is
<em><a href="mailto:userid@email.com">userid@email.com</a></em> and has view and modify access to that profile.
The following resources are created as part of the profile creation:</p>
<ul>
<li>A Kubernetes namespace that shares the same name with the corresponding
profile.</li>
<li>Kubernetes RBAC (<a href="https://kubernetes.io/docs/reference/access-authn-authz/rbac/">Role-based access control</a>)
role binding role binding for the namespace: <em>Admin</em>. This makes the
profile owner the namespace administrator, thus giving them access to the
namespace using kubectl (via the Kubernetes API).</li>
<li>Istio namespace-scoped AuthorizationPolicy: <em>user-userid-email-com-clusterrole-edit</em>.
This allows the <code>user</code> to access data belonging to the namespace the AuthorizationPolicy was created in</li>
<li>Namespace-scoped service-accounts <em>default-editor</em> and <em>default-viewer</em> to be used by
user-created pods in the namespace.</li>
<li>Namespace scoped resource quota limits will be placed.</li>
</ul>
<p><strong>Note</strong>: Due to a one-to-one correspondence of profiles with Kubernetes
namespaces, the terms <em>profile</em> and <em>namespace</em> are sometimes used interchangeably in the
documentation.</p>
<h3 id="batch-creation-of-user-profiles">Batch creation of user profiles</h3>
<p>Administrators might want to create profiles for multiple users as a batch. You can
do this by creating a <code>profile.yaml</code> on the local machine with multiple sections of
profile descriptions as shown below:</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-fallback" data-lang="fallback"><span class="line"><span class="cl">apiVersion: kubeflow.org/v1beta1
</span></span><span class="line"><span class="cl">kind: Profile
</span></span><span class="line"><span class="cl">metadata:
</span></span><span class="line"><span class="cl">  name: profileName1   # replace with the name of profile you want
</span></span><span class="line"><span class="cl">spec:
</span></span><span class="line"><span class="cl">  owner:
</span></span><span class="line"><span class="cl">    kind: User
</span></span><span class="line"><span class="cl">    name: userid1@email.com   # replace with the email of the user
</span></span><span class="line"><span class="cl">---
</span></span><span class="line"><span class="cl">apiVersion: kubeflow.org/v1beta1
</span></span><span class="line"><span class="cl">kind: Profile
</span></span><span class="line"><span class="cl">metadata:
</span></span><span class="line"><span class="cl">  name: profileName2   # replace with the name of profile you want
</span></span><span class="line"><span class="cl">spec:
</span></span><span class="line"><span class="cl">  owner:
</span></span><span class="line"><span class="cl">    kind: User
</span></span><span class="line"><span class="cl">    name: userid2@email.com   # replace with the email of the user
</span></span></code></pre></div><p>Run the following command to apply the namespaces to the Kubernetes cluster:</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-fallback" data-lang="fallback"><span class="line"><span class="cl">kubectl create -f profile.yaml
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">kubectl apply -f profile.yaml  #if you are modifying the profiles
</span></span></code></pre></div><p>This will create multiple profiles, one for each individual listed in the sections
in <code>profile.yaml</code>.</p>
<h3 id="automatic-profile-creation">Automatic profile creation</h3>
<p>Kubeflow v1.6.0 provides automatic profile creation:</p>
<ul>
<li>Automatic profile creation is not activated by default, and needs to be explicitly included as part of deployment. After turning on automatic user profile creation during deployment, a new user profile is created for authenticated users on their first login. Users will be able to see their new profile in the dropdown list of the Kubeflow central dashboard.</li>
<li>The automatic profile creation can be enabled as part of the deployment by setting the <code>CD_REGISTRATION_FLOW</code> env variable to <code>true</code>. Modify the <code>&lt;manifests-path&gt;/apps/centraldashboard/upstream/base/params.env</code> to set the registration variable to <code>true</code></li>
</ul>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-fallback" data-lang="fallback"><span class="line"><span class="cl">CD_CLUSTER_DOMAIN=cluster.local
</span></span><span class="line"><span class="cl">CD_USERID_HEADER=kubeflow-userid
</span></span><span class="line"><span class="cl">CD_USERID_PREFIX=
</span></span><span class="line"><span class="cl">CD_REGISTRATION_FLOW=true
</span></span></code></pre></div><ul>
<li>When an authenticated user logs into the system and visits the central
dashboard for the first time, they trigger a profile creation automatically.
<ul>
<li>A brief message introduces profiles: <img
src="/docs/images/auto-profile1.png" alt="Automatic profile creation
step 1" class="mt-3 mb-3 border border-info rounded"></li>
<li>The user can name their profile and click <em>Finish</em>:  <img
src="/docs/images/auto-profile2.png" alt="Automatic profile creation
step 2" class="mt-3 mb-3 border border-info rounded"></li>
<li>This redirects the user to the dashboard where they can view and select
their profile in the dropdown list.</li>
</ul>
</li>
</ul>
<h2 id="listing-and-describing-profiles">Listing and describing profiles</h2>
<p>An administrator can list the existing profiles in the system:</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-fallback" data-lang="fallback"><span class="line"><span class="cl">$ kubectl get profiles
</span></span></code></pre></div><p>and describe a specific profile using:</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-fallback" data-lang="fallback"><span class="line"><span class="cl">$ kubectl describe profile profileName
</span></span></code></pre></div><h2 id="deleting-an-existing-profile">Deleting an existing profile</h2>
<p>An administrator can delete an existing profile using:</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-fallback" data-lang="fallback"><span class="line"><span class="cl">$ kubectl delete profile profileName
</span></span></code></pre></div><p>This will delete the profile, the corresponding namespace and any Kubernetes
resources associated with the profile. The profile&rsquo;s owner or other users with
access to the profile will no longer have access to the profile and will not see
it in the dropdown list on the central dashboard.</p>
<h2 id="managing-contributors-through-the-kubeflow-ui">Managing contributors through the Kubeflow UI</h2>
<p>Kubeflow v1.6.0 allows sharing of profiles with other users in the
system.  An owner of a profile can share access to their profile using the
<strong>Manage Contributors</strong> tab available through the dashboard.</p>
<p><img src="/docs/images/multi-user-contributors.png"
alt="Manage Contributors in Profiles"
class="mt-3 mb-3 border border-info rounded"></p>
<p>Here is an example of the Manage Contributors tab view:</p>
<p><img src="/docs/images/manage-contributors.png"
alt="Manage Contributors in Profiles"
class="mt-3 mb-3 border border-info rounded"></p>
<p>Notice that in the above view the account associated with the profile is a
cluster administrator (<em>Cluster Admin</em>)
as this account was used to deploy Kubeflow. The view lists the
profiles accessible to the user along with the role associated with that
profile.</p>
<p>To add or remove a contributor, add/remove the
email address or the user identifier in the <strong>Contributors to your namespace</strong> field.</p>
<p><img src="/docs/images/add-contributors.png"
alt="Add Contributors"
class="mt-3 mb-3 border border-info rounded"></p>
<p>The Manage Contributors tab shows the contributors that the namespace owner has
added. Note that the cluster administrator can view all the
profiles in the system along with their contributors.</p>
<p><img src="/docs/images/view-contributors.png"
alt="View Contributors"
class="mt-3 mb-3 border border-info rounded"></p>
<p>The contributors have access to all the Kubernetes resources in the
namespace and can create notebook servers as well as access
existing notebooks.</p>
<h2 id="managing-contributors-manually">Managing contributors manually</h2>
<p>An administrator can manually add contributors to an existing profile as described below.</p>
<p>Create a rolebinding.yaml file with the following content on your local machine:</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-fallback" data-lang="fallback"><span class="line"><span class="cl">apiVersion: rbac.authorization.k8s.io/v1
</span></span><span class="line"><span class="cl">kind: RoleBinding
</span></span><span class="line"><span class="cl">metadata:
</span></span><span class="line"><span class="cl">  annotations:
</span></span><span class="line"><span class="cl">    role: edit
</span></span><span class="line"><span class="cl">    user: userid@email.com   # replace with the email of the user from your Active Directory case sensitive
</span></span><span class="line"><span class="cl">  name: user-userid-email-com-clusterrole-edit
</span></span><span class="line"><span class="cl">  # Ex: if the user email is lalith.vaka@kp.org the name should be user-lalith-vaka-kp-org-clusterrole-edit
</span></span><span class="line"><span class="cl">  # Note: if the user email is Lalith.Vaka@kp.org from your Active Directory, the name should be user-lalith-vaka-kp-org-clusterrole-edit
</span></span><span class="line"><span class="cl">  namespace: profileName # replace with the namespace/profile name that you are adding contributors to
</span></span><span class="line"><span class="cl">roleRef:
</span></span><span class="line"><span class="cl">  apiGroup: rbac.authorization.k8s.io
</span></span><span class="line"><span class="cl">  kind: ClusterRole
</span></span><span class="line"><span class="cl">  name: kubeflow-edit
</span></span><span class="line"><span class="cl">subjects:
</span></span><span class="line"><span class="cl">- apiGroup: rbac.authorization.k8s.io
</span></span><span class="line"><span class="cl">  kind: User
</span></span><span class="line"><span class="cl">  name: userid@email.com   # replace with the email of the user from your Active Directory case sensitive
</span></span></code></pre></div><p>Create an authorizationpolicy.yaml file with the following content on your local machine:</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-fallback" data-lang="fallback"><span class="line"><span class="cl">apiVersion: security.istio.io/v1beta1
</span></span><span class="line"><span class="cl">kind: AuthorizationPolicy
</span></span><span class="line"><span class="cl">metadata:
</span></span><span class="line"><span class="cl">  annotations:
</span></span><span class="line"><span class="cl">    role: edit
</span></span><span class="line"><span class="cl">    user: userid@email.com # replace with the email of the user from your Active Directory case sensitive
</span></span><span class="line"><span class="cl">  name: user-userid-email-com-clusterrole-edit
</span></span><span class="line"><span class="cl">  namespace: profileName # replace with the namespace/profile name that you are adding contributors to
</span></span><span class="line"><span class="cl">spec:
</span></span><span class="line"><span class="cl">  action: ALLOW
</span></span><span class="line"><span class="cl">  rules:
</span></span><span class="line"><span class="cl">  - when:
</span></span><span class="line"><span class="cl">    - key: request.headers[kubeflow-userid] # for GCP, use x-goog-authenticated-user-email instead of kubeflow-userid for authentication purpose
</span></span><span class="line"><span class="cl">      values:
</span></span><span class="line"><span class="cl">      - accounts.google.com:userid@email.com   # replace with the email of the user from your Active Directory case sensitive
</span></span></code></pre></div><p>Run the following command to create the corresponding contributor resources:</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-fallback" data-lang="fallback"><span class="line"><span class="cl">kubectl create -f rolebinding.yaml
</span></span><span class="line"><span class="cl">kubectl create -f authorizationpolicy.yaml
</span></span></code></pre></div><p>The above command adds a contributor <em><a href="mailto:userid@email.com">userid@email.com</a></em> to the profile named <em>profileName</em>. The contributor
<em><a href="mailto:userid@email.com">userid@email.com</a></em> has view and modify access to that profile.</p>

</div>



    
	
  

    
	
  



          </main>
        </div>
      </div>
      
<footer class="bg-dark pt-3 row d-print-none">
  <div class="container-fluid mx-sm-5">
    <div class="row">
      <div class="col-6 col-sm-4 text-xs-center order-sm-2">
        
        
        
<ul class="list-inline mb-0">
  
  <li class="list-inline-item mx-2 h3" data-toggle="tooltip" data-placement="top" title="Kubeflow mailing list" aria-label="Kubeflow mailing list">
    <a class="text-white" target="_blank" rel="noopener" href="https://www.kubeflow.org/docs/about/community/#kubeflow-mailing-list" aria-label="Kubeflow mailing list">
      <i class="fa fa-envelope"></i>
    </a>
  </li>
  
  <li class="list-inline-item mx-2 h3" data-toggle="tooltip" data-placement="top" title="Twitter" aria-label="Twitter">
    <a class="text-white" target="_blank" rel="noopener" href="https://twitter.com/kubeflow" aria-label="Twitter">
      <i class="fab fa-twitter"></i>
    </a>
  </li>
  
  <li class="list-inline-item mx-2 h3" data-toggle="tooltip" data-placement="top" title="Stack Overflow" aria-label="Stack Overflow">
    <a class="text-white" target="_blank" rel="noopener" href="https://stackoverflow.com/questions/tagged/kubeflow" aria-label="Stack Overflow">
      <i class="fab fa-stack-overflow"></i>
    </a>
  </li>
  
</ul>

        
        
      </div>
      <div class="col-6 col-sm-4 text-right text-xs-center order-sm-3">
        
        
        
<ul class="list-inline mb-0">
  
  <li class="list-inline-item mx-2 h3" data-toggle="tooltip" data-placement="top" title="GitHub" aria-label="GitHub">
    <a class="text-white" target="_blank" rel="noopener" href="https://github.com/GoogleCloudPlatform/kubeflow-distribution" aria-label="GitHub">
      <i class="fab fa-github"></i>
    </a>
  </li>
  
  <li class="list-inline-item mx-2 h3" data-toggle="tooltip" data-placement="top" title="Slack" aria-label="Slack">
    <a class="text-white" target="_blank" rel="noopener" href="https://www.kubeflow.org/docs/about/community/#kubeflow-slack" aria-label="Slack">
      <i class="fab fa-slack"></i>
    </a>
  </li>
  
  <li class="list-inline-item mx-2 h3" data-toggle="tooltip" data-placement="top" title="Kubeflow community calendar" aria-label="Kubeflow community calendar">
    <a class="text-white" target="_blank" rel="noopener" href="https://www.kubeflow.org/docs/about/community/#kubeflow-community-calendars" aria-label="Kubeflow community calendar">
      <i class="fa fa-calendar"></i>
    </a>
  </li>
  
</ul>

        
        
      </div>
      <div class="col-12 col-sm-5 text-center py-2 order-sm-2">
        <small class="text-white">&copy; 2022 Google | Documentation Distributed under CC BY 4.0</small>
        <p><small class="ml-1"><a href="https://policies.google.com/privacy" target="_blank" rel="noopener">Privacy Policy</a></small></p>
	
		<p class="mt-2"><a href="/kubeflow-docs/docs/about/">About</a></p>
	
      </div>
    </div>
  </div>
</footer>


    </div>
    <script src="/kubeflow-docs/js/main.min.301c0110334bec1b4445867d27dc7dd69b2df859154ccf252005508bc860cc5a.js" integrity="sha256-MBwBEDNL7BtERYZ9J9x91pst&#43;FkVTM8lIAVQi8hgzFo=" crossorigin="anonymous"></script>
<script src='/kubeflow-docs/js/tabpane-persist.js'></script>

  </body>
</html>
