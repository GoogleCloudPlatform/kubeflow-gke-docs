<!doctype html>
<html itemscope itemtype="http://schema.org/WebPage" lang="en" class="no-js">
  <head>
    <meta charset="utf-8">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<meta name="generator" content="Hugo 0.105.0">
<meta name="robots" content="index, follow">

<script type="application/ld+json">
  {
      "@context" : "http://schema.org",
      "@type" : "WebSite",
      "mainEntityOfPage": {
           "@type": "WebPage",
           "@id": "https:\/\/googlecloudplatform.github.io\/kubeflow-gke-docs\/dev"
      },
      "articleSection" : "docs",
      "name" : "Upgrade Kubeflow",
      "headline" : "Upgrade Kubeflow",
      "description" : "Upgrading your Kubeflow installation on Google Cloud",
      "inLanguage" : "en-US",
      "author" : "",
      "creator" : "",
      "publisher": "",
      "accountablePerson" : "",
      "copyrightHolder" : "",
      "copyrightYear" : "0001",
      "datePublished": "0001-01-01 00:00:00 \u002b0000 UTC",
      "dateModified" : "0001-01-01 00:00:00 \u002b0000 UTC",
      "url" : "https:\/\/googlecloudplatform.github.io\/kubeflow-gke-docs\/dev\/docs\/deploy\/upgrade\/",
      "wordCount" : "1895",
      "keywords" : [ "Kubeflow on GCP" ]
  }
  </script>

<link rel="shortcut icon" href="/kubeflow-gke-docs/dev/favicons/favicon.ico" >
<link rel="apple-touch-icon" href="/kubeflow-gke-docs/dev/favicons/apple-touch-icon-180x180.png" sizes="180x180">
<link rel="icon" type="image/png" href="/kubeflow-gke-docs/dev/favicons/favicon-16x16.png" sizes="16x16">
<link rel="icon" type="image/png" href="/kubeflow-gke-docs/dev/favicons/favicon-32x32.png" sizes="32x32">
<link rel="manifest" href="/kubeflow-gke-docs/dev/favicons/manifest.json">
<meta name="msapplication-config" content="/kubeflow-gke-docs/dev/favicons/browserconfig.xml" />
<meta name="msapplication-TileColor" content="#4279f4">
<meta name="theme-color" content="#4279f4">

<title>Upgrade Kubeflow | Kubeflow on Google Cloud Platform</title>
<meta name="description" content="Upgrading your Kubeflow installation on Google Cloud">
<meta property="og:title" content="Upgrade Kubeflow" />
<meta property="og:description" content="Upgrading your Kubeflow installation on Google Cloud" />
<meta property="og:type" content="article" />
<meta property="og:url" content="https://googlecloudplatform.github.io/kubeflow-gke-docs/dev/docs/deploy/upgrade/" /><meta property="article:section" content="docs" />

<meta property="article:modified_time" content="2023-01-02T22:56:34+00:00" /><meta property="og:site_name" content="Kubeflow on Google Cloud Platform" />

<meta itemprop="name" content="Upgrade Kubeflow">
<meta itemprop="description" content="Upgrading your Kubeflow installation on Google Cloud">
<meta itemprop="dateModified" content="2023-01-02T22:56:34+00:00" />
<meta itemprop="wordCount" content="1895">
<meta itemprop="keywords" content="" /><meta name="twitter:card" content="summary"/>
<meta name="twitter:title" content="Upgrade Kubeflow"/>
<meta name="twitter:description" content="Upgrading your Kubeflow installation on Google Cloud"/>




<link rel="preload" href="/kubeflow-gke-docs/dev/scss/main.min.5006b434b14f73c3d5537a7ba4c8ecef723ddc93f3a3c8530e19d24f75486ea9.css" as="style">
<link href="/kubeflow-gke-docs/dev/scss/main.min.5006b434b14f73c3d5537a7ba4c8ecef723ddc93f3a3c8530e19d24f75486ea9.css" rel="stylesheet" integrity="">

<script
  src="https://code.jquery.com/jquery-3.5.1.min.js"
  integrity="sha256-9/aliU8dGd2tb6OSsuzixeV4y/faTqgFtohetphbbj0="
  crossorigin="anonymous"></script>

<script async src="https://www.googletagmanager.com/gtag/js?id=G-GK9XL47N6S"></script>
<script>
var doNotTrack = false;
if (!doNotTrack) {
	window.dataLayer = window.dataLayer || [];
	function gtag(){dataLayer.push(arguments);}
	gtag('js', new Date());
	gtag('config', 'G-GK9XL47N6S', { 'anonymize_ip': false });
}
</script>

  </head>
  <body class="td-page">
    <header>
      
<nav class="js-navbar-scroll navbar navbar-expand-md navbar-dark  td-navbar">
        <a class="navbar-brand" href="/kubeflow-gke-docs/dev/">
		<span class="navbar-logo"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 276.93 274.55"><g data-name="Layer 2"><g data-name="Layer 1"><path d="M95.9 62.15l4.1 102.1 73.75-94.12a6.79 6.79.0 019.6-1.11l46 36.92-15-65.61z" fill="#4279f4"/><path fill="#0028aa" d="M102.55 182.98h65.42l-40.17-32.23-25.25 32.23z"/><path fill="#014bd1" d="M180.18 83.92l-44 56.14 46.88 37.61 44.47-55.76-47.35-37.99z"/><path fill="#bedcff" d="M83.56 52.3l.01-.01 38.69-48.52-62.39 30.05-15.41 67.51 39.1-49.03z"/><path fill="#6ca1ff" d="M45.32 122.05l41.44 51.96-3.95-98.98-37.49 47.02z"/><path fill="#a1c3ff" d="M202.31 28.73 142.65.0l-37.13 46.56 96.79-17.83z"/><path d="M1.6 272v-44.78h5.74v23.41l20.48-23.41h6.4l-17.39 19.7 19 25.07H29.1l-15.92-20.8-5.84 6.65V272zm40.02-9.79V240h5.43v22.39a4.67 4.67.0 002.35 4.19 11 11 0 0011 0 4.69 4.69.0 002.33-4.19V240h5.43v22.19a9.08 9.08.0 01-4.1 7.87 16.2 16.2.0 01-18.37.0 9.07 9.07.0 01-4.07-7.85zM77.46 272v-48h5.43v16.81a29.29 29.29.0 019.32-1.73 13.1 13.1.0 016.2 1.41 10.71 10.71.0 014.18 3.74 18.07 18.07.0 012.23 5.06 21.26 21.26.0 01.73 5.58q0 8.43-4.38 12.79T87.35 272zm5.43-4.87h4.55q6.77.0 9.72-2.95t3-9.51a14.21 14.21.0 00-2-7.52 6.55 6.55.0 00-6-3.22 24.73 24.73.0 00-9.25 1.54zm29.47-11.19q0-7.71 4.09-12.3a13.75 13.75.0 0110.8-4.59q13.35.0 13.36 18.86h-22.82a12.3 12.3.0 002.9 7.07q2.59 3.11 7.9 3.1a24.92 24.92.0 0010.55-2v5a27.74 27.74.0 01-9.86 1.87 19.83 19.83.0 01-7.7-1.37 13.31 13.31.0 01-5.28-3.76 16.21 16.21.0 01-3-5.38 20.84 20.84.0 01-.94-6.5zm5.62-2.12h17.26a14.91 14.91.0 00-2.37-7.12 6.44 6.44.0 00-5.62-2.78 8.2 8.2.0 00-6.21 2.72 12.07 12.07.0 00-3.04 7.18z" fill="#4279f4" stroke="#4279f4" stroke-miterlimit="10" stroke-width="3.2"/><path d="M147.32 244.89V240h5v-7.59a8.14 8.14.0 012.31-6.05 7.79 7.79.0 015.69-2.28h7.86V229h-5c-2.21.0-3.67.45-4.37 1.34s-1.06 2.55-1.06 5V240h8.46v4.87h-8.46V272h-5.44v-27.1zM175.26 272v-48h5.43v48zm19.15-3.95a17.86 17.86.0 1112.33 4.9 16.57 16.57.0 01-12.33-4.9zm3.84-20.65a13.16 13.16.0 000 17.2 12.07 12.07.0 0017 0 13.09 13.09.0 000-17.2 12.07 12.07.0 00-17 0zm30.2-7.4h5.75l7.3 25.32 7.43-25.32h5.36l7.34 25.34L269 240h5.74l-10.04 32h-6.12l-6.83-24.58L245 272h-6.47z" fill="#0028aa" stroke="#0028aa" stroke-miterlimit="10" stroke-width="3.2"/></g></g></svg></span><span class="text-uppercase font-weight-bold">Kubeflow on Google Cloud Platform</span>
	</a>
	<button class="navbar-toggler" type="button" data-toggle="collapse" data-target="#main_navbar" aria-controls="main_navbar" aria-expanded="false" aria-label="Toggle navigation">
		<span class="navbar-toggler-icon"></span>
	</button>
	<div class="collapse navbar-collapse ml-md-auto" id="main_navbar">
		<ul class="navbar-nav ml-auto pt-4 pt-md-0 my-2 my-md-1">
			
			
			<li class="nav-item mr-2 mr-lg-4 mt-1 mt-lg-0">
				
				
				
				
				
				
				<a class="nav-link" href="/kubeflow-gke-docs/dev/docs/" ><span>Docs</span></a>
			</li>
			
			<li class="nav-item mr-2 mr-lg-4 mt-1 mt-lg-0">
				
				
				
				
				
				
				<a class="nav-link" href="/kubeflow-gke-docs/dev/news/" ><span>News</span></a>
			</li>
			
			<li class="nav-item mr-2 mr-lg-4 mt-1 mt-lg-0">
				
				
				
				
				
				
				<a class="nav-link" href="https://github.com/googlecloudplatform/kubeflow-distribution" target="_blank" ><i class='fa-brands fa-github pr-2'></i><span>Manifests</span></a>
			</li>
			
			
			<li class="nav-item dropdown mt-1 mt-lg-0 mr-2">
				<a class="nav-link dropdown-toggle" href="#" id="navbarDropdown" role="button" data-toggle="dropdown" aria-haspopup="true" aria-expanded="false">
	dev
</a>
<div class="dropdown-menu dropdown-menu-md-right dropdown-menu-lg-left" aria-labelledby="navbarDropdownMenuLink">
	
	<a class="dropdown-item" href="https://googlecloudplatform.github.io/kubeflow-gke-docs/docs">v1.6 (latest)</a>
	
	<a class="dropdown-item" href="https://googlecloudplatform.github.io/kubeflow-gke-docs/v1.5/docs">v1.5</a>
	
	<a class="dropdown-item" href="https://googlecloudplatform.github.io/kubeflow-gke-docs/v1.4/docs">v1.4</a>
	
	<a class="dropdown-item" href="https://googlecloudplatform.github.io/kubeflow-gke-docs/dev/docs">dev</a>
	
</div>

			</li>
			
			
		</ul>
	</div>
</nav>

    </header>
    <div class="container-fluid td-outer">
      <div class="td-main">
        <div class="row flex-xl-nowrap">
          <aside class="col-12 col-md-3 col-xl-2 td-sidebar d-print-none">
            
<div id="td-sidebar-menu" class="td-sidebar__inner">
  <form class="td-sidebar__search d-flex align-items-center">
    
    <button class="btn btn-link td-sidebar__toggle d-md-none p-0 ml-3 fas fa-bars" type="button" data-toggle="collapse" data-target="#td-section-nav" aria-controls="td-section-nav" aria-expanded="false" aria-label="Toggle section navigation">
    </button>
  </form>
  <nav class="collapse td-sidebar-nav foldable-nav" id="td-section-nav">
    <ul class="td-sidebar-nav__section pr-md-3 ul-0">
      <li class="td-sidebar-nav__section-title td-sidebar-nav__section with-child active-path" id="m-kubeflow-gke-docsdevdocs-li">
  <a href="/kubeflow-gke-docs/dev/docs/" class="align-left pl-0 td-sidebar-link td-sidebar-link__section tree-root" id="m-kubeflow-gke-docsdevdocs"><span class="">Kubeflow on Google Cloud</span></a>
  <ul class="ul-1">
    <li class="td-sidebar-nav__section-title td-sidebar-nav__section with-child active-path" id="m-kubeflow-gke-docsdevdocsdeploy-li">
  <input type="checkbox" id="m-kubeflow-gke-docsdevdocsdeploy-check" checked/>
  <label for="m-kubeflow-gke-docsdevdocsdeploy-check"><a href="/kubeflow-gke-docs/dev/docs/deploy/" class="align-left pl-0  td-sidebar-link td-sidebar-link__section" id="m-kubeflow-gke-docsdevdocsdeploy"><span class="">Deployment</span></a></label>
  
  <ul class="ul-2 foldable">
    <li class="td-sidebar-nav__section-title td-sidebar-nav__section without-child" id="m-kubeflow-gke-docsdevdocsdeployoverview-li">
  <input type="checkbox" id="m-kubeflow-gke-docsdevdocsdeployoverview-check"/>
  <label for="m-kubeflow-gke-docsdevdocsdeployoverview-check"><a href="/kubeflow-gke-docs/dev/docs/deploy/overview/" class="align-left pl-0  td-sidebar-link td-sidebar-link__page" id="m-kubeflow-gke-docsdevdocsdeployoverview"><span class="">Overview</span></a></label>
  
</li><li class="td-sidebar-nav__section-title td-sidebar-nav__section without-child" id="m-kubeflow-gke-docsdevdocsdeployproject-setup-li">
  <input type="checkbox" id="m-kubeflow-gke-docsdevdocsdeployproject-setup-check"/>
  <label for="m-kubeflow-gke-docsdevdocsdeployproject-setup-check"><a href="/kubeflow-gke-docs/dev/docs/deploy/project-setup/" class="align-left pl-0  td-sidebar-link td-sidebar-link__page" id="m-kubeflow-gke-docsdevdocsdeployproject-setup"><span class="">Setting up GCP Project</span></a></label>
  
</li><li class="td-sidebar-nav__section-title td-sidebar-nav__section without-child" id="m-kubeflow-gke-docsdevdocsdeployoauth-setup-li">
  <input type="checkbox" id="m-kubeflow-gke-docsdevdocsdeployoauth-setup-check"/>
  <label for="m-kubeflow-gke-docsdevdocsdeployoauth-setup-check"><a href="/kubeflow-gke-docs/dev/docs/deploy/oauth-setup/" class="align-left pl-0  td-sidebar-link td-sidebar-link__page" id="m-kubeflow-gke-docsdevdocsdeployoauth-setup"><span class="">Setting up OAuth client</span></a></label>
  
</li><li class="td-sidebar-nav__section-title td-sidebar-nav__section without-child" id="m-kubeflow-gke-docsdevdocsdeploymanagement-setup-li">
  <input type="checkbox" id="m-kubeflow-gke-docsdevdocsdeploymanagement-setup-check"/>
  <label for="m-kubeflow-gke-docsdevdocsdeploymanagement-setup-check"><a href="/kubeflow-gke-docs/dev/docs/deploy/management-setup/" class="align-left pl-0  td-sidebar-link td-sidebar-link__page" id="m-kubeflow-gke-docsdevdocsdeploymanagement-setup"><span class="">Deploying Management cluster</span></a></label>
  
</li><li class="td-sidebar-nav__section-title td-sidebar-nav__section without-child" id="m-kubeflow-gke-docsdevdocsdeploydeploy-cli-li">
  <input type="checkbox" id="m-kubeflow-gke-docsdevdocsdeploydeploy-cli-check"/>
  <label for="m-kubeflow-gke-docsdevdocsdeploydeploy-cli-check"><a href="/kubeflow-gke-docs/dev/docs/deploy/deploy-cli/" class="align-left pl-0  td-sidebar-link td-sidebar-link__page" id="m-kubeflow-gke-docsdevdocsdeploydeploy-cli"><span class="">Deploying Kubeflow cluster</span></a></label>
  
</li><li class="td-sidebar-nav__section-title td-sidebar-nav__section without-child active-path" id="m-kubeflow-gke-docsdevdocsdeployupgrade-li">
  <input type="checkbox" id="m-kubeflow-gke-docsdevdocsdeployupgrade-check" checked/>
  <label for="m-kubeflow-gke-docsdevdocsdeployupgrade-check"><a href="/kubeflow-gke-docs/dev/docs/deploy/upgrade/" class="align-left pl-0  active td-sidebar-link td-sidebar-link__page" id="m-kubeflow-gke-docsdevdocsdeployupgrade"><span class="td-sidebar-nav-active-item">Upgrade Kubeflow</span></a></label>
  
</li><li class="td-sidebar-nav__section-title td-sidebar-nav__section without-child" id="m-kubeflow-gke-docsdevdocsdeploymonitor-iap-setup-li">
  <input type="checkbox" id="m-kubeflow-gke-docsdevdocsdeploymonitor-iap-setup-check"/>
  <label for="m-kubeflow-gke-docsdevdocsdeploymonitor-iap-setup-check"><a href="/kubeflow-gke-docs/dev/docs/deploy/monitor-iap-setup/" class="align-left pl-0  td-sidebar-link td-sidebar-link__page" id="m-kubeflow-gke-docsdevdocsdeploymonitor-iap-setup"><span class="">Monitoring Cloud IAP Setup</span></a></label>
  
</li><li class="td-sidebar-nav__section-title td-sidebar-nav__section without-child" id="m-kubeflow-gke-docsdevdocsdeploydelete-cli-li">
  <input type="checkbox" id="m-kubeflow-gke-docsdevdocsdeploydelete-cli-check"/>
  <label for="m-kubeflow-gke-docsdevdocsdeploydelete-cli-check"><a href="/kubeflow-gke-docs/dev/docs/deploy/delete-cli/" class="align-left pl-0  td-sidebar-link td-sidebar-link__page" id="m-kubeflow-gke-docsdevdocsdeploydelete-cli"><span class="">Deleting Kubeflow</span></a></label>
  
</li>
  </ul>
</li><li class="td-sidebar-nav__section-title td-sidebar-nav__section with-child" id="m-kubeflow-gke-docsdevdocspipelines-li">
  <input type="checkbox" id="m-kubeflow-gke-docsdevdocspipelines-check"/>
  <label for="m-kubeflow-gke-docsdevdocspipelines-check"><a href="/kubeflow-gke-docs/dev/docs/pipelines/" class="align-left pl-0  td-sidebar-link td-sidebar-link__section" id="m-kubeflow-gke-docsdevdocspipelines"><span class="">Pipelines on Google Cloud</span></a></label>
  
  <ul class="ul-2 foldable">
    <li class="td-sidebar-nav__section-title td-sidebar-nav__section without-child" id="m-kubeflow-gke-docsdevdocspipelinesauthentication-sdk-li">
  <input type="checkbox" id="m-kubeflow-gke-docsdevdocspipelinesauthentication-sdk-check"/>
  <label for="m-kubeflow-gke-docsdevdocspipelinesauthentication-sdk-check"><a href="/kubeflow-gke-docs/dev/docs/pipelines/authentication-sdk/" class="align-left pl-0  td-sidebar-link td-sidebar-link__page" id="m-kubeflow-gke-docsdevdocspipelinesauthentication-sdk"><span class="">Connecting to Kubeflow Pipelines on Google Cloud using the SDK</span></a></label>
  
</li><li class="td-sidebar-nav__section-title td-sidebar-nav__section without-child" id="m-kubeflow-gke-docsdevdocspipelinesauthentication-pipelines-li">
  <input type="checkbox" id="m-kubeflow-gke-docsdevdocspipelinesauthentication-pipelines-check"/>
  <label for="m-kubeflow-gke-docsdevdocspipelinesauthentication-pipelines-check"><a href="/kubeflow-gke-docs/dev/docs/pipelines/authentication-pipelines/" class="align-left pl-0  td-sidebar-link td-sidebar-link__page" id="m-kubeflow-gke-docsdevdocspipelinesauthentication-pipelines"><span class="">Authenticating Pipelines to Google Cloud</span></a></label>
  
</li><li class="td-sidebar-nav__section-title td-sidebar-nav__section without-child" id="m-kubeflow-gke-docsdevdocspipelinesupgrade-li">
  <input type="checkbox" id="m-kubeflow-gke-docsdevdocspipelinesupgrade-check"/>
  <label for="m-kubeflow-gke-docsdevdocspipelinesupgrade-check"><a href="/kubeflow-gke-docs/dev/docs/pipelines/upgrade/" class="align-left pl-0  td-sidebar-link td-sidebar-link__page" id="m-kubeflow-gke-docsdevdocspipelinesupgrade"><span class="">Upgrading</span></a></label>
  
</li><li class="td-sidebar-nav__section-title td-sidebar-nav__section without-child" id="m-kubeflow-gke-docsdevdocspipelinesenable-gpu-and-tpu-li">
  <input type="checkbox" id="m-kubeflow-gke-docsdevdocspipelinesenable-gpu-and-tpu-check"/>
  <label for="m-kubeflow-gke-docsdevdocspipelinesenable-gpu-and-tpu-check"><a href="/kubeflow-gke-docs/dev/docs/pipelines/enable-gpu-and-tpu/" class="align-left pl-0  td-sidebar-link td-sidebar-link__page" id="m-kubeflow-gke-docsdevdocspipelinesenable-gpu-and-tpu"><span class="">Enabling GPU and TPU</span></a></label>
  
</li><li class="td-sidebar-nav__section-title td-sidebar-nav__section without-child" id="m-kubeflow-gke-docsdevdocspipelinespreemptible-li">
  <input type="checkbox" id="m-kubeflow-gke-docsdevdocspipelinespreemptible-check"/>
  <label for="m-kubeflow-gke-docsdevdocspipelinespreemptible-check"><a href="/kubeflow-gke-docs/dev/docs/pipelines/preemptible/" class="align-left pl-0  td-sidebar-link td-sidebar-link__page" id="m-kubeflow-gke-docsdevdocspipelinespreemptible"><span class="">Using Preemptible VMs and GPUs on Google Cloud</span></a></label>
  
</li>
  </ul>
</li><li class="td-sidebar-nav__section-title td-sidebar-nav__section without-child" id="m-kubeflow-gke-docsdevdocscustomizing-li">
  <input type="checkbox" id="m-kubeflow-gke-docsdevdocscustomizing-check"/>
  <label for="m-kubeflow-gke-docsdevdocscustomizing-check"><a href="/kubeflow-gke-docs/dev/docs/customizing/" class="align-left pl-0  td-sidebar-link td-sidebar-link__page" id="m-kubeflow-gke-docsdevdocscustomizing"><span class="">Customize Kubeflow on Google Cloud</span></a></label>
  
</li><li class="td-sidebar-nav__section-title td-sidebar-nav__section without-child" id="m-kubeflow-gke-docsdevdocscustom-domain-li">
  <input type="checkbox" id="m-kubeflow-gke-docsdevdocscustom-domain-check"/>
  <label for="m-kubeflow-gke-docsdevdocscustom-domain-check"><a href="/kubeflow-gke-docs/dev/docs/custom-domain/" class="align-left pl-0  td-sidebar-link td-sidebar-link__page" id="m-kubeflow-gke-docsdevdocscustom-domain"><span class="">Using Your Own Domain</span></a></label>
  
</li><li class="td-sidebar-nav__section-title td-sidebar-nav__section without-child" id="m-kubeflow-gke-docsdevdocsauthentication-li">
  <input type="checkbox" id="m-kubeflow-gke-docsdevdocsauthentication-check"/>
  <label for="m-kubeflow-gke-docsdevdocsauthentication-check"><a href="/kubeflow-gke-docs/dev/docs/authentication/" class="align-left pl-0  td-sidebar-link td-sidebar-link__page" id="m-kubeflow-gke-docsdevdocsauthentication"><span class="">Authenticating Kubeflow to Google Cloud</span></a></label>
  
</li><li class="td-sidebar-nav__section-title td-sidebar-nav__section without-child" id="m-kubeflow-gke-docsdevdocsprivate-clusters-li">
  <input type="checkbox" id="m-kubeflow-gke-docsdevdocsprivate-clusters-check"/>
  <label for="m-kubeflow-gke-docsdevdocsprivate-clusters-check"><a href="/kubeflow-gke-docs/dev/docs/private-clusters/" class="align-left pl-0  td-sidebar-link td-sidebar-link__page" id="m-kubeflow-gke-docsdevdocsprivate-clusters"><span class="">Securing Your Clusters</span></a></label>
  
</li><li class="td-sidebar-nav__section-title td-sidebar-nav__section without-child" id="m-kubeflow-gke-docsdevdocstroubleshooting-li">
  <input type="checkbox" id="m-kubeflow-gke-docsdevdocstroubleshooting-check"/>
  <label for="m-kubeflow-gke-docsdevdocstroubleshooting-check"><a href="/kubeflow-gke-docs/dev/docs/troubleshooting/" class="align-left pl-0  td-sidebar-link td-sidebar-link__page" id="m-kubeflow-gke-docsdevdocstroubleshooting"><span class="">Troubleshooting Deployments on Google Cloud</span></a></label>
  
</li><li class="td-sidebar-nav__section-title td-sidebar-nav__section without-child" id="m-kubeflow-gke-docsdevdocsanthos-li">
  <input type="checkbox" id="m-kubeflow-gke-docsdevdocsanthos-check"/>
  <label for="m-kubeflow-gke-docsdevdocsanthos-check"><a href="/kubeflow-gke-docs/dev/docs/anthos/" class="align-left pl-0  td-sidebar-link td-sidebar-link__page" id="m-kubeflow-gke-docsdevdocsanthos"><span class="">Kubeflow On-premises on Anthos</span></a></label>
  
</li><li class="td-sidebar-nav__section-title td-sidebar-nav__section without-child" id="m-kubeflow-gke-docsdevdocschangelog-li">
  <input type="checkbox" id="m-kubeflow-gke-docsdevdocschangelog-check"/>
  <label for="m-kubeflow-gke-docsdevdocschangelog-check"><a href="/kubeflow-gke-docs/dev/docs/changelog/" class="align-left pl-0  td-sidebar-link td-sidebar-link__section" id="m-kubeflow-gke-docsdevdocschangelog"><span class="">Changelog</span></a></label>
  
</li>
  </ul>
</li>
    </ul>
  </nav>
</div>

          </aside>
          <aside class="d-none d-xl-block col-xl-2 td-sidebar-toc d-print-none">
            
<div class="td-page-meta ml-2 pb-1 pt-2 mb-0">
<a id="print" href="https://googlecloudplatform.github.io/kubeflow-gke-docs/dev/docs/deploy/_print/"><i class="fa-solid fa-print fa-fw"></i> Print entire section</a>

</div>

            <div class="td-toc">
        <nav id="TableOfContents">
  <ul>
    <li><a href="#before-you-start">Before you start</a></li>
    <li><a href="#general-upgrade-instructions">General upgrade instructions</a></li>
    <li><a href="#upgrading-management-cluster">Upgrading management cluster</a>
      <ul>
        <li><a href="#upgrading-management-cluster-before-15">Upgrading management cluster before 1.5</a></li>
        <li><a href="#upgrade-management-cluster-from-v11-to-v12">Upgrade management cluster from v1.1 to v1.2</a></li>
      </ul>
    </li>
    <li><a href="#upgrading-kubeflow-cluster">Upgrading Kubeflow cluster</a>
      <ul>
        <li><a href="#general-instructions-for-upgrading-kubeflow-cluster">General instructions for upgrading Kubeflow cluster</a></li>
        <li><a href="#upgrade-kubeflow-cluster-to-v16">Upgrade Kubeflow cluster to v1.6</a></li>
        <li><a href="#upgrade-kubeflow-cluster-to-v15">Upgrade Kubeflow cluster to v1.5</a></li>
        <li><a href="#upgrade-kubeflow-cluster-to-v13">Upgrade Kubeflow cluster to v1.3</a></li>
        <li><a href="#upgrade-kubeflow-cluster-from-v11-to-v12">Upgrade Kubeflow cluster from v1.1 to v1.2</a></li>
      </ul>
    </li>
    <li><a href="#upgrade-asm-anthos-service-mesh">Upgrade ASM (Anthos Service Mesh)</a>
      <ul>
        <li><a href="#install-a-new-asm-workload">Install a new ASM workload</a></li>
        <li><a href="#upgrade-other-kubeflow-components-to-use-new-asm">Upgrade other Kubeflow components to use new ASM</a></li>
        <li><a href="#optional-uninstall-the-old-asm-workload">(Optional) Uninstall the old ASM workload</a></li>
      </ul>
    </li>
  </ul>
</nav>
      </div>
    
            

	
		
			
				
			
			



  
  

		
			
				
			
			



  
  

		
	

          </aside>
          <main class="col-12 col-md-9 col-xl-8 pl-md-5" role="main">
            
  

            <nav aria-label="breadcrumb" class="td-breadcrumbs">
  <ol class="breadcrumb">
  <li class="breadcrumb-item">
    <a href="https://googlecloudplatform.github.io/kubeflow-gke-docs/dev/docs/">Kubeflow on Google Cloud</a>
  </li>
  <li class="breadcrumb-item">
    <a href="https://googlecloudplatform.github.io/kubeflow-gke-docs/dev/docs/deploy/">Deployment</a>
  </li>
  <li class="breadcrumb-item active" aria-current="page">
    <a href="https://googlecloudplatform.github.io/kubeflow-gke-docs/dev/docs/deploy/upgrade/" aria-disabled="true" class="btn-link disabled">Upgrade Kubeflow</a>
  </li>
  </ol>
</nav>
            
<div class="td-content">
	<h1>Upgrade Kubeflow</h1>
	<div class="lead">Upgrading your Kubeflow installation on Google Cloud</div>
	<header class="article-meta">
		

  
    
      


    
      


    
  

		
			<p class="reading-time"><i class="fa-solid fa-clock" aria-hidden="true"></i>&nbsp; 9 minute read &nbsp;</p>

		
	</header>    
	<h2 id="before-you-start">Before you start</h2>
<p>To better understand upgrade process, you should read the following sections first:</p>
<ul>
<li><a href="./docs/deploy/management-setup#understanding-the-deployment-process">Understanding the deployment process for management cluster</a></li>
<li><a href="./docs/deploy/deploy-cli#understanding-the-deployment-process">Understanding the deployment process for Kubeflow cluster</a></li>
</ul>
<p>This guide assumes the following settings:</p>
<ul>
<li>The <code>${MGMT_DIR}</code> and <code>${MGMT_NAME}</code> environment variables
are the same as in <a href="./docs/deploy/management-setup#configure-environment-variables">Management cluster setup</a>.</li>
<li>The <code>${KF_NAME}</code>, <code>${CLIENT_ID}</code> and <code>${CLIENT_SECRET}</code> environment variables
are the same as in <a href="./docs/deploy/deploy-cli#environment-variables">Deploy using kubectl and kpt</a>.</li>
<li>The <code>${KF_DIR}</code> environment variable contains the path to
your Kubeflow application directory, which holds your Kubeflow configuration
files. For example, <code>/opt/kubeflow-distribution/kubeflow/</code>.</li>
</ul>
<h2 id="general-upgrade-instructions">General upgrade instructions</h2>
<p>Starting from Kubeflow v1.5, we have integrated with <a href="https://cloud.google.com/anthos-config-management/docs/concepts/config-controller-overview">Config Controller</a>. You don&rsquo;t need to manually upgrade Management cluster any more, since it managed by <a href="https://cloud.google.com/anthos-config-management/docs/how-to/config-controller-setup#upgrade">Upgrade Config Controller</a>.</p>
<p>Starting from Kubeflow v1.3, we have reworked on the structure of <code>googlecloudplatform/kubeflow-distribution</code> repository. All resources are located in <code>kubeflow-distribution/management</code> directory. Upgrade to Management cluster v1.3 is not supported.</p>
<p>Before Kubeflow v1.3, both management cluster and Kubeflow cluster follow the same <code>instance</code> and <code>upstream</code> folder convention. To upgrade, you&rsquo;ll typically need to update packages in <code>upstream</code> to the new version and repeat the <code>make apply-&lt;subcommand&gt;</code> commands in their respective deployment process.</p>
<p>However, specific upgrades might need manual actions below.</p>
<h2 id="upgrading-management-cluster">Upgrading management cluster</h2>
<h3 id="upgrading-management-cluster-before-15">Upgrading management cluster before 1.5</h3>
<p>It is strongly recommended to use source control to keep a copy of your working repository for recording changes at each step.</p>
<p>Due to the refactoring of <code>kubeflow/manifests</code> repository, the way we depend on <code>googlecloudplatform/kubeflow-distribution</code> has changed drastically. This section suits for upgrading from Kubeflow 1.3 to higher.</p>
<ol>
<li>
<p>The instructions below assume that your current working directory is</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash"><span class="line"><span class="cl"><span class="nb">cd</span> <span class="s2">&#34;</span><span class="si">${</span><span class="nv">MGMT_DIR</span><span class="si">}</span><span class="s2">&#34;</span>
</span></span></code></pre></div></li>
<li>
<p>Use your management cluster&rsquo;s kubectl context:</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash"><span class="line"><span class="cl"><span class="c1"># Look at all your contexts</span>
</span></span><span class="line"><span class="cl">kubectl config get-contexts
</span></span><span class="line"><span class="cl"><span class="c1"># Select your management cluster&#39;s context</span>
</span></span><span class="line"><span class="cl">kubectl config use-context <span class="s2">&#34;</span><span class="si">${</span><span class="nv">MGMT_NAME</span><span class="si">}</span><span class="s2">&#34;</span>
</span></span><span class="line"><span class="cl"><span class="c1"># Verify the context connects to the cluster properly</span>
</span></span><span class="line"><span class="cl">kubectl get namespace
</span></span></code></pre></div><p>If you are using a different environment, you can always
reconfigure the context by:</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash"><span class="line"><span class="cl">make create-context
</span></span></code></pre></div></li>
<li>
<p>Check your existing config connector version:</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash"><span class="line"><span class="cl"><span class="c1"># For Kubeflow v1.3, it should be 1.46.0</span>
</span></span><span class="line"><span class="cl">$ kubectl get namespace cnrm-system -ojsonpath<span class="o">=</span><span class="s1">&#39;{.metadata.annotations.cnrm\.cloud\.google\.com\/version}&#39;</span>
</span></span><span class="line"><span class="cl">1.46.0
</span></span></code></pre></div></li>
<li>
<p>Merge the content from new Kubeflow version of <code>googlecloudplatform/kubeflow-distribution</code></p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash"><span class="line"><span class="cl"><span class="nv">WORKING_BRANCH</span><span class="o">=</span>&lt;your-github-working-branch&gt;
</span></span><span class="line"><span class="cl"><span class="nv">VERSION_TAG</span><span class="o">=</span>&lt;targeted-kubeflow-version-tag-on-github&gt;
</span></span><span class="line"><span class="cl">git checkout -b <span class="s2">&#34;</span><span class="si">${</span><span class="nv">WORKING_BRANCH</span><span class="si">}</span><span class="s2">&#34;</span>
</span></span><span class="line"><span class="cl">git remote add upstream https://github.com/googlecloudplatform/kubeflow-distribution.git <span class="c1"># This is one time only.</span>
</span></span><span class="line"><span class="cl">git fetch upstream 
</span></span><span class="line"><span class="cl">git merge <span class="s2">&#34;</span><span class="si">${</span><span class="nv">VERSION_TAG</span><span class="si">}</span><span class="s2">&#34;</span>
</span></span></code></pre></div></li>
<li>
<p>Make sure your build directory (<code>./build</code> by default) is checked in to source control (git).</p>
</li>
<li>
<p>Run the following command to hydrate Config Connector resources:</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash"><span class="line"><span class="cl">make hydrate-kcc
</span></span></code></pre></div></li>
<li>
<p>Compare the difference on your source control tracking after making hydration change. If they are addition or modification only, proceed to next step. If it includes deletion, you need to use <code>kubectl delete</code> to manually clean up the deleted resource for cleanup.</p>
</li>
<li>
<p>After confirmation, run the following command to apply new changes:</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash"><span class="line"><span class="cl">make apply-kcc
</span></span></code></pre></div></li>
<li>
<p>Check version has been upgraded after applying new Config Connector resource:</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash"><span class="line"><span class="cl">$ kubectl get namespace cnrm-system -ojsonpath<span class="o">=</span><span class="s1">&#39;{.metadata.annotations.cnrm\.cloud\.google\.com\/version}&#39;</span>
</span></span></code></pre></div></li>
</ol>
<h3 id="upgrade-management-cluster-from-v11-to-v12">Upgrade management cluster from v1.1 to v1.2</h3>
<ol>
<li>
<p>The instructions below assume that your current working directory is</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash"><span class="line"><span class="cl"><span class="nb">cd</span> <span class="s2">&#34;</span><span class="si">${</span><span class="nv">MGMT_DIR</span><span class="si">}</span><span class="s2">&#34;</span>
</span></span></code></pre></div></li>
<li>
<p>Use your management cluster&rsquo;s kubectl context:</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash"><span class="line"><span class="cl"><span class="c1"># Look at all your contexts</span>
</span></span><span class="line"><span class="cl">kubectl config get-contexts
</span></span><span class="line"><span class="cl"><span class="c1"># Select your management cluster&#39;s context</span>
</span></span><span class="line"><span class="cl">kubectl config use-context <span class="s2">&#34;</span><span class="si">${</span><span class="nv">MGMT_NAME</span><span class="si">}</span><span class="s2">&#34;</span>
</span></span><span class="line"><span class="cl"><span class="c1"># Verify the context connects to the cluster properly</span>
</span></span><span class="line"><span class="cl">kubectl get namespace
</span></span></code></pre></div><p>If you are using a different environment, you can always
reconfigure the context by:</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash"><span class="line"><span class="cl">make create-context
</span></span></code></pre></div></li>
<li>
<p>Check your existing config connector version:</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash"><span class="line"><span class="cl"><span class="c1"># For Kubeflow v1.1, it should be 1.15.1</span>
</span></span><span class="line"><span class="cl">$ kubectl get namespace cnrm-system -ojsonpath<span class="o">=</span><span class="s1">&#39;{.metadata.annotations.cnrm\.cloud\.google\.com\/version}&#39;</span>
</span></span><span class="line"><span class="cl">1.15.1
</span></span></code></pre></div></li>
<li>
<p>Uninstall the old config connector in the management cluster:</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash"><span class="line"><span class="cl">kubectl delete sts,deploy,po,svc,roles,clusterroles,clusterrolebindings --all-namespaces -l cnrm.cloud.google.com/system<span class="o">=</span><span class="nb">true</span> --wait<span class="o">=</span><span class="nb">true</span>
</span></span><span class="line"><span class="cl">kubectl delete validatingwebhookconfiguration abandon-on-uninstall.cnrm.cloud.google.com --ignore-not-found --wait<span class="o">=</span><span class="nb">true</span>
</span></span><span class="line"><span class="cl">kubectl delete validatingwebhookconfiguration validating-webhook.cnrm.cloud.google.com --ignore-not-found --wait<span class="o">=</span><span class="nb">true</span>
</span></span><span class="line"><span class="cl">kubectl delete mutatingwebhookconfiguration mutating-webhook.cnrm.cloud.google.com --ignore-not-found --wait<span class="o">=</span><span class="nb">true</span>
</span></span></code></pre></div><p>These commands uninstall the config connector without removing your resources.</p>
</li>
<li>
<p>Replace your <code>./Makefile</code> with the version in Kubeflow <code>v1.2.0</code>: <a href="https://github.com/googlecloudplatform/kubeflow-distribution/blob/v1.2.0/management/Makefile">https://github.com/googlecloudplatform/kubeflow-distribution/blob/v1.2.0/management/Makefile</a>.</p>
<p>If you made any customizations in <code>./Makefile</code>, you should merge your changes with the upstream version. We&rsquo;ve refactored the Makefile to move substantial commands into the upstream package, so hopefully future upgrades won&rsquo;t require a manual merge of the Makefile.</p>
</li>
<li>
<p>Update <code>./upstream/management</code> package:</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash"><span class="line"><span class="cl">make update
</span></span></code></pre></div></li>
<li>
<p>Use kpt to set user values:</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash"><span class="line"><span class="cl">kpt cfg <span class="nb">set</span> -R . name <span class="si">${</span><span class="nv">MGMT_NAME</span><span class="si">}</span>
</span></span><span class="line"><span class="cl">kpt cfg <span class="nb">set</span> -R . gcloud.core.project <span class="si">${</span><span class="nv">MGMT_PROJECT</span><span class="si">}</span>
</span></span><span class="line"><span class="cl">kpt cfg <span class="nb">set</span> -R . location <span class="si">${</span><span class="nv">LOCATION</span><span class="si">}</span>
</span></span></code></pre></div><p>Note, you can find out which setters exist in a package and what there current values are by:</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash"><span class="line"><span class="cl">kpt cfg list-setters .
</span></span></code></pre></div></li>
<li>
<p>Apply upgraded config connector:</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash"><span class="line"><span class="cl">make apply-kcc
</span></span></code></pre></div><p>Note, you can optionally also run <code>make apply-cluster</code>, but it should be the same as your existing management cluster.</p>
</li>
<li>
<p>Check that your config connector upgrade is successful:</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash"><span class="line"><span class="cl"><span class="c1"># For Kubeflow v1.2, it should be 1.29.0</span>
</span></span><span class="line"><span class="cl">$ kubectl get namespace cnrm-system -ojsonpath<span class="o">=</span><span class="s1">&#39;{.metadata.annotations.cnrm\.cloud\.google\.com\/version}&#39;</span>
</span></span><span class="line"><span class="cl">1.29.0
</span></span></code></pre></div></li>
</ol>
<h2 id="upgrading-kubeflow-cluster">Upgrading Kubeflow cluster</h2>


<div class="alert alert-warning" role="alert">
<h4 class="alert-heading">DISCLAIMERS</h4>

    <div>The upgrade process depends on each Kubeflow application to handle the upgrade properly. There's no guarantee on data completeness unless the application provides such a guarantee.</div>
<div>You are recommended to back up your data before an upgrade.</div>
<div>Upgrading Kubeflow cluster can be a disruptive process, please schedule some downtime and communicate with your users.</div>


</div>

<p>To upgrade from specific versions of Kubeflow, you may need to take certain manual actions — refer to specific sections in the guidelines below.</p>
<h3 id="general-instructions-for-upgrading-kubeflow-cluster">General instructions for upgrading Kubeflow cluster</h3>
<ol>
<li>
<p>The instructions below assume that:</p>
<ul>
<li>
<p>Your current working directory is:</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash"><span class="line"><span class="cl"><span class="nb">cd</span> <span class="si">${</span><span class="nv">KF_DIR</span><span class="si">}</span>
</span></span></code></pre></div></li>
<li>
<p>Your kubectl uses a context that connects to your Kubeflow cluster</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash"><span class="line"><span class="cl"><span class="c1"># List your existing contexts</span>
</span></span><span class="line"><span class="cl">kubectl config get-contexts
</span></span><span class="line"><span class="cl"><span class="c1"># Use the context that connects to your Kubeflow cluster</span>
</span></span><span class="line"><span class="cl">kubectl config use-context <span class="si">${</span><span class="nv">KF_NAME</span><span class="si">}</span>
</span></span></code></pre></div></li>
</ul>
</li>
<li>
<p>Merge the new version of <code>googlecloudplatform/kubeflow-distribution</code> (example: v1.3.1), you don&rsquo;t need to do it again if you have already done so during management cluster upgrade.</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash"><span class="line"><span class="cl"><span class="nv">WORKING_BRANCH</span><span class="o">=</span>&lt;your-github-working-branch&gt;
</span></span><span class="line"><span class="cl"><span class="nv">VERSION_TAG</span><span class="o">=</span>&lt;targeted-kubeflow-version-tag-on-github&gt;
</span></span><span class="line"><span class="cl">git checkout -b <span class="s2">&#34;</span><span class="si">${</span><span class="nv">WORKING_BRANCH</span><span class="si">}</span><span class="s2">&#34;</span>
</span></span><span class="line"><span class="cl">git remote add upstream https://github.com/googlecloudplatform/kubeflow-distribution.git <span class="c1"># This is one time only.</span>
</span></span><span class="line"><span class="cl">git fetch upstream 
</span></span><span class="line"><span class="cl">git merge <span class="s2">&#34;</span><span class="si">${</span><span class="nv">VERSION_TAG</span><span class="si">}</span><span class="s2">&#34;</span>
</span></span></code></pre></div></li>
<li>
<p>Change the <code>KUBEFLOW_MANIFESTS_VERSION</code> in <code>./pull-upstream.sh</code> with the targeted kubeflow version same as <code>$VERSION_TAG</code>. Run the following commands to pull new changes from upstream <code>kubeflow/manifests</code>.</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash"><span class="line"><span class="cl">bash ./pull-upstream.sh
</span></span></code></pre></div></li>
<li>
<p>(Optional) If you only want to upgrade some of Kubeflow components, you can comment non-upgrade components in <code>kubeflow/config.yaml</code> file. Commands below will only apply the remaining components.</p>
</li>
<li>
<p>Make sure you have checked in <code>build</code> folders for each component. The following command will change them so you can compare for difference.</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash"><span class="line"><span class="cl">make hydrate
</span></span></code></pre></div></li>
<li>
<p>Once you confirm the changes are ready to apply, run the following command to upgrade Kubeflow cluster:</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash"><span class="line"><span class="cl">make apply
</span></span></code></pre></div></li>
</ol>


<div class="alert alert-primary" role="alert">
<h4 class="alert-heading">Note</h4>

    Kubeflow on Google Cloud doesn&rsquo;t guarantee the upgrade for each Kubeflow component always works with the general upgrade guide here. Please refer to corresponding repository in <a href="https://github.com/kubeflow">Kubeflow org</a> for upgrade support.

</div>

<h3 id="upgrade-kubeflow-cluster-to-v16">Upgrade Kubeflow cluster to v1.6</h3>
<p>Starting from Kubeflow v1.6.0:</p>
<ul>
<li>Component with deprecated API versions were upgraded to support Google Kubernetes Engine v1.22. If you would like to upgrade your Google Kubernetes Engine cluster, follow <a href="https://cloud.google.com/kubernetes-engine/docs/how-to/upgrading-a-cluster">GCP instructions</a>.</li>
<li>ASM was upgraded to v1.14. Follow the instructions on how to <a href="#upgrade-asm-anthos-service-mesh">upgrade ASM (Anthos Service Mesh)</a>. If you want to use ASM version prior to 1.11, refer to <a href="https://github.com/googlecloudplatform/kubeflow-distribution/blob/master/kubeflow/asm/deprecated/README.md">the legacy instructions</a>.</li>
<li>Knative was upgraded to v1.2. Follow <a href="https://knative.dev/docs/install/upgrade/upgrade-installation/">Knative instructions</a> to check current version and see if the update includes any breaking changes.</li>
<li>Cert-manager was upgraded to v1.5. To check your current version and see if the update includes any breaking changes, follow the <a href="https://cert-manager.io/docs/installation/upgrading/">cert-manager instructions</a>.</li>
<li>Deprecated kfserving component was removed. To upgrade to KServe, follow the <a href="https://github.com/kserve/kserve/tree/master/hack/kserve_migration">KServe Migration guide</a>.</li>
</ul>
<h3 id="upgrade-kubeflow-cluster-to-v15">Upgrade Kubeflow cluster to v1.5</h3>
<p>In Kubeflow v1.5.1 we use ASM v1.13. See <a href="#upgrade-asm-anthos-service-mesh">how to upgrade ASM</a>. To use ASM versions prior to 1.11, follow <a href="https://github.com/googlecloudplatform/kubeflow-distribution/blob/master/kubeflow/asm/deprecated/README.md">the legacy instructions</a>.</p>
<p>Starting from Kubeflow v1.5, Kubeflow manifests have included KServe as an independent component from kfserving, Google Cloud distribution has switched over from kfserving to KServe for default installed components. If you want to upgrade Kubeflow while keeping kfsering, you can comment KServe and uncomment kfserving in <code>kubeflow-distribution/kubeflow/config.yaml</code> file. If you want to upgrade to KServe, follow the <a href="https://github.com/kserve/kserve/tree/master/hack/kserve_migration">KServe Migration guide</a>.</p>
<h3 id="upgrade-kubeflow-cluster-to-v13">Upgrade Kubeflow cluster to v1.3</h3>
<p>Due to the refactoring of <code>kubeflow/manifests</code> repository, the way we depend on <code>googlecloudplatform/kubeflow-distribution</code> has changed drastically. Upgrade to Kubeflow cluster v1.3 is not supported. And individual component upgrade has been deferred to its corresponding repository for support.</p>
<h3 id="upgrade-kubeflow-cluster-from-v11-to-v12">Upgrade Kubeflow cluster from v1.1 to v1.2</h3>
<ol>
<li>
<p>The instructions below assume</p>
<ul>
<li>
<p>Your current working directory is:</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash"><span class="line"><span class="cl"><span class="nb">cd</span> <span class="si">${</span><span class="nv">KF_DIR</span><span class="si">}</span>
</span></span></code></pre></div></li>
<li>
<p>Your kubectl uses a context that connects to your Kubeflow cluster:</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash"><span class="line"><span class="cl"><span class="c1"># List your existing contexts</span>
</span></span><span class="line"><span class="cl">kubectl config get-contexts
</span></span><span class="line"><span class="cl"><span class="c1"># Use the context that connects to your Kubeflow cluster</span>
</span></span><span class="line"><span class="cl">kubectl config use-context <span class="si">${</span><span class="nv">KF_NAME</span><span class="si">}</span>
</span></span></code></pre></div></li>
</ul>
</li>
<li>
<p>(Recommended) Replace your <code>./Makefile</code> with the version in Kubeflow <code>v1.2.0</code>: <a href="https://github.com/googlecloudplatform/kubeflow-distribution/blob/v1.2.0/kubeflow/Makefile">https://github.com/googlecloudplatform/kubeflow-distribution/blob/v1.2.0/kubeflow/Makefile</a>.</p>
<p>If you made any customizations in <code>./Makefile</code>, you should merge your changes with the upstream version.</p>
<p>This step is recommended, because we introduced usability improvements and fixed compatibility for newer Kustomize versions (while still being compatible with Kustomize v3.2.1) to the Makefile. However, the deployment process is backward-compatible, so this is recommended, but not required.</p>
</li>
<li>
<p>Update <code>./upstream/manifests</code> package:</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash"><span class="line"><span class="cl">make update
</span></span></code></pre></div></li>
<li>
<p>Before applying new resources, you need to delete some immutable resources that were updated in this release:</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash"><span class="line"><span class="cl">kubectl delete statefulset kfserving-controller-manager -n kubeflow --wait
</span></span><span class="line"><span class="cl">kubectl delete crds experiments.kubeflow suggestions.kubeflow trials.kubeflow
</span></span></code></pre></div><p><strong>WARNING</strong>: This step <strong>deletes</strong> all Katib running resources.</p>
<p>Refer to <a href="https://github.com/kubeflow/kubeflow/issues/5371#issuecomment-731359384">a github comment in the v1.2 release issue</a> for more details.</p>
</li>
<li>
<p>Redeploy:</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash"><span class="line"><span class="cl">make apply
</span></span></code></pre></div><p>To evaluate the changes before deploying them you can:</p>
<ol>
<li>Run <code>make hydrate</code>.</li>
<li>Compare the contents
of <code>.build</code> with a historic version with tools like <code>git diff</code>.</li>
</ol>
</li>
</ol>
<h2 id="upgrade-asm-anthos-service-mesh">Upgrade ASM (Anthos Service Mesh)</h2>
<p>If you want to upgrade ASM instead of the Kubeflow components, refer to [kubeflow/common/asm/README.md](<a href="https://github.com/googlecloudplatform/kubeflow-distribution/blob/master/kubeflow/asm/README.md">https://github.com/googlecloudplatform/kubeflow-distribution/blob/master/kubeflow/asm/README.md</a> for the latest instructions on upgrading ASM. Detailed explanation is listed below. Note: if you are going to upgrade major or minor version of ASM, it is recommended to read <a href="https://cloud.google.com/service-mesh/docs/upgrade-path-old-versions-gke">the official ASM upgrade documentation</a> before proceeding with the steps below.</p>
<h3 id="install-a-new-asm-workload">Install a new ASM workload</h3>
<p>In order to use the new ASM version, we need to download the corresponding ASM configuration package and <code>asmcli</code> script. Get a list of available ASM packages and the corresponding <code>asmcli</code> scripts by running the following command:</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash"><span class="line"><span class="cl">curl https://storage.googleapis.com/csm-artifacts/asm/ASMCLI_VERSIONS
</span></span></code></pre></div><p>It should return a list of ASM versions that can be installed with asmcli script. To install older versions, refer to <a href="https://github.com/googlecloudplatform/kubeflow-distribution/blob/master/kubeflow/asm/deprecated/README.md">the legacy instructions</a>. The returned list will have a format of <code>${ASM_PACKAGE_VERSION}:${ASMCLI_SCRIPT_VERSION}</code>. For example, in the following output:</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-fallback" data-lang="fallback"><span class="line"><span class="cl">...
</span></span><span class="line"><span class="cl">1.13.2-asm.5+config2:asmcli_1.13.2-asm.5-config2
</span></span><span class="line"><span class="cl">1.13.2-asm.5+config1:asmcli_1.13.2-asm.5-config1
</span></span><span class="line"><span class="cl">1.13.2-asm.2+config2:asmcli_1.13.2-asm.2-config2
</span></span><span class="line"><span class="cl">1.13.2-asm.2+config1:asmcli_1.13.2-asm.2-config1
</span></span><span class="line"><span class="cl">1.13.1-asm.1+config1:asmcli_1.13.1-asm.1-config1
</span></span><span class="line"><span class="cl">...
</span></span></code></pre></div><p>record 1.13.2-asm.5+config2:asmcli_1.13.2-asm.5-config2 corresponds to:</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash"><span class="line"><span class="cl"><span class="nv">ASM_PACKAGE_VERSION</span><span class="o">=</span>1.13.2-asm.5+config2
</span></span><span class="line"><span class="cl"><span class="nv">ASMCLI_SCRIPT_VERSION</span><span class="o">=</span>asmcli_1.13.2-asm.5-config2
</span></span></code></pre></div><p>You need to set these two values in <a href="https://github.com/googlecloudplatform/kubeflow-distribution/blob/master/kubeflow/asm/Makefile">kubeflow/asm/Makefile</a>. Then, run the following command in <code>kubeflow/asm</code> directory to install the new ASM. Note, the old ASM will not be uninstalled.</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash"><span class="line"><span class="cl">make apply
</span></span></code></pre></div><p>Once installed successfully, you can see istiod <code>Deployment</code> in your cluster with name in pattern <code>istiod-asm-VERSION-REVISION</code>. For example, <code>istiod-asm-1132-5</code> would correspond to ASM version 1.13.2-asm.5.</p>
<h3 id="upgrade-other-kubeflow-components-to-use-new-asm">Upgrade other Kubeflow components to use new ASM</h3>
<p>There are multiple Kubeflow components with ASM namespace label, including user created namespaces. To upgrade them at once, change the following line in <code>kubeflow/env.sh</code> with the new ASM version <code>asm-VERSION-REVISION</code>, like <code>asm-1132-5</code>.</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash"><span class="line"><span class="cl"><span class="nb">export</span> <span class="nv">ASM_LABEL</span><span class="o">=</span>asm-1132-5
</span></span></code></pre></div><p>Then run the following commands in <code>kubeflow/</code> directory to configure the environmental variables:</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash"><span class="line"><span class="cl"><span class="nb">source</span> env.sh
</span></span></code></pre></div><p>Run the following command to configure kpt setter:</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash"><span class="line"><span class="cl">bash kpt-set.sh
</span></span></code></pre></div><p>Examine the change using source control after running the following command:</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash"><span class="line"><span class="cl">make hydrate
</span></span></code></pre></div><p>Refer to <a href="https://cloud.google.com/service-mesh/docs/unified-install/upgrade#deploying_and_redeploying_workloads">Deploying and redeploying workloads</a> for the complete steps to adopt the new ASM version. As part of the instructions, you can run the following command to update namespaces&rsquo; labels across the cluster:</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash"><span class="line"><span class="cl">make apply
</span></span></code></pre></div><h3 id="optional-uninstall-the-old-asm-workload">(Optional) Uninstall the old ASM workload</h3>
<p>Once you validated that new ASM installation and sidecar-injection for Kubeflow components are working as expected. You can <strong>Complete the transition</strong> to the new ASM or <strong>Rollback</strong> to the old ASM as instructed in <a href="https://cloud.google.com/service-mesh/docs/unified-install/upgrade#deploying_and_redeploying_workloads">Deploy and Redeploy workloads</a>.</p>

	
		<style>
  .feedback--answer {
    display: inline-block;
  }
  .feedback--answer-no {
    margin-left: 1em;
  }
  .feedback--response {
    display: none;
    margin-top: 1em;
  }
  .feedback--response__visible {
    display: block;
  }
</style>
<div class="card mt-4 col-12 col-sm-6">
  <div class="card-body">
    <h3 class="card-title">Feedback</h3>
    <p class="card-text">Was this page helpful?</p>
    <button class="btn btn-primary feedback--answer feedback--answer-yes" style="width: 5rem;">Yes</button>
    <button class="btn btn-primary feedback--answer feedback--answer-no" style="width: 5rem;">No</button>
    <p class="feedback--response feedback--response-yes">
      Thank you! <a href="https://github.com/googlecloudplatform/kubeflow-gke-docs/issues/new">Send your feedback to us</a>.
    </p>
    <p class="feedback--response feedback--response-no">
      Sorry to hear that. Please <a href="https://github.com/googlecloudplatform/kubeflow-gke-docs/issues/new">tell us how we can improve</a>.
    </p>
  </div>
</div>
<script>
  const yesButton = document.querySelector('.feedback--answer-yes');
  const noButton = document.querySelector('.feedback--answer-no');
  const yesResponse = document.querySelector('.feedback--response-yes');
  const noResponse = document.querySelector('.feedback--response-no');
  const disableButtons = () => {
    yesButton.disabled = true;
    noButton.disabled = true;
  };
  const sendFeedback = (value) => {
    if (typeof ga !== 'function') return;
    const args = {
      command: 'send',
      hitType: 'event',
      category: 'Helpful',
      action: 'click',
      label: window.location.pathname,
      value: value
    };
    ga(args.command, args.hitType, args.category, args.action, args.label, args.value);
  };
  yesButton.addEventListener('click', () => {
    yesResponse.classList.add('feedback--response__visible');
    disableButtons();
    sendFeedback(1);
  });
  noButton.addEventListener('click', () => {
    noResponse.classList.add('feedback--response__visible');
    disableButtons();
    sendFeedback(0);
  });
</script>

		<br />
	
	
	
</div>


          </main>
        </div>
      </div>
      
<footer class="bg-dark pt-3 row d-print-none">
  <div class="container-fluid mx-sm-5">
    <div class="row">
      <div class="col-6 col-sm-4 text-xs-center order-sm-2">
        
        
        
<ul class="list-inline mb-0">
  
  <li class="list-inline-item mx-2 h3" data-toggle="tooltip" data-placement="top" title="Kubeflow mailing list" aria-label="Kubeflow mailing list">
    <a class="text-white" target="_blank" rel="noopener" href="https://www.kubeflow.org/docs/about/community/#kubeflow-mailing-list" aria-label="Kubeflow mailing list">
      <i class="fa fa-envelope"></i>
    </a>
  </li>
  
  <li class="list-inline-item mx-2 h3" data-toggle="tooltip" data-placement="top" title="Slack" aria-label="Slack">
    <a class="text-white" target="_blank" rel="noopener" href="https://www.kubeflow.org/docs/about/community/#kubeflow-slack" aria-label="Slack">
      <i class="fab fa-slack"></i>
    </a>
  </li>
  
  <li class="list-inline-item mx-2 h3" data-toggle="tooltip" data-placement="top" title="Twitter" aria-label="Twitter">
    <a class="text-white" target="_blank" rel="noopener" href="https://twitter.com/kubeflow" aria-label="Twitter">
      <i class="fab fa-twitter"></i>
    </a>
  </li>
  
  <li class="list-inline-item mx-2 h3" data-toggle="tooltip" data-placement="top" title="Stack Overflow" aria-label="Stack Overflow">
    <a class="text-white" target="_blank" rel="noopener" href="https://stackoverflow.com/questions/tagged/kubeflow" aria-label="Stack Overflow">
      <i class="fab fa-stack-overflow"></i>
    </a>
  </li>
  
</ul>

        
        
      </div>
      <div class="col-12 col-sm-4 text-center py-2 order-sm-2">
        <small class="text-white">&copy; 2023 The Kubeflow Authors. | Documentation Distributed under CC BY 4.0</small>
        <p><small class="ml-1"><a href="https://policies.google.com/privacy" target="_blank" rel="noopener">Privacy Policy</a></small></p>
	
		
	
      </div>
      <div class="col-6 col-sm-4 text-right text-xs-center order-sm-3">
        
        
        
<ul class="list-inline mb-0">
  
  <li class="list-inline-item mx-2 h3" data-toggle="tooltip" data-placement="top" title="GitHub" aria-label="GitHub">
    <a class="text-white" target="_blank" rel="noopener" href="https://github.com/googlecloudplatform/kubeflow-distribution" aria-label="GitHub">
      <i class="fab fa-github"></i>
    </a>
  </li>
  
  <li class="list-inline-item mx-2 h3" data-toggle="tooltip" data-placement="top" title="Kubeflow community calendar" aria-label="Kubeflow community calendar">
    <a class="text-white" target="_blank" rel="noopener" href="https://www.kubeflow.org/docs/about/community/#kubeflow-community-calendars" aria-label="Kubeflow community calendar">
      <i class="fa fa-calendar"></i>
    </a>
  </li>
  
</ul>

        
        
      </div>
    </div>
  </div>
</footer>


    </div>
    <script src="/kubeflow-gke-docs/dev/js/main.min.540ec1b72bead82cdc6abc13982a46cdc63ebeadb6d74fdb7a408a5424892f20.js" integrity="sha256-VA7Btyvq2CzcarwTmCpGzcY&#43;vq2210/bekCKVCSJLyA=" crossorigin="anonymous"></script>
<script src='/kubeflow-gke-docs/dev/js/tabpane-persist.js'></script>

  </body>
</html>